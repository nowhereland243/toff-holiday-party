console.log("Theme.js starting");var B1=Object.defineProperty;var V1=(r,e,t)=>e in r?B1(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t;var q=(r,e,t)=>(V1(r,typeof e!="symbol"?e+"":e,t),t);function z1(r,e){for(var t=0;t<e.length;t++){const i=e[t];if(typeof i!="string"&&!Array.isArray(i)){for(const n in i)if(n!=="default"&&!(n in r)){const s=Object.getOwnPropertyDescriptor(i,n);s&&Object.defineProperty(r,n,s.get?s:{enumerable:!0,get:()=>i[n]})}}}return Object.freeze(Object.defineProperty(r,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))i(n);new MutationObserver(n=>{for(const s of n)if(s.type==="childList")for(const a of s.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&i(a)}).observe(document,{childList:!0,subtree:!0});function t(n){const s={};return n.integrity&&(s.integrity=n.integrity),n.referrerPolicy&&(s.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?s.credentials="include":n.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function i(n){if(n.ep)return;n.ep=!0;const s=t(n);fetch(n.href,s)}})();/**
 * @license
 * Copyright 2010-2022 Three.js Authors
 * SPDX-License-Identifier: MIT
 */const gm="148",xa={LEFT:0,MIDDLE:1,RIGHT:2,ROTATE:0,DOLLY:1,PAN:2},wa={ROTATE:0,PAN:1,DOLLY_PAN:2,DOLLY_ROTATE:3},U1=0,i_=1,G1=2,Z0=1,H1=2,gc=3,Ns=0,Vn=1,lu=2,Hu=3,cr=0,Fo=1,xf=2,wf=3,yf=4,J0=5,Ua=100,W1=101,j1=102,n_=103,s_=104,q1=200,X1=201,$1=202,Y1=203,Q0=204,eb=205,K1=206,Z1=207,J1=208,Q1=209,eS=210,tS=0,iS=1,nS=2,Sf=3,sS=4,rS=5,oS=6,aS=7,tb=0,lS=1,cS=2,ur=0,uS=1,hS=2,dS=3,pS=4,fS=5,ib=300,ol=301,al=302,Mf=303,Tf=304,cd=306,Kr=1e3,bn=1001,qh=1002,Ai=1003,Ef=1004,kh=1005,Ui=1006,nb=1007,dr=1008,Yo=1009,mS=1010,gS=1011,sb=1012,_S=1013,Lo=1014,zr=1015,Gc=1016,vS=1017,bS=1018,Ja=1020,xS=1021,wS=1022,es=1023,yS=1024,SS=1025,Oo=1026,ll=1027,MS=1028,TS=1029,ES=1030,CS=1031,DS=1033,hp=33776,dp=33777,pp=33778,fp=33779,r_=35840,o_=35841,a_=35842,l_=35843,PS=36196,c_=37492,u_=37496,h_=37808,d_=37809,p_=37810,f_=37811,m_=37812,g_=37813,__=37814,v_=37815,b_=37816,x_=37817,w_=37818,y_=37819,S_=37820,M_=37821,T_=36492,Hc=2300,cl=2301,mp=2302,E_=2400,C_=2401,D_=2402,AS=2500,LS=1,rb=2,pr=3e3,Gt=3001,RS=3200,kS=3201,ob=0,IS=1,Ts="srgb",Wc="srgb-linear",gp=7680,FS=519,Cf=35044,P_="300 es",Df=1035;class ra{addEventListener(e,t){this._listeners===void 0&&(this._listeners={});const i=this._listeners;i[e]===void 0&&(i[e]=[]),i[e].indexOf(t)===-1&&i[e].push(t)}hasEventListener(e,t){if(this._listeners===void 0)return!1;const i=this._listeners;return i[e]!==void 0&&i[e].indexOf(t)!==-1}removeEventListener(e,t){if(this._listeners===void 0)return;const n=this._listeners[e];if(n!==void 0){const s=n.indexOf(t);s!==-1&&n.splice(s,1)}}dispatchEvent(e){if(this._listeners===void 0)return;const i=this._listeners[e.type];if(i!==void 0){e.target=this;const n=i.slice(0);for(let s=0,a=n.length;s<a;s++)n[s].call(this,e);e.target=null}}}const Ni=["00","01","02","03","04","05","06","07","08","09","0a","0b","0c","0d","0e","0f","10","11","12","13","14","15","16","17","18","19","1a","1b","1c","1d","1e","1f","20","21","22","23","24","25","26","27","28","29","2a","2b","2c","2d","2e","2f","30","31","32","33","34","35","36","37","38","39","3a","3b","3c","3d","3e","3f","40","41","42","43","44","45","46","47","48","49","4a","4b","4c","4d","4e","4f","50","51","52","53","54","55","56","57","58","59","5a","5b","5c","5d","5e","5f","60","61","62","63","64","65","66","67","68","69","6a","6b","6c","6d","6e","6f","70","71","72","73","74","75","76","77","78","79","7a","7b","7c","7d","7e","7f","80","81","82","83","84","85","86","87","88","89","8a","8b","8c","8d","8e","8f","90","91","92","93","94","95","96","97","98","99","9a","9b","9c","9d","9e","9f","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","aa","ab","ac","ad","ae","af","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","ba","bb","bc","bd","be","bf","c0","c1","c2","c3","c4","c5","c6","c7","c8","c9","ca","cb","cc","cd","ce","cf","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","da","db","dc","dd","de","df","e0","e1","e2","e3","e4","e5","e6","e7","e8","e9","ea","eb","ec","ed","ee","ef","f0","f1","f2","f3","f4","f5","f6","f7","f8","f9","fa","fb","fc","fd","fe","ff"];let A_=1234567;const Tc=Math.PI/180,jc=180/Math.PI;function _s(){const r=Math.random()*4294967295|0,e=Math.random()*4294967295|0,t=Math.random()*4294967295|0,i=Math.random()*4294967295|0;return(Ni[r&255]+Ni[r>>8&255]+Ni[r>>16&255]+Ni[r>>24&255]+"-"+Ni[e&255]+Ni[e>>8&255]+"-"+Ni[e>>16&15|64]+Ni[e>>24&255]+"-"+Ni[t&63|128]+Ni[t>>8&255]+"-"+Ni[t>>16&255]+Ni[t>>24&255]+Ni[i&255]+Ni[i>>8&255]+Ni[i>>16&255]+Ni[i>>24&255]).toLowerCase()}function Li(r,e,t){return Math.max(e,Math.min(t,r))}function _m(r,e){return(r%e+e)%e}function OS(r,e,t,i,n){return i+(r-e)*(n-i)/(t-e)}function NS(r,e,t){return r!==e?(t-r)/(e-r):0}function Ec(r,e,t){return(1-t)*r+t*e}function BS(r,e,t,i){return Ec(r,e,1-Math.exp(-t*i))}function VS(r,e=1){return e-Math.abs(_m(r,e*2)-e)}function zS(r,e,t){return r<=e?0:r>=t?1:(r=(r-e)/(t-e),r*r*(3-2*r))}function US(r,e,t){return r<=e?0:r>=t?1:(r=(r-e)/(t-e),r*r*r*(r*(r*6-15)+10))}function GS(r,e){return r+Math.floor(Math.random()*(e-r+1))}function HS(r,e){return r+Math.random()*(e-r)}function WS(r){return r*(.5-Math.random())}function jS(r){r!==void 0&&(A_=r);let e=A_+=1831565813;return e=Math.imul(e^e>>>15,e|1),e^=e+Math.imul(e^e>>>7,e|61),((e^e>>>14)>>>0)/4294967296}function qS(r){return r*Tc}function XS(r){return r*jc}function Pf(r){return(r&r-1)===0&&r!==0}function ab(r){return Math.pow(2,Math.ceil(Math.log(r)/Math.LN2))}function Xh(r){return Math.pow(2,Math.floor(Math.log(r)/Math.LN2))}function $S(r,e,t,i,n){const s=Math.cos,a=Math.sin,o=s(t/2),u=a(t/2),h=s((e+i)/2),f=a((e+i)/2),c=s((e-i)/2),d=a((e-i)/2),m=s((i-e)/2),x=a((i-e)/2);switch(n){case"XYX":r.set(o*f,u*c,u*d,o*h);break;case"YZY":r.set(u*d,o*f,u*c,o*h);break;case"ZXZ":r.set(u*c,u*d,o*f,o*h);break;case"XZX":r.set(o*f,u*x,u*m,o*h);break;case"YXY":r.set(u*m,o*f,u*x,o*h);break;case"ZYZ":r.set(u*x,u*m,o*f,o*h);break;default:console.warn("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: "+n)}}function or(r,e){switch(e.constructor){case Float32Array:return r;case Uint16Array:return r/65535;case Uint8Array:return r/255;case Int16Array:return Math.max(r/32767,-1);case Int8Array:return Math.max(r/127,-1);default:throw new Error("Invalid component type.")}}function Xt(r,e){switch(e.constructor){case Float32Array:return r;case Uint16Array:return Math.round(r*65535);case Uint8Array:return Math.round(r*255);case Int16Array:return Math.round(r*32767);case Int8Array:return Math.round(r*127);default:throw new Error("Invalid component type.")}}var No=Object.freeze({__proto__:null,DEG2RAD:Tc,RAD2DEG:jc,generateUUID:_s,clamp:Li,euclideanModulo:_m,mapLinear:OS,inverseLerp:NS,lerp:Ec,damp:BS,pingpong:VS,smoothstep:zS,smootherstep:US,randInt:GS,randFloat:HS,randFloatSpread:WS,seededRandom:jS,degToRad:qS,radToDeg:XS,isPowerOfTwo:Pf,ceilPowerOfTwo:ab,floorPowerOfTwo:Xh,setQuaternionFromProperEuler:$S,normalize:Xt,denormalize:or});class Ue{constructor(e=0,t=0){Ue.prototype.isVector2=!0,this.x=e,this.y=t}get width(){return this.x}set width(e){this.x=e}get height(){return this.y}set height(e){this.y=e}set(e,t){return this.x=e,this.y=t,this}setScalar(e){return this.x=e,this.y=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y)}copy(e){return this.x=e.x,this.y=e.y,this}add(e){return this.x+=e.x,this.y+=e.y,this}addScalar(e){return this.x+=e,this.y+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this}subScalar(e){return this.x-=e,this.y-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this}multiply(e){return this.x*=e.x,this.y*=e.y,this}multiplyScalar(e){return this.x*=e,this.y*=e,this}divide(e){return this.x/=e.x,this.y/=e.y,this}divideScalar(e){return this.multiplyScalar(1/e)}applyMatrix3(e){const t=this.x,i=this.y,n=e.elements;return this.x=n[0]*t+n[3]*i+n[6],this.y=n[1]*t+n[4]*i+n[7],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this}clampLength(e,t){const i=this.length();return this.divideScalar(i||1).multiplyScalar(Math.max(e,Math.min(t,i)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(e){return this.x*e.x+this.y*e.y}cross(e){return this.x*e.y-this.y*e.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,i=this.y-e.y;return t*t+i*i}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this}lerpVectors(e,t,i){return this.x=e.x+(t.x-e.x)*i,this.y=e.y+(t.y-e.y)*i,this}equals(e){return e.x===this.x&&e.y===this.y}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this}rotateAround(e,t){const i=Math.cos(t),n=Math.sin(t),s=this.x-e.x,a=this.y-e.y;return this.x=s*i-a*n+e.x,this.y=s*n+a*i+e.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}}class Nn{constructor(){Nn.prototype.isMatrix3=!0,this.elements=[1,0,0,0,1,0,0,0,1]}set(e,t,i,n,s,a,o,u,h){const f=this.elements;return f[0]=e,f[1]=n,f[2]=o,f[3]=t,f[4]=s,f[5]=u,f[6]=i,f[7]=a,f[8]=h,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(e){const t=this.elements,i=e.elements;return t[0]=i[0],t[1]=i[1],t[2]=i[2],t[3]=i[3],t[4]=i[4],t[5]=i[5],t[6]=i[6],t[7]=i[7],t[8]=i[8],this}extractBasis(e,t,i){return e.setFromMatrix3Column(this,0),t.setFromMatrix3Column(this,1),i.setFromMatrix3Column(this,2),this}setFromMatrix4(e){const t=e.elements;return this.set(t[0],t[4],t[8],t[1],t[5],t[9],t[2],t[6],t[10]),this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const i=e.elements,n=t.elements,s=this.elements,a=i[0],o=i[3],u=i[6],h=i[1],f=i[4],c=i[7],d=i[2],m=i[5],x=i[8],_=n[0],b=n[3],y=n[6],M=n[1],D=n[4],C=n[7],P=n[2],I=n[5],F=n[8];return s[0]=a*_+o*M+u*P,s[3]=a*b+o*D+u*I,s[6]=a*y+o*C+u*F,s[1]=h*_+f*M+c*P,s[4]=h*b+f*D+c*I,s[7]=h*y+f*C+c*F,s[2]=d*_+m*M+x*P,s[5]=d*b+m*D+x*I,s[8]=d*y+m*C+x*F,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[3]*=e,t[6]*=e,t[1]*=e,t[4]*=e,t[7]*=e,t[2]*=e,t[5]*=e,t[8]*=e,this}determinant(){const e=this.elements,t=e[0],i=e[1],n=e[2],s=e[3],a=e[4],o=e[5],u=e[6],h=e[7],f=e[8];return t*a*f-t*o*h-i*s*f+i*o*u+n*s*h-n*a*u}invert(){const e=this.elements,t=e[0],i=e[1],n=e[2],s=e[3],a=e[4],o=e[5],u=e[6],h=e[7],f=e[8],c=f*a-o*h,d=o*u-f*s,m=h*s-a*u,x=t*c+i*d+n*m;if(x===0)return this.set(0,0,0,0,0,0,0,0,0);const _=1/x;return e[0]=c*_,e[1]=(n*h-f*i)*_,e[2]=(o*i-n*a)*_,e[3]=d*_,e[4]=(f*t-n*u)*_,e[5]=(n*s-o*t)*_,e[6]=m*_,e[7]=(i*u-h*t)*_,e[8]=(a*t-i*s)*_,this}transpose(){let e;const t=this.elements;return e=t[1],t[1]=t[3],t[3]=e,e=t[2],t[2]=t[6],t[6]=e,e=t[5],t[5]=t[7],t[7]=e,this}getNormalMatrix(e){return this.setFromMatrix4(e).invert().transpose()}transposeIntoArray(e){const t=this.elements;return e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8],this}setUvTransform(e,t,i,n,s,a,o){const u=Math.cos(s),h=Math.sin(s);return this.set(i*u,i*h,-i*(u*a+h*o)+a+e,-n*h,n*u,-n*(-h*a+u*o)+o+t,0,0,1),this}scale(e,t){return this.premultiply(_p.makeScale(e,t)),this}rotate(e){return this.premultiply(_p.makeRotation(-e)),this}translate(e,t){return this.premultiply(_p.makeTranslation(e,t)),this}makeTranslation(e,t){return this.set(1,0,e,0,1,t,0,0,1),this}makeRotation(e){const t=Math.cos(e),i=Math.sin(e);return this.set(t,-i,0,i,t,0,0,0,1),this}makeScale(e,t){return this.set(e,0,0,0,t,0,0,0,1),this}equals(e){const t=this.elements,i=e.elements;for(let n=0;n<9;n++)if(t[n]!==i[n])return!1;return!0}fromArray(e,t=0){for(let i=0;i<9;i++)this.elements[i]=e[i+t];return this}toArray(e=[],t=0){const i=this.elements;return e[t]=i[0],e[t+1]=i[1],e[t+2]=i[2],e[t+3]=i[3],e[t+4]=i[4],e[t+5]=i[5],e[t+6]=i[6],e[t+7]=i[7],e[t+8]=i[8],e}clone(){return new this.constructor().fromArray(this.elements)}}const _p=new Nn;function lb(r){for(let e=r.length-1;e>=0;--e)if(r[e]>=65535)return!0;return!1}function qc(r){return document.createElementNS("http://www.w3.org/1999/xhtml",r)}function Bo(r){return r<.04045?r*.0773993808:Math.pow(r*.9478672986+.0521327014,2.4)}function Ih(r){return r<.0031308?r*12.92:1.055*Math.pow(r,.41666)-.055}const vp={[Ts]:{[Wc]:Bo},[Wc]:{[Ts]:Ih}},Ki={legacyMode:!0,get workingColorSpace(){return Wc},set workingColorSpace(r){console.warn("THREE.ColorManagement: .workingColorSpace is readonly.")},convert:function(r,e,t){if(this.legacyMode||e===t||!e||!t)return r;if(vp[e]&&vp[e][t]!==void 0){const i=vp[e][t];return r.r=i(r.r),r.g=i(r.g),r.b=i(r.b),r}throw new Error("Unsupported color space conversion.")},fromWorkingColorSpace:function(r,e){return this.convert(r,this.workingColorSpace,e)},toWorkingColorSpace:function(r,e){return this.convert(r,e,this.workingColorSpace)}},cb={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},xi={r:0,g:0,b:0},hs={h:0,s:0,l:0},Wu={h:0,s:0,l:0};function bp(r,e,t){return t<0&&(t+=1),t>1&&(t-=1),t<1/6?r+(e-r)*6*t:t<1/2?e:t<2/3?r+(e-r)*6*(2/3-t):r}function ju(r,e){return e.r=r.r,e.g=r.g,e.b=r.b,e}class pt{constructor(e,t,i){return this.isColor=!0,this.r=1,this.g=1,this.b=1,t===void 0&&i===void 0?this.set(e):this.setRGB(e,t,i)}set(e){return e&&e.isColor?this.copy(e):typeof e=="number"?this.setHex(e):typeof e=="string"&&this.setStyle(e),this}setScalar(e){return this.r=e,this.g=e,this.b=e,this}setHex(e,t=Ts){return e=Math.floor(e),this.r=(e>>16&255)/255,this.g=(e>>8&255)/255,this.b=(e&255)/255,Ki.toWorkingColorSpace(this,t),this}setRGB(e,t,i,n=Ki.workingColorSpace){return this.r=e,this.g=t,this.b=i,Ki.toWorkingColorSpace(this,n),this}setHSL(e,t,i,n=Ki.workingColorSpace){if(e=_m(e,1),t=Li(t,0,1),i=Li(i,0,1),t===0)this.r=this.g=this.b=i;else{const s=i<=.5?i*(1+t):i+t-i*t,a=2*i-s;this.r=bp(a,s,e+1/3),this.g=bp(a,s,e),this.b=bp(a,s,e-1/3)}return Ki.toWorkingColorSpace(this,n),this}setStyle(e,t=Ts){function i(s){s!==void 0&&parseFloat(s)<1&&console.warn("THREE.Color: Alpha component of "+e+" will be ignored.")}let n;if(n=/^((?:rgb|hsl)a?)\(([^\)]*)\)/.exec(e)){let s;const a=n[1],o=n[2];switch(a){case"rgb":case"rgba":if(s=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(o))return this.r=Math.min(255,parseInt(s[1],10))/255,this.g=Math.min(255,parseInt(s[2],10))/255,this.b=Math.min(255,parseInt(s[3],10))/255,Ki.toWorkingColorSpace(this,t),i(s[4]),this;if(s=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(o))return this.r=Math.min(100,parseInt(s[1],10))/100,this.g=Math.min(100,parseInt(s[2],10))/100,this.b=Math.min(100,parseInt(s[3],10))/100,Ki.toWorkingColorSpace(this,t),i(s[4]),this;break;case"hsl":case"hsla":if(s=/^\s*(\d*\.?\d+)\s*,\s*(\d*\.?\d+)\%\s*,\s*(\d*\.?\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(o)){const u=parseFloat(s[1])/360,h=parseFloat(s[2])/100,f=parseFloat(s[3])/100;return i(s[4]),this.setHSL(u,h,f,t)}break}}else if(n=/^\#([A-Fa-f\d]+)$/.exec(e)){const s=n[1],a=s.length;if(a===3)return this.r=parseInt(s.charAt(0)+s.charAt(0),16)/255,this.g=parseInt(s.charAt(1)+s.charAt(1),16)/255,this.b=parseInt(s.charAt(2)+s.charAt(2),16)/255,Ki.toWorkingColorSpace(this,t),this;if(a===6)return this.r=parseInt(s.charAt(0)+s.charAt(1),16)/255,this.g=parseInt(s.charAt(2)+s.charAt(3),16)/255,this.b=parseInt(s.charAt(4)+s.charAt(5),16)/255,Ki.toWorkingColorSpace(this,t),this}return e&&e.length>0?this.setColorName(e,t):this}setColorName(e,t=Ts){const i=cb[e.toLowerCase()];return i!==void 0?this.setHex(i,t):console.warn("THREE.Color: Unknown color "+e),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(e){return this.r=e.r,this.g=e.g,this.b=e.b,this}copySRGBToLinear(e){return this.r=Bo(e.r),this.g=Bo(e.g),this.b=Bo(e.b),this}copyLinearToSRGB(e){return this.r=Ih(e.r),this.g=Ih(e.g),this.b=Ih(e.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(e=Ts){return Ki.fromWorkingColorSpace(ju(this,xi),e),Li(xi.r*255,0,255)<<16^Li(xi.g*255,0,255)<<8^Li(xi.b*255,0,255)<<0}getHexString(e=Ts){return("000000"+this.getHex(e).toString(16)).slice(-6)}getHSL(e,t=Ki.workingColorSpace){Ki.fromWorkingColorSpace(ju(this,xi),t);const i=xi.r,n=xi.g,s=xi.b,a=Math.max(i,n,s),o=Math.min(i,n,s);let u,h;const f=(o+a)/2;if(o===a)u=0,h=0;else{const c=a-o;switch(h=f<=.5?c/(a+o):c/(2-a-o),a){case i:u=(n-s)/c+(n<s?6:0);break;case n:u=(s-i)/c+2;break;case s:u=(i-n)/c+4;break}u/=6}return e.h=u,e.s=h,e.l=f,e}getRGB(e,t=Ki.workingColorSpace){return Ki.fromWorkingColorSpace(ju(this,xi),t),e.r=xi.r,e.g=xi.g,e.b=xi.b,e}getStyle(e=Ts){return Ki.fromWorkingColorSpace(ju(this,xi),e),e!==Ts?`color(${e} ${xi.r} ${xi.g} ${xi.b})`:`rgb(${xi.r*255|0},${xi.g*255|0},${xi.b*255|0})`}offsetHSL(e,t,i){return this.getHSL(hs),hs.h+=e,hs.s+=t,hs.l+=i,this.setHSL(hs.h,hs.s,hs.l),this}add(e){return this.r+=e.r,this.g+=e.g,this.b+=e.b,this}addColors(e,t){return this.r=e.r+t.r,this.g=e.g+t.g,this.b=e.b+t.b,this}addScalar(e){return this.r+=e,this.g+=e,this.b+=e,this}sub(e){return this.r=Math.max(0,this.r-e.r),this.g=Math.max(0,this.g-e.g),this.b=Math.max(0,this.b-e.b),this}multiply(e){return this.r*=e.r,this.g*=e.g,this.b*=e.b,this}multiplyScalar(e){return this.r*=e,this.g*=e,this.b*=e,this}lerp(e,t){return this.r+=(e.r-this.r)*t,this.g+=(e.g-this.g)*t,this.b+=(e.b-this.b)*t,this}lerpColors(e,t,i){return this.r=e.r+(t.r-e.r)*i,this.g=e.g+(t.g-e.g)*i,this.b=e.b+(t.b-e.b)*i,this}lerpHSL(e,t){this.getHSL(hs),e.getHSL(Wu);const i=Ec(hs.h,Wu.h,t),n=Ec(hs.s,Wu.s,t),s=Ec(hs.l,Wu.l,t);return this.setHSL(i,n,s),this}equals(e){return e.r===this.r&&e.g===this.g&&e.b===this.b}fromArray(e,t=0){return this.r=e[t],this.g=e[t+1],this.b=e[t+2],this}toArray(e=[],t=0){return e[t]=this.r,e[t+1]=this.g,e[t+2]=this.b,e}fromBufferAttribute(e,t){return this.r=e.getX(t),this.g=e.getY(t),this.b=e.getZ(t),this}toJSON(){return this.getHex()}*[Symbol.iterator](){yield this.r,yield this.g,yield this.b}}pt.NAMES=cb;let ya;class ub{static getDataURL(e){if(/^data:/i.test(e.src)||typeof HTMLCanvasElement>"u")return e.src;let t;if(e instanceof HTMLCanvasElement)t=e;else{ya===void 0&&(ya=qc("canvas")),ya.width=e.width,ya.height=e.height;const i=ya.getContext("2d");e instanceof ImageData?i.putImageData(e,0,0):i.drawImage(e,0,0,e.width,e.height),t=ya}return t.width>2048||t.height>2048?(console.warn("THREE.ImageUtils.getDataURL: Image converted to jpg for performance reasons",e),t.toDataURL("image/jpeg",.6)):t.toDataURL("image/png")}static sRGBToLinear(e){if(typeof HTMLImageElement<"u"&&e instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&e instanceof ImageBitmap){const t=qc("canvas");t.width=e.width,t.height=e.height;const i=t.getContext("2d");i.drawImage(e,0,0,e.width,e.height);const n=i.getImageData(0,0,e.width,e.height),s=n.data;for(let a=0;a<s.length;a++)s[a]=Bo(s[a]/255)*255;return i.putImageData(n,0,0),t}else if(e.data){const t=e.data.slice(0);for(let i=0;i<t.length;i++)t instanceof Uint8Array||t instanceof Uint8ClampedArray?t[i]=Math.floor(Bo(t[i]/255)*255):t[i]=Bo(t[i]);return{data:t,width:e.width,height:e.height}}else return console.warn("THREE.ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied."),e}}class hb{constructor(e=null){this.isSource=!0,this.uuid=_s(),this.data=e,this.version=0}set needsUpdate(e){e===!0&&this.version++}toJSON(e){const t=e===void 0||typeof e=="string";if(!t&&e.images[this.uuid]!==void 0)return e.images[this.uuid];const i={uuid:this.uuid,url:""},n=this.data;if(n!==null){let s;if(Array.isArray(n)){s=[];for(let a=0,o=n.length;a<o;a++)n[a].isDataTexture?s.push(xp(n[a].image)):s.push(xp(n[a]))}else s=xp(n);i.url=s}return t||(e.images[this.uuid]=i),i}}function xp(r){return typeof HTMLImageElement<"u"&&r instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&r instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&r instanceof ImageBitmap?ub.getDataURL(r):r.data?{data:Array.from(r.data),width:r.width,height:r.height,type:r.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}let YS=0;class vi extends ra{constructor(e=vi.DEFAULT_IMAGE,t=vi.DEFAULT_MAPPING,i=bn,n=bn,s=Ui,a=dr,o=es,u=Yo,h=vi.DEFAULT_ANISOTROPY,f=pr){super(),this.isTexture=!0,Object.defineProperty(this,"id",{value:YS++}),this.uuid=_s(),this.name="",this.source=new hb(e),this.mipmaps=[],this.mapping=t,this.wrapS=i,this.wrapT=n,this.magFilter=s,this.minFilter=a,this.anisotropy=h,this.format=o,this.internalFormat=null,this.type=u,this.offset=new Ue(0,0),this.repeat=new Ue(1,1),this.center=new Ue(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new Nn,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.encoding=f,this.userData={},this.version=0,this.onUpdate=null,this.isRenderTargetTexture=!1,this.needsPMREMUpdate=!1}get image(){return this.source.data}set image(e){this.source.data=e}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}clone(){return new this.constructor().copy(this)}copy(e){return this.name=e.name,this.source=e.source,this.mipmaps=e.mipmaps.slice(0),this.mapping=e.mapping,this.wrapS=e.wrapS,this.wrapT=e.wrapT,this.magFilter=e.magFilter,this.minFilter=e.minFilter,this.anisotropy=e.anisotropy,this.format=e.format,this.internalFormat=e.internalFormat,this.type=e.type,this.offset.copy(e.offset),this.repeat.copy(e.repeat),this.center.copy(e.center),this.rotation=e.rotation,this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrix.copy(e.matrix),this.generateMipmaps=e.generateMipmaps,this.premultiplyAlpha=e.premultiplyAlpha,this.flipY=e.flipY,this.unpackAlignment=e.unpackAlignment,this.encoding=e.encoding,this.userData=JSON.parse(JSON.stringify(e.userData)),this.needsUpdate=!0,this}toJSON(e){const t=e===void 0||typeof e=="string";if(!t&&e.textures[this.uuid]!==void 0)return e.textures[this.uuid];const i={metadata:{version:4.5,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,image:this.source.toJSON(e).uuid,mapping:this.mapping,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,type:this.type,encoding:this.encoding,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,generateMipmaps:this.generateMipmaps,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};return Object.keys(this.userData).length>0&&(i.userData=this.userData),t||(e.textures[this.uuid]=i),i}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(e){if(this.mapping!==ib)return e;if(e.applyMatrix3(this.matrix),e.x<0||e.x>1)switch(this.wrapS){case Kr:e.x=e.x-Math.floor(e.x);break;case bn:e.x=e.x<0?0:1;break;case qh:Math.abs(Math.floor(e.x)%2)===1?e.x=Math.ceil(e.x)-e.x:e.x=e.x-Math.floor(e.x);break}if(e.y<0||e.y>1)switch(this.wrapT){case Kr:e.y=e.y-Math.floor(e.y);break;case bn:e.y=e.y<0?0:1;break;case qh:Math.abs(Math.floor(e.y)%2)===1?e.y=Math.ceil(e.y)-e.y:e.y=e.y-Math.floor(e.y);break}return this.flipY&&(e.y=1-e.y),e}set needsUpdate(e){e===!0&&(this.version++,this.source.needsUpdate=!0)}}vi.DEFAULT_IMAGE=null;vi.DEFAULT_MAPPING=ib;vi.DEFAULT_ANISOTROPY=1;class $t{constructor(e=0,t=0,i=0,n=1){$t.prototype.isVector4=!0,this.x=e,this.y=t,this.z=i,this.w=n}get width(){return this.z}set width(e){this.z=e}get height(){return this.w}set height(e){this.w=e}set(e,t,i,n){return this.x=e,this.y=t,this.z=i,this.w=n,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this.w=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setW(e){return this.w=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;case 3:this.w=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=e.w!==void 0?e.w:1,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this.w+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this.w=e.w+t.w,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this.w+=e.w*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this.w-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this.w=e.w-t.w,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this.w*=e.w,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this}applyMatrix4(e){const t=this.x,i=this.y,n=this.z,s=this.w,a=e.elements;return this.x=a[0]*t+a[4]*i+a[8]*n+a[12]*s,this.y=a[1]*t+a[5]*i+a[9]*n+a[13]*s,this.z=a[2]*t+a[6]*i+a[10]*n+a[14]*s,this.w=a[3]*t+a[7]*i+a[11]*n+a[15]*s,this}divideScalar(e){return this.multiplyScalar(1/e)}setAxisAngleFromQuaternion(e){this.w=2*Math.acos(e.w);const t=Math.sqrt(1-e.w*e.w);return t<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=e.x/t,this.y=e.y/t,this.z=e.z/t),this}setAxisAngleFromRotationMatrix(e){let t,i,n,s;const u=e.elements,h=u[0],f=u[4],c=u[8],d=u[1],m=u[5],x=u[9],_=u[2],b=u[6],y=u[10];if(Math.abs(f-d)<.01&&Math.abs(c-_)<.01&&Math.abs(x-b)<.01){if(Math.abs(f+d)<.1&&Math.abs(c+_)<.1&&Math.abs(x+b)<.1&&Math.abs(h+m+y-3)<.1)return this.set(1,0,0,0),this;t=Math.PI;const D=(h+1)/2,C=(m+1)/2,P=(y+1)/2,I=(f+d)/4,F=(c+_)/4,A=(x+b)/4;return D>C&&D>P?D<.01?(i=0,n=.707106781,s=.707106781):(i=Math.sqrt(D),n=I/i,s=F/i):C>P?C<.01?(i=.707106781,n=0,s=.707106781):(n=Math.sqrt(C),i=I/n,s=A/n):P<.01?(i=.707106781,n=.707106781,s=0):(s=Math.sqrt(P),i=F/s,n=A/s),this.set(i,n,s,t),this}let M=Math.sqrt((b-x)*(b-x)+(c-_)*(c-_)+(d-f)*(d-f));return Math.abs(M)<.001&&(M=1),this.x=(b-x)/M,this.y=(c-_)/M,this.z=(d-f)/M,this.w=Math.acos((h+m+y-1)/2),this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this.w=Math.min(this.w,e.w),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this.w=Math.max(this.w,e.w),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this.w=Math.max(e.w,Math.min(t.w,this.w)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this.w=Math.max(e,Math.min(t,this.w)),this}clampLength(e,t){const i=this.length();return this.divideScalar(i||1).multiplyScalar(Math.max(e,Math.min(t,i)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this.w=this.w<0?Math.ceil(this.w):Math.floor(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this.w+=(e.w-this.w)*t,this}lerpVectors(e,t,i){return this.x=e.x+(t.x-e.x)*i,this.y=e.y+(t.y-e.y)*i,this.z=e.z+(t.z-e.z)*i,this.w=e.w+(t.w-e.w)*i,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this.w=e[t+3],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e[t+3]=this.w,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this.w=e.getW(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z,yield this.w}}class Ko extends ra{constructor(e=1,t=1,i={}){super(),this.isWebGLRenderTarget=!0,this.width=e,this.height=t,this.depth=1,this.scissor=new $t(0,0,e,t),this.scissorTest=!1,this.viewport=new $t(0,0,e,t);const n={width:e,height:t,depth:1};this.texture=new vi(n,i.mapping,i.wrapS,i.wrapT,i.magFilter,i.minFilter,i.format,i.type,i.anisotropy,i.encoding),this.texture.isRenderTargetTexture=!0,this.texture.flipY=!1,this.texture.generateMipmaps=i.generateMipmaps!==void 0?i.generateMipmaps:!1,this.texture.internalFormat=i.internalFormat!==void 0?i.internalFormat:null,this.texture.minFilter=i.minFilter!==void 0?i.minFilter:Ui,this.depthBuffer=i.depthBuffer!==void 0?i.depthBuffer:!0,this.stencilBuffer=i.stencilBuffer!==void 0?i.stencilBuffer:!1,this.depthTexture=i.depthTexture!==void 0?i.depthTexture:null,this.samples=i.samples!==void 0?i.samples:0}setSize(e,t,i=1){(this.width!==e||this.height!==t||this.depth!==i)&&(this.width=e,this.height=t,this.depth=i,this.texture.image.width=e,this.texture.image.height=t,this.texture.image.depth=i,this.dispose()),this.viewport.set(0,0,e,t),this.scissor.set(0,0,e,t)}clone(){return new this.constructor().copy(this)}copy(e){this.width=e.width,this.height=e.height,this.depth=e.depth,this.viewport.copy(e.viewport),this.texture=e.texture.clone(),this.texture.isRenderTargetTexture=!0;const t=Object.assign({},e.texture.image);return this.texture.source=new hb(t),this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,e.depthTexture!==null&&(this.depthTexture=e.depthTexture.clone()),this.samples=e.samples,this}dispose(){this.dispatchEvent({type:"dispose"})}}class db extends vi{constructor(e=null,t=1,i=1,n=1){super(null),this.isDataArrayTexture=!0,this.image={data:e,width:t,height:i,depth:n},this.magFilter=Ai,this.minFilter=Ai,this.wrapR=bn,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class KS extends vi{constructor(e=null,t=1,i=1,n=1){super(null),this.isData3DTexture=!0,this.image={data:e,width:t,height:i,depth:n},this.magFilter=Ai,this.minFilter=Ai,this.wrapR=bn,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class vs{constructor(e=0,t=0,i=0,n=1){this.isQuaternion=!0,this._x=e,this._y=t,this._z=i,this._w=n}static slerpFlat(e,t,i,n,s,a,o){let u=i[n+0],h=i[n+1],f=i[n+2],c=i[n+3];const d=s[a+0],m=s[a+1],x=s[a+2],_=s[a+3];if(o===0){e[t+0]=u,e[t+1]=h,e[t+2]=f,e[t+3]=c;return}if(o===1){e[t+0]=d,e[t+1]=m,e[t+2]=x,e[t+3]=_;return}if(c!==_||u!==d||h!==m||f!==x){let b=1-o;const y=u*d+h*m+f*x+c*_,M=y>=0?1:-1,D=1-y*y;if(D>Number.EPSILON){const P=Math.sqrt(D),I=Math.atan2(P,y*M);b=Math.sin(b*I)/P,o=Math.sin(o*I)/P}const C=o*M;if(u=u*b+d*C,h=h*b+m*C,f=f*b+x*C,c=c*b+_*C,b===1-o){const P=1/Math.sqrt(u*u+h*h+f*f+c*c);u*=P,h*=P,f*=P,c*=P}}e[t]=u,e[t+1]=h,e[t+2]=f,e[t+3]=c}static multiplyQuaternionsFlat(e,t,i,n,s,a){const o=i[n],u=i[n+1],h=i[n+2],f=i[n+3],c=s[a],d=s[a+1],m=s[a+2],x=s[a+3];return e[t]=o*x+f*c+u*m-h*d,e[t+1]=u*x+f*d+h*c-o*m,e[t+2]=h*x+f*m+o*d-u*c,e[t+3]=f*x-o*c-u*d-h*m,e}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get w(){return this._w}set w(e){this._w=e,this._onChangeCallback()}set(e,t,i,n){return this._x=e,this._y=t,this._z=i,this._w=n,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(e){return this._x=e.x,this._y=e.y,this._z=e.z,this._w=e.w,this._onChangeCallback(),this}setFromEuler(e,t){const i=e._x,n=e._y,s=e._z,a=e._order,o=Math.cos,u=Math.sin,h=o(i/2),f=o(n/2),c=o(s/2),d=u(i/2),m=u(n/2),x=u(s/2);switch(a){case"XYZ":this._x=d*f*c+h*m*x,this._y=h*m*c-d*f*x,this._z=h*f*x+d*m*c,this._w=h*f*c-d*m*x;break;case"YXZ":this._x=d*f*c+h*m*x,this._y=h*m*c-d*f*x,this._z=h*f*x-d*m*c,this._w=h*f*c+d*m*x;break;case"ZXY":this._x=d*f*c-h*m*x,this._y=h*m*c+d*f*x,this._z=h*f*x+d*m*c,this._w=h*f*c-d*m*x;break;case"ZYX":this._x=d*f*c-h*m*x,this._y=h*m*c+d*f*x,this._z=h*f*x-d*m*c,this._w=h*f*c+d*m*x;break;case"YZX":this._x=d*f*c+h*m*x,this._y=h*m*c+d*f*x,this._z=h*f*x-d*m*c,this._w=h*f*c-d*m*x;break;case"XZY":this._x=d*f*c-h*m*x,this._y=h*m*c-d*f*x,this._z=h*f*x+d*m*c,this._w=h*f*c+d*m*x;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+a)}return t!==!1&&this._onChangeCallback(),this}setFromAxisAngle(e,t){const i=t/2,n=Math.sin(i);return this._x=e.x*n,this._y=e.y*n,this._z=e.z*n,this._w=Math.cos(i),this._onChangeCallback(),this}setFromRotationMatrix(e){const t=e.elements,i=t[0],n=t[4],s=t[8],a=t[1],o=t[5],u=t[9],h=t[2],f=t[6],c=t[10],d=i+o+c;if(d>0){const m=.5/Math.sqrt(d+1);this._w=.25/m,this._x=(f-u)*m,this._y=(s-h)*m,this._z=(a-n)*m}else if(i>o&&i>c){const m=2*Math.sqrt(1+i-o-c);this._w=(f-u)/m,this._x=.25*m,this._y=(n+a)/m,this._z=(s+h)/m}else if(o>c){const m=2*Math.sqrt(1+o-i-c);this._w=(s-h)/m,this._x=(n+a)/m,this._y=.25*m,this._z=(u+f)/m}else{const m=2*Math.sqrt(1+c-i-o);this._w=(a-n)/m,this._x=(s+h)/m,this._y=(u+f)/m,this._z=.25*m}return this._onChangeCallback(),this}setFromUnitVectors(e,t){let i=e.dot(t)+1;return i<Number.EPSILON?(i=0,Math.abs(e.x)>Math.abs(e.z)?(this._x=-e.y,this._y=e.x,this._z=0,this._w=i):(this._x=0,this._y=-e.z,this._z=e.y,this._w=i)):(this._x=e.y*t.z-e.z*t.y,this._y=e.z*t.x-e.x*t.z,this._z=e.x*t.y-e.y*t.x,this._w=i),this.normalize()}angleTo(e){return 2*Math.acos(Math.abs(Li(this.dot(e),-1,1)))}rotateTowards(e,t){const i=this.angleTo(e);if(i===0)return this;const n=Math.min(1,t/i);return this.slerp(e,n),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let e=this.length();return e===0?(this._x=0,this._y=0,this._z=0,this._w=1):(e=1/e,this._x=this._x*e,this._y=this._y*e,this._z=this._z*e,this._w=this._w*e),this._onChangeCallback(),this}multiply(e){return this.multiplyQuaternions(this,e)}premultiply(e){return this.multiplyQuaternions(e,this)}multiplyQuaternions(e,t){const i=e._x,n=e._y,s=e._z,a=e._w,o=t._x,u=t._y,h=t._z,f=t._w;return this._x=i*f+a*o+n*h-s*u,this._y=n*f+a*u+s*o-i*h,this._z=s*f+a*h+i*u-n*o,this._w=a*f-i*o-n*u-s*h,this._onChangeCallback(),this}slerp(e,t){if(t===0)return this;if(t===1)return this.copy(e);const i=this._x,n=this._y,s=this._z,a=this._w;let o=a*e._w+i*e._x+n*e._y+s*e._z;if(o<0?(this._w=-e._w,this._x=-e._x,this._y=-e._y,this._z=-e._z,o=-o):this.copy(e),o>=1)return this._w=a,this._x=i,this._y=n,this._z=s,this;const u=1-o*o;if(u<=Number.EPSILON){const m=1-t;return this._w=m*a+t*this._w,this._x=m*i+t*this._x,this._y=m*n+t*this._y,this._z=m*s+t*this._z,this.normalize(),this._onChangeCallback(),this}const h=Math.sqrt(u),f=Math.atan2(h,o),c=Math.sin((1-t)*f)/h,d=Math.sin(t*f)/h;return this._w=a*c+this._w*d,this._x=i*c+this._x*d,this._y=n*c+this._y*d,this._z=s*c+this._z*d,this._onChangeCallback(),this}slerpQuaternions(e,t,i){return this.copy(e).slerp(t,i)}random(){const e=Math.random(),t=Math.sqrt(1-e),i=Math.sqrt(e),n=2*Math.PI*Math.random(),s=2*Math.PI*Math.random();return this.set(t*Math.cos(n),i*Math.sin(s),i*Math.cos(s),t*Math.sin(n))}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w}fromArray(e,t=0){return this._x=e[t],this._y=e[t+1],this._z=e[t+2],this._w=e[t+3],this._onChangeCallback(),this}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._w,e}fromBufferAttribute(e,t){return this._x=e.getX(t),this._y=e.getY(t),this._z=e.getZ(t),this._w=e.getW(t),this}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._w}}class Z{constructor(e=0,t=0,i=0){Z.prototype.isVector3=!0,this.x=e,this.y=t,this.z=i}set(e,t,i){return i===void 0&&(i=this.z),this.x=e,this.y=t,this.z=i,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this}multiplyVectors(e,t){return this.x=e.x*t.x,this.y=e.y*t.y,this.z=e.z*t.z,this}applyEuler(e){return this.applyQuaternion(L_.setFromEuler(e))}applyAxisAngle(e,t){return this.applyQuaternion(L_.setFromAxisAngle(e,t))}applyMatrix3(e){const t=this.x,i=this.y,n=this.z,s=e.elements;return this.x=s[0]*t+s[3]*i+s[6]*n,this.y=s[1]*t+s[4]*i+s[7]*n,this.z=s[2]*t+s[5]*i+s[8]*n,this}applyNormalMatrix(e){return this.applyMatrix3(e).normalize()}applyMatrix4(e){const t=this.x,i=this.y,n=this.z,s=e.elements,a=1/(s[3]*t+s[7]*i+s[11]*n+s[15]);return this.x=(s[0]*t+s[4]*i+s[8]*n+s[12])*a,this.y=(s[1]*t+s[5]*i+s[9]*n+s[13])*a,this.z=(s[2]*t+s[6]*i+s[10]*n+s[14])*a,this}applyQuaternion(e){const t=this.x,i=this.y,n=this.z,s=e.x,a=e.y,o=e.z,u=e.w,h=u*t+a*n-o*i,f=u*i+o*t-s*n,c=u*n+s*i-a*t,d=-s*t-a*i-o*n;return this.x=h*u+d*-s+f*-o-c*-a,this.y=f*u+d*-a+c*-s-h*-o,this.z=c*u+d*-o+h*-a-f*-s,this}project(e){return this.applyMatrix4(e.matrixWorldInverse).applyMatrix4(e.projectionMatrix)}unproject(e){return this.applyMatrix4(e.projectionMatrixInverse).applyMatrix4(e.matrixWorld)}transformDirection(e){const t=this.x,i=this.y,n=this.z,s=e.elements;return this.x=s[0]*t+s[4]*i+s[8]*n,this.y=s[1]*t+s[5]*i+s[9]*n,this.z=s[2]*t+s[6]*i+s[10]*n,this.normalize()}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this}divideScalar(e){return this.multiplyScalar(1/e)}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this}clampLength(e,t){const i=this.length();return this.divideScalar(i||1).multiplyScalar(Math.max(e,Math.min(t,i)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this}lerpVectors(e,t,i){return this.x=e.x+(t.x-e.x)*i,this.y=e.y+(t.y-e.y)*i,this.z=e.z+(t.z-e.z)*i,this}cross(e){return this.crossVectors(this,e)}crossVectors(e,t){const i=e.x,n=e.y,s=e.z,a=t.x,o=t.y,u=t.z;return this.x=n*u-s*o,this.y=s*a-i*u,this.z=i*o-n*a,this}projectOnVector(e){const t=e.lengthSq();if(t===0)return this.set(0,0,0);const i=e.dot(this)/t;return this.copy(e).multiplyScalar(i)}projectOnPlane(e){return wp.copy(this).projectOnVector(e),this.sub(wp)}reflect(e){return this.sub(wp.copy(e).multiplyScalar(2*this.dot(e)))}angleTo(e){const t=Math.sqrt(this.lengthSq()*e.lengthSq());if(t===0)return Math.PI/2;const i=this.dot(e)/t;return Math.acos(Li(i,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,i=this.y-e.y,n=this.z-e.z;return t*t+i*i+n*n}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)+Math.abs(this.z-e.z)}setFromSpherical(e){return this.setFromSphericalCoords(e.radius,e.phi,e.theta)}setFromSphericalCoords(e,t,i){const n=Math.sin(t)*e;return this.x=n*Math.sin(i),this.y=Math.cos(t)*e,this.z=n*Math.cos(i),this}setFromCylindrical(e){return this.setFromCylindricalCoords(e.radius,e.theta,e.y)}setFromCylindricalCoords(e,t,i){return this.x=e*Math.sin(t),this.y=i,this.z=e*Math.cos(t),this}setFromMatrixPosition(e){const t=e.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this}setFromMatrixScale(e){const t=this.setFromMatrixColumn(e,0).length(),i=this.setFromMatrixColumn(e,1).length(),n=this.setFromMatrixColumn(e,2).length();return this.x=t,this.y=i,this.z=n,this}setFromMatrixColumn(e,t){return this.fromArray(e.elements,t*4)}setFromMatrix3Column(e,t){return this.fromArray(e.elements,t*3)}setFromEuler(e){return this.x=e._x,this.y=e._y,this.z=e._z,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){const e=(Math.random()-.5)*2,t=Math.random()*Math.PI*2,i=Math.sqrt(1-e**2);return this.x=i*Math.cos(t),this.y=i*Math.sin(t),this.z=e,this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}}const wp=new Z,L_=new vs;class Ml{constructor(e=new Z(1/0,1/0,1/0),t=new Z(-1/0,-1/0,-1/0)){this.isBox3=!0,this.min=e,this.max=t}set(e,t){return this.min.copy(e),this.max.copy(t),this}setFromArray(e){let t=1/0,i=1/0,n=1/0,s=-1/0,a=-1/0,o=-1/0;for(let u=0,h=e.length;u<h;u+=3){const f=e[u],c=e[u+1],d=e[u+2];f<t&&(t=f),c<i&&(i=c),d<n&&(n=d),f>s&&(s=f),c>a&&(a=c),d>o&&(o=d)}return this.min.set(t,i,n),this.max.set(s,a,o),this}setFromBufferAttribute(e){let t=1/0,i=1/0,n=1/0,s=-1/0,a=-1/0,o=-1/0;for(let u=0,h=e.count;u<h;u++){const f=e.getX(u),c=e.getY(u),d=e.getZ(u);f<t&&(t=f),c<i&&(i=c),d<n&&(n=d),f>s&&(s=f),c>a&&(a=c),d>o&&(o=d)}return this.min.set(t,i,n),this.max.set(s,a,o),this}setFromPoints(e){this.makeEmpty();for(let t=0,i=e.length;t<i;t++)this.expandByPoint(e[t]);return this}setFromCenterAndSize(e,t){const i=_o.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(i),this.max.copy(e).add(i),this}setFromObject(e,t=!1){return this.makeEmpty(),this.expandByObject(e,t)}clone(){return new this.constructor().copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(e){return this.isEmpty()?e.set(0,0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}expandByObject(e,t=!1){e.updateWorldMatrix(!1,!1);const i=e.geometry;if(i!==void 0)if(t&&i.attributes!=null&&i.attributes.position!==void 0){const s=i.attributes.position;for(let a=0,o=s.count;a<o;a++)_o.fromBufferAttribute(s,a).applyMatrix4(e.matrixWorld),this.expandByPoint(_o)}else i.boundingBox===null&&i.computeBoundingBox(),yp.copy(i.boundingBox),yp.applyMatrix4(e.matrixWorld),this.union(yp);const n=e.children;for(let s=0,a=n.length;s<a;s++)this.expandByObject(n[s],t);return this}containsPoint(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y||e.z<this.min.z||e.z>this.max.z)}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z}getParameter(e,t){return t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y||e.max.z<this.min.z||e.min.z>this.max.z)}intersectsSphere(e){return this.clampPoint(e.center,_o),_o.distanceToSquared(e.center)<=e.radius*e.radius}intersectsPlane(e){let t,i;return e.normal.x>0?(t=e.normal.x*this.min.x,i=e.normal.x*this.max.x):(t=e.normal.x*this.max.x,i=e.normal.x*this.min.x),e.normal.y>0?(t+=e.normal.y*this.min.y,i+=e.normal.y*this.max.y):(t+=e.normal.y*this.max.y,i+=e.normal.y*this.min.y),e.normal.z>0?(t+=e.normal.z*this.min.z,i+=e.normal.z*this.max.z):(t+=e.normal.z*this.max.z,i+=e.normal.z*this.min.z),t<=-e.constant&&i>=-e.constant}intersectsTriangle(e){if(this.isEmpty())return!1;this.getCenter(Ql),qu.subVectors(this.max,Ql),Sa.subVectors(e.a,Ql),Ma.subVectors(e.b,Ql),Ta.subVectors(e.c,Ql),Pr.subVectors(Ma,Sa),Ar.subVectors(Ta,Ma),vo.subVectors(Sa,Ta);let t=[0,-Pr.z,Pr.y,0,-Ar.z,Ar.y,0,-vo.z,vo.y,Pr.z,0,-Pr.x,Ar.z,0,-Ar.x,vo.z,0,-vo.x,-Pr.y,Pr.x,0,-Ar.y,Ar.x,0,-vo.y,vo.x,0];return!Sp(t,Sa,Ma,Ta,qu)||(t=[1,0,0,0,1,0,0,0,1],!Sp(t,Sa,Ma,Ta,qu))?!1:(Xu.crossVectors(Pr,Ar),t=[Xu.x,Xu.y,Xu.z],Sp(t,Sa,Ma,Ta,qu))}clampPoint(e,t){return t.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return _o.copy(e).clamp(this.min,this.max).sub(e).length()}getBoundingSphere(e){return this.getCenter(e.center),e.radius=this.getSize(_o).length()*.5,e}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}applyMatrix4(e){return this.isEmpty()?this:($s[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e),$s[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e),$s[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e),$s[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e),$s[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e),$s[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e),$s[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e),$s[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e),this.setFromPoints($s),this)}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}const $s=[new Z,new Z,new Z,new Z,new Z,new Z,new Z,new Z],_o=new Z,yp=new Ml,Sa=new Z,Ma=new Z,Ta=new Z,Pr=new Z,Ar=new Z,vo=new Z,Ql=new Z,qu=new Z,Xu=new Z,bo=new Z;function Sp(r,e,t,i,n){for(let s=0,a=r.length-3;s<=a;s+=3){bo.fromArray(r,s);const o=n.x*Math.abs(bo.x)+n.y*Math.abs(bo.y)+n.z*Math.abs(bo.z),u=e.dot(bo),h=t.dot(bo),f=i.dot(bo);if(Math.max(-Math.max(u,h,f),Math.min(u,h,f))>o)return!1}return!0}const ZS=new Ml,ec=new Z,Mp=new Z;class Tl{constructor(e=new Z,t=-1){this.center=e,this.radius=t}set(e,t){return this.center.copy(e),this.radius=t,this}setFromPoints(e,t){const i=this.center;t!==void 0?i.copy(t):ZS.setFromPoints(e).getCenter(i);let n=0;for(let s=0,a=e.length;s<a;s++)n=Math.max(n,i.distanceToSquared(e[s]));return this.radius=Math.sqrt(n),this}copy(e){return this.center.copy(e.center),this.radius=e.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(e){return e.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(e){return e.distanceTo(this.center)-this.radius}intersectsSphere(e){const t=this.radius+e.radius;return e.center.distanceToSquared(this.center)<=t*t}intersectsBox(e){return e.intersectsSphere(this)}intersectsPlane(e){return Math.abs(e.distanceToPoint(this.center))<=this.radius}clampPoint(e,t){const i=this.center.distanceToSquared(e);return t.copy(e),i>this.radius*this.radius&&(t.sub(this.center).normalize(),t.multiplyScalar(this.radius).add(this.center)),t}getBoundingBox(e){return this.isEmpty()?(e.makeEmpty(),e):(e.set(this.center,this.center),e.expandByScalar(this.radius),e)}applyMatrix4(e){return this.center.applyMatrix4(e),this.radius=this.radius*e.getMaxScaleOnAxis(),this}translate(e){return this.center.add(e),this}expandByPoint(e){if(this.isEmpty())return this.center.copy(e),this.radius=0,this;ec.subVectors(e,this.center);const t=ec.lengthSq();if(t>this.radius*this.radius){const i=Math.sqrt(t),n=(i-this.radius)*.5;this.center.addScaledVector(ec,n/i),this.radius+=n}return this}union(e){return e.isEmpty()?this:this.isEmpty()?(this.copy(e),this):(this.center.equals(e.center)===!0?this.radius=Math.max(this.radius,e.radius):(Mp.subVectors(e.center,this.center).setLength(e.radius),this.expandByPoint(ec.copy(e.center).add(Mp)),this.expandByPoint(ec.copy(e.center).sub(Mp))),this)}equals(e){return e.center.equals(this.center)&&e.radius===this.radius}clone(){return new this.constructor().copy(this)}}const Ys=new Z,Tp=new Z,$u=new Z,Lr=new Z,Ep=new Z,Yu=new Z,Cp=new Z;class ud{constructor(e=new Z,t=new Z(0,0,-1)){this.origin=e,this.direction=t}set(e,t){return this.origin.copy(e),this.direction.copy(t),this}copy(e){return this.origin.copy(e.origin),this.direction.copy(e.direction),this}at(e,t){return t.copy(this.direction).multiplyScalar(e).add(this.origin)}lookAt(e){return this.direction.copy(e).sub(this.origin).normalize(),this}recast(e){return this.origin.copy(this.at(e,Ys)),this}closestPointToPoint(e,t){t.subVectors(e,this.origin);const i=t.dot(this.direction);return i<0?t.copy(this.origin):t.copy(this.direction).multiplyScalar(i).add(this.origin)}distanceToPoint(e){return Math.sqrt(this.distanceSqToPoint(e))}distanceSqToPoint(e){const t=Ys.subVectors(e,this.origin).dot(this.direction);return t<0?this.origin.distanceToSquared(e):(Ys.copy(this.direction).multiplyScalar(t).add(this.origin),Ys.distanceToSquared(e))}distanceSqToSegment(e,t,i,n){Tp.copy(e).add(t).multiplyScalar(.5),$u.copy(t).sub(e).normalize(),Lr.copy(this.origin).sub(Tp);const s=e.distanceTo(t)*.5,a=-this.direction.dot($u),o=Lr.dot(this.direction),u=-Lr.dot($u),h=Lr.lengthSq(),f=Math.abs(1-a*a);let c,d,m,x;if(f>0)if(c=a*u-o,d=a*o-u,x=s*f,c>=0)if(d>=-x)if(d<=x){const _=1/f;c*=_,d*=_,m=c*(c+a*d+2*o)+d*(a*c+d+2*u)+h}else d=s,c=Math.max(0,-(a*d+o)),m=-c*c+d*(d+2*u)+h;else d=-s,c=Math.max(0,-(a*d+o)),m=-c*c+d*(d+2*u)+h;else d<=-x?(c=Math.max(0,-(-a*s+o)),d=c>0?-s:Math.min(Math.max(-s,-u),s),m=-c*c+d*(d+2*u)+h):d<=x?(c=0,d=Math.min(Math.max(-s,-u),s),m=d*(d+2*u)+h):(c=Math.max(0,-(a*s+o)),d=c>0?s:Math.min(Math.max(-s,-u),s),m=-c*c+d*(d+2*u)+h);else d=a>0?-s:s,c=Math.max(0,-(a*d+o)),m=-c*c+d*(d+2*u)+h;return i&&i.copy(this.direction).multiplyScalar(c).add(this.origin),n&&n.copy($u).multiplyScalar(d).add(Tp),m}intersectSphere(e,t){Ys.subVectors(e.center,this.origin);const i=Ys.dot(this.direction),n=Ys.dot(Ys)-i*i,s=e.radius*e.radius;if(n>s)return null;const a=Math.sqrt(s-n),o=i-a,u=i+a;return o<0&&u<0?null:o<0?this.at(u,t):this.at(o,t)}intersectsSphere(e){return this.distanceSqToPoint(e.center)<=e.radius*e.radius}distanceToPlane(e){const t=e.normal.dot(this.direction);if(t===0)return e.distanceToPoint(this.origin)===0?0:null;const i=-(this.origin.dot(e.normal)+e.constant)/t;return i>=0?i:null}intersectPlane(e,t){const i=this.distanceToPlane(e);return i===null?null:this.at(i,t)}intersectsPlane(e){const t=e.distanceToPoint(this.origin);return t===0||e.normal.dot(this.direction)*t<0}intersectBox(e,t){let i,n,s,a,o,u;const h=1/this.direction.x,f=1/this.direction.y,c=1/this.direction.z,d=this.origin;return h>=0?(i=(e.min.x-d.x)*h,n=(e.max.x-d.x)*h):(i=(e.max.x-d.x)*h,n=(e.min.x-d.x)*h),f>=0?(s=(e.min.y-d.y)*f,a=(e.max.y-d.y)*f):(s=(e.max.y-d.y)*f,a=(e.min.y-d.y)*f),i>a||s>n||((s>i||isNaN(i))&&(i=s),(a<n||isNaN(n))&&(n=a),c>=0?(o=(e.min.z-d.z)*c,u=(e.max.z-d.z)*c):(o=(e.max.z-d.z)*c,u=(e.min.z-d.z)*c),i>u||o>n)||((o>i||i!==i)&&(i=o),(u<n||n!==n)&&(n=u),n<0)?null:this.at(i>=0?i:n,t)}intersectsBox(e){return this.intersectBox(e,Ys)!==null}intersectTriangle(e,t,i,n,s){Ep.subVectors(t,e),Yu.subVectors(i,e),Cp.crossVectors(Ep,Yu);let a=this.direction.dot(Cp),o;if(a>0){if(n)return null;o=1}else if(a<0)o=-1,a=-a;else return null;Lr.subVectors(this.origin,e);const u=o*this.direction.dot(Yu.crossVectors(Lr,Yu));if(u<0)return null;const h=o*this.direction.dot(Ep.cross(Lr));if(h<0||u+h>a)return null;const f=-o*Lr.dot(Cp);return f<0?null:this.at(f/a,s)}applyMatrix4(e){return this.origin.applyMatrix4(e),this.direction.transformDirection(e),this}equals(e){return e.origin.equals(this.origin)&&e.direction.equals(this.direction)}clone(){return new this.constructor().copy(this)}}class Pt{constructor(){Pt.prototype.isMatrix4=!0,this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}set(e,t,i,n,s,a,o,u,h,f,c,d,m,x,_,b){const y=this.elements;return y[0]=e,y[4]=t,y[8]=i,y[12]=n,y[1]=s,y[5]=a,y[9]=o,y[13]=u,y[2]=h,y[6]=f,y[10]=c,y[14]=d,y[3]=m,y[7]=x,y[11]=_,y[15]=b,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return new Pt().fromArray(this.elements)}copy(e){const t=this.elements,i=e.elements;return t[0]=i[0],t[1]=i[1],t[2]=i[2],t[3]=i[3],t[4]=i[4],t[5]=i[5],t[6]=i[6],t[7]=i[7],t[8]=i[8],t[9]=i[9],t[10]=i[10],t[11]=i[11],t[12]=i[12],t[13]=i[13],t[14]=i[14],t[15]=i[15],this}copyPosition(e){const t=this.elements,i=e.elements;return t[12]=i[12],t[13]=i[13],t[14]=i[14],this}setFromMatrix3(e){const t=e.elements;return this.set(t[0],t[3],t[6],0,t[1],t[4],t[7],0,t[2],t[5],t[8],0,0,0,0,1),this}extractBasis(e,t,i){return e.setFromMatrixColumn(this,0),t.setFromMatrixColumn(this,1),i.setFromMatrixColumn(this,2),this}makeBasis(e,t,i){return this.set(e.x,t.x,i.x,0,e.y,t.y,i.y,0,e.z,t.z,i.z,0,0,0,0,1),this}extractRotation(e){const t=this.elements,i=e.elements,n=1/Ea.setFromMatrixColumn(e,0).length(),s=1/Ea.setFromMatrixColumn(e,1).length(),a=1/Ea.setFromMatrixColumn(e,2).length();return t[0]=i[0]*n,t[1]=i[1]*n,t[2]=i[2]*n,t[3]=0,t[4]=i[4]*s,t[5]=i[5]*s,t[6]=i[6]*s,t[7]=0,t[8]=i[8]*a,t[9]=i[9]*a,t[10]=i[10]*a,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromEuler(e){const t=this.elements,i=e.x,n=e.y,s=e.z,a=Math.cos(i),o=Math.sin(i),u=Math.cos(n),h=Math.sin(n),f=Math.cos(s),c=Math.sin(s);if(e.order==="XYZ"){const d=a*f,m=a*c,x=o*f,_=o*c;t[0]=u*f,t[4]=-u*c,t[8]=h,t[1]=m+x*h,t[5]=d-_*h,t[9]=-o*u,t[2]=_-d*h,t[6]=x+m*h,t[10]=a*u}else if(e.order==="YXZ"){const d=u*f,m=u*c,x=h*f,_=h*c;t[0]=d+_*o,t[4]=x*o-m,t[8]=a*h,t[1]=a*c,t[5]=a*f,t[9]=-o,t[2]=m*o-x,t[6]=_+d*o,t[10]=a*u}else if(e.order==="ZXY"){const d=u*f,m=u*c,x=h*f,_=h*c;t[0]=d-_*o,t[4]=-a*c,t[8]=x+m*o,t[1]=m+x*o,t[5]=a*f,t[9]=_-d*o,t[2]=-a*h,t[6]=o,t[10]=a*u}else if(e.order==="ZYX"){const d=a*f,m=a*c,x=o*f,_=o*c;t[0]=u*f,t[4]=x*h-m,t[8]=d*h+_,t[1]=u*c,t[5]=_*h+d,t[9]=m*h-x,t[2]=-h,t[6]=o*u,t[10]=a*u}else if(e.order==="YZX"){const d=a*u,m=a*h,x=o*u,_=o*h;t[0]=u*f,t[4]=_-d*c,t[8]=x*c+m,t[1]=c,t[5]=a*f,t[9]=-o*f,t[2]=-h*f,t[6]=m*c+x,t[10]=d-_*c}else if(e.order==="XZY"){const d=a*u,m=a*h,x=o*u,_=o*h;t[0]=u*f,t[4]=-c,t[8]=h*f,t[1]=d*c+_,t[5]=a*f,t[9]=m*c-x,t[2]=x*c-m,t[6]=o*f,t[10]=_*c+d}return t[3]=0,t[7]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromQuaternion(e){return this.compose(JS,e,QS)}lookAt(e,t,i){const n=this.elements;return Pn.subVectors(e,t),Pn.lengthSq()===0&&(Pn.z=1),Pn.normalize(),Rr.crossVectors(i,Pn),Rr.lengthSq()===0&&(Math.abs(i.z)===1?Pn.x+=1e-4:Pn.z+=1e-4,Pn.normalize(),Rr.crossVectors(i,Pn)),Rr.normalize(),Ku.crossVectors(Pn,Rr),n[0]=Rr.x,n[4]=Ku.x,n[8]=Pn.x,n[1]=Rr.y,n[5]=Ku.y,n[9]=Pn.y,n[2]=Rr.z,n[6]=Ku.z,n[10]=Pn.z,this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const i=e.elements,n=t.elements,s=this.elements,a=i[0],o=i[4],u=i[8],h=i[12],f=i[1],c=i[5],d=i[9],m=i[13],x=i[2],_=i[6],b=i[10],y=i[14],M=i[3],D=i[7],C=i[11],P=i[15],I=n[0],F=n[4],A=n[8],k=n[12],O=n[1],J=n[5],Q=n[9],X=n[13],j=n[2],K=n[6],ie=n[10],ee=n[14],V=n[3],_e=n[7],U=n[11],oe=n[15];return s[0]=a*I+o*O+u*j+h*V,s[4]=a*F+o*J+u*K+h*_e,s[8]=a*A+o*Q+u*ie+h*U,s[12]=a*k+o*X+u*ee+h*oe,s[1]=f*I+c*O+d*j+m*V,s[5]=f*F+c*J+d*K+m*_e,s[9]=f*A+c*Q+d*ie+m*U,s[13]=f*k+c*X+d*ee+m*oe,s[2]=x*I+_*O+b*j+y*V,s[6]=x*F+_*J+b*K+y*_e,s[10]=x*A+_*Q+b*ie+y*U,s[14]=x*k+_*X+b*ee+y*oe,s[3]=M*I+D*O+C*j+P*V,s[7]=M*F+D*J+C*K+P*_e,s[11]=M*A+D*Q+C*ie+P*U,s[15]=M*k+D*X+C*ee+P*oe,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[4]*=e,t[8]*=e,t[12]*=e,t[1]*=e,t[5]*=e,t[9]*=e,t[13]*=e,t[2]*=e,t[6]*=e,t[10]*=e,t[14]*=e,t[3]*=e,t[7]*=e,t[11]*=e,t[15]*=e,this}determinant(){const e=this.elements,t=e[0],i=e[4],n=e[8],s=e[12],a=e[1],o=e[5],u=e[9],h=e[13],f=e[2],c=e[6],d=e[10],m=e[14],x=e[3],_=e[7],b=e[11],y=e[15];return x*(+s*u*c-n*h*c-s*o*d+i*h*d+n*o*m-i*u*m)+_*(+t*u*m-t*h*d+s*a*d-n*a*m+n*h*f-s*u*f)+b*(+t*h*c-t*o*m-s*a*c+i*a*m+s*o*f-i*h*f)+y*(-n*o*f-t*u*c+t*o*d+n*a*c-i*a*d+i*u*f)}transpose(){const e=this.elements;let t;return t=e[1],e[1]=e[4],e[4]=t,t=e[2],e[2]=e[8],e[8]=t,t=e[6],e[6]=e[9],e[9]=t,t=e[3],e[3]=e[12],e[12]=t,t=e[7],e[7]=e[13],e[13]=t,t=e[11],e[11]=e[14],e[14]=t,this}setPosition(e,t,i){const n=this.elements;return e.isVector3?(n[12]=e.x,n[13]=e.y,n[14]=e.z):(n[12]=e,n[13]=t,n[14]=i),this}invert(){const e=this.elements,t=e[0],i=e[1],n=e[2],s=e[3],a=e[4],o=e[5],u=e[6],h=e[7],f=e[8],c=e[9],d=e[10],m=e[11],x=e[12],_=e[13],b=e[14],y=e[15],M=c*b*h-_*d*h+_*u*m-o*b*m-c*u*y+o*d*y,D=x*d*h-f*b*h-x*u*m+a*b*m+f*u*y-a*d*y,C=f*_*h-x*c*h+x*o*m-a*_*m-f*o*y+a*c*y,P=x*c*u-f*_*u-x*o*d+a*_*d+f*o*b-a*c*b,I=t*M+i*D+n*C+s*P;if(I===0)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);const F=1/I;return e[0]=M*F,e[1]=(_*d*s-c*b*s-_*n*m+i*b*m+c*n*y-i*d*y)*F,e[2]=(o*b*s-_*u*s+_*n*h-i*b*h-o*n*y+i*u*y)*F,e[3]=(c*u*s-o*d*s-c*n*h+i*d*h+o*n*m-i*u*m)*F,e[4]=D*F,e[5]=(f*b*s-x*d*s+x*n*m-t*b*m-f*n*y+t*d*y)*F,e[6]=(x*u*s-a*b*s-x*n*h+t*b*h+a*n*y-t*u*y)*F,e[7]=(a*d*s-f*u*s+f*n*h-t*d*h-a*n*m+t*u*m)*F,e[8]=C*F,e[9]=(x*c*s-f*_*s-x*i*m+t*_*m+f*i*y-t*c*y)*F,e[10]=(a*_*s-x*o*s+x*i*h-t*_*h-a*i*y+t*o*y)*F,e[11]=(f*o*s-a*c*s-f*i*h+t*c*h+a*i*m-t*o*m)*F,e[12]=P*F,e[13]=(f*_*n-x*c*n+x*i*d-t*_*d-f*i*b+t*c*b)*F,e[14]=(x*o*n-a*_*n-x*i*u+t*_*u+a*i*b-t*o*b)*F,e[15]=(a*c*n-f*o*n+f*i*u-t*c*u-a*i*d+t*o*d)*F,this}scale(e){const t=this.elements,i=e.x,n=e.y,s=e.z;return t[0]*=i,t[4]*=n,t[8]*=s,t[1]*=i,t[5]*=n,t[9]*=s,t[2]*=i,t[6]*=n,t[10]*=s,t[3]*=i,t[7]*=n,t[11]*=s,this}getMaxScaleOnAxis(){const e=this.elements,t=e[0]*e[0]+e[1]*e[1]+e[2]*e[2],i=e[4]*e[4]+e[5]*e[5]+e[6]*e[6],n=e[8]*e[8]+e[9]*e[9]+e[10]*e[10];return Math.sqrt(Math.max(t,i,n))}makeTranslation(e,t,i){return this.set(1,0,0,e,0,1,0,t,0,0,1,i,0,0,0,1),this}makeRotationX(e){const t=Math.cos(e),i=Math.sin(e);return this.set(1,0,0,0,0,t,-i,0,0,i,t,0,0,0,0,1),this}makeRotationY(e){const t=Math.cos(e),i=Math.sin(e);return this.set(t,0,i,0,0,1,0,0,-i,0,t,0,0,0,0,1),this}makeRotationZ(e){const t=Math.cos(e),i=Math.sin(e);return this.set(t,-i,0,0,i,t,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(e,t){const i=Math.cos(t),n=Math.sin(t),s=1-i,a=e.x,o=e.y,u=e.z,h=s*a,f=s*o;return this.set(h*a+i,h*o-n*u,h*u+n*o,0,h*o+n*u,f*o+i,f*u-n*a,0,h*u-n*o,f*u+n*a,s*u*u+i,0,0,0,0,1),this}makeScale(e,t,i){return this.set(e,0,0,0,0,t,0,0,0,0,i,0,0,0,0,1),this}makeShear(e,t,i,n,s,a){return this.set(1,i,s,0,e,1,a,0,t,n,1,0,0,0,0,1),this}compose(e,t,i){const n=this.elements,s=t._x,a=t._y,o=t._z,u=t._w,h=s+s,f=a+a,c=o+o,d=s*h,m=s*f,x=s*c,_=a*f,b=a*c,y=o*c,M=u*h,D=u*f,C=u*c,P=i.x,I=i.y,F=i.z;return n[0]=(1-(_+y))*P,n[1]=(m+C)*P,n[2]=(x-D)*P,n[3]=0,n[4]=(m-C)*I,n[5]=(1-(d+y))*I,n[6]=(b+M)*I,n[7]=0,n[8]=(x+D)*F,n[9]=(b-M)*F,n[10]=(1-(d+_))*F,n[11]=0,n[12]=e.x,n[13]=e.y,n[14]=e.z,n[15]=1,this}decompose(e,t,i){const n=this.elements;let s=Ea.set(n[0],n[1],n[2]).length();const a=Ea.set(n[4],n[5],n[6]).length(),o=Ea.set(n[8],n[9],n[10]).length();this.determinant()<0&&(s=-s),e.x=n[12],e.y=n[13],e.z=n[14],ds.copy(this);const h=1/s,f=1/a,c=1/o;return ds.elements[0]*=h,ds.elements[1]*=h,ds.elements[2]*=h,ds.elements[4]*=f,ds.elements[5]*=f,ds.elements[6]*=f,ds.elements[8]*=c,ds.elements[9]*=c,ds.elements[10]*=c,t.setFromRotationMatrix(ds),i.x=s,i.y=a,i.z=o,this}makePerspective(e,t,i,n,s,a){const o=this.elements,u=2*s/(t-e),h=2*s/(i-n),f=(t+e)/(t-e),c=(i+n)/(i-n),d=-(a+s)/(a-s),m=-2*a*s/(a-s);return o[0]=u,o[4]=0,o[8]=f,o[12]=0,o[1]=0,o[5]=h,o[9]=c,o[13]=0,o[2]=0,o[6]=0,o[10]=d,o[14]=m,o[3]=0,o[7]=0,o[11]=-1,o[15]=0,this}makeOrthographic(e,t,i,n,s,a){const o=this.elements,u=1/(t-e),h=1/(i-n),f=1/(a-s),c=(t+e)*u,d=(i+n)*h,m=(a+s)*f;return o[0]=2*u,o[4]=0,o[8]=0,o[12]=-c,o[1]=0,o[5]=2*h,o[9]=0,o[13]=-d,o[2]=0,o[6]=0,o[10]=-2*f,o[14]=-m,o[3]=0,o[7]=0,o[11]=0,o[15]=1,this}equals(e){const t=this.elements,i=e.elements;for(let n=0;n<16;n++)if(t[n]!==i[n])return!1;return!0}fromArray(e,t=0){for(let i=0;i<16;i++)this.elements[i]=e[i+t];return this}toArray(e=[],t=0){const i=this.elements;return e[t]=i[0],e[t+1]=i[1],e[t+2]=i[2],e[t+3]=i[3],e[t+4]=i[4],e[t+5]=i[5],e[t+6]=i[6],e[t+7]=i[7],e[t+8]=i[8],e[t+9]=i[9],e[t+10]=i[10],e[t+11]=i[11],e[t+12]=i[12],e[t+13]=i[13],e[t+14]=i[14],e[t+15]=i[15],e}}const Ea=new Z,ds=new Pt,JS=new Z(0,0,0),QS=new Z(1,1,1),Rr=new Z,Ku=new Z,Pn=new Z,R_=new Pt,k_=new vs;class El{constructor(e=0,t=0,i=0,n=El.DefaultOrder){this.isEuler=!0,this._x=e,this._y=t,this._z=i,this._order=n}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get order(){return this._order}set order(e){this._order=e,this._onChangeCallback()}set(e,t,i,n=this._order){return this._x=e,this._y=t,this._z=i,this._order=n,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(e){return this._x=e._x,this._y=e._y,this._z=e._z,this._order=e._order,this._onChangeCallback(),this}setFromRotationMatrix(e,t=this._order,i=!0){const n=e.elements,s=n[0],a=n[4],o=n[8],u=n[1],h=n[5],f=n[9],c=n[2],d=n[6],m=n[10];switch(t){case"XYZ":this._y=Math.asin(Li(o,-1,1)),Math.abs(o)<.9999999?(this._x=Math.atan2(-f,m),this._z=Math.atan2(-a,s)):(this._x=Math.atan2(d,h),this._z=0);break;case"YXZ":this._x=Math.asin(-Li(f,-1,1)),Math.abs(f)<.9999999?(this._y=Math.atan2(o,m),this._z=Math.atan2(u,h)):(this._y=Math.atan2(-c,s),this._z=0);break;case"ZXY":this._x=Math.asin(Li(d,-1,1)),Math.abs(d)<.9999999?(this._y=Math.atan2(-c,m),this._z=Math.atan2(-a,h)):(this._y=0,this._z=Math.atan2(u,s));break;case"ZYX":this._y=Math.asin(-Li(c,-1,1)),Math.abs(c)<.9999999?(this._x=Math.atan2(d,m),this._z=Math.atan2(u,s)):(this._x=0,this._z=Math.atan2(-a,h));break;case"YZX":this._z=Math.asin(Li(u,-1,1)),Math.abs(u)<.9999999?(this._x=Math.atan2(-f,h),this._y=Math.atan2(-c,s)):(this._x=0,this._y=Math.atan2(o,m));break;case"XZY":this._z=Math.asin(-Li(a,-1,1)),Math.abs(a)<.9999999?(this._x=Math.atan2(d,h),this._y=Math.atan2(o,s)):(this._x=Math.atan2(-f,m),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+t)}return this._order=t,i===!0&&this._onChangeCallback(),this}setFromQuaternion(e,t,i){return R_.makeRotationFromQuaternion(e),this.setFromRotationMatrix(R_,t,i)}setFromVector3(e,t=this._order){return this.set(e.x,e.y,e.z,t)}reorder(e){return k_.setFromEuler(this),this.setFromQuaternion(k_,e)}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._order===this._order}fromArray(e){return this._x=e[0],this._y=e[1],this._z=e[2],e[3]!==void 0&&(this._order=e[3]),this._onChangeCallback(),this}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._order,e}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._order}toVector3(){console.error("THREE.Euler: .toVector3() has been removed. Use Vector3.setFromEuler() instead")}}El.DefaultOrder="XYZ";El.RotationOrders=["XYZ","YZX","ZXY","XZY","YXZ","ZYX"];class vm{constructor(){this.mask=1}set(e){this.mask=(1<<e|0)>>>0}enable(e){this.mask|=1<<e|0}enableAll(){this.mask=-1}toggle(e){this.mask^=1<<e|0}disable(e){this.mask&=~(1<<e|0)}disableAll(){this.mask=0}test(e){return(this.mask&e.mask)!==0}isEnabled(e){return(this.mask&(1<<e|0))!==0}}let eM=0;const I_=new Z,Ca=new vs,Ks=new Pt,Zu=new Z,tc=new Z,tM=new Z,iM=new vs,F_=new Z(1,0,0),O_=new Z(0,1,0),N_=new Z(0,0,1),nM={type:"added"},B_={type:"removed"};class ei extends ra{constructor(){super(),this.isObject3D=!0,Object.defineProperty(this,"id",{value:eM++}),this.uuid=_s(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=ei.DefaultUp.clone();const e=new Z,t=new El,i=new vs,n=new Z(1,1,1);function s(){i.setFromEuler(t,!1)}function a(){t.setFromQuaternion(i,void 0,!1)}t._onChange(s),i._onChange(a),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:e},rotation:{configurable:!0,enumerable:!0,value:t},quaternion:{configurable:!0,enumerable:!0,value:i},scale:{configurable:!0,enumerable:!0,value:n},modelViewMatrix:{value:new Pt},normalMatrix:{value:new Nn}}),this.matrix=new Pt,this.matrixWorld=new Pt,this.matrixAutoUpdate=ei.DefaultMatrixAutoUpdate,this.matrixWorldNeedsUpdate=!1,this.matrixWorldAutoUpdate=ei.DefaultMatrixWorldAutoUpdate,this.layers=new vm,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.userData={}}onBeforeRender(){}onAfterRender(){}applyMatrix4(e){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(e),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(e){return this.quaternion.premultiply(e),this}setRotationFromAxisAngle(e,t){this.quaternion.setFromAxisAngle(e,t)}setRotationFromEuler(e){this.quaternion.setFromEuler(e,!0)}setRotationFromMatrix(e){this.quaternion.setFromRotationMatrix(e)}setRotationFromQuaternion(e){this.quaternion.copy(e)}rotateOnAxis(e,t){return Ca.setFromAxisAngle(e,t),this.quaternion.multiply(Ca),this}rotateOnWorldAxis(e,t){return Ca.setFromAxisAngle(e,t),this.quaternion.premultiply(Ca),this}rotateX(e){return this.rotateOnAxis(F_,e)}rotateY(e){return this.rotateOnAxis(O_,e)}rotateZ(e){return this.rotateOnAxis(N_,e)}translateOnAxis(e,t){return I_.copy(e).applyQuaternion(this.quaternion),this.position.add(I_.multiplyScalar(t)),this}translateX(e){return this.translateOnAxis(F_,e)}translateY(e){return this.translateOnAxis(O_,e)}translateZ(e){return this.translateOnAxis(N_,e)}localToWorld(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(this.matrixWorld)}worldToLocal(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(Ks.copy(this.matrixWorld).invert())}lookAt(e,t,i){e.isVector3?Zu.copy(e):Zu.set(e,t,i);const n=this.parent;this.updateWorldMatrix(!0,!1),tc.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?Ks.lookAt(tc,Zu,this.up):Ks.lookAt(Zu,tc,this.up),this.quaternion.setFromRotationMatrix(Ks),n&&(Ks.extractRotation(n.matrixWorld),Ca.setFromRotationMatrix(Ks),this.quaternion.premultiply(Ca.invert()))}add(e){if(arguments.length>1){for(let t=0;t<arguments.length;t++)this.add(arguments[t]);return this}return e===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",e),this):(e&&e.isObject3D?(e.parent!==null&&e.parent.remove(e),e.parent=this,this.children.push(e),e.dispatchEvent(nM)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",e),this)}remove(e){if(arguments.length>1){for(let i=0;i<arguments.length;i++)this.remove(arguments[i]);return this}const t=this.children.indexOf(e);return t!==-1&&(e.parent=null,this.children.splice(t,1),e.dispatchEvent(B_)),this}removeFromParent(){const e=this.parent;return e!==null&&e.remove(this),this}clear(){for(let e=0;e<this.children.length;e++){const t=this.children[e];t.parent=null,t.dispatchEvent(B_)}return this.children.length=0,this}attach(e){return this.updateWorldMatrix(!0,!1),Ks.copy(this.matrixWorld).invert(),e.parent!==null&&(e.parent.updateWorldMatrix(!0,!1),Ks.multiply(e.parent.matrixWorld)),e.applyMatrix4(Ks),this.add(e),e.updateWorldMatrix(!1,!0),this}getObjectById(e){return this.getObjectByProperty("id",e)}getObjectByName(e){return this.getObjectByProperty("name",e)}getObjectByProperty(e,t){if(this[e]===t)return this;for(let i=0,n=this.children.length;i<n;i++){const a=this.children[i].getObjectByProperty(e,t);if(a!==void 0)return a}}getObjectsByProperty(e,t){let i=[];this[e]===t&&i.push(this);for(let n=0,s=this.children.length;n<s;n++){const a=this.children[n].getObjectsByProperty(e,t);a.length>0&&(i=i.concat(a))}return i}getWorldPosition(e){return this.updateWorldMatrix(!0,!1),e.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(tc,e,tM),e}getWorldScale(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(tc,iM,e),e}getWorldDirection(e){this.updateWorldMatrix(!0,!1);const t=this.matrixWorld.elements;return e.set(t[8],t[9],t[10]).normalize()}raycast(){}traverse(e){e(this);const t=this.children;for(let i=0,n=t.length;i<n;i++)t[i].traverse(e)}traverseVisible(e){if(this.visible===!1)return;e(this);const t=this.children;for(let i=0,n=t.length;i<n;i++)t[i].traverseVisible(e)}traverseAncestors(e){const t=this.parent;t!==null&&(e(t),t.traverseAncestors(e))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(e){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||e)&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,e=!0);const t=this.children;for(let i=0,n=t.length;i<n;i++){const s=t[i];(s.matrixWorldAutoUpdate===!0||e===!0)&&s.updateMatrixWorld(e)}}updateWorldMatrix(e,t){const i=this.parent;if(e===!0&&i!==null&&i.matrixWorldAutoUpdate===!0&&i.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),t===!0){const n=this.children;for(let s=0,a=n.length;s<a;s++){const o=n[s];o.matrixWorldAutoUpdate===!0&&o.updateWorldMatrix(!1,!0)}}}toJSON(e){const t=e===void 0||typeof e=="string",i={};t&&(e={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{},nodes:{}},i.metadata={version:4.5,type:"Object",generator:"Object3D.toJSON"});const n={};n.uuid=this.uuid,n.type=this.type,this.name!==""&&(n.name=this.name),this.castShadow===!0&&(n.castShadow=!0),this.receiveShadow===!0&&(n.receiveShadow=!0),this.visible===!1&&(n.visible=!1),this.frustumCulled===!1&&(n.frustumCulled=!1),this.renderOrder!==0&&(n.renderOrder=this.renderOrder),Object.keys(this.userData).length>0&&(n.userData=this.userData),n.layers=this.layers.mask,n.matrix=this.matrix.toArray(),this.matrixAutoUpdate===!1&&(n.matrixAutoUpdate=!1),this.isInstancedMesh&&(n.type="InstancedMesh",n.count=this.count,n.instanceMatrix=this.instanceMatrix.toJSON(),this.instanceColor!==null&&(n.instanceColor=this.instanceColor.toJSON()));function s(o,u){return o[u.uuid]===void 0&&(o[u.uuid]=u.toJSON(e)),u.uuid}if(this.isScene)this.background&&(this.background.isColor?n.background=this.background.toJSON():this.background.isTexture&&(n.background=this.background.toJSON(e).uuid)),this.environment&&this.environment.isTexture&&this.environment.isRenderTargetTexture!==!0&&(n.environment=this.environment.toJSON(e).uuid);else if(this.isMesh||this.isLine||this.isPoints){n.geometry=s(e.geometries,this.geometry);const o=this.geometry.parameters;if(o!==void 0&&o.shapes!==void 0){const u=o.shapes;if(Array.isArray(u))for(let h=0,f=u.length;h<f;h++){const c=u[h];s(e.shapes,c)}else s(e.shapes,u)}}if(this.isSkinnedMesh&&(n.bindMode=this.bindMode,n.bindMatrix=this.bindMatrix.toArray(),this.skeleton!==void 0&&(s(e.skeletons,this.skeleton),n.skeleton=this.skeleton.uuid)),this.material!==void 0)if(Array.isArray(this.material)){const o=[];for(let u=0,h=this.material.length;u<h;u++)o.push(s(e.materials,this.material[u]));n.material=o}else n.material=s(e.materials,this.material);if(this.children.length>0){n.children=[];for(let o=0;o<this.children.length;o++)n.children.push(this.children[o].toJSON(e).object)}if(this.animations.length>0){n.animations=[];for(let o=0;o<this.animations.length;o++){const u=this.animations[o];n.animations.push(s(e.animations,u))}}if(t){const o=a(e.geometries),u=a(e.materials),h=a(e.textures),f=a(e.images),c=a(e.shapes),d=a(e.skeletons),m=a(e.animations),x=a(e.nodes);o.length>0&&(i.geometries=o),u.length>0&&(i.materials=u),h.length>0&&(i.textures=h),f.length>0&&(i.images=f),c.length>0&&(i.shapes=c),d.length>0&&(i.skeletons=d),m.length>0&&(i.animations=m),x.length>0&&(i.nodes=x)}return i.object=n,i;function a(o){const u=[];for(const h in o){const f=o[h];delete f.metadata,u.push(f)}return u}}clone(e){return new this.constructor().copy(this,e)}copy(e,t=!0){if(this.name=e.name,this.up.copy(e.up),this.position.copy(e.position),this.rotation.order=e.rotation.order,this.quaternion.copy(e.quaternion),this.scale.copy(e.scale),this.matrix.copy(e.matrix),this.matrixWorld.copy(e.matrixWorld),this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrixWorldNeedsUpdate=e.matrixWorldNeedsUpdate,this.matrixWorldAutoUpdate=e.matrixWorldAutoUpdate,this.layers.mask=e.layers.mask,this.visible=e.visible,this.castShadow=e.castShadow,this.receiveShadow=e.receiveShadow,this.frustumCulled=e.frustumCulled,this.renderOrder=e.renderOrder,this.userData=JSON.parse(JSON.stringify(e.userData)),t===!0)for(let i=0;i<e.children.length;i++){const n=e.children[i];this.add(n.clone())}return this}}ei.DefaultUp=new Z(0,1,0);ei.DefaultMatrixAutoUpdate=!0;ei.DefaultMatrixWorldAutoUpdate=!0;const ps=new Z,Zs=new Z,Dp=new Z,Js=new Z,Da=new Z,Pa=new Z,V_=new Z,Pp=new Z,Ap=new Z,Lp=new Z;class sr{constructor(e=new Z,t=new Z,i=new Z){this.a=e,this.b=t,this.c=i}static getNormal(e,t,i,n){n.subVectors(i,t),ps.subVectors(e,t),n.cross(ps);const s=n.lengthSq();return s>0?n.multiplyScalar(1/Math.sqrt(s)):n.set(0,0,0)}static getBarycoord(e,t,i,n,s){ps.subVectors(n,t),Zs.subVectors(i,t),Dp.subVectors(e,t);const a=ps.dot(ps),o=ps.dot(Zs),u=ps.dot(Dp),h=Zs.dot(Zs),f=Zs.dot(Dp),c=a*h-o*o;if(c===0)return s.set(-2,-1,-1);const d=1/c,m=(h*u-o*f)*d,x=(a*f-o*u)*d;return s.set(1-m-x,x,m)}static containsPoint(e,t,i,n){return this.getBarycoord(e,t,i,n,Js),Js.x>=0&&Js.y>=0&&Js.x+Js.y<=1}static getUV(e,t,i,n,s,a,o,u){return this.getBarycoord(e,t,i,n,Js),u.set(0,0),u.addScaledVector(s,Js.x),u.addScaledVector(a,Js.y),u.addScaledVector(o,Js.z),u}static isFrontFacing(e,t,i,n){return ps.subVectors(i,t),Zs.subVectors(e,t),ps.cross(Zs).dot(n)<0}set(e,t,i){return this.a.copy(e),this.b.copy(t),this.c.copy(i),this}setFromPointsAndIndices(e,t,i,n){return this.a.copy(e[t]),this.b.copy(e[i]),this.c.copy(e[n]),this}setFromAttributeAndIndices(e,t,i,n){return this.a.fromBufferAttribute(e,t),this.b.fromBufferAttribute(e,i),this.c.fromBufferAttribute(e,n),this}clone(){return new this.constructor().copy(this)}copy(e){return this.a.copy(e.a),this.b.copy(e.b),this.c.copy(e.c),this}getArea(){return ps.subVectors(this.c,this.b),Zs.subVectors(this.a,this.b),ps.cross(Zs).length()*.5}getMidpoint(e){return e.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(e){return sr.getNormal(this.a,this.b,this.c,e)}getPlane(e){return e.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(e,t){return sr.getBarycoord(e,this.a,this.b,this.c,t)}getUV(e,t,i,n,s){return sr.getUV(e,this.a,this.b,this.c,t,i,n,s)}containsPoint(e){return sr.containsPoint(e,this.a,this.b,this.c)}isFrontFacing(e){return sr.isFrontFacing(this.a,this.b,this.c,e)}intersectsBox(e){return e.intersectsTriangle(this)}closestPointToPoint(e,t){const i=this.a,n=this.b,s=this.c;let a,o;Da.subVectors(n,i),Pa.subVectors(s,i),Pp.subVectors(e,i);const u=Da.dot(Pp),h=Pa.dot(Pp);if(u<=0&&h<=0)return t.copy(i);Ap.subVectors(e,n);const f=Da.dot(Ap),c=Pa.dot(Ap);if(f>=0&&c<=f)return t.copy(n);const d=u*c-f*h;if(d<=0&&u>=0&&f<=0)return a=u/(u-f),t.copy(i).addScaledVector(Da,a);Lp.subVectors(e,s);const m=Da.dot(Lp),x=Pa.dot(Lp);if(x>=0&&m<=x)return t.copy(s);const _=m*h-u*x;if(_<=0&&h>=0&&x<=0)return o=h/(h-x),t.copy(i).addScaledVector(Pa,o);const b=f*x-m*c;if(b<=0&&c-f>=0&&m-x>=0)return V_.subVectors(s,n),o=(c-f)/(c-f+(m-x)),t.copy(n).addScaledVector(V_,o);const y=1/(b+_+d);return a=_*y,o=d*y,t.copy(i).addScaledVector(Da,a).addScaledVector(Pa,o)}equals(e){return e.a.equals(this.a)&&e.b.equals(this.b)&&e.c.equals(this.c)}}let sM=0;class ks extends ra{constructor(){super(),this.isMaterial=!0,Object.defineProperty(this,"id",{value:sM++}),this.uuid=_s(),this.name="",this.type="Material",this.blending=Fo,this.side=Ns,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.blendSrc=Q0,this.blendDst=eb,this.blendEquation=Ua,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.depthFunc=Sf,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=FS,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=gp,this.stencilZFail=gp,this.stencilZPass=gp,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0,this._alphaTest=0}get alphaTest(){return this._alphaTest}set alphaTest(e){this._alphaTest>0!=e>0&&this.version++,this._alphaTest=e}onBuild(){}onBeforeRender(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(e){if(e!==void 0)for(const t in e){const i=e[t];if(i===void 0){console.warn("THREE.Material: '"+t+"' parameter is undefined.");continue}const n=this[t];if(n===void 0){console.warn("THREE."+this.type+": '"+t+"' is not a property of this material.");continue}n&&n.isColor?n.set(i):n&&n.isVector3&&i&&i.isVector3?n.copy(i):this[t]=i}}toJSON(e){const t=e===void 0||typeof e=="string";t&&(e={textures:{},images:{}});const i={metadata:{version:4.5,type:"Material",generator:"Material.toJSON"}};i.uuid=this.uuid,i.type=this.type,this.name!==""&&(i.name=this.name),this.color&&this.color.isColor&&(i.color=this.color.getHex()),this.roughness!==void 0&&(i.roughness=this.roughness),this.metalness!==void 0&&(i.metalness=this.metalness),this.sheen!==void 0&&(i.sheen=this.sheen),this.sheenColor&&this.sheenColor.isColor&&(i.sheenColor=this.sheenColor.getHex()),this.sheenRoughness!==void 0&&(i.sheenRoughness=this.sheenRoughness),this.emissive&&this.emissive.isColor&&(i.emissive=this.emissive.getHex()),this.emissiveIntensity&&this.emissiveIntensity!==1&&(i.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(i.specular=this.specular.getHex()),this.specularIntensity!==void 0&&(i.specularIntensity=this.specularIntensity),this.specularColor&&this.specularColor.isColor&&(i.specularColor=this.specularColor.getHex()),this.shininess!==void 0&&(i.shininess=this.shininess),this.clearcoat!==void 0&&(i.clearcoat=this.clearcoat),this.clearcoatRoughness!==void 0&&(i.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(i.clearcoatMap=this.clearcoatMap.toJSON(e).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(i.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(e).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(i.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(e).uuid,i.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),this.iridescence!==void 0&&(i.iridescence=this.iridescence),this.iridescenceIOR!==void 0&&(i.iridescenceIOR=this.iridescenceIOR),this.iridescenceThicknessRange!==void 0&&(i.iridescenceThicknessRange=this.iridescenceThicknessRange),this.iridescenceMap&&this.iridescenceMap.isTexture&&(i.iridescenceMap=this.iridescenceMap.toJSON(e).uuid),this.iridescenceThicknessMap&&this.iridescenceThicknessMap.isTexture&&(i.iridescenceThicknessMap=this.iridescenceThicknessMap.toJSON(e).uuid),this.map&&this.map.isTexture&&(i.map=this.map.toJSON(e).uuid),this.matcap&&this.matcap.isTexture&&(i.matcap=this.matcap.toJSON(e).uuid),this.alphaMap&&this.alphaMap.isTexture&&(i.alphaMap=this.alphaMap.toJSON(e).uuid),this.lightMap&&this.lightMap.isTexture&&(i.lightMap=this.lightMap.toJSON(e).uuid,i.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(i.aoMap=this.aoMap.toJSON(e).uuid,i.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(i.bumpMap=this.bumpMap.toJSON(e).uuid,i.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(i.normalMap=this.normalMap.toJSON(e).uuid,i.normalMapType=this.normalMapType,i.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(i.displacementMap=this.displacementMap.toJSON(e).uuid,i.displacementScale=this.displacementScale,i.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(i.roughnessMap=this.roughnessMap.toJSON(e).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(i.metalnessMap=this.metalnessMap.toJSON(e).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(i.emissiveMap=this.emissiveMap.toJSON(e).uuid),this.specularMap&&this.specularMap.isTexture&&(i.specularMap=this.specularMap.toJSON(e).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(i.specularIntensityMap=this.specularIntensityMap.toJSON(e).uuid),this.specularColorMap&&this.specularColorMap.isTexture&&(i.specularColorMap=this.specularColorMap.toJSON(e).uuid),this.envMap&&this.envMap.isTexture&&(i.envMap=this.envMap.toJSON(e).uuid,this.combine!==void 0&&(i.combine=this.combine)),this.envMapIntensity!==void 0&&(i.envMapIntensity=this.envMapIntensity),this.reflectivity!==void 0&&(i.reflectivity=this.reflectivity),this.refractionRatio!==void 0&&(i.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(i.gradientMap=this.gradientMap.toJSON(e).uuid),this.transmission!==void 0&&(i.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(i.transmissionMap=this.transmissionMap.toJSON(e).uuid),this.thickness!==void 0&&(i.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(i.thicknessMap=this.thicknessMap.toJSON(e).uuid),this.attenuationDistance!==void 0&&this.attenuationDistance!==1/0&&(i.attenuationDistance=this.attenuationDistance),this.attenuationColor!==void 0&&(i.attenuationColor=this.attenuationColor.getHex()),this.size!==void 0&&(i.size=this.size),this.shadowSide!==null&&(i.shadowSide=this.shadowSide),this.sizeAttenuation!==void 0&&(i.sizeAttenuation=this.sizeAttenuation),this.blending!==Fo&&(i.blending=this.blending),this.side!==Ns&&(i.side=this.side),this.vertexColors&&(i.vertexColors=!0),this.opacity<1&&(i.opacity=this.opacity),this.transparent===!0&&(i.transparent=this.transparent),i.depthFunc=this.depthFunc,i.depthTest=this.depthTest,i.depthWrite=this.depthWrite,i.colorWrite=this.colorWrite,i.stencilWrite=this.stencilWrite,i.stencilWriteMask=this.stencilWriteMask,i.stencilFunc=this.stencilFunc,i.stencilRef=this.stencilRef,i.stencilFuncMask=this.stencilFuncMask,i.stencilFail=this.stencilFail,i.stencilZFail=this.stencilZFail,i.stencilZPass=this.stencilZPass,this.rotation!==void 0&&this.rotation!==0&&(i.rotation=this.rotation),this.polygonOffset===!0&&(i.polygonOffset=!0),this.polygonOffsetFactor!==0&&(i.polygonOffsetFactor=this.polygonOffsetFactor),this.polygonOffsetUnits!==0&&(i.polygonOffsetUnits=this.polygonOffsetUnits),this.linewidth!==void 0&&this.linewidth!==1&&(i.linewidth=this.linewidth),this.dashSize!==void 0&&(i.dashSize=this.dashSize),this.gapSize!==void 0&&(i.gapSize=this.gapSize),this.scale!==void 0&&(i.scale=this.scale),this.dithering===!0&&(i.dithering=!0),this.alphaTest>0&&(i.alphaTest=this.alphaTest),this.alphaToCoverage===!0&&(i.alphaToCoverage=this.alphaToCoverage),this.premultipliedAlpha===!0&&(i.premultipliedAlpha=this.premultipliedAlpha),this.wireframe===!0&&(i.wireframe=this.wireframe),this.wireframeLinewidth>1&&(i.wireframeLinewidth=this.wireframeLinewidth),this.wireframeLinecap!=="round"&&(i.wireframeLinecap=this.wireframeLinecap),this.wireframeLinejoin!=="round"&&(i.wireframeLinejoin=this.wireframeLinejoin),this.flatShading===!0&&(i.flatShading=this.flatShading),this.visible===!1&&(i.visible=!1),this.toneMapped===!1&&(i.toneMapped=!1),this.fog===!1&&(i.fog=!1),Object.keys(this.userData).length>0&&(i.userData=this.userData);function n(s){const a=[];for(const o in s){const u=s[o];delete u.metadata,a.push(u)}return a}if(t){const s=n(e.textures),a=n(e.images);s.length>0&&(i.textures=s),a.length>0&&(i.images=a)}return i}clone(){return new this.constructor().copy(this)}copy(e){this.name=e.name,this.blending=e.blending,this.side=e.side,this.vertexColors=e.vertexColors,this.opacity=e.opacity,this.transparent=e.transparent,this.blendSrc=e.blendSrc,this.blendDst=e.blendDst,this.blendEquation=e.blendEquation,this.blendSrcAlpha=e.blendSrcAlpha,this.blendDstAlpha=e.blendDstAlpha,this.blendEquationAlpha=e.blendEquationAlpha,this.depthFunc=e.depthFunc,this.depthTest=e.depthTest,this.depthWrite=e.depthWrite,this.stencilWriteMask=e.stencilWriteMask,this.stencilFunc=e.stencilFunc,this.stencilRef=e.stencilRef,this.stencilFuncMask=e.stencilFuncMask,this.stencilFail=e.stencilFail,this.stencilZFail=e.stencilZFail,this.stencilZPass=e.stencilZPass,this.stencilWrite=e.stencilWrite;const t=e.clippingPlanes;let i=null;if(t!==null){const n=t.length;i=new Array(n);for(let s=0;s!==n;++s)i[s]=t[s].clone()}return this.clippingPlanes=i,this.clipIntersection=e.clipIntersection,this.clipShadows=e.clipShadows,this.shadowSide=e.shadowSide,this.colorWrite=e.colorWrite,this.precision=e.precision,this.polygonOffset=e.polygonOffset,this.polygonOffsetFactor=e.polygonOffsetFactor,this.polygonOffsetUnits=e.polygonOffsetUnits,this.dithering=e.dithering,this.alphaTest=e.alphaTest,this.alphaToCoverage=e.alphaToCoverage,this.premultipliedAlpha=e.premultipliedAlpha,this.visible=e.visible,this.toneMapped=e.toneMapped,this.userData=JSON.parse(JSON.stringify(e.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(e){e===!0&&this.version++}}class ar extends ks{constructor(e){super(),this.isMeshBasicMaterial=!0,this.type="MeshBasicMaterial",this.color=new pt(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=tb,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}}const mi=new Z,Ju=new Ue;class ln{constructor(e,t,i=!1){if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.isBufferAttribute=!0,this.name="",this.array=e,this.itemSize=t,this.count=e!==void 0?e.length/t:0,this.normalized=i,this.usage=Cf,this.updateRange={offset:0,count:-1},this.version=0}onUploadCallback(){}set needsUpdate(e){e===!0&&this.version++}setUsage(e){return this.usage=e,this}copy(e){return this.name=e.name,this.array=new e.array.constructor(e.array),this.itemSize=e.itemSize,this.count=e.count,this.normalized=e.normalized,this.usage=e.usage,this}copyAt(e,t,i){e*=this.itemSize,i*=t.itemSize;for(let n=0,s=this.itemSize;n<s;n++)this.array[e+n]=t.array[i+n];return this}copyArray(e){return this.array.set(e),this}applyMatrix3(e){if(this.itemSize===2)for(let t=0,i=this.count;t<i;t++)Ju.fromBufferAttribute(this,t),Ju.applyMatrix3(e),this.setXY(t,Ju.x,Ju.y);else if(this.itemSize===3)for(let t=0,i=this.count;t<i;t++)mi.fromBufferAttribute(this,t),mi.applyMatrix3(e),this.setXYZ(t,mi.x,mi.y,mi.z);return this}applyMatrix4(e){for(let t=0,i=this.count;t<i;t++)mi.fromBufferAttribute(this,t),mi.applyMatrix4(e),this.setXYZ(t,mi.x,mi.y,mi.z);return this}applyNormalMatrix(e){for(let t=0,i=this.count;t<i;t++)mi.fromBufferAttribute(this,t),mi.applyNormalMatrix(e),this.setXYZ(t,mi.x,mi.y,mi.z);return this}transformDirection(e){for(let t=0,i=this.count;t<i;t++)mi.fromBufferAttribute(this,t),mi.transformDirection(e),this.setXYZ(t,mi.x,mi.y,mi.z);return this}set(e,t=0){return this.array.set(e,t),this}getX(e){let t=this.array[e*this.itemSize];return this.normalized&&(t=or(t,this.array)),t}setX(e,t){return this.normalized&&(t=Xt(t,this.array)),this.array[e*this.itemSize]=t,this}getY(e){let t=this.array[e*this.itemSize+1];return this.normalized&&(t=or(t,this.array)),t}setY(e,t){return this.normalized&&(t=Xt(t,this.array)),this.array[e*this.itemSize+1]=t,this}getZ(e){let t=this.array[e*this.itemSize+2];return this.normalized&&(t=or(t,this.array)),t}setZ(e,t){return this.normalized&&(t=Xt(t,this.array)),this.array[e*this.itemSize+2]=t,this}getW(e){let t=this.array[e*this.itemSize+3];return this.normalized&&(t=or(t,this.array)),t}setW(e,t){return this.normalized&&(t=Xt(t,this.array)),this.array[e*this.itemSize+3]=t,this}setXY(e,t,i){return e*=this.itemSize,this.normalized&&(t=Xt(t,this.array),i=Xt(i,this.array)),this.array[e+0]=t,this.array[e+1]=i,this}setXYZ(e,t,i,n){return e*=this.itemSize,this.normalized&&(t=Xt(t,this.array),i=Xt(i,this.array),n=Xt(n,this.array)),this.array[e+0]=t,this.array[e+1]=i,this.array[e+2]=n,this}setXYZW(e,t,i,n,s){return e*=this.itemSize,this.normalized&&(t=Xt(t,this.array),i=Xt(i,this.array),n=Xt(n,this.array),s=Xt(s,this.array)),this.array[e+0]=t,this.array[e+1]=i,this.array[e+2]=n,this.array[e+3]=s,this}onUpload(e){return this.onUploadCallback=e,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){const e={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.from(this.array),normalized:this.normalized};return this.name!==""&&(e.name=this.name),this.usage!==Cf&&(e.usage=this.usage),(this.updateRange.offset!==0||this.updateRange.count!==-1)&&(e.updateRange=this.updateRange),e}copyColorsArray(){console.error("THREE.BufferAttribute: copyColorsArray() was removed in r144.")}copyVector2sArray(){console.error("THREE.BufferAttribute: copyVector2sArray() was removed in r144.")}copyVector3sArray(){console.error("THREE.BufferAttribute: copyVector3sArray() was removed in r144.")}copyVector4sArray(){console.error("THREE.BufferAttribute: copyVector4sArray() was removed in r144.")}}class pb extends ln{constructor(e,t,i){super(new Uint16Array(e),t,i)}}class fb extends ln{constructor(e,t,i){super(new Uint32Array(e),t,i)}}class xn extends ln{constructor(e,t,i){super(new Float32Array(e),t,i)}}let rM=0;const Yn=new Pt,Rp=new ei,Aa=new Z,An=new Ml,ic=new Ml,Ci=new Z;class un extends ra{constructor(){super(),this.isBufferGeometry=!0,Object.defineProperty(this,"id",{value:rM++}),this.uuid=_s(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(e){return Array.isArray(e)?this.index=new(lb(e)?fb:pb)(e,1):this.index=e,this}getAttribute(e){return this.attributes[e]}setAttribute(e,t){return this.attributes[e]=t,this}deleteAttribute(e){return delete this.attributes[e],this}hasAttribute(e){return this.attributes[e]!==void 0}addGroup(e,t,i=0){this.groups.push({start:e,count:t,materialIndex:i})}clearGroups(){this.groups=[]}setDrawRange(e,t){this.drawRange.start=e,this.drawRange.count=t}applyMatrix4(e){const t=this.attributes.position;t!==void 0&&(t.applyMatrix4(e),t.needsUpdate=!0);const i=this.attributes.normal;if(i!==void 0){const s=new Nn().getNormalMatrix(e);i.applyNormalMatrix(s),i.needsUpdate=!0}const n=this.attributes.tangent;return n!==void 0&&(n.transformDirection(e),n.needsUpdate=!0),this.boundingBox!==null&&this.computeBoundingBox(),this.boundingSphere!==null&&this.computeBoundingSphere(),this}applyQuaternion(e){return Yn.makeRotationFromQuaternion(e),this.applyMatrix4(Yn),this}rotateX(e){return Yn.makeRotationX(e),this.applyMatrix4(Yn),this}rotateY(e){return Yn.makeRotationY(e),this.applyMatrix4(Yn),this}rotateZ(e){return Yn.makeRotationZ(e),this.applyMatrix4(Yn),this}translate(e,t,i){return Yn.makeTranslation(e,t,i),this.applyMatrix4(Yn),this}scale(e,t,i){return Yn.makeScale(e,t,i),this.applyMatrix4(Yn),this}lookAt(e){return Rp.lookAt(e),Rp.updateMatrix(),this.applyMatrix4(Rp.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(Aa).negate(),this.translate(Aa.x,Aa.y,Aa.z),this}setFromPoints(e){const t=[];for(let i=0,n=e.length;i<n;i++){const s=e[i];t.push(s.x,s.y,s.z||0)}return this.setAttribute("position",new xn(t,3)),this}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new Ml);const e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){console.error('THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box. Alternatively set "mesh.frustumCulled" to "false".',this),this.boundingBox.set(new Z(-1/0,-1/0,-1/0),new Z(1/0,1/0,1/0));return}if(e!==void 0){if(this.boundingBox.setFromBufferAttribute(e),t)for(let i=0,n=t.length;i<n;i++){const s=t[i];An.setFromBufferAttribute(s),this.morphTargetsRelative?(Ci.addVectors(this.boundingBox.min,An.min),this.boundingBox.expandByPoint(Ci),Ci.addVectors(this.boundingBox.max,An.max),this.boundingBox.expandByPoint(Ci)):(this.boundingBox.expandByPoint(An.min),this.boundingBox.expandByPoint(An.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new Tl);const e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){console.error('THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere. Alternatively set "mesh.frustumCulled" to "false".',this),this.boundingSphere.set(new Z,1/0);return}if(e){const i=this.boundingSphere.center;if(An.setFromBufferAttribute(e),t)for(let s=0,a=t.length;s<a;s++){const o=t[s];ic.setFromBufferAttribute(o),this.morphTargetsRelative?(Ci.addVectors(An.min,ic.min),An.expandByPoint(Ci),Ci.addVectors(An.max,ic.max),An.expandByPoint(Ci)):(An.expandByPoint(ic.min),An.expandByPoint(ic.max))}An.getCenter(i);let n=0;for(let s=0,a=e.count;s<a;s++)Ci.fromBufferAttribute(e,s),n=Math.max(n,i.distanceToSquared(Ci));if(t)for(let s=0,a=t.length;s<a;s++){const o=t[s],u=this.morphTargetsRelative;for(let h=0,f=o.count;h<f;h++)Ci.fromBufferAttribute(o,h),u&&(Aa.fromBufferAttribute(e,h),Ci.add(Aa)),n=Math.max(n,i.distanceToSquared(Ci))}this.boundingSphere.radius=Math.sqrt(n),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeTangents(){const e=this.index,t=this.attributes;if(e===null||t.position===void 0||t.normal===void 0||t.uv===void 0){console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");return}const i=e.array,n=t.position.array,s=t.normal.array,a=t.uv.array,o=n.length/3;this.hasAttribute("tangent")===!1&&this.setAttribute("tangent",new ln(new Float32Array(4*o),4));const u=this.getAttribute("tangent").array,h=[],f=[];for(let O=0;O<o;O++)h[O]=new Z,f[O]=new Z;const c=new Z,d=new Z,m=new Z,x=new Ue,_=new Ue,b=new Ue,y=new Z,M=new Z;function D(O,J,Q){c.fromArray(n,O*3),d.fromArray(n,J*3),m.fromArray(n,Q*3),x.fromArray(a,O*2),_.fromArray(a,J*2),b.fromArray(a,Q*2),d.sub(c),m.sub(c),_.sub(x),b.sub(x);const X=1/(_.x*b.y-b.x*_.y);isFinite(X)&&(y.copy(d).multiplyScalar(b.y).addScaledVector(m,-_.y).multiplyScalar(X),M.copy(m).multiplyScalar(_.x).addScaledVector(d,-b.x).multiplyScalar(X),h[O].add(y),h[J].add(y),h[Q].add(y),f[O].add(M),f[J].add(M),f[Q].add(M))}let C=this.groups;C.length===0&&(C=[{start:0,count:i.length}]);for(let O=0,J=C.length;O<J;++O){const Q=C[O],X=Q.start,j=Q.count;for(let K=X,ie=X+j;K<ie;K+=3)D(i[K+0],i[K+1],i[K+2])}const P=new Z,I=new Z,F=new Z,A=new Z;function k(O){F.fromArray(s,O*3),A.copy(F);const J=h[O];P.copy(J),P.sub(F.multiplyScalar(F.dot(J))).normalize(),I.crossVectors(A,J);const X=I.dot(f[O])<0?-1:1;u[O*4]=P.x,u[O*4+1]=P.y,u[O*4+2]=P.z,u[O*4+3]=X}for(let O=0,J=C.length;O<J;++O){const Q=C[O],X=Q.start,j=Q.count;for(let K=X,ie=X+j;K<ie;K+=3)k(i[K+0]),k(i[K+1]),k(i[K+2])}}computeVertexNormals(){const e=this.index,t=this.getAttribute("position");if(t!==void 0){let i=this.getAttribute("normal");if(i===void 0)i=new ln(new Float32Array(t.count*3),3),this.setAttribute("normal",i);else for(let d=0,m=i.count;d<m;d++)i.setXYZ(d,0,0,0);const n=new Z,s=new Z,a=new Z,o=new Z,u=new Z,h=new Z,f=new Z,c=new Z;if(e)for(let d=0,m=e.count;d<m;d+=3){const x=e.getX(d+0),_=e.getX(d+1),b=e.getX(d+2);n.fromBufferAttribute(t,x),s.fromBufferAttribute(t,_),a.fromBufferAttribute(t,b),f.subVectors(a,s),c.subVectors(n,s),f.cross(c),o.fromBufferAttribute(i,x),u.fromBufferAttribute(i,_),h.fromBufferAttribute(i,b),o.add(f),u.add(f),h.add(f),i.setXYZ(x,o.x,o.y,o.z),i.setXYZ(_,u.x,u.y,u.z),i.setXYZ(b,h.x,h.y,h.z)}else for(let d=0,m=t.count;d<m;d+=3)n.fromBufferAttribute(t,d+0),s.fromBufferAttribute(t,d+1),a.fromBufferAttribute(t,d+2),f.subVectors(a,s),c.subVectors(n,s),f.cross(c),i.setXYZ(d+0,f.x,f.y,f.z),i.setXYZ(d+1,f.x,f.y,f.z),i.setXYZ(d+2,f.x,f.y,f.z);this.normalizeNormals(),i.needsUpdate=!0}}merge(){return console.error("THREE.BufferGeometry.merge() has been removed. Use THREE.BufferGeometryUtils.mergeBufferGeometries() instead."),this}normalizeNormals(){const e=this.attributes.normal;for(let t=0,i=e.count;t<i;t++)Ci.fromBufferAttribute(e,t),Ci.normalize(),e.setXYZ(t,Ci.x,Ci.y,Ci.z)}toNonIndexed(){function e(o,u){const h=o.array,f=o.itemSize,c=o.normalized,d=new h.constructor(u.length*f);let m=0,x=0;for(let _=0,b=u.length;_<b;_++){o.isInterleavedBufferAttribute?m=u[_]*o.data.stride+o.offset:m=u[_]*f;for(let y=0;y<f;y++)d[x++]=h[m++]}return new ln(d,f,c)}if(this.index===null)return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;const t=new un,i=this.index.array,n=this.attributes;for(const o in n){const u=n[o],h=e(u,i);t.setAttribute(o,h)}const s=this.morphAttributes;for(const o in s){const u=[],h=s[o];for(let f=0,c=h.length;f<c;f++){const d=h[f],m=e(d,i);u.push(m)}t.morphAttributes[o]=u}t.morphTargetsRelative=this.morphTargetsRelative;const a=this.groups;for(let o=0,u=a.length;o<u;o++){const h=a[o];t.addGroup(h.start,h.count,h.materialIndex)}return t}toJSON(){const e={metadata:{version:4.5,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,this.name!==""&&(e.name=this.name),Object.keys(this.userData).length>0&&(e.userData=this.userData),this.parameters!==void 0){const u=this.parameters;for(const h in u)u[h]!==void 0&&(e[h]=u[h]);return e}e.data={attributes:{}};const t=this.index;t!==null&&(e.data.index={type:t.array.constructor.name,array:Array.prototype.slice.call(t.array)});const i=this.attributes;for(const u in i){const h=i[u];e.data.attributes[u]=h.toJSON(e.data)}const n={};let s=!1;for(const u in this.morphAttributes){const h=this.morphAttributes[u],f=[];for(let c=0,d=h.length;c<d;c++){const m=h[c];f.push(m.toJSON(e.data))}f.length>0&&(n[u]=f,s=!0)}s&&(e.data.morphAttributes=n,e.data.morphTargetsRelative=this.morphTargetsRelative);const a=this.groups;a.length>0&&(e.data.groups=JSON.parse(JSON.stringify(a)));const o=this.boundingSphere;return o!==null&&(e.data.boundingSphere={center:o.center.toArray(),radius:o.radius}),e}clone(){return new this.constructor().copy(this)}copy(e){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;const t={};this.name=e.name;const i=e.index;i!==null&&this.setIndex(i.clone(t));const n=e.attributes;for(const h in n){const f=n[h];this.setAttribute(h,f.clone(t))}const s=e.morphAttributes;for(const h in s){const f=[],c=s[h];for(let d=0,m=c.length;d<m;d++)f.push(c[d].clone(t));this.morphAttributes[h]=f}this.morphTargetsRelative=e.morphTargetsRelative;const a=e.groups;for(let h=0,f=a.length;h<f;h++){const c=a[h];this.addGroup(c.start,c.count,c.materialIndex)}const o=e.boundingBox;o!==null&&(this.boundingBox=o.clone());const u=e.boundingSphere;return u!==null&&(this.boundingSphere=u.clone()),this.drawRange.start=e.drawRange.start,this.drawRange.count=e.drawRange.count,this.userData=e.userData,e.parameters!==void 0&&(this.parameters=Object.assign({},e.parameters)),this}dispose(){this.dispatchEvent({type:"dispose"})}}const z_=new Pt,La=new ud,kp=new Tl,nc=new Z,sc=new Z,rc=new Z,Ip=new Z,Qu=new Z,eh=new Ue,th=new Ue,ih=new Ue,Fp=new Z,nh=new Z;class Wi extends ei{constructor(e=new un,t=new ar){super(),this.isMesh=!0,this.type="Mesh",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),e.morphTargetInfluences!==void 0&&(this.morphTargetInfluences=e.morphTargetInfluences.slice()),e.morphTargetDictionary!==void 0&&(this.morphTargetDictionary=Object.assign({},e.morphTargetDictionary)),this.material=e.material,this.geometry=e.geometry,this}updateMorphTargets(){const t=this.geometry.morphAttributes,i=Object.keys(t);if(i.length>0){const n=t[i[0]];if(n!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let s=0,a=n.length;s<a;s++){const o=n[s].name||String(s);this.morphTargetInfluences.push(0),this.morphTargetDictionary[o]=s}}}}getVertexPosition(e,t){const i=this.geometry,n=i.attributes.position,s=i.morphAttributes.position,a=i.morphTargetsRelative;t.fromBufferAttribute(n,e);const o=this.morphTargetInfluences;if(s&&o){Qu.set(0,0,0);for(let u=0,h=s.length;u<h;u++){const f=o[u],c=s[u];f!==0&&(Ip.fromBufferAttribute(c,e),a?Qu.addScaledVector(Ip,f):Qu.addScaledVector(Ip.sub(t),f))}t.add(Qu)}return this.isSkinnedMesh&&this.boneTransform(e,t),t}raycast(e,t){const i=this.geometry,n=this.material,s=this.matrixWorld;if(n===void 0||(i.boundingSphere===null&&i.computeBoundingSphere(),kp.copy(i.boundingSphere),kp.applyMatrix4(s),e.ray.intersectsSphere(kp)===!1)||(z_.copy(s).invert(),La.copy(e.ray).applyMatrix4(z_),i.boundingBox!==null&&La.intersectsBox(i.boundingBox)===!1))return;let a;const o=i.index,u=i.attributes.position,h=i.attributes.uv,f=i.attributes.uv2,c=i.groups,d=i.drawRange;if(o!==null)if(Array.isArray(n))for(let m=0,x=c.length;m<x;m++){const _=c[m],b=n[_.materialIndex],y=Math.max(_.start,d.start),M=Math.min(o.count,Math.min(_.start+_.count,d.start+d.count));for(let D=y,C=M;D<C;D+=3){const P=o.getX(D),I=o.getX(D+1),F=o.getX(D+2);a=sh(this,b,e,La,h,f,P,I,F),a&&(a.faceIndex=Math.floor(D/3),a.face.materialIndex=_.materialIndex,t.push(a))}}else{const m=Math.max(0,d.start),x=Math.min(o.count,d.start+d.count);for(let _=m,b=x;_<b;_+=3){const y=o.getX(_),M=o.getX(_+1),D=o.getX(_+2);a=sh(this,n,e,La,h,f,y,M,D),a&&(a.faceIndex=Math.floor(_/3),t.push(a))}}else if(u!==void 0)if(Array.isArray(n))for(let m=0,x=c.length;m<x;m++){const _=c[m],b=n[_.materialIndex],y=Math.max(_.start,d.start),M=Math.min(u.count,Math.min(_.start+_.count,d.start+d.count));for(let D=y,C=M;D<C;D+=3){const P=D,I=D+1,F=D+2;a=sh(this,b,e,La,h,f,P,I,F),a&&(a.faceIndex=Math.floor(D/3),a.face.materialIndex=_.materialIndex,t.push(a))}}else{const m=Math.max(0,d.start),x=Math.min(u.count,d.start+d.count);for(let _=m,b=x;_<b;_+=3){const y=_,M=_+1,D=_+2;a=sh(this,n,e,La,h,f,y,M,D),a&&(a.faceIndex=Math.floor(_/3),t.push(a))}}}}function oM(r,e,t,i,n,s,a,o){let u;if(e.side===Vn?u=i.intersectTriangle(a,s,n,!0,o):u=i.intersectTriangle(n,s,a,e.side===Ns,o),u===null)return null;nh.copy(o),nh.applyMatrix4(r.matrixWorld);const h=t.ray.origin.distanceTo(nh);return h<t.near||h>t.far?null:{distance:h,point:nh.clone(),object:r}}function sh(r,e,t,i,n,s,a,o,u){r.getVertexPosition(a,nc),r.getVertexPosition(o,sc),r.getVertexPosition(u,rc);const h=oM(r,e,t,i,nc,sc,rc,Fp);if(h){n&&(eh.fromBufferAttribute(n,a),th.fromBufferAttribute(n,o),ih.fromBufferAttribute(n,u),h.uv=sr.getUV(Fp,nc,sc,rc,eh,th,ih,new Ue)),s&&(eh.fromBufferAttribute(s,a),th.fromBufferAttribute(s,o),ih.fromBufferAttribute(s,u),h.uv2=sr.getUV(Fp,nc,sc,rc,eh,th,ih,new Ue));const f={a,b:o,c:u,normal:new Z,materialIndex:0};sr.getNormal(nc,sc,rc,f.normal),h.face=f}return h}class cu extends un{constructor(e=1,t=1,i=1,n=1,s=1,a=1){super(),this.type="BoxGeometry",this.parameters={width:e,height:t,depth:i,widthSegments:n,heightSegments:s,depthSegments:a};const o=this;n=Math.floor(n),s=Math.floor(s),a=Math.floor(a);const u=[],h=[],f=[],c=[];let d=0,m=0;x("z","y","x",-1,-1,i,t,e,a,s,0),x("z","y","x",1,-1,i,t,-e,a,s,1),x("x","z","y",1,1,e,i,t,n,a,2),x("x","z","y",1,-1,e,i,-t,n,a,3),x("x","y","z",1,-1,e,t,i,n,s,4),x("x","y","z",-1,-1,e,t,-i,n,s,5),this.setIndex(u),this.setAttribute("position",new xn(h,3)),this.setAttribute("normal",new xn(f,3)),this.setAttribute("uv",new xn(c,2));function x(_,b,y,M,D,C,P,I,F,A,k){const O=C/F,J=P/A,Q=C/2,X=P/2,j=I/2,K=F+1,ie=A+1;let ee=0,V=0;const _e=new Z;for(let U=0;U<ie;U++){const oe=U*J-X;for(let ce=0;ce<K;ce++){const me=ce*O-Q;_e[_]=me*M,_e[b]=oe*D,_e[y]=j,h.push(_e.x,_e.y,_e.z),_e[_]=0,_e[b]=0,_e[y]=I>0?1:-1,f.push(_e.x,_e.y,_e.z),c.push(ce/F),c.push(1-U/A),ee+=1}}for(let U=0;U<A;U++)for(let oe=0;oe<F;oe++){const ce=d+oe+K*U,me=d+oe+K*(U+1),le=d+(oe+1)+K*(U+1),be=d+(oe+1)+K*U;u.push(ce,me,be),u.push(me,le,be),V+=6}o.addGroup(m,V,k),m+=V,d+=ee}}static fromJSON(e){return new cu(e.width,e.height,e.depth,e.widthSegments,e.heightSegments,e.depthSegments)}}function ul(r){const e={};for(const t in r){e[t]={};for(const i in r[t]){const n=r[t][i];n&&(n.isColor||n.isMatrix3||n.isMatrix4||n.isVector2||n.isVector3||n.isVector4||n.isTexture||n.isQuaternion)?e[t][i]=n.clone():Array.isArray(n)?e[t][i]=n.slice():e[t][i]=n}}return e}function en(r){const e={};for(let t=0;t<r.length;t++){const i=ul(r[t]);for(const n in i)e[n]=i[n]}return e}function aM(r){const e=[];for(let t=0;t<r.length;t++)e.push(r[t].clone());return e}function mb(r){return r.getRenderTarget()===null&&r.outputEncoding===Gt?Ts:Wc}const lM={clone:ul,merge:en};var cM=`void main() {
	gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
}`,uM=`void main() {
	gl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );
}`;class fr extends ks{constructor(e){super(),this.isShaderMaterial=!0,this.type="ShaderMaterial",this.defines={},this.uniforms={},this.uniformsGroups=[],this.vertexShader=cM,this.fragmentShader=uM,this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv2:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,e!==void 0&&this.setValues(e)}copy(e){return super.copy(e),this.fragmentShader=e.fragmentShader,this.vertexShader=e.vertexShader,this.uniforms=ul(e.uniforms),this.uniformsGroups=aM(e.uniformsGroups),this.defines=Object.assign({},e.defines),this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.fog=e.fog,this.lights=e.lights,this.clipping=e.clipping,this.extensions=Object.assign({},e.extensions),this.glslVersion=e.glslVersion,this}toJSON(e){const t=super.toJSON(e);t.glslVersion=this.glslVersion,t.uniforms={};for(const n in this.uniforms){const a=this.uniforms[n].value;a&&a.isTexture?t.uniforms[n]={type:"t",value:a.toJSON(e).uuid}:a&&a.isColor?t.uniforms[n]={type:"c",value:a.getHex()}:a&&a.isVector2?t.uniforms[n]={type:"v2",value:a.toArray()}:a&&a.isVector3?t.uniforms[n]={type:"v3",value:a.toArray()}:a&&a.isVector4?t.uniforms[n]={type:"v4",value:a.toArray()}:a&&a.isMatrix3?t.uniforms[n]={type:"m3",value:a.toArray()}:a&&a.isMatrix4?t.uniforms[n]={type:"m4",value:a.toArray()}:t.uniforms[n]={value:a}}Object.keys(this.defines).length>0&&(t.defines=this.defines),t.vertexShader=this.vertexShader,t.fragmentShader=this.fragmentShader;const i={};for(const n in this.extensions)this.extensions[n]===!0&&(i[n]=!0);return Object.keys(i).length>0&&(t.extensions=i),t}}class bm extends ei{constructor(){super(),this.isCamera=!0,this.type="Camera",this.matrixWorldInverse=new Pt,this.projectionMatrix=new Pt,this.projectionMatrixInverse=new Pt}copy(e,t){return super.copy(e,t),this.matrixWorldInverse.copy(e.matrixWorldInverse),this.projectionMatrix.copy(e.projectionMatrix),this.projectionMatrixInverse.copy(e.projectionMatrixInverse),this}getWorldDirection(e){this.updateWorldMatrix(!0,!1);const t=this.matrixWorld.elements;return e.set(-t[8],-t[9],-t[10]).normalize()}updateMatrixWorld(e){super.updateMatrixWorld(e),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(e,t){super.updateWorldMatrix(e,t),this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return new this.constructor().copy(this)}}class Gi extends bm{constructor(e=50,t=1,i=.1,n=2e3){super(),this.isPerspectiveCamera=!0,this.type="PerspectiveCamera",this.fov=e,this.zoom=1,this.near=i,this.far=n,this.focus=10,this.aspect=t,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.fov=e.fov,this.zoom=e.zoom,this.near=e.near,this.far=e.far,this.focus=e.focus,this.aspect=e.aspect,this.view=e.view===null?null:Object.assign({},e.view),this.filmGauge=e.filmGauge,this.filmOffset=e.filmOffset,this}setFocalLength(e){const t=.5*this.getFilmHeight()/e;this.fov=jc*2*Math.atan(t),this.updateProjectionMatrix()}getFocalLength(){const e=Math.tan(Tc*.5*this.fov);return .5*this.getFilmHeight()/e}getEffectiveFOV(){return jc*2*Math.atan(Math.tan(Tc*.5*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}setViewOffset(e,t,i,n,s,a){this.aspect=e/t,this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=i,this.view.offsetY=n,this.view.width=s,this.view.height=a,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=this.near;let t=e*Math.tan(Tc*.5*this.fov)/this.zoom,i=2*t,n=this.aspect*i,s=-.5*n;const a=this.view;if(this.view!==null&&this.view.enabled){const u=a.fullWidth,h=a.fullHeight;s+=a.offsetX*n/u,t-=a.offsetY*i/h,n*=a.width/u,i*=a.height/h}const o=this.filmOffset;o!==0&&(s+=e*o/this.getFilmWidth()),this.projectionMatrix.makePerspective(s,s+n,t,t-i,e,this.far),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const t=super.toJSON(e);return t.object.fov=this.fov,t.object.zoom=this.zoom,t.object.near=this.near,t.object.far=this.far,t.object.focus=this.focus,t.object.aspect=this.aspect,this.view!==null&&(t.object.view=Object.assign({},this.view)),t.object.filmGauge=this.filmGauge,t.object.filmOffset=this.filmOffset,t}}const Ra=-90,ka=1;class hM extends ei{constructor(e,t,i){super(),this.type="CubeCamera",this.renderTarget=i;const n=new Gi(Ra,ka,e,t);n.layers=this.layers,n.up.set(0,1,0),n.lookAt(1,0,0),this.add(n);const s=new Gi(Ra,ka,e,t);s.layers=this.layers,s.up.set(0,1,0),s.lookAt(-1,0,0),this.add(s);const a=new Gi(Ra,ka,e,t);a.layers=this.layers,a.up.set(0,0,-1),a.lookAt(0,1,0),this.add(a);const o=new Gi(Ra,ka,e,t);o.layers=this.layers,o.up.set(0,0,1),o.lookAt(0,-1,0),this.add(o);const u=new Gi(Ra,ka,e,t);u.layers=this.layers,u.up.set(0,1,0),u.lookAt(0,0,1),this.add(u);const h=new Gi(Ra,ka,e,t);h.layers=this.layers,h.up.set(0,1,0),h.lookAt(0,0,-1),this.add(h)}update(e,t){this.parent===null&&this.updateMatrixWorld();const i=this.renderTarget,[n,s,a,o,u,h]=this.children,f=e.getRenderTarget(),c=e.toneMapping,d=e.xr.enabled;e.toneMapping=ur,e.xr.enabled=!1;const m=i.texture.generateMipmaps;i.texture.generateMipmaps=!1,e.setRenderTarget(i,0),e.render(t,n),e.setRenderTarget(i,1),e.render(t,s),e.setRenderTarget(i,2),e.render(t,a),e.setRenderTarget(i,3),e.render(t,o),e.setRenderTarget(i,4),e.render(t,u),i.texture.generateMipmaps=m,e.setRenderTarget(i,5),e.render(t,h),e.setRenderTarget(f),e.toneMapping=c,e.xr.enabled=d,i.texture.needsPMREMUpdate=!0}}class gb extends vi{constructor(e,t,i,n,s,a,o,u,h,f){e=e!==void 0?e:[],t=t!==void 0?t:ol,super(e,t,i,n,s,a,o,u,h,f),this.isCubeTexture=!0,this.flipY=!1}get images(){return this.image}set images(e){this.image=e}}class dM extends Ko{constructor(e=1,t={}){super(e,e,t),this.isWebGLCubeRenderTarget=!0;const i={width:e,height:e,depth:1},n=[i,i,i,i,i,i];this.texture=new gb(n,t.mapping,t.wrapS,t.wrapT,t.magFilter,t.minFilter,t.format,t.type,t.anisotropy,t.encoding),this.texture.isRenderTargetTexture=!0,this.texture.generateMipmaps=t.generateMipmaps!==void 0?t.generateMipmaps:!1,this.texture.minFilter=t.minFilter!==void 0?t.minFilter:Ui}fromEquirectangularTexture(e,t){this.texture.type=t.type,this.texture.encoding=t.encoding,this.texture.generateMipmaps=t.generateMipmaps,this.texture.minFilter=t.minFilter,this.texture.magFilter=t.magFilter;const i={uniforms:{tEquirect:{value:null}},vertexShader:`

				varying vec3 vWorldDirection;

				vec3 transformDirection( in vec3 dir, in mat4 matrix ) {

					return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );

				}

				void main() {

					vWorldDirection = transformDirection( position, modelMatrix );

					#include <begin_vertex>
					#include <project_vertex>

				}
			`,fragmentShader:`

				uniform sampler2D tEquirect;

				varying vec3 vWorldDirection;

				#include <common>

				void main() {

					vec3 direction = normalize( vWorldDirection );

					vec2 sampleUV = equirectUv( direction );

					gl_FragColor = texture2D( tEquirect, sampleUV );

				}
			`},n=new cu(5,5,5),s=new fr({name:"CubemapFromEquirect",uniforms:ul(i.uniforms),vertexShader:i.vertexShader,fragmentShader:i.fragmentShader,side:Vn,blending:cr});s.uniforms.tEquirect.value=t;const a=new Wi(n,s),o=t.minFilter;return t.minFilter===dr&&(t.minFilter=Ui),new hM(1,10,this).update(e,a),t.minFilter=o,a.geometry.dispose(),a.material.dispose(),this}clear(e,t,i,n){const s=e.getRenderTarget();for(let a=0;a<6;a++)e.setRenderTarget(this,a),e.clear(t,i,n);e.setRenderTarget(s)}}const Op=new Z,pM=new Z,fM=new Nn;class So{constructor(e=new Z(1,0,0),t=0){this.isPlane=!0,this.normal=e,this.constant=t}set(e,t){return this.normal.copy(e),this.constant=t,this}setComponents(e,t,i,n){return this.normal.set(e,t,i),this.constant=n,this}setFromNormalAndCoplanarPoint(e,t){return this.normal.copy(e),this.constant=-t.dot(this.normal),this}setFromCoplanarPoints(e,t,i){const n=Op.subVectors(i,t).cross(pM.subVectors(e,t)).normalize();return this.setFromNormalAndCoplanarPoint(n,e),this}copy(e){return this.normal.copy(e.normal),this.constant=e.constant,this}normalize(){const e=1/this.normal.length();return this.normal.multiplyScalar(e),this.constant*=e,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(e){return this.normal.dot(e)+this.constant}distanceToSphere(e){return this.distanceToPoint(e.center)-e.radius}projectPoint(e,t){return t.copy(this.normal).multiplyScalar(-this.distanceToPoint(e)).add(e)}intersectLine(e,t){const i=e.delta(Op),n=this.normal.dot(i);if(n===0)return this.distanceToPoint(e.start)===0?t.copy(e.start):null;const s=-(e.start.dot(this.normal)+this.constant)/n;return s<0||s>1?null:t.copy(i).multiplyScalar(s).add(e.start)}intersectsLine(e){const t=this.distanceToPoint(e.start),i=this.distanceToPoint(e.end);return t<0&&i>0||i<0&&t>0}intersectsBox(e){return e.intersectsPlane(this)}intersectsSphere(e){return e.intersectsPlane(this)}coplanarPoint(e){return e.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(e,t){const i=t||fM.getNormalMatrix(e),n=this.coplanarPoint(Op).applyMatrix4(e),s=this.normal.applyMatrix3(i).normalize();return this.constant=-n.dot(s),this}translate(e){return this.constant-=e.dot(this.normal),this}equals(e){return e.normal.equals(this.normal)&&e.constant===this.constant}clone(){return new this.constructor().copy(this)}}const Ia=new Tl,rh=new Z;class xm{constructor(e=new So,t=new So,i=new So,n=new So,s=new So,a=new So){this.planes=[e,t,i,n,s,a]}set(e,t,i,n,s,a){const o=this.planes;return o[0].copy(e),o[1].copy(t),o[2].copy(i),o[3].copy(n),o[4].copy(s),o[5].copy(a),this}copy(e){const t=this.planes;for(let i=0;i<6;i++)t[i].copy(e.planes[i]);return this}setFromProjectionMatrix(e){const t=this.planes,i=e.elements,n=i[0],s=i[1],a=i[2],o=i[3],u=i[4],h=i[5],f=i[6],c=i[7],d=i[8],m=i[9],x=i[10],_=i[11],b=i[12],y=i[13],M=i[14],D=i[15];return t[0].setComponents(o-n,c-u,_-d,D-b).normalize(),t[1].setComponents(o+n,c+u,_+d,D+b).normalize(),t[2].setComponents(o+s,c+h,_+m,D+y).normalize(),t[3].setComponents(o-s,c-h,_-m,D-y).normalize(),t[4].setComponents(o-a,c-f,_-x,D-M).normalize(),t[5].setComponents(o+a,c+f,_+x,D+M).normalize(),this}intersectsObject(e){const t=e.geometry;return t.boundingSphere===null&&t.computeBoundingSphere(),Ia.copy(t.boundingSphere).applyMatrix4(e.matrixWorld),this.intersectsSphere(Ia)}intersectsSprite(e){return Ia.center.set(0,0,0),Ia.radius=.7071067811865476,Ia.applyMatrix4(e.matrixWorld),this.intersectsSphere(Ia)}intersectsSphere(e){const t=this.planes,i=e.center,n=-e.radius;for(let s=0;s<6;s++)if(t[s].distanceToPoint(i)<n)return!1;return!0}intersectsBox(e){const t=this.planes;for(let i=0;i<6;i++){const n=t[i];if(rh.x=n.normal.x>0?e.max.x:e.min.x,rh.y=n.normal.y>0?e.max.y:e.min.y,rh.z=n.normal.z>0?e.max.z:e.min.z,n.distanceToPoint(rh)<0)return!1}return!0}containsPoint(e){const t=this.planes;for(let i=0;i<6;i++)if(t[i].distanceToPoint(e)<0)return!1;return!0}clone(){return new this.constructor().copy(this)}}function _b(){let r=null,e=!1,t=null,i=null;function n(s,a){t(s,a),i=r.requestAnimationFrame(n)}return{start:function(){e!==!0&&t!==null&&(i=r.requestAnimationFrame(n),e=!0)},stop:function(){r.cancelAnimationFrame(i),e=!1},setAnimationLoop:function(s){t=s},setContext:function(s){r=s}}}function mM(r,e){const t=e.isWebGL2,i=new WeakMap;function n(h,f){const c=h.array,d=h.usage,m=r.createBuffer();r.bindBuffer(f,m),r.bufferData(f,c,d),h.onUploadCallback();let x;if(c instanceof Float32Array)x=5126;else if(c instanceof Uint16Array)if(h.isFloat16BufferAttribute)if(t)x=5131;else throw new Error("THREE.WebGLAttributes: Usage of Float16BufferAttribute requires WebGL2.");else x=5123;else if(c instanceof Int16Array)x=5122;else if(c instanceof Uint32Array)x=5125;else if(c instanceof Int32Array)x=5124;else if(c instanceof Int8Array)x=5120;else if(c instanceof Uint8Array)x=5121;else if(c instanceof Uint8ClampedArray)x=5121;else throw new Error("THREE.WebGLAttributes: Unsupported buffer data format: "+c);return{buffer:m,type:x,bytesPerElement:c.BYTES_PER_ELEMENT,version:h.version}}function s(h,f,c){const d=f.array,m=f.updateRange;r.bindBuffer(c,h),m.count===-1?r.bufferSubData(c,0,d):(t?r.bufferSubData(c,m.offset*d.BYTES_PER_ELEMENT,d,m.offset,m.count):r.bufferSubData(c,m.offset*d.BYTES_PER_ELEMENT,d.subarray(m.offset,m.offset+m.count)),m.count=-1),f.onUploadCallback()}function a(h){return h.isInterleavedBufferAttribute&&(h=h.data),i.get(h)}function o(h){h.isInterleavedBufferAttribute&&(h=h.data);const f=i.get(h);f&&(r.deleteBuffer(f.buffer),i.delete(h))}function u(h,f){if(h.isGLBufferAttribute){const d=i.get(h);(!d||d.version<h.version)&&i.set(h,{buffer:h.buffer,type:h.type,bytesPerElement:h.elementSize,version:h.version});return}h.isInterleavedBufferAttribute&&(h=h.data);const c=i.get(h);c===void 0?i.set(h,n(h,f)):c.version<h.version&&(s(c.buffer,h,f),c.version=h.version)}return{get:a,remove:o,update:u}}class uu extends un{constructor(e=1,t=1,i=1,n=1){super(),this.type="PlaneGeometry",this.parameters={width:e,height:t,widthSegments:i,heightSegments:n};const s=e/2,a=t/2,o=Math.floor(i),u=Math.floor(n),h=o+1,f=u+1,c=e/o,d=t/u,m=[],x=[],_=[],b=[];for(let y=0;y<f;y++){const M=y*d-a;for(let D=0;D<h;D++){const C=D*c-s;x.push(C,-M,0),_.push(0,0,1),b.push(D/o),b.push(1-y/u)}}for(let y=0;y<u;y++)for(let M=0;M<o;M++){const D=M+h*y,C=M+h*(y+1),P=M+1+h*(y+1),I=M+1+h*y;m.push(D,C,I),m.push(C,P,I)}this.setIndex(m),this.setAttribute("position",new xn(x,3)),this.setAttribute("normal",new xn(_,3)),this.setAttribute("uv",new xn(b,2))}static fromJSON(e){return new uu(e.width,e.height,e.widthSegments,e.heightSegments)}}var gM=`#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, vUv ).g;
#endif`,_M=`#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,vM=`#ifdef USE_ALPHATEST
	if ( diffuseColor.a < alphaTest ) discard;
#endif`,bM=`#ifdef USE_ALPHATEST
	uniform float alphaTest;
#endif`,xM=`#ifdef USE_AOMAP
	float ambientOcclusion = ( texture2D( aoMap, vUv2 ).r - 1.0 ) * aoMapIntensity + 1.0;
	reflectedLight.indirectDiffuse *= ambientOcclusion;
	#if defined( USE_ENVMAP ) && defined( STANDARD )
		float dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );
		reflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.roughness );
	#endif
#endif`,wM=`#ifdef USE_AOMAP
	uniform sampler2D aoMap;
	uniform float aoMapIntensity;
#endif`,yM="vec3 transformed = vec3( position );",SM=`vec3 objectNormal = vec3( normal );
#ifdef USE_TANGENT
	vec3 objectTangent = vec3( tangent.xyz );
#endif`,MM=`vec3 BRDF_Lambert( const in vec3 diffuseColor ) {
	return RECIPROCAL_PI * diffuseColor;
}
vec3 F_Schlick( const in vec3 f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
}
float F_Schlick( const in float f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
}
vec3 Schlick_to_F0( const in vec3 f, const in float f90, const in float dotVH ) {
    float x = clamp( 1.0 - dotVH, 0.0, 1.0 );
    float x2 = x * x;
    float x5 = clamp( x * x2 * x2, 0.0, 0.9999 );
    return ( f - vec3( f90 ) * x5 ) / ( 1.0 - x5 );
}
float V_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {
	float a2 = pow2( alpha );
	float gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );
	float gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );
	return 0.5 / max( gv + gl, EPSILON );
}
float D_GGX( const in float alpha, const in float dotNH ) {
	float a2 = pow2( alpha );
	float denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;
	return RECIPROCAL_PI * a2 / pow2( denom );
}
vec3 BRDF_GGX( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 f0, const in float f90, const in float roughness ) {
	float alpha = pow2( roughness );
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( f0, f90, dotVH );
	float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
	float D = D_GGX( alpha, dotNH );
	return F * ( V * D );
}
#ifdef USE_IRIDESCENCE
	vec3 BRDF_GGX_Iridescence( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 f0, const in float f90, const in float iridescence, const in vec3 iridescenceFresnel, const in float roughness ) {
		float alpha = pow2( roughness );
		vec3 halfDir = normalize( lightDir + viewDir );
		float dotNL = saturate( dot( normal, lightDir ) );
		float dotNV = saturate( dot( normal, viewDir ) );
		float dotNH = saturate( dot( normal, halfDir ) );
		float dotVH = saturate( dot( viewDir, halfDir ) );
		vec3 F = mix( F_Schlick( f0, f90, dotVH ), iridescenceFresnel, iridescence );
		float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
		float D = D_GGX( alpha, dotNH );
		return F * ( V * D );
	}
#endif
vec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {
	const float LUT_SIZE = 64.0;
	const float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;
	const float LUT_BIAS = 0.5 / LUT_SIZE;
	float dotNV = saturate( dot( N, V ) );
	vec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );
	uv = uv * LUT_SCALE + LUT_BIAS;
	return uv;
}
float LTC_ClippedSphereFormFactor( const in vec3 f ) {
	float l = length( f );
	return max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );
}
vec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {
	float x = dot( v1, v2 );
	float y = abs( x );
	float a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;
	float b = 3.4175940 + ( 4.1616724 + y ) * y;
	float v = a / b;
	float theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;
	return cross( v1, v2 ) * theta_sintheta;
}
vec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {
	vec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];
	vec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];
	vec3 lightNormal = cross( v1, v2 );
	if( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );
	vec3 T1, T2;
	T1 = normalize( V - N * dot( V, N ) );
	T2 = - cross( N, T1 );
	mat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );
	vec3 coords[ 4 ];
	coords[ 0 ] = mat * ( rectCoords[ 0 ] - P );
	coords[ 1 ] = mat * ( rectCoords[ 1 ] - P );
	coords[ 2 ] = mat * ( rectCoords[ 2 ] - P );
	coords[ 3 ] = mat * ( rectCoords[ 3 ] - P );
	coords[ 0 ] = normalize( coords[ 0 ] );
	coords[ 1 ] = normalize( coords[ 1 ] );
	coords[ 2 ] = normalize( coords[ 2 ] );
	coords[ 3 ] = normalize( coords[ 3 ] );
	vec3 vectorFormFactor = vec3( 0.0 );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );
	float result = LTC_ClippedSphereFormFactor( vectorFormFactor );
	return vec3( result );
}
float G_BlinnPhong_Implicit( ) {
	return 0.25;
}
float D_BlinnPhong( const in float shininess, const in float dotNH ) {
	return RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );
}
vec3 BRDF_BlinnPhong( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float shininess ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( specularColor, 1.0, dotVH );
	float G = G_BlinnPhong_Implicit( );
	float D = D_BlinnPhong( shininess, dotNH );
	return F * ( G * D );
}
#if defined( USE_SHEEN )
float D_Charlie( float roughness, float dotNH ) {
	float alpha = pow2( roughness );
	float invAlpha = 1.0 / alpha;
	float cos2h = dotNH * dotNH;
	float sin2h = max( 1.0 - cos2h, 0.0078125 );
	return ( 2.0 + invAlpha ) * pow( sin2h, invAlpha * 0.5 ) / ( 2.0 * PI );
}
float V_Neubelt( float dotNV, float dotNL ) {
	return saturate( 1.0 / ( 4.0 * ( dotNL + dotNV - dotNL * dotNV ) ) );
}
vec3 BRDF_Sheen( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, vec3 sheenColor, const in float sheenRoughness ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float D = D_Charlie( sheenRoughness, dotNH );
	float V = V_Neubelt( dotNV, dotNL );
	return sheenColor * ( D * V );
}
#endif`,TM=`#ifdef USE_IRIDESCENCE
	const mat3 XYZ_TO_REC709 = mat3(
		 3.2404542, -0.9692660,  0.0556434,
		-1.5371385,  1.8760108, -0.2040259,
		-0.4985314,  0.0415560,  1.0572252
	);
	vec3 Fresnel0ToIor( vec3 fresnel0 ) {
		vec3 sqrtF0 = sqrt( fresnel0 );
		return ( vec3( 1.0 ) + sqrtF0 ) / ( vec3( 1.0 ) - sqrtF0 );
	}
	vec3 IorToFresnel0( vec3 transmittedIor, float incidentIor ) {
		return pow2( ( transmittedIor - vec3( incidentIor ) ) / ( transmittedIor + vec3( incidentIor ) ) );
	}
	float IorToFresnel0( float transmittedIor, float incidentIor ) {
		return pow2( ( transmittedIor - incidentIor ) / ( transmittedIor + incidentIor ));
	}
	vec3 evalSensitivity( float OPD, vec3 shift ) {
		float phase = 2.0 * PI * OPD * 1.0e-9;
		vec3 val = vec3( 5.4856e-13, 4.4201e-13, 5.2481e-13 );
		vec3 pos = vec3( 1.6810e+06, 1.7953e+06, 2.2084e+06 );
		vec3 var = vec3( 4.3278e+09, 9.3046e+09, 6.6121e+09 );
		vec3 xyz = val * sqrt( 2.0 * PI * var ) * cos( pos * phase + shift ) * exp( - pow2( phase ) * var );
		xyz.x += 9.7470e-14 * sqrt( 2.0 * PI * 4.5282e+09 ) * cos( 2.2399e+06 * phase + shift[ 0 ] ) * exp( - 4.5282e+09 * pow2( phase ) );
		xyz /= 1.0685e-7;
		vec3 rgb = XYZ_TO_REC709 * xyz;
		return rgb;
	}
	vec3 evalIridescence( float outsideIOR, float eta2, float cosTheta1, float thinFilmThickness, vec3 baseF0 ) {
		vec3 I;
		float iridescenceIOR = mix( outsideIOR, eta2, smoothstep( 0.0, 0.03, thinFilmThickness ) );
		float sinTheta2Sq = pow2( outsideIOR / iridescenceIOR ) * ( 1.0 - pow2( cosTheta1 ) );
		float cosTheta2Sq = 1.0 - sinTheta2Sq;
		if ( cosTheta2Sq < 0.0 ) {
			 return vec3( 1.0 );
		}
		float cosTheta2 = sqrt( cosTheta2Sq );
		float R0 = IorToFresnel0( iridescenceIOR, outsideIOR );
		float R12 = F_Schlick( R0, 1.0, cosTheta1 );
		float R21 = R12;
		float T121 = 1.0 - R12;
		float phi12 = 0.0;
		if ( iridescenceIOR < outsideIOR ) phi12 = PI;
		float phi21 = PI - phi12;
		vec3 baseIOR = Fresnel0ToIor( clamp( baseF0, 0.0, 0.9999 ) );		vec3 R1 = IorToFresnel0( baseIOR, iridescenceIOR );
		vec3 R23 = F_Schlick( R1, 1.0, cosTheta2 );
		vec3 phi23 = vec3( 0.0 );
		if ( baseIOR[ 0 ] < iridescenceIOR ) phi23[ 0 ] = PI;
		if ( baseIOR[ 1 ] < iridescenceIOR ) phi23[ 1 ] = PI;
		if ( baseIOR[ 2 ] < iridescenceIOR ) phi23[ 2 ] = PI;
		float OPD = 2.0 * iridescenceIOR * thinFilmThickness * cosTheta2;
		vec3 phi = vec3( phi21 ) + phi23;
		vec3 R123 = clamp( R12 * R23, 1e-5, 0.9999 );
		vec3 r123 = sqrt( R123 );
		vec3 Rs = pow2( T121 ) * R23 / ( vec3( 1.0 ) - R123 );
		vec3 C0 = R12 + Rs;
		I = C0;
		vec3 Cm = Rs - T121;
		for ( int m = 1; m <= 2; ++ m ) {
			Cm *= r123;
			vec3 Sm = 2.0 * evalSensitivity( float( m ) * OPD, float( m ) * phi );
			I += Cm * Sm;
		}
		return max( I, vec3( 0.0 ) );
	}
#endif`,EM=`#ifdef USE_BUMPMAP
	uniform sampler2D bumpMap;
	uniform float bumpScale;
	vec2 dHdxy_fwd() {
		vec2 dSTdx = dFdx( vUv );
		vec2 dSTdy = dFdy( vUv );
		float Hll = bumpScale * texture2D( bumpMap, vUv ).x;
		float dBx = bumpScale * texture2D( bumpMap, vUv + dSTdx ).x - Hll;
		float dBy = bumpScale * texture2D( bumpMap, vUv + dSTdy ).x - Hll;
		return vec2( dBx, dBy );
	}
	vec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {
		vec3 vSigmaX = dFdx( surf_pos.xyz );
		vec3 vSigmaY = dFdy( surf_pos.xyz );
		vec3 vN = surf_norm;
		vec3 R1 = cross( vSigmaY, vN );
		vec3 R2 = cross( vN, vSigmaX );
		float fDet = dot( vSigmaX, R1 ) * faceDirection;
		vec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );
		return normalize( abs( fDet ) * surf_norm - vGrad );
	}
#endif`,CM=`#if NUM_CLIPPING_PLANES > 0
	vec4 plane;
	#pragma unroll_loop_start
	for ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {
		plane = clippingPlanes[ i ];
		if ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;
	}
	#pragma unroll_loop_end
	#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES
		bool clipped = true;
		#pragma unroll_loop_start
		for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {
			plane = clippingPlanes[ i ];
			clipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;
		}
		#pragma unroll_loop_end
		if ( clipped ) discard;
	#endif
#endif`,DM=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
	uniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];
#endif`,PM=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
#endif`,AM=`#if NUM_CLIPPING_PLANES > 0
	vClipPosition = - mvPosition.xyz;
#endif`,LM=`#if defined( USE_COLOR_ALPHA )
	diffuseColor *= vColor;
#elif defined( USE_COLOR )
	diffuseColor.rgb *= vColor;
#endif`,RM=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR )
	varying vec3 vColor;
#endif`,kM=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )
	varying vec3 vColor;
#endif`,IM=`#if defined( USE_COLOR_ALPHA )
	vColor = vec4( 1.0 );
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )
	vColor = vec3( 1.0 );
#endif
#ifdef USE_COLOR
	vColor *= color;
#endif
#ifdef USE_INSTANCING_COLOR
	vColor.xyz *= instanceColor.xyz;
#endif`,FM=`#define PI 3.141592653589793
#define PI2 6.283185307179586
#define PI_HALF 1.5707963267948966
#define RECIPROCAL_PI 0.3183098861837907
#define RECIPROCAL_PI2 0.15915494309189535
#define EPSILON 1e-6
#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
#define whiteComplement( a ) ( 1.0 - saturate( a ) )
float pow2( const in float x ) { return x*x; }
vec3 pow2( const in vec3 x ) { return x*x; }
float pow3( const in float x ) { return x*x*x; }
float pow4( const in float x ) { float x2 = x*x; return x2*x2; }
float max3( const in vec3 v ) { return max( max( v.x, v.y ), v.z ); }
float average( const in vec3 v ) { return dot( v, vec3( 0.3333333 ) ); }
highp float rand( const in vec2 uv ) {
	const highp float a = 12.9898, b = 78.233, c = 43758.5453;
	highp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );
	return fract( sin( sn ) * c );
}
#ifdef HIGH_PRECISION
	float precisionSafeLength( vec3 v ) { return length( v ); }
#else
	float precisionSafeLength( vec3 v ) {
		float maxComponent = max3( abs( v ) );
		return length( v / maxComponent ) * maxComponent;
	}
#endif
struct IncidentLight {
	vec3 color;
	vec3 direction;
	bool visible;
};
struct ReflectedLight {
	vec3 directDiffuse;
	vec3 directSpecular;
	vec3 indirectDiffuse;
	vec3 indirectSpecular;
};
struct GeometricContext {
	vec3 position;
	vec3 normal;
	vec3 viewDir;
#ifdef USE_CLEARCOAT
	vec3 clearcoatNormal;
#endif
};
vec3 transformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );
}
vec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );
}
mat3 transposeMat3( const in mat3 m ) {
	mat3 tmp;
	tmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );
	tmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );
	tmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );
	return tmp;
}
float luminance( const in vec3 rgb ) {
	const vec3 weights = vec3( 0.2126729, 0.7151522, 0.0721750 );
	return dot( weights, rgb );
}
bool isPerspectiveMatrix( mat4 m ) {
	return m[ 2 ][ 3 ] == - 1.0;
}
vec2 equirectUv( in vec3 dir ) {
	float u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;
	float v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;
	return vec2( u, v );
}`,OM=`#ifdef ENVMAP_TYPE_CUBE_UV
	#define cubeUV_minMipLevel 4.0
	#define cubeUV_minTileSize 16.0
	float getFace( vec3 direction ) {
		vec3 absDirection = abs( direction );
		float face = - 1.0;
		if ( absDirection.x > absDirection.z ) {
			if ( absDirection.x > absDirection.y )
				face = direction.x > 0.0 ? 0.0 : 3.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		} else {
			if ( absDirection.z > absDirection.y )
				face = direction.z > 0.0 ? 2.0 : 5.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		}
		return face;
	}
	vec2 getUV( vec3 direction, float face ) {
		vec2 uv;
		if ( face == 0.0 ) {
			uv = vec2( direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 1.0 ) {
			uv = vec2( - direction.x, - direction.z ) / abs( direction.y );
		} else if ( face == 2.0 ) {
			uv = vec2( - direction.x, direction.y ) / abs( direction.z );
		} else if ( face == 3.0 ) {
			uv = vec2( - direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 4.0 ) {
			uv = vec2( - direction.x, direction.z ) / abs( direction.y );
		} else {
			uv = vec2( direction.x, direction.y ) / abs( direction.z );
		}
		return 0.5 * ( uv + 1.0 );
	}
	vec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {
		float face = getFace( direction );
		float filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );
		mipInt = max( mipInt, cubeUV_minMipLevel );
		float faceSize = exp2( mipInt );
		highp vec2 uv = getUV( direction, face ) * ( faceSize - 2.0 ) + 1.0;
		if ( face > 2.0 ) {
			uv.y += faceSize;
			face -= 3.0;
		}
		uv.x += face * faceSize;
		uv.x += filterInt * 3.0 * cubeUV_minTileSize;
		uv.y += 4.0 * ( exp2( CUBEUV_MAX_MIP ) - faceSize );
		uv.x *= CUBEUV_TEXEL_WIDTH;
		uv.y *= CUBEUV_TEXEL_HEIGHT;
		#ifdef texture2DGradEXT
			return texture2DGradEXT( envMap, uv, vec2( 0.0 ), vec2( 0.0 ) ).rgb;
		#else
			return texture2D( envMap, uv ).rgb;
		#endif
	}
	#define cubeUV_r0 1.0
	#define cubeUV_v0 0.339
	#define cubeUV_m0 - 2.0
	#define cubeUV_r1 0.8
	#define cubeUV_v1 0.276
	#define cubeUV_m1 - 1.0
	#define cubeUV_r4 0.4
	#define cubeUV_v4 0.046
	#define cubeUV_m4 2.0
	#define cubeUV_r5 0.305
	#define cubeUV_v5 0.016
	#define cubeUV_m5 3.0
	#define cubeUV_r6 0.21
	#define cubeUV_v6 0.0038
	#define cubeUV_m6 4.0
	float roughnessToMip( float roughness ) {
		float mip = 0.0;
		if ( roughness >= cubeUV_r1 ) {
			mip = ( cubeUV_r0 - roughness ) * ( cubeUV_m1 - cubeUV_m0 ) / ( cubeUV_r0 - cubeUV_r1 ) + cubeUV_m0;
		} else if ( roughness >= cubeUV_r4 ) {
			mip = ( cubeUV_r1 - roughness ) * ( cubeUV_m4 - cubeUV_m1 ) / ( cubeUV_r1 - cubeUV_r4 ) + cubeUV_m1;
		} else if ( roughness >= cubeUV_r5 ) {
			mip = ( cubeUV_r4 - roughness ) * ( cubeUV_m5 - cubeUV_m4 ) / ( cubeUV_r4 - cubeUV_r5 ) + cubeUV_m4;
		} else if ( roughness >= cubeUV_r6 ) {
			mip = ( cubeUV_r5 - roughness ) * ( cubeUV_m6 - cubeUV_m5 ) / ( cubeUV_r5 - cubeUV_r6 ) + cubeUV_m5;
		} else {
			mip = - 2.0 * log2( 1.16 * roughness );		}
		return mip;
	}
	vec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {
		float mip = clamp( roughnessToMip( roughness ), cubeUV_m0, CUBEUV_MAX_MIP );
		float mipF = fract( mip );
		float mipInt = floor( mip );
		vec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );
		if ( mipF == 0.0 ) {
			return vec4( color0, 1.0 );
		} else {
			vec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );
			return vec4( mix( color0, color1, mipF ), 1.0 );
		}
	}
#endif`,NM=`vec3 transformedNormal = objectNormal;
#ifdef USE_INSTANCING
	mat3 m = mat3( instanceMatrix );
	transformedNormal /= vec3( dot( m[ 0 ], m[ 0 ] ), dot( m[ 1 ], m[ 1 ] ), dot( m[ 2 ], m[ 2 ] ) );
	transformedNormal = m * transformedNormal;
#endif
transformedNormal = normalMatrix * transformedNormal;
#ifdef FLIP_SIDED
	transformedNormal = - transformedNormal;
#endif
#ifdef USE_TANGENT
	vec3 transformedTangent = ( modelViewMatrix * vec4( objectTangent, 0.0 ) ).xyz;
	#ifdef FLIP_SIDED
		transformedTangent = - transformedTangent;
	#endif
#endif`,BM=`#ifdef USE_DISPLACEMENTMAP
	uniform sampler2D displacementMap;
	uniform float displacementScale;
	uniform float displacementBias;
#endif`,VM=`#ifdef USE_DISPLACEMENTMAP
	transformed += normalize( objectNormal ) * ( texture2D( displacementMap, vUv ).x * displacementScale + displacementBias );
#endif`,zM=`#ifdef USE_EMISSIVEMAP
	vec4 emissiveColor = texture2D( emissiveMap, vUv );
	totalEmissiveRadiance *= emissiveColor.rgb;
#endif`,UM=`#ifdef USE_EMISSIVEMAP
	uniform sampler2D emissiveMap;
#endif`,GM="gl_FragColor = linearToOutputTexel( gl_FragColor );",HM=`vec4 LinearToLinear( in vec4 value ) {
	return value;
}
vec4 LinearTosRGB( in vec4 value ) {
	return vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );
}`,WM=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vec3 cameraToFrag;
		if ( isOrthographic ) {
			cameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToFrag = normalize( vWorldPosition - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vec3 reflectVec = reflect( cameraToFrag, worldNormal );
		#else
			vec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );
		#endif
	#else
		vec3 reflectVec = vReflect;
	#endif
	#ifdef ENVMAP_TYPE_CUBE
		vec4 envColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );
	#else
		vec4 envColor = vec4( 0.0 );
	#endif
	#ifdef ENVMAP_BLENDING_MULTIPLY
		outgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_MIX )
		outgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_ADD )
		outgoingLight += envColor.xyz * specularStrength * reflectivity;
	#endif
#endif`,jM=`#ifdef USE_ENVMAP
	uniform float envMapIntensity;
	uniform float flipEnvMap;
	#ifdef ENVMAP_TYPE_CUBE
		uniform samplerCube envMap;
	#else
		uniform sampler2D envMap;
	#endif
	
#endif`,qM=`#ifdef USE_ENVMAP
	uniform float reflectivity;
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		varying vec3 vWorldPosition;
		uniform float refractionRatio;
	#else
		varying vec3 vReflect;
	#endif
#endif`,XM=`#ifdef USE_ENVMAP
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		
		varying vec3 vWorldPosition;
	#else
		varying vec3 vReflect;
		uniform float refractionRatio;
	#endif
#endif`,$M=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vWorldPosition = worldPosition.xyz;
	#else
		vec3 cameraToVertex;
		if ( isOrthographic ) {
			cameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToVertex = normalize( worldPosition.xyz - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vReflect = reflect( cameraToVertex, worldNormal );
		#else
			vReflect = refract( cameraToVertex, worldNormal, refractionRatio );
		#endif
	#endif
#endif`,YM=`#ifdef USE_FOG
	vFogDepth = - mvPosition.z;
#endif`,KM=`#ifdef USE_FOG
	varying float vFogDepth;
#endif`,ZM=`#ifdef USE_FOG
	#ifdef FOG_EXP2
		float fogFactor = 1.0 - exp( - fogDensity * fogDensity * vFogDepth * vFogDepth );
	#else
		float fogFactor = smoothstep( fogNear, fogFar, vFogDepth );
	#endif
	gl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );
#endif`,JM=`#ifdef USE_FOG
	uniform vec3 fogColor;
	varying float vFogDepth;
	#ifdef FOG_EXP2
		uniform float fogDensity;
	#else
		uniform float fogNear;
		uniform float fogFar;
	#endif
#endif`,QM=`#ifdef USE_GRADIENTMAP
	uniform sampler2D gradientMap;
#endif
vec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {
	float dotNL = dot( normal, lightDirection );
	vec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );
	#ifdef USE_GRADIENTMAP
		return vec3( texture2D( gradientMap, coord ).r );
	#else
		vec2 fw = fwidth( coord ) * 0.5;
		return mix( vec3( 0.7 ), vec3( 1.0 ), smoothstep( 0.7 - fw.x, 0.7 + fw.x, coord.x ) );
	#endif
}`,eT=`#ifdef USE_LIGHTMAP
	vec4 lightMapTexel = texture2D( lightMap, vUv2 );
	vec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;
	reflectedLight.indirectDiffuse += lightMapIrradiance;
#endif`,tT=`#ifdef USE_LIGHTMAP
	uniform sampler2D lightMap;
	uniform float lightMapIntensity;
#endif`,iT=`LambertMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularStrength = specularStrength;`,nT=`varying vec3 vViewPosition;
struct LambertMaterial {
	vec3 diffuseColor;
	float specularStrength;
};
void RE_Direct_Lambert( const in IncidentLight directLight, const in GeometricContext geometry, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometry.normal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Lambert( const in vec3 irradiance, const in GeometricContext geometry, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Lambert
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Lambert`,sT=`uniform bool receiveShadow;
uniform vec3 ambientLightColor;
uniform vec3 lightProbe[ 9 ];
vec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {
	float x = normal.x, y = normal.y, z = normal.z;
	vec3 result = shCoefficients[ 0 ] * 0.886227;
	result += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;
	result += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;
	result += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;
	result += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;
	result += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;
	result += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );
	result += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;
	result += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );
	return result;
}
vec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in vec3 normal ) {
	vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
	vec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );
	return irradiance;
}
vec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {
	vec3 irradiance = ambientLightColor;
	return irradiance;
}
float getDistanceAttenuation( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {
	#if defined ( PHYSICALLY_CORRECT_LIGHTS )
		float distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );
		if ( cutoffDistance > 0.0 ) {
			distanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );
		}
		return distanceFalloff;
	#else
		if ( cutoffDistance > 0.0 && decayExponent > 0.0 ) {
			return pow( saturate( - lightDistance / cutoffDistance + 1.0 ), decayExponent );
		}
		return 1.0;
	#endif
}
float getSpotAttenuation( const in float coneCosine, const in float penumbraCosine, const in float angleCosine ) {
	return smoothstep( coneCosine, penumbraCosine, angleCosine );
}
#if NUM_DIR_LIGHTS > 0
	struct DirectionalLight {
		vec3 direction;
		vec3 color;
	};
	uniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];
	void getDirectionalLightInfo( const in DirectionalLight directionalLight, const in GeometricContext geometry, out IncidentLight light ) {
		light.color = directionalLight.color;
		light.direction = directionalLight.direction;
		light.visible = true;
	}
#endif
#if NUM_POINT_LIGHTS > 0
	struct PointLight {
		vec3 position;
		vec3 color;
		float distance;
		float decay;
	};
	uniform PointLight pointLights[ NUM_POINT_LIGHTS ];
	void getPointLightInfo( const in PointLight pointLight, const in GeometricContext geometry, out IncidentLight light ) {
		vec3 lVector = pointLight.position - geometry.position;
		light.direction = normalize( lVector );
		float lightDistance = length( lVector );
		light.color = pointLight.color;
		light.color *= getDistanceAttenuation( lightDistance, pointLight.distance, pointLight.decay );
		light.visible = ( light.color != vec3( 0.0 ) );
	}
#endif
#if NUM_SPOT_LIGHTS > 0
	struct SpotLight {
		vec3 position;
		vec3 direction;
		vec3 color;
		float distance;
		float decay;
		float coneCos;
		float penumbraCos;
	};
	uniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];
	void getSpotLightInfo( const in SpotLight spotLight, const in GeometricContext geometry, out IncidentLight light ) {
		vec3 lVector = spotLight.position - geometry.position;
		light.direction = normalize( lVector );
		float angleCos = dot( light.direction, spotLight.direction );
		float spotAttenuation = getSpotAttenuation( spotLight.coneCos, spotLight.penumbraCos, angleCos );
		if ( spotAttenuation > 0.0 ) {
			float lightDistance = length( lVector );
			light.color = spotLight.color * spotAttenuation;
			light.color *= getDistanceAttenuation( lightDistance, spotLight.distance, spotLight.decay );
			light.visible = ( light.color != vec3( 0.0 ) );
		} else {
			light.color = vec3( 0.0 );
			light.visible = false;
		}
	}
#endif
#if NUM_RECT_AREA_LIGHTS > 0
	struct RectAreaLight {
		vec3 color;
		vec3 position;
		vec3 halfWidth;
		vec3 halfHeight;
	};
	uniform sampler2D ltc_1;	uniform sampler2D ltc_2;
	uniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];
#endif
#if NUM_HEMI_LIGHTS > 0
	struct HemisphereLight {
		vec3 direction;
		vec3 skyColor;
		vec3 groundColor;
	};
	uniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];
	vec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in vec3 normal ) {
		float dotNL = dot( normal, hemiLight.direction );
		float hemiDiffuseWeight = 0.5 * dotNL + 0.5;
		vec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );
		return irradiance;
	}
#endif`,rT=`#if defined( USE_ENVMAP )
	vec3 getIBLIrradiance( const in vec3 normal ) {
		#if defined( ENVMAP_TYPE_CUBE_UV )
			vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, worldNormal, 1.0 );
			return PI * envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
	vec3 getIBLRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness ) {
		#if defined( ENVMAP_TYPE_CUBE_UV )
			vec3 reflectVec = reflect( - viewDir, normal );
			reflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );
			reflectVec = inverseTransformDirection( reflectVec, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, reflectVec, roughness );
			return envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
#endif`,oT=`ToonMaterial material;
material.diffuseColor = diffuseColor.rgb;`,aT=`varying vec3 vViewPosition;
struct ToonMaterial {
	vec3 diffuseColor;
};
void RE_Direct_Toon( const in IncidentLight directLight, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	vec3 irradiance = getGradientIrradiance( geometry.normal, directLight.direction ) * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Toon
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Toon`,lT=`BlinnPhongMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularColor = specular;
material.specularShininess = shininess;
material.specularStrength = specularStrength;`,cT=`varying vec3 vViewPosition;
struct BlinnPhongMaterial {
	vec3 diffuseColor;
	vec3 specularColor;
	float specularShininess;
	float specularStrength;
};
void RE_Direct_BlinnPhong( const in IncidentLight directLight, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometry.normal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
	reflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularShininess ) * material.specularStrength;
}
void RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_BlinnPhong
#define RE_IndirectDiffuse		RE_IndirectDiffuse_BlinnPhong`,uT=`PhysicalMaterial material;
material.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );
vec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );
float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );
material.roughness = max( roughnessFactor, 0.0525 );material.roughness += geometryRoughness;
material.roughness = min( material.roughness, 1.0 );
#ifdef IOR
	material.ior = ior;
	#ifdef SPECULAR
		float specularIntensityFactor = specularIntensity;
		vec3 specularColorFactor = specularColor;
		#ifdef USE_SPECULARINTENSITYMAP
			specularIntensityFactor *= texture2D( specularIntensityMap, vUv ).a;
		#endif
		#ifdef USE_SPECULARCOLORMAP
			specularColorFactor *= texture2D( specularColorMap, vUv ).rgb;
		#endif
		material.specularF90 = mix( specularIntensityFactor, 1.0, metalnessFactor );
	#else
		float specularIntensityFactor = 1.0;
		vec3 specularColorFactor = vec3( 1.0 );
		material.specularF90 = 1.0;
	#endif
	material.specularColor = mix( min( pow2( ( material.ior - 1.0 ) / ( material.ior + 1.0 ) ) * specularColorFactor, vec3( 1.0 ) ) * specularIntensityFactor, diffuseColor.rgb, metalnessFactor );
#else
	material.specularColor = mix( vec3( 0.04 ), diffuseColor.rgb, metalnessFactor );
	material.specularF90 = 1.0;
#endif
#ifdef USE_CLEARCOAT
	material.clearcoat = clearcoat;
	material.clearcoatRoughness = clearcoatRoughness;
	material.clearcoatF0 = vec3( 0.04 );
	material.clearcoatF90 = 1.0;
	#ifdef USE_CLEARCOATMAP
		material.clearcoat *= texture2D( clearcoatMap, vUv ).x;
	#endif
	#ifdef USE_CLEARCOAT_ROUGHNESSMAP
		material.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vUv ).y;
	#endif
	material.clearcoat = saturate( material.clearcoat );	material.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );
	material.clearcoatRoughness += geometryRoughness;
	material.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );
#endif
#ifdef USE_IRIDESCENCE
	material.iridescence = iridescence;
	material.iridescenceIOR = iridescenceIOR;
	#ifdef USE_IRIDESCENCEMAP
		material.iridescence *= texture2D( iridescenceMap, vUv ).r;
	#endif
	#ifdef USE_IRIDESCENCE_THICKNESSMAP
		material.iridescenceThickness = (iridescenceThicknessMaximum - iridescenceThicknessMinimum) * texture2D( iridescenceThicknessMap, vUv ).g + iridescenceThicknessMinimum;
	#else
		material.iridescenceThickness = iridescenceThicknessMaximum;
	#endif
#endif
#ifdef USE_SHEEN
	material.sheenColor = sheenColor;
	#ifdef USE_SHEENCOLORMAP
		material.sheenColor *= texture2D( sheenColorMap, vUv ).rgb;
	#endif
	material.sheenRoughness = clamp( sheenRoughness, 0.07, 1.0 );
	#ifdef USE_SHEENROUGHNESSMAP
		material.sheenRoughness *= texture2D( sheenRoughnessMap, vUv ).a;
	#endif
#endif`,hT=`struct PhysicalMaterial {
	vec3 diffuseColor;
	float roughness;
	vec3 specularColor;
	float specularF90;
	#ifdef USE_CLEARCOAT
		float clearcoat;
		float clearcoatRoughness;
		vec3 clearcoatF0;
		float clearcoatF90;
	#endif
	#ifdef USE_IRIDESCENCE
		float iridescence;
		float iridescenceIOR;
		float iridescenceThickness;
		vec3 iridescenceFresnel;
		vec3 iridescenceF0;
	#endif
	#ifdef USE_SHEEN
		vec3 sheenColor;
		float sheenRoughness;
	#endif
	#ifdef IOR
		float ior;
	#endif
	#ifdef USE_TRANSMISSION
		float transmission;
		float transmissionAlpha;
		float thickness;
		float attenuationDistance;
		vec3 attenuationColor;
	#endif
};
vec3 clearcoatSpecular = vec3( 0.0 );
vec3 sheenSpecular = vec3( 0.0 );
float IBLSheenBRDF( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	float r2 = roughness * roughness;
	float a = roughness < 0.25 ? -339.2 * r2 + 161.4 * roughness - 25.9 : -8.48 * r2 + 14.3 * roughness - 9.95;
	float b = roughness < 0.25 ? 44.0 * r2 - 23.7 * roughness + 3.26 : 1.97 * r2 - 3.27 * roughness + 0.72;
	float DG = exp( a * dotNV + b ) + ( roughness < 0.25 ? 0.0 : 0.1 * ( roughness - 0.25 ) );
	return saturate( DG * RECIPROCAL_PI );
}
vec2 DFGApprox( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	const vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );
	const vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );
	vec4 r = roughness * c0 + c1;
	float a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;
	vec2 fab = vec2( - 1.04, 1.04 ) * a004 + r.zw;
	return fab;
}
vec3 EnvironmentBRDF( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness ) {
	vec2 fab = DFGApprox( normal, viewDir, roughness );
	return specularColor * fab.x + specularF90 * fab.y;
}
#ifdef USE_IRIDESCENCE
void computeMultiscatteringIridescence( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float iridescence, const in vec3 iridescenceF0, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#else
void computeMultiscattering( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#endif
	vec2 fab = DFGApprox( normal, viewDir, roughness );
	#ifdef USE_IRIDESCENCE
		vec3 Fr = mix( specularColor, iridescenceF0, iridescence );
	#else
		vec3 Fr = specularColor;
	#endif
	vec3 FssEss = Fr * fab.x + specularF90 * fab.y;
	float Ess = fab.x + fab.y;
	float Ems = 1.0 - Ess;
	vec3 Favg = Fr + ( 1.0 - Fr ) * 0.047619;	vec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );
	singleScatter += FssEss;
	multiScatter += Fms * Ems;
}
#if NUM_RECT_AREA_LIGHTS > 0
	void RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
		vec3 normal = geometry.normal;
		vec3 viewDir = geometry.viewDir;
		vec3 position = geometry.position;
		vec3 lightPos = rectAreaLight.position;
		vec3 halfWidth = rectAreaLight.halfWidth;
		vec3 halfHeight = rectAreaLight.halfHeight;
		vec3 lightColor = rectAreaLight.color;
		float roughness = material.roughness;
		vec3 rectCoords[ 4 ];
		rectCoords[ 0 ] = lightPos + halfWidth - halfHeight;		rectCoords[ 1 ] = lightPos - halfWidth - halfHeight;
		rectCoords[ 2 ] = lightPos - halfWidth + halfHeight;
		rectCoords[ 3 ] = lightPos + halfWidth + halfHeight;
		vec2 uv = LTC_Uv( normal, viewDir, roughness );
		vec4 t1 = texture2D( ltc_1, uv );
		vec4 t2 = texture2D( ltc_2, uv );
		mat3 mInv = mat3(
			vec3( t1.x, 0, t1.y ),
			vec3(    0, 1,    0 ),
			vec3( t1.z, 0, t1.w )
		);
		vec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );
		reflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );
		reflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );
	}
#endif
void RE_Direct_Physical( const in IncidentLight directLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometry.normal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	#ifdef USE_CLEARCOAT
		float dotNLcc = saturate( dot( geometry.clearcoatNormal, directLight.direction ) );
		vec3 ccIrradiance = dotNLcc * directLight.color;
		clearcoatSpecular += ccIrradiance * BRDF_GGX( directLight.direction, geometry.viewDir, geometry.clearcoatNormal, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );
	#endif
	#ifdef USE_SHEEN
		sheenSpecular += irradiance * BRDF_Sheen( directLight.direction, geometry.viewDir, geometry.normal, material.sheenColor, material.sheenRoughness );
	#endif
	#ifdef USE_IRIDESCENCE
		reflectedLight.directSpecular += irradiance * BRDF_GGX_Iridescence( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnel, material.roughness );
	#else
		reflectedLight.directSpecular += irradiance * BRDF_GGX( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularF90, material.roughness );
	#endif
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {
	#ifdef USE_CLEARCOAT
		clearcoatSpecular += clearcoatRadiance * EnvironmentBRDF( geometry.clearcoatNormal, geometry.viewDir, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );
	#endif
	#ifdef USE_SHEEN
		sheenSpecular += irradiance * material.sheenColor * IBLSheenBRDF( geometry.normal, geometry.viewDir, material.sheenRoughness );
	#endif
	vec3 singleScattering = vec3( 0.0 );
	vec3 multiScattering = vec3( 0.0 );
	vec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;
	#ifdef USE_IRIDESCENCE
		computeMultiscatteringIridescence( geometry.normal, geometry.viewDir, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnel, material.roughness, singleScattering, multiScattering );
	#else
		computeMultiscattering( geometry.normal, geometry.viewDir, material.specularColor, material.specularF90, material.roughness, singleScattering, multiScattering );
	#endif
	vec3 totalScattering = singleScattering + multiScattering;
	vec3 diffuse = material.diffuseColor * ( 1.0 - max( max( totalScattering.r, totalScattering.g ), totalScattering.b ) );
	reflectedLight.indirectSpecular += radiance * singleScattering;
	reflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;
	reflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;
}
#define RE_Direct				RE_Direct_Physical
#define RE_Direct_RectArea		RE_Direct_RectArea_Physical
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Physical
#define RE_IndirectSpecular		RE_IndirectSpecular_Physical
float computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {
	return saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );
}`,dT=`
GeometricContext geometry;
geometry.position = - vViewPosition;
geometry.normal = normal;
geometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );
#ifdef USE_CLEARCOAT
	geometry.clearcoatNormal = clearcoatNormal;
#endif
#ifdef USE_IRIDESCENCE
	float dotNVi = saturate( dot( normal, geometry.viewDir ) );
	if ( material.iridescenceThickness == 0.0 ) {
		material.iridescence = 0.0;
	} else {
		material.iridescence = saturate( material.iridescence );
	}
	if ( material.iridescence > 0.0 ) {
		material.iridescenceFresnel = evalIridescence( 1.0, material.iridescenceIOR, dotNVi, material.iridescenceThickness, material.specularColor );
		material.iridescenceF0 = Schlick_to_F0( material.iridescenceFresnel, 1.0, dotNVi );
	}
#endif
IncidentLight directLight;
#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )
	PointLight pointLight;
	#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {
		pointLight = pointLights[ i ];
		getPointLightInfo( pointLight, geometry, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )
		pointLightShadow = pointLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;
		#endif
		RE_Direct( directLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )
	SpotLight spotLight;
	vec4 spotColor;
	vec3 spotLightCoord;
	bool inSpotLightMap;
	#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {
		spotLight = spotLights[ i ];
		getSpotLightInfo( spotLight, geometry, directLight );
		#if ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#define SPOT_LIGHT_MAP_INDEX UNROLLED_LOOP_INDEX
		#elif ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		#define SPOT_LIGHT_MAP_INDEX NUM_SPOT_LIGHT_MAPS
		#else
		#define SPOT_LIGHT_MAP_INDEX ( UNROLLED_LOOP_INDEX - NUM_SPOT_LIGHT_SHADOWS + NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#endif
		#if ( SPOT_LIGHT_MAP_INDEX < NUM_SPOT_LIGHT_MAPS )
			spotLightCoord = vSpotLightCoord[ i ].xyz / vSpotLightCoord[ i ].w;
			inSpotLightMap = all( lessThan( abs( spotLightCoord * 2. - 1. ), vec3( 1.0 ) ) );
			spotColor = texture2D( spotLightMap[ SPOT_LIGHT_MAP_INDEX ], spotLightCoord.xy );
			directLight.color = inSpotLightMap ? directLight.color * spotColor.rgb : directLight.color;
		#endif
		#undef SPOT_LIGHT_MAP_INDEX
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		spotLightShadow = spotLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )
	DirectionalLight directionalLight;
	#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {
		directionalLight = directionalLights[ i ];
		getDirectionalLightInfo( directionalLight, geometry, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )
		directionalLightShadow = directionalLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )
	RectAreaLight rectAreaLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {
		rectAreaLight = rectAreaLights[ i ];
		RE_Direct_RectArea( rectAreaLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if defined( RE_IndirectDiffuse )
	vec3 iblIrradiance = vec3( 0.0 );
	vec3 irradiance = getAmbientLightIrradiance( ambientLightColor );
	irradiance += getLightProbeIrradiance( lightProbe, geometry.normal );
	#if ( NUM_HEMI_LIGHTS > 0 )
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {
			irradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry.normal );
		}
		#pragma unroll_loop_end
	#endif
#endif
#if defined( RE_IndirectSpecular )
	vec3 radiance = vec3( 0.0 );
	vec3 clearcoatRadiance = vec3( 0.0 );
#endif`,pT=`#if defined( RE_IndirectDiffuse )
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vUv2 );
		vec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;
		irradiance += lightMapIrradiance;
	#endif
	#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )
		iblIrradiance += getIBLIrradiance( geometry.normal );
	#endif
#endif
#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )
	radiance += getIBLRadiance( geometry.viewDir, geometry.normal, material.roughness );
	#ifdef USE_CLEARCOAT
		clearcoatRadiance += getIBLRadiance( geometry.viewDir, geometry.clearcoatNormal, material.clearcoatRoughness );
	#endif
#endif`,fT=`#if defined( RE_IndirectDiffuse )
	RE_IndirectDiffuse( irradiance, geometry, material, reflectedLight );
#endif
#if defined( RE_IndirectSpecular )
	RE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometry, material, reflectedLight );
#endif`,mT=`#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )
	gl_FragDepthEXT = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;
#endif`,gT=`#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )
	uniform float logDepthBufFC;
	varying float vFragDepth;
	varying float vIsPerspective;
#endif`,_T=`#ifdef USE_LOGDEPTHBUF
	#ifdef USE_LOGDEPTHBUF_EXT
		varying float vFragDepth;
		varying float vIsPerspective;
	#else
		uniform float logDepthBufFC;
	#endif
#endif`,vT=`#ifdef USE_LOGDEPTHBUF
	#ifdef USE_LOGDEPTHBUF_EXT
		vFragDepth = 1.0 + gl_Position.w;
		vIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );
	#else
		if ( isPerspectiveMatrix( projectionMatrix ) ) {
			gl_Position.z = log2( max( EPSILON, gl_Position.w + 1.0 ) ) * logDepthBufFC - 1.0;
			gl_Position.z *= gl_Position.w;
		}
	#endif
#endif`,bT=`#ifdef USE_MAP
	vec4 sampledDiffuseColor = texture2D( map, vUv );
	#ifdef DECODE_VIDEO_TEXTURE
		sampledDiffuseColor = vec4( mix( pow( sampledDiffuseColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), sampledDiffuseColor.rgb * 0.0773993808, vec3( lessThanEqual( sampledDiffuseColor.rgb, vec3( 0.04045 ) ) ) ), sampledDiffuseColor.w );
	#endif
	diffuseColor *= sampledDiffuseColor;
#endif`,xT=`#ifdef USE_MAP
	uniform sampler2D map;
#endif`,wT=`#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
	vec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;
#endif
#ifdef USE_MAP
	diffuseColor *= texture2D( map, uv );
#endif
#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, uv ).g;
#endif`,yT=`#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
	uniform mat3 uvTransform;
#endif
#ifdef USE_MAP
	uniform sampler2D map;
#endif
#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,ST=`float metalnessFactor = metalness;
#ifdef USE_METALNESSMAP
	vec4 texelMetalness = texture2D( metalnessMap, vUv );
	metalnessFactor *= texelMetalness.b;
#endif`,MT=`#ifdef USE_METALNESSMAP
	uniform sampler2D metalnessMap;
#endif`,TT=`#if defined( USE_MORPHCOLORS ) && defined( MORPHTARGETS_TEXTURE )
	vColor *= morphTargetBaseInfluence;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		#if defined( USE_COLOR_ALPHA )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ) * morphTargetInfluences[ i ];
		#elif defined( USE_COLOR )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ).rgb * morphTargetInfluences[ i ];
		#endif
	}
#endif`,ET=`#ifdef USE_MORPHNORMALS
	objectNormal *= morphTargetBaseInfluence;
	#ifdef MORPHTARGETS_TEXTURE
		for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
			if ( morphTargetInfluences[ i ] != 0.0 ) objectNormal += getMorph( gl_VertexID, i, 1 ).xyz * morphTargetInfluences[ i ];
		}
	#else
		objectNormal += morphNormal0 * morphTargetInfluences[ 0 ];
		objectNormal += morphNormal1 * morphTargetInfluences[ 1 ];
		objectNormal += morphNormal2 * morphTargetInfluences[ 2 ];
		objectNormal += morphNormal3 * morphTargetInfluences[ 3 ];
	#endif
#endif`,CT=`#ifdef USE_MORPHTARGETS
	uniform float morphTargetBaseInfluence;
	#ifdef MORPHTARGETS_TEXTURE
		uniform float morphTargetInfluences[ MORPHTARGETS_COUNT ];
		uniform sampler2DArray morphTargetsTexture;
		uniform ivec2 morphTargetsTextureSize;
		vec4 getMorph( const in int vertexIndex, const in int morphTargetIndex, const in int offset ) {
			int texelIndex = vertexIndex * MORPHTARGETS_TEXTURE_STRIDE + offset;
			int y = texelIndex / morphTargetsTextureSize.x;
			int x = texelIndex - y * morphTargetsTextureSize.x;
			ivec3 morphUV = ivec3( x, y, morphTargetIndex );
			return texelFetch( morphTargetsTexture, morphUV, 0 );
		}
	#else
		#ifndef USE_MORPHNORMALS
			uniform float morphTargetInfluences[ 8 ];
		#else
			uniform float morphTargetInfluences[ 4 ];
		#endif
	#endif
#endif`,DT=`#ifdef USE_MORPHTARGETS
	transformed *= morphTargetBaseInfluence;
	#ifdef MORPHTARGETS_TEXTURE
		for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
			if ( morphTargetInfluences[ i ] != 0.0 ) transformed += getMorph( gl_VertexID, i, 0 ).xyz * morphTargetInfluences[ i ];
		}
	#else
		transformed += morphTarget0 * morphTargetInfluences[ 0 ];
		transformed += morphTarget1 * morphTargetInfluences[ 1 ];
		transformed += morphTarget2 * morphTargetInfluences[ 2 ];
		transformed += morphTarget3 * morphTargetInfluences[ 3 ];
		#ifndef USE_MORPHNORMALS
			transformed += morphTarget4 * morphTargetInfluences[ 4 ];
			transformed += morphTarget5 * morphTargetInfluences[ 5 ];
			transformed += morphTarget6 * morphTargetInfluences[ 6 ];
			transformed += morphTarget7 * morphTargetInfluences[ 7 ];
		#endif
	#endif
#endif`,PT=`float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;
#ifdef FLAT_SHADED
	vec3 fdx = dFdx( vViewPosition );
	vec3 fdy = dFdy( vViewPosition );
	vec3 normal = normalize( cross( fdx, fdy ) );
#else
	vec3 normal = normalize( vNormal );
	#ifdef DOUBLE_SIDED
		normal = normal * faceDirection;
	#endif
	#ifdef USE_TANGENT
		vec3 tangent = normalize( vTangent );
		vec3 bitangent = normalize( vBitangent );
		#ifdef DOUBLE_SIDED
			tangent = tangent * faceDirection;
			bitangent = bitangent * faceDirection;
		#endif
		#if defined( TANGENTSPACE_NORMALMAP ) || defined( USE_CLEARCOAT_NORMALMAP )
			mat3 vTBN = mat3( tangent, bitangent, normal );
		#endif
	#endif
#endif
vec3 geometryNormal = normal;`,AT=`#ifdef OBJECTSPACE_NORMALMAP
	normal = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;
	#ifdef FLIP_SIDED
		normal = - normal;
	#endif
	#ifdef DOUBLE_SIDED
		normal = normal * faceDirection;
	#endif
	normal = normalize( normalMatrix * normal );
#elif defined( TANGENTSPACE_NORMALMAP )
	vec3 mapN = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;
	mapN.xy *= normalScale;
	#ifdef USE_TANGENT
		normal = normalize( vTBN * mapN );
	#else
		normal = perturbNormal2Arb( - vViewPosition, normal, mapN, faceDirection );
	#endif
#elif defined( USE_BUMPMAP )
	normal = perturbNormalArb( - vViewPosition, normal, dHdxy_fwd(), faceDirection );
#endif`,LT=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,RT=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,kT=`#ifndef FLAT_SHADED
	vNormal = normalize( transformedNormal );
	#ifdef USE_TANGENT
		vTangent = normalize( transformedTangent );
		vBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );
	#endif
#endif`,IT=`#ifdef USE_NORMALMAP
	uniform sampler2D normalMap;
	uniform vec2 normalScale;
#endif
#ifdef OBJECTSPACE_NORMALMAP
	uniform mat3 normalMatrix;
#endif
#if ! defined ( USE_TANGENT ) && ( defined ( TANGENTSPACE_NORMALMAP ) || defined ( USE_CLEARCOAT_NORMALMAP ) )
	vec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm, vec3 mapN, float faceDirection ) {
		vec3 q0 = dFdx( eye_pos.xyz );
		vec3 q1 = dFdy( eye_pos.xyz );
		vec2 st0 = dFdx( vUv.st );
		vec2 st1 = dFdy( vUv.st );
		vec3 N = surf_norm;
		vec3 q1perp = cross( q1, N );
		vec3 q0perp = cross( N, q0 );
		vec3 T = q1perp * st0.x + q0perp * st1.x;
		vec3 B = q1perp * st0.y + q0perp * st1.y;
		float det = max( dot( T, T ), dot( B, B ) );
		float scale = ( det == 0.0 ) ? 0.0 : faceDirection * inversesqrt( det );
		return normalize( T * ( mapN.x * scale ) + B * ( mapN.y * scale ) + N * mapN.z );
	}
#endif`,FT=`#ifdef USE_CLEARCOAT
	vec3 clearcoatNormal = geometryNormal;
#endif`,OT=`#ifdef USE_CLEARCOAT_NORMALMAP
	vec3 clearcoatMapN = texture2D( clearcoatNormalMap, vUv ).xyz * 2.0 - 1.0;
	clearcoatMapN.xy *= clearcoatNormalScale;
	#ifdef USE_TANGENT
		clearcoatNormal = normalize( vTBN * clearcoatMapN );
	#else
		clearcoatNormal = perturbNormal2Arb( - vViewPosition, clearcoatNormal, clearcoatMapN, faceDirection );
	#endif
#endif`,NT=`#ifdef USE_CLEARCOATMAP
	uniform sampler2D clearcoatMap;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform sampler2D clearcoatRoughnessMap;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform sampler2D clearcoatNormalMap;
	uniform vec2 clearcoatNormalScale;
#endif`,BT=`#ifdef USE_IRIDESCENCEMAP
	uniform sampler2D iridescenceMap;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	uniform sampler2D iridescenceThicknessMap;
#endif`,VT=`#ifdef OPAQUE
diffuseColor.a = 1.0;
#endif
#ifdef USE_TRANSMISSION
diffuseColor.a *= material.transmissionAlpha + 0.1;
#endif
gl_FragColor = vec4( outgoingLight, diffuseColor.a );`,zT=`vec3 packNormalToRGB( const in vec3 normal ) {
	return normalize( normal ) * 0.5 + 0.5;
}
vec3 unpackRGBToNormal( const in vec3 rgb ) {
	return 2.0 * rgb.xyz - 1.0;
}
const float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;
const vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256., 256. );
const vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );
const float ShiftRight8 = 1. / 256.;
vec4 packDepthToRGBA( const in float v ) {
	vec4 r = vec4( fract( v * PackFactors ), v );
	r.yzw -= r.xyz * ShiftRight8;	return r * PackUpscale;
}
float unpackRGBAToDepth( const in vec4 v ) {
	return dot( v, UnpackFactors );
}
vec2 packDepthToRG( in highp float v ) {
	return packDepthToRGBA( v ).yx;
}
float unpackRGToDepth( const in highp vec2 v ) {
	return unpackRGBAToDepth( vec4( v.xy, 0.0, 0.0 ) );
}
vec4 pack2HalfToRGBA( vec2 v ) {
	vec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ) );
	return vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w );
}
vec2 unpackRGBATo2Half( vec4 v ) {
	return vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );
}
float viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {
	return ( viewZ + near ) / ( near - far );
}
float orthographicDepthToViewZ( const in float linearClipZ, const in float near, const in float far ) {
	return linearClipZ * ( near - far ) - near;
}
float viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {
	return ( ( near + viewZ ) * far ) / ( ( far - near ) * viewZ );
}
float perspectiveDepthToViewZ( const in float invClipZ, const in float near, const in float far ) {
	return ( near * far ) / ( ( far - near ) * invClipZ - far );
}`,UT=`#ifdef PREMULTIPLIED_ALPHA
	gl_FragColor.rgb *= gl_FragColor.a;
#endif`,GT=`vec4 mvPosition = vec4( transformed, 1.0 );
#ifdef USE_INSTANCING
	mvPosition = instanceMatrix * mvPosition;
#endif
mvPosition = modelViewMatrix * mvPosition;
gl_Position = projectionMatrix * mvPosition;`,HT=`#ifdef DITHERING
	gl_FragColor.rgb = dithering( gl_FragColor.rgb );
#endif`,WT=`#ifdef DITHERING
	vec3 dithering( vec3 color ) {
		float grid_position = rand( gl_FragCoord.xy );
		vec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );
		dither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );
		return color + dither_shift_RGB;
	}
#endif`,jT=`float roughnessFactor = roughness;
#ifdef USE_ROUGHNESSMAP
	vec4 texelRoughness = texture2D( roughnessMap, vUv );
	roughnessFactor *= texelRoughness.g;
#endif`,qT=`#ifdef USE_ROUGHNESSMAP
	uniform sampler2D roughnessMap;
#endif`,XT=`#if NUM_SPOT_LIGHT_COORDS > 0
  varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];
#endif
#if NUM_SPOT_LIGHT_MAPS > 0
  uniform sampler2D spotLightMap[ NUM_SPOT_LIGHT_MAPS ];
#endif
#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		uniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];
		struct SpotLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
	float texture2DCompare( sampler2D depths, vec2 uv, float compare ) {
		return step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );
	}
	vec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {
		return unpackRGBATo2Half( texture2D( shadow, uv ) );
	}
	float VSMShadow (sampler2D shadow, vec2 uv, float compare ){
		float occlusion = 1.0;
		vec2 distribution = texture2DDistribution( shadow, uv );
		float hard_shadow = step( compare , distribution.x );
		if (hard_shadow != 1.0 ) {
			float distance = compare - distribution.x ;
			float variance = max( 0.00000, distribution.y * distribution.y );
			float softness_probability = variance / (variance + distance * distance );			softness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );			occlusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );
		}
		return occlusion;
	}
	float getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {
		float shadow = 1.0;
		shadowCoord.xyz /= shadowCoord.w;
		shadowCoord.z += shadowBias;
		bool inFrustum = shadowCoord.x >= 0.0 && shadowCoord.x <= 1.0 && shadowCoord.y >= 0.0 && shadowCoord.y <= 1.0;
		bool frustumTest = inFrustum && shadowCoord.z <= 1.0;
		if ( frustumTest ) {
		#if defined( SHADOWMAP_TYPE_PCF )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx0 = - texelSize.x * shadowRadius;
			float dy0 = - texelSize.y * shadowRadius;
			float dx1 = + texelSize.x * shadowRadius;
			float dy1 = + texelSize.y * shadowRadius;
			float dx2 = dx0 / 2.0;
			float dy2 = dy0 / 2.0;
			float dx3 = dx1 / 2.0;
			float dy3 = dy1 / 2.0;
			shadow = (
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )
			) * ( 1.0 / 17.0 );
		#elif defined( SHADOWMAP_TYPE_PCF_SOFT )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx = texelSize.x;
			float dy = texelSize.y;
			vec2 uv = shadowCoord.xy;
			vec2 f = fract( uv * shadowMapSize + 0.5 );
			uv -= f * texelSize;
			shadow = (
				texture2DCompare( shadowMap, uv, shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ),
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),
						  f.x ),
					 mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ),
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),
						  f.x ),
					 f.y )
			) * ( 1.0 / 9.0 );
		#elif defined( SHADOWMAP_TYPE_VSM )
			shadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );
		#else
			shadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );
		#endif
		}
		return shadow;
	}
	vec2 cubeToUV( vec3 v, float texelSizeY ) {
		vec3 absV = abs( v );
		float scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );
		absV *= scaleToCube;
		v *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );
		vec2 planar = v.xy;
		float almostATexel = 1.5 * texelSizeY;
		float almostOne = 1.0 - almostATexel;
		if ( absV.z >= almostOne ) {
			if ( v.z > 0.0 )
				planar.x = 4.0 - v.x;
		} else if ( absV.x >= almostOne ) {
			float signX = sign( v.x );
			planar.x = v.z * signX + 2.0 * signX;
		} else if ( absV.y >= almostOne ) {
			float signY = sign( v.y );
			planar.x = v.x + 2.0 * signY + 2.0;
			planar.y = v.z * signY - 2.0;
		}
		return vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );
	}
	float getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {
		vec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );
		vec3 lightToPosition = shadowCoord.xyz;
		float dp = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );		dp += shadowBias;
		vec3 bd3D = normalize( lightToPosition );
		#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )
			vec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;
			return (
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )
			) * ( 1.0 / 9.0 );
		#else
			return texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );
		#endif
	}
#endif`,$T=`#if NUM_SPOT_LIGHT_COORDS > 0
  uniform mat4 spotLightMatrix[ NUM_SPOT_LIGHT_COORDS ];
  varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];
#endif
#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		struct SpotLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
#endif`,YT=`#if defined( USE_SHADOWMAP ) || ( NUM_SPOT_LIGHT_COORDS > 0 )
	#if NUM_DIR_LIGHT_SHADOWS > 0 || NUM_SPOT_LIGHT_COORDS > 0 || NUM_POINT_LIGHT_SHADOWS > 0
		vec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
		vec4 shadowWorldPosition;
	#endif
	#if NUM_DIR_LIGHT_SHADOWS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
		shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );
		vDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_SPOT_LIGHT_COORDS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_COORDS; i ++ ) {
		shadowWorldPosition = worldPosition;
		#if ( defined( USE_SHADOWMAP ) && UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
			shadowWorldPosition.xyz += shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias;
		#endif
		vSpotLightCoord[ i ] = spotLightMatrix[ i ] * shadowWorldPosition;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
		shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );
		vPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;
	}
	#pragma unroll_loop_end
	#endif
#endif`,KT=`float getShadowMask() {
	float shadow = 1.0;
	#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
		directionalLight = directionalLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {
		spotLight = spotLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
		pointLight = pointLightShadows[ i ];
		shadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#endif
	return shadow;
}`,ZT=`#ifdef USE_SKINNING
	mat4 boneMatX = getBoneMatrix( skinIndex.x );
	mat4 boneMatY = getBoneMatrix( skinIndex.y );
	mat4 boneMatZ = getBoneMatrix( skinIndex.z );
	mat4 boneMatW = getBoneMatrix( skinIndex.w );
#endif`,JT=`#ifdef USE_SKINNING
	uniform mat4 bindMatrix;
	uniform mat4 bindMatrixInverse;
	uniform highp sampler2D boneTexture;
	uniform int boneTextureSize;
	mat4 getBoneMatrix( const in float i ) {
		float j = i * 4.0;
		float x = mod( j, float( boneTextureSize ) );
		float y = floor( j / float( boneTextureSize ) );
		float dx = 1.0 / float( boneTextureSize );
		float dy = 1.0 / float( boneTextureSize );
		y = dy * ( y + 0.5 );
		vec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );
		vec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );
		vec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );
		vec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );
		mat4 bone = mat4( v1, v2, v3, v4 );
		return bone;
	}
#endif`,QT=`#ifdef USE_SKINNING
	vec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );
	vec4 skinned = vec4( 0.0 );
	skinned += boneMatX * skinVertex * skinWeight.x;
	skinned += boneMatY * skinVertex * skinWeight.y;
	skinned += boneMatZ * skinVertex * skinWeight.z;
	skinned += boneMatW * skinVertex * skinWeight.w;
	transformed = ( bindMatrixInverse * skinned ).xyz;
#endif`,eE=`#ifdef USE_SKINNING
	mat4 skinMatrix = mat4( 0.0 );
	skinMatrix += skinWeight.x * boneMatX;
	skinMatrix += skinWeight.y * boneMatY;
	skinMatrix += skinWeight.z * boneMatZ;
	skinMatrix += skinWeight.w * boneMatW;
	skinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;
	objectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;
	#ifdef USE_TANGENT
		objectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;
	#endif
#endif`,tE=`float specularStrength;
#ifdef USE_SPECULARMAP
	vec4 texelSpecular = texture2D( specularMap, vUv );
	specularStrength = texelSpecular.r;
#else
	specularStrength = 1.0;
#endif`,iE=`#ifdef USE_SPECULARMAP
	uniform sampler2D specularMap;
#endif`,nE=`#if defined( TONE_MAPPING )
	gl_FragColor.rgb = toneMapping( gl_FragColor.rgb );
#endif`,sE=`#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
uniform float toneMappingExposure;
vec3 LinearToneMapping( vec3 color ) {
	return toneMappingExposure * color;
}
vec3 ReinhardToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	return saturate( color / ( vec3( 1.0 ) + color ) );
}
vec3 OptimizedCineonToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	color = max( vec3( 0.0 ), color - 0.004 );
	return pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );
}
vec3 RRTAndODTFit( vec3 v ) {
	vec3 a = v * ( v + 0.0245786 ) - 0.000090537;
	vec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;
	return a / b;
}
vec3 ACESFilmicToneMapping( vec3 color ) {
	const mat3 ACESInputMat = mat3(
		vec3( 0.59719, 0.07600, 0.02840 ),		vec3( 0.35458, 0.90834, 0.13383 ),
		vec3( 0.04823, 0.01566, 0.83777 )
	);
	const mat3 ACESOutputMat = mat3(
		vec3(  1.60475, -0.10208, -0.00327 ),		vec3( -0.53108,  1.10813, -0.07276 ),
		vec3( -0.07367, -0.00605,  1.07602 )
	);
	color *= toneMappingExposure / 0.6;
	color = ACESInputMat * color;
	color = RRTAndODTFit( color );
	color = ACESOutputMat * color;
	return saturate( color );
}
vec3 CustomToneMapping( vec3 color ) { return color; }`,rE=`#ifdef USE_TRANSMISSION
	material.transmission = transmission;
	material.transmissionAlpha = 1.0;
	material.thickness = thickness;
	material.attenuationDistance = attenuationDistance;
	material.attenuationColor = attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		material.transmission *= texture2D( transmissionMap, vUv ).r;
	#endif
	#ifdef USE_THICKNESSMAP
		material.thickness *= texture2D( thicknessMap, vUv ).g;
	#endif
	vec3 pos = vWorldPosition;
	vec3 v = normalize( cameraPosition - pos );
	vec3 n = inverseTransformDirection( normal, viewMatrix );
	vec4 transmission = getIBLVolumeRefraction(
		n, v, material.roughness, material.diffuseColor, material.specularColor, material.specularF90,
		pos, modelMatrix, viewMatrix, projectionMatrix, material.ior, material.thickness,
		material.attenuationColor, material.attenuationDistance );
	material.transmissionAlpha = mix( material.transmissionAlpha, transmission.a, material.transmission );
	totalDiffuse = mix( totalDiffuse, transmission.rgb, material.transmission );
#endif`,oE=`#ifdef USE_TRANSMISSION
	uniform float transmission;
	uniform float thickness;
	uniform float attenuationDistance;
	uniform vec3 attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		uniform sampler2D transmissionMap;
	#endif
	#ifdef USE_THICKNESSMAP
		uniform sampler2D thicknessMap;
	#endif
	uniform vec2 transmissionSamplerSize;
	uniform sampler2D transmissionSamplerMap;
	uniform mat4 modelMatrix;
	uniform mat4 projectionMatrix;
	varying vec3 vWorldPosition;
	vec3 getVolumeTransmissionRay( const in vec3 n, const in vec3 v, const in float thickness, const in float ior, const in mat4 modelMatrix ) {
		vec3 refractionVector = refract( - v, normalize( n ), 1.0 / ior );
		vec3 modelScale;
		modelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );
		modelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );
		modelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );
		return normalize( refractionVector ) * thickness * modelScale;
	}
	float applyIorToRoughness( const in float roughness, const in float ior ) {
		return roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );
	}
	vec4 getTransmissionSample( const in vec2 fragCoord, const in float roughness, const in float ior ) {
		float framebufferLod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );
		#ifdef texture2DLodEXT
			return texture2DLodEXT( transmissionSamplerMap, fragCoord.xy, framebufferLod );
		#else
			return texture2D( transmissionSamplerMap, fragCoord.xy, framebufferLod );
		#endif
	}
	vec3 applyVolumeAttenuation( const in vec3 radiance, const in float transmissionDistance, const in vec3 attenuationColor, const in float attenuationDistance ) {
		if ( isinf( attenuationDistance ) ) {
			return radiance;
		} else {
			vec3 attenuationCoefficient = -log( attenuationColor ) / attenuationDistance;
			vec3 transmittance = exp( - attenuationCoefficient * transmissionDistance );			return transmittance * radiance;
		}
	}
	vec4 getIBLVolumeRefraction( const in vec3 n, const in vec3 v, const in float roughness, const in vec3 diffuseColor,
		const in vec3 specularColor, const in float specularF90, const in vec3 position, const in mat4 modelMatrix,
		const in mat4 viewMatrix, const in mat4 projMatrix, const in float ior, const in float thickness,
		const in vec3 attenuationColor, const in float attenuationDistance ) {
		vec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );
		vec3 refractedRayExit = position + transmissionRay;
		vec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );
		vec2 refractionCoords = ndcPos.xy / ndcPos.w;
		refractionCoords += 1.0;
		refractionCoords /= 2.0;
		vec4 transmittedLight = getTransmissionSample( refractionCoords, roughness, ior );
		vec3 attenuatedColor = applyVolumeAttenuation( transmittedLight.rgb, length( transmissionRay ), attenuationColor, attenuationDistance );
		vec3 F = EnvironmentBRDF( n, v, specularColor, specularF90, roughness );
		return vec4( ( 1.0 - F ) * attenuatedColor * diffuseColor, transmittedLight.a );
	}
#endif`,aE=`#if ( defined( USE_UV ) && ! defined( UVS_VERTEX_ONLY ) )
	varying vec2 vUv;
#endif`,lE=`#ifdef USE_UV
	#ifdef UVS_VERTEX_ONLY
		vec2 vUv;
	#else
		varying vec2 vUv;
	#endif
	uniform mat3 uvTransform;
#endif`,cE=`#ifdef USE_UV
	vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
#endif`,uE=`#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )
	varying vec2 vUv2;
#endif`,hE=`#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )
	attribute vec2 uv2;
	varying vec2 vUv2;
	uniform mat3 uv2Transform;
#endif`,dE=`#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )
	vUv2 = ( uv2Transform * vec3( uv2, 1 ) ).xy;
#endif`,pE=`#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP ) || defined ( USE_TRANSMISSION ) || NUM_SPOT_LIGHT_COORDS > 0
	vec4 worldPosition = vec4( transformed, 1.0 );
	#ifdef USE_INSTANCING
		worldPosition = instanceMatrix * worldPosition;
	#endif
	worldPosition = modelMatrix * worldPosition;
#endif`;const fE=`varying vec2 vUv;
uniform mat3 uvTransform;
void main() {
	vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	gl_Position = vec4( position.xy, 1.0, 1.0 );
}`,mE=`uniform sampler2D t2D;
uniform float backgroundIntensity;
varying vec2 vUv;
void main() {
	vec4 texColor = texture2D( t2D, vUv );
	#ifdef DECODE_VIDEO_TEXTURE
		texColor = vec4( mix( pow( texColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), texColor.rgb * 0.0773993808, vec3( lessThanEqual( texColor.rgb, vec3( 0.04045 ) ) ) ), texColor.w );
	#endif
	texColor.rgb *= backgroundIntensity;
	gl_FragColor = texColor;
	#include <tonemapping_fragment>
	#include <encodings_fragment>
}`,gE=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,_E=`#ifdef ENVMAP_TYPE_CUBE
	uniform samplerCube envMap;
#elif defined( ENVMAP_TYPE_CUBE_UV )
	uniform sampler2D envMap;
#endif
uniform float flipEnvMap;
uniform float backgroundBlurriness;
uniform float backgroundIntensity;
varying vec3 vWorldDirection;
#include <cube_uv_reflection_fragment>
void main() {
	#ifdef ENVMAP_TYPE_CUBE
		vec4 texColor = textureCube( envMap, vec3( flipEnvMap * vWorldDirection.x, vWorldDirection.yz ) );
	#elif defined( ENVMAP_TYPE_CUBE_UV )
		vec4 texColor = textureCubeUV( envMap, vWorldDirection, backgroundBlurriness );
	#else
		vec4 texColor = vec4( 0.0, 0.0, 0.0, 1.0 );
	#endif
	texColor.rgb *= backgroundIntensity;
	gl_FragColor = texColor;
	#include <tonemapping_fragment>
	#include <encodings_fragment>
}`,vE=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,bE=`uniform samplerCube tCube;
uniform float tFlip;
uniform float opacity;
varying vec3 vWorldDirection;
void main() {
	vec4 texColor = textureCube( tCube, vec3( tFlip * vWorldDirection.x, vWorldDirection.yz ) );
	gl_FragColor = texColor;
	gl_FragColor.a *= opacity;
	#include <tonemapping_fragment>
	#include <encodings_fragment>
}`,xE=`#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
varying vec2 vHighPrecisionZW;
void main() {
	#include <uv_vertex>
	#include <skinbase_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vHighPrecisionZW = gl_Position.zw;
}`,wE=`#if DEPTH_PACKING == 3200
	uniform float opacity;
#endif
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
varying vec2 vHighPrecisionZW;
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( 1.0 );
	#if DEPTH_PACKING == 3200
		diffuseColor.a = opacity;
	#endif
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <logdepthbuf_fragment>
	float fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;
	#if DEPTH_PACKING == 3200
		gl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );
	#elif DEPTH_PACKING == 3201
		gl_FragColor = packDepthToRGBA( fragCoordZ );
	#endif
}`,yE=`#define DISTANCE
varying vec3 vWorldPosition;
#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <skinbase_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <worldpos_vertex>
	#include <clipping_planes_vertex>
	vWorldPosition = worldPosition.xyz;
}`,SE=`#define DISTANCE
uniform vec3 referencePosition;
uniform float nearDistance;
uniform float farDistance;
varying vec3 vWorldPosition;
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <clipping_planes_pars_fragment>
void main () {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( 1.0 );
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	float dist = length( vWorldPosition - referencePosition );
	dist = ( dist - nearDistance ) / ( farDistance - nearDistance );
	dist = saturate( dist );
	gl_FragColor = packDepthToRGBA( dist );
}`,ME=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
}`,TE=`uniform sampler2D tEquirect;
varying vec3 vWorldDirection;
#include <common>
void main() {
	vec3 direction = normalize( vWorldDirection );
	vec2 sampleUV = equirectUv( direction );
	gl_FragColor = texture2D( tEquirect, sampleUV );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
}`,EE=`uniform float scale;
attribute float lineDistance;
varying float vLineDistance;
#include <common>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	vLineDistance = scale * lineDistance;
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,CE=`uniform vec3 diffuse;
uniform float opacity;
uniform float dashSize;
uniform float totalSize;
varying float vLineDistance;
#include <common>
#include <color_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	if ( mod( vLineDistance, totalSize ) > dashSize ) {
		discard;
	}
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <color_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,DE=`#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#if defined ( USE_ENVMAP ) || defined ( USE_SKINNING )
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinbase_vertex>
		#include <skinnormal_vertex>
		#include <defaultnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <fog_vertex>
}`,PE=`uniform vec3 diffuse;
uniform float opacity;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <specularmap_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vUv2 );
		reflectedLight.indirectDiffuse += lightMapTexel.rgb * lightMapIntensity * RECIPROCAL_PI;
	#else
		reflectedLight.indirectDiffuse += vec3( 1.0 );
	#endif
	#include <aomap_fragment>
	reflectedLight.indirectDiffuse *= diffuseColor.rgb;
	vec3 outgoingLight = reflectedLight.indirectDiffuse;
	#include <envmap_fragment>
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,AE=`#define LAMBERT
varying vec3 vViewPosition;
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,LE=`#define LAMBERT
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_lambert_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_lambert_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,RE=`#define MATCAP
varying vec3 vViewPosition;
#include <common>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <displacementmap_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
	vViewPosition = - mvPosition.xyz;
}`,kE=`#define MATCAP
uniform vec3 diffuse;
uniform float opacity;
uniform sampler2D matcap;
varying vec3 vViewPosition;
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <fog_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	vec3 viewDir = normalize( vViewPosition );
	vec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );
	vec3 y = cross( viewDir, x );
	vec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;
	#ifdef USE_MATCAP
		vec4 matcapColor = texture2D( matcap, uv );
	#else
		vec4 matcapColor = vec4( vec3( mix( 0.2, 0.8, uv.y ) ), 1.0 );
	#endif
	vec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,IE=`#define NORMAL
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )
	varying vec3 vViewPosition;
#endif
#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )
	vViewPosition = - mvPosition.xyz;
#endif
}`,FE=`#define NORMAL
uniform float opacity;
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )
	varying vec3 vViewPosition;
#endif
#include <packing>
#include <uv_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	gl_FragColor = vec4( packNormalToRGB( normal ), opacity );
	#ifdef OPAQUE
		gl_FragColor.a = 1.0;
	#endif
}`,OE=`#define PHONG
varying vec3 vViewPosition;
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,NE=`#define PHONG
uniform vec3 diffuse;
uniform vec3 emissive;
uniform vec3 specular;
uniform float shininess;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_phong_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_phong_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,BE=`#define STANDARD
varying vec3 vViewPosition;
#ifdef USE_TRANSMISSION
	varying vec3 vWorldPosition;
#endif
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
#ifdef USE_TRANSMISSION
	vWorldPosition = worldPosition.xyz;
#endif
}`,VE=`#define STANDARD
#ifdef PHYSICAL
	#define IOR
	#define SPECULAR
#endif
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float roughness;
uniform float metalness;
uniform float opacity;
#ifdef IOR
	uniform float ior;
#endif
#ifdef SPECULAR
	uniform float specularIntensity;
	uniform vec3 specularColor;
	#ifdef USE_SPECULARINTENSITYMAP
		uniform sampler2D specularIntensityMap;
	#endif
	#ifdef USE_SPECULARCOLORMAP
		uniform sampler2D specularColorMap;
	#endif
#endif
#ifdef USE_CLEARCOAT
	uniform float clearcoat;
	uniform float clearcoatRoughness;
#endif
#ifdef USE_IRIDESCENCE
	uniform float iridescence;
	uniform float iridescenceIOR;
	uniform float iridescenceThicknessMinimum;
	uniform float iridescenceThicknessMaximum;
#endif
#ifdef USE_SHEEN
	uniform vec3 sheenColor;
	uniform float sheenRoughness;
	#ifdef USE_SHEENCOLORMAP
		uniform sampler2D sheenColorMap;
	#endif
	#ifdef USE_SHEENROUGHNESSMAP
		uniform sampler2D sheenRoughnessMap;
	#endif
#endif
varying vec3 vViewPosition;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <bsdfs>
#include <iridescence_fragment>
#include <cube_uv_reflection_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_physical_pars_fragment>
#include <fog_pars_fragment>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_physical_pars_fragment>
#include <transmission_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <clearcoat_pars_fragment>
#include <iridescence_pars_fragment>
#include <roughnessmap_pars_fragment>
#include <metalnessmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <roughnessmap_fragment>
	#include <metalnessmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <clearcoat_normal_fragment_begin>
	#include <clearcoat_normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_physical_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;
	vec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;
	#include <transmission_fragment>
	vec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;
	#ifdef USE_SHEEN
		float sheenEnergyComp = 1.0 - 0.157 * max3( material.sheenColor );
		outgoingLight = outgoingLight * sheenEnergyComp + sheenSpecular;
	#endif
	#ifdef USE_CLEARCOAT
		float dotNVcc = saturate( dot( geometry.clearcoatNormal, geometry.viewDir ) );
		vec3 Fcc = F_Schlick( material.clearcoatF0, material.clearcoatF90, dotNVcc );
		outgoingLight = outgoingLight * ( 1.0 - material.clearcoat * Fcc ) + clearcoatSpecular * material.clearcoat;
	#endif
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,zE=`#define TOON
varying vec3 vViewPosition;
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,UE=`#define TOON
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <gradientmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_toon_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_toon_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,GE=`uniform float size;
uniform float scale;
#include <common>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	gl_PointSize = size;
	#ifdef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );
	#endif
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <fog_vertex>
}`,HE=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <color_pars_fragment>
#include <map_particle_pars_fragment>
#include <alphatest_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_particle_fragment>
	#include <color_fragment>
	#include <alphatest_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,WE=`#include <common>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
void main() {
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,jE=`uniform vec3 color;
uniform float opacity;
#include <common>
#include <packing>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <shadowmap_pars_fragment>
#include <shadowmask_pars_fragment>
void main() {
	gl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
}`,qE=`uniform float rotation;
uniform vec2 center;
#include <common>
#include <uv_pars_vertex>
#include <fog_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	vec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );
	vec2 scale;
	scale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );
	scale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );
	#ifndef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) scale *= - mvPosition.z;
	#endif
	vec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;
	vec2 rotatedPosition;
	rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;
	rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;
	mvPosition.xy += rotatedPosition;
	gl_Position = projectionMatrix * mvPosition;
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,XE=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
}`,Mt={alphamap_fragment:gM,alphamap_pars_fragment:_M,alphatest_fragment:vM,alphatest_pars_fragment:bM,aomap_fragment:xM,aomap_pars_fragment:wM,begin_vertex:yM,beginnormal_vertex:SM,bsdfs:MM,iridescence_fragment:TM,bumpmap_pars_fragment:EM,clipping_planes_fragment:CM,clipping_planes_pars_fragment:DM,clipping_planes_pars_vertex:PM,clipping_planes_vertex:AM,color_fragment:LM,color_pars_fragment:RM,color_pars_vertex:kM,color_vertex:IM,common:FM,cube_uv_reflection_fragment:OM,defaultnormal_vertex:NM,displacementmap_pars_vertex:BM,displacementmap_vertex:VM,emissivemap_fragment:zM,emissivemap_pars_fragment:UM,encodings_fragment:GM,encodings_pars_fragment:HM,envmap_fragment:WM,envmap_common_pars_fragment:jM,envmap_pars_fragment:qM,envmap_pars_vertex:XM,envmap_physical_pars_fragment:rT,envmap_vertex:$M,fog_vertex:YM,fog_pars_vertex:KM,fog_fragment:ZM,fog_pars_fragment:JM,gradientmap_pars_fragment:QM,lightmap_fragment:eT,lightmap_pars_fragment:tT,lights_lambert_fragment:iT,lights_lambert_pars_fragment:nT,lights_pars_begin:sT,lights_toon_fragment:oT,lights_toon_pars_fragment:aT,lights_phong_fragment:lT,lights_phong_pars_fragment:cT,lights_physical_fragment:uT,lights_physical_pars_fragment:hT,lights_fragment_begin:dT,lights_fragment_maps:pT,lights_fragment_end:fT,logdepthbuf_fragment:mT,logdepthbuf_pars_fragment:gT,logdepthbuf_pars_vertex:_T,logdepthbuf_vertex:vT,map_fragment:bT,map_pars_fragment:xT,map_particle_fragment:wT,map_particle_pars_fragment:yT,metalnessmap_fragment:ST,metalnessmap_pars_fragment:MT,morphcolor_vertex:TT,morphnormal_vertex:ET,morphtarget_pars_vertex:CT,morphtarget_vertex:DT,normal_fragment_begin:PT,normal_fragment_maps:AT,normal_pars_fragment:LT,normal_pars_vertex:RT,normal_vertex:kT,normalmap_pars_fragment:IT,clearcoat_normal_fragment_begin:FT,clearcoat_normal_fragment_maps:OT,clearcoat_pars_fragment:NT,iridescence_pars_fragment:BT,output_fragment:VT,packing:zT,premultiplied_alpha_fragment:UT,project_vertex:GT,dithering_fragment:HT,dithering_pars_fragment:WT,roughnessmap_fragment:jT,roughnessmap_pars_fragment:qT,shadowmap_pars_fragment:XT,shadowmap_pars_vertex:$T,shadowmap_vertex:YT,shadowmask_pars_fragment:KT,skinbase_vertex:ZT,skinning_pars_vertex:JT,skinning_vertex:QT,skinnormal_vertex:eE,specularmap_fragment:tE,specularmap_pars_fragment:iE,tonemapping_fragment:nE,tonemapping_pars_fragment:sE,transmission_fragment:rE,transmission_pars_fragment:oE,uv_pars_fragment:aE,uv_pars_vertex:lE,uv_vertex:cE,uv2_pars_fragment:uE,uv2_pars_vertex:hE,uv2_vertex:dE,worldpos_vertex:pE,background_vert:fE,background_frag:mE,backgroundCube_vert:gE,backgroundCube_frag:_E,cube_vert:vE,cube_frag:bE,depth_vert:xE,depth_frag:wE,distanceRGBA_vert:yE,distanceRGBA_frag:SE,equirect_vert:ME,equirect_frag:TE,linedashed_vert:EE,linedashed_frag:CE,meshbasic_vert:DE,meshbasic_frag:PE,meshlambert_vert:AE,meshlambert_frag:LE,meshmatcap_vert:RE,meshmatcap_frag:kE,meshnormal_vert:IE,meshnormal_frag:FE,meshphong_vert:OE,meshphong_frag:NE,meshphysical_vert:BE,meshphysical_frag:VE,meshtoon_vert:zE,meshtoon_frag:UE,points_vert:GE,points_frag:HE,shadow_vert:WE,shadow_frag:jE,sprite_vert:qE,sprite_frag:XE},Ve={common:{diffuse:{value:new pt(16777215)},opacity:{value:1},map:{value:null},uvTransform:{value:new Nn},uv2Transform:{value:new Nn},alphaMap:{value:null},alphaTest:{value:0}},specularmap:{specularMap:{value:null}},envmap:{envMap:{value:null},flipEnvMap:{value:-1},reflectivity:{value:1},ior:{value:1.5},refractionRatio:{value:.98}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1}},emissivemap:{emissiveMap:{value:null}},bumpmap:{bumpMap:{value:null},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalScale:{value:new Ue(1,1)}},displacementmap:{displacementMap:{value:null},displacementScale:{value:1},displacementBias:{value:0}},roughnessmap:{roughnessMap:{value:null}},metalnessmap:{metalnessMap:{value:null}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new pt(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotLightMap:{value:[]},spotShadowMap:{value:[]},spotLightMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new pt(16777215)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},alphaTest:{value:0},uvTransform:{value:new Nn}},sprite:{diffuse:{value:new pt(16777215)},opacity:{value:1},center:{value:new Ue(.5,.5)},rotation:{value:0},map:{value:null},alphaMap:{value:null},alphaTest:{value:0},uvTransform:{value:new Nn}}},Ps={basic:{uniforms:en([Ve.common,Ve.specularmap,Ve.envmap,Ve.aomap,Ve.lightmap,Ve.fog]),vertexShader:Mt.meshbasic_vert,fragmentShader:Mt.meshbasic_frag},lambert:{uniforms:en([Ve.common,Ve.specularmap,Ve.envmap,Ve.aomap,Ve.lightmap,Ve.emissivemap,Ve.bumpmap,Ve.normalmap,Ve.displacementmap,Ve.fog,Ve.lights,{emissive:{value:new pt(0)}}]),vertexShader:Mt.meshlambert_vert,fragmentShader:Mt.meshlambert_frag},phong:{uniforms:en([Ve.common,Ve.specularmap,Ve.envmap,Ve.aomap,Ve.lightmap,Ve.emissivemap,Ve.bumpmap,Ve.normalmap,Ve.displacementmap,Ve.fog,Ve.lights,{emissive:{value:new pt(0)},specular:{value:new pt(1118481)},shininess:{value:30}}]),vertexShader:Mt.meshphong_vert,fragmentShader:Mt.meshphong_frag},standard:{uniforms:en([Ve.common,Ve.envmap,Ve.aomap,Ve.lightmap,Ve.emissivemap,Ve.bumpmap,Ve.normalmap,Ve.displacementmap,Ve.roughnessmap,Ve.metalnessmap,Ve.fog,Ve.lights,{emissive:{value:new pt(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:Mt.meshphysical_vert,fragmentShader:Mt.meshphysical_frag},toon:{uniforms:en([Ve.common,Ve.aomap,Ve.lightmap,Ve.emissivemap,Ve.bumpmap,Ve.normalmap,Ve.displacementmap,Ve.gradientmap,Ve.fog,Ve.lights,{emissive:{value:new pt(0)}}]),vertexShader:Mt.meshtoon_vert,fragmentShader:Mt.meshtoon_frag},matcap:{uniforms:en([Ve.common,Ve.bumpmap,Ve.normalmap,Ve.displacementmap,Ve.fog,{matcap:{value:null}}]),vertexShader:Mt.meshmatcap_vert,fragmentShader:Mt.meshmatcap_frag},points:{uniforms:en([Ve.points,Ve.fog]),vertexShader:Mt.points_vert,fragmentShader:Mt.points_frag},dashed:{uniforms:en([Ve.common,Ve.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:Mt.linedashed_vert,fragmentShader:Mt.linedashed_frag},depth:{uniforms:en([Ve.common,Ve.displacementmap]),vertexShader:Mt.depth_vert,fragmentShader:Mt.depth_frag},normal:{uniforms:en([Ve.common,Ve.bumpmap,Ve.normalmap,Ve.displacementmap,{opacity:{value:1}}]),vertexShader:Mt.meshnormal_vert,fragmentShader:Mt.meshnormal_frag},sprite:{uniforms:en([Ve.sprite,Ve.fog]),vertexShader:Mt.sprite_vert,fragmentShader:Mt.sprite_frag},background:{uniforms:{uvTransform:{value:new Nn},t2D:{value:null},backgroundIntensity:{value:1}},vertexShader:Mt.background_vert,fragmentShader:Mt.background_frag},backgroundCube:{uniforms:{envMap:{value:null},flipEnvMap:{value:-1},backgroundBlurriness:{value:0},backgroundIntensity:{value:1}},vertexShader:Mt.backgroundCube_vert,fragmentShader:Mt.backgroundCube_frag},cube:{uniforms:{tCube:{value:null},tFlip:{value:-1},opacity:{value:1}},vertexShader:Mt.cube_vert,fragmentShader:Mt.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:Mt.equirect_vert,fragmentShader:Mt.equirect_frag},distanceRGBA:{uniforms:en([Ve.common,Ve.displacementmap,{referencePosition:{value:new Z},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:Mt.distanceRGBA_vert,fragmentShader:Mt.distanceRGBA_frag},shadow:{uniforms:en([Ve.lights,Ve.fog,{color:{value:new pt(0)},opacity:{value:1}}]),vertexShader:Mt.shadow_vert,fragmentShader:Mt.shadow_frag}};Ps.physical={uniforms:en([Ps.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatNormalScale:{value:new Ue(1,1)},clearcoatNormalMap:{value:null},iridescence:{value:0},iridescenceMap:{value:null},iridescenceIOR:{value:1.3},iridescenceThicknessMinimum:{value:100},iridescenceThicknessMaximum:{value:400},iridescenceThicknessMap:{value:null},sheen:{value:0},sheenColor:{value:new pt(0)},sheenColorMap:{value:null},sheenRoughness:{value:1},sheenRoughnessMap:{value:null},transmission:{value:0},transmissionMap:{value:null},transmissionSamplerSize:{value:new Ue},transmissionSamplerMap:{value:null},thickness:{value:0},thicknessMap:{value:null},attenuationDistance:{value:0},attenuationColor:{value:new pt(0)},specularIntensity:{value:1},specularIntensityMap:{value:null},specularColor:{value:new pt(1,1,1)},specularColorMap:{value:null}}]),vertexShader:Mt.meshphysical_vert,fragmentShader:Mt.meshphysical_frag};const oh={r:0,b:0,g:0};function $E(r,e,t,i,n,s,a){const o=new pt(0);let u=s===!0?0:1,h,f,c=null,d=0,m=null;function x(b,y){let M=!1,D=y.isScene===!0?y.background:null;D&&D.isTexture&&(D=(y.backgroundBlurriness>0?t:e).get(D));const C=r.xr,P=C.getSession&&C.getSession();P&&P.environmentBlendMode==="additive"&&(D=null),D===null?_(o,u):D&&D.isColor&&(_(D,1),M=!0),(r.autoClear||M)&&r.clear(r.autoClearColor,r.autoClearDepth,r.autoClearStencil),D&&(D.isCubeTexture||D.mapping===cd)?(f===void 0&&(f=new Wi(new cu(1,1,1),new fr({name:"BackgroundCubeMaterial",uniforms:ul(Ps.backgroundCube.uniforms),vertexShader:Ps.backgroundCube.vertexShader,fragmentShader:Ps.backgroundCube.fragmentShader,side:Vn,depthTest:!1,depthWrite:!1,fog:!1})),f.geometry.deleteAttribute("normal"),f.geometry.deleteAttribute("uv"),f.onBeforeRender=function(I,F,A){this.matrixWorld.copyPosition(A.matrixWorld)},Object.defineProperty(f.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),n.update(f)),f.material.uniforms.envMap.value=D,f.material.uniforms.flipEnvMap.value=D.isCubeTexture&&D.isRenderTargetTexture===!1?-1:1,f.material.uniforms.backgroundBlurriness.value=y.backgroundBlurriness,f.material.uniforms.backgroundIntensity.value=y.backgroundIntensity,f.material.toneMapped=D.encoding!==Gt,(c!==D||d!==D.version||m!==r.toneMapping)&&(f.material.needsUpdate=!0,c=D,d=D.version,m=r.toneMapping),f.layers.enableAll(),b.unshift(f,f.geometry,f.material,0,0,null)):D&&D.isTexture&&(h===void 0&&(h=new Wi(new uu(2,2),new fr({name:"BackgroundMaterial",uniforms:ul(Ps.background.uniforms),vertexShader:Ps.background.vertexShader,fragmentShader:Ps.background.fragmentShader,side:Ns,depthTest:!1,depthWrite:!1,fog:!1})),h.geometry.deleteAttribute("normal"),Object.defineProperty(h.material,"map",{get:function(){return this.uniforms.t2D.value}}),n.update(h)),h.material.uniforms.t2D.value=D,h.material.uniforms.backgroundIntensity.value=y.backgroundIntensity,h.material.toneMapped=D.encoding!==Gt,D.matrixAutoUpdate===!0&&D.updateMatrix(),h.material.uniforms.uvTransform.value.copy(D.matrix),(c!==D||d!==D.version||m!==r.toneMapping)&&(h.material.needsUpdate=!0,c=D,d=D.version,m=r.toneMapping),h.layers.enableAll(),b.unshift(h,h.geometry,h.material,0,0,null))}function _(b,y){b.getRGB(oh,mb(r)),i.buffers.color.setClear(oh.r,oh.g,oh.b,y,a)}return{getClearColor:function(){return o},setClearColor:function(b,y=1){o.set(b),u=y,_(o,u)},getClearAlpha:function(){return u},setClearAlpha:function(b){u=b,_(o,u)},render:x}}function YE(r,e,t,i){const n=r.getParameter(34921),s=i.isWebGL2?null:e.get("OES_vertex_array_object"),a=i.isWebGL2||s!==null,o={},u=b(null);let h=u,f=!1;function c(j,K,ie,ee,V){let _e=!1;if(a){const U=_(ee,ie,K);h!==U&&(h=U,m(h.object)),_e=y(j,ee,ie,V),_e&&M(j,ee,ie,V)}else{const U=K.wireframe===!0;(h.geometry!==ee.id||h.program!==ie.id||h.wireframe!==U)&&(h.geometry=ee.id,h.program=ie.id,h.wireframe=U,_e=!0)}V!==null&&t.update(V,34963),(_e||f)&&(f=!1,A(j,K,ie,ee),V!==null&&r.bindBuffer(34963,t.get(V).buffer))}function d(){return i.isWebGL2?r.createVertexArray():s.createVertexArrayOES()}function m(j){return i.isWebGL2?r.bindVertexArray(j):s.bindVertexArrayOES(j)}function x(j){return i.isWebGL2?r.deleteVertexArray(j):s.deleteVertexArrayOES(j)}function _(j,K,ie){const ee=ie.wireframe===!0;let V=o[j.id];V===void 0&&(V={},o[j.id]=V);let _e=V[K.id];_e===void 0&&(_e={},V[K.id]=_e);let U=_e[ee];return U===void 0&&(U=b(d()),_e[ee]=U),U}function b(j){const K=[],ie=[],ee=[];for(let V=0;V<n;V++)K[V]=0,ie[V]=0,ee[V]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:K,enabledAttributes:ie,attributeDivisors:ee,object:j,attributes:{},index:null}}function y(j,K,ie,ee){const V=h.attributes,_e=K.attributes;let U=0;const oe=ie.getAttributes();for(const ce in oe)if(oe[ce].location>=0){const le=V[ce];let be=_e[ce];if(be===void 0&&(ce==="instanceMatrix"&&j.instanceMatrix&&(be=j.instanceMatrix),ce==="instanceColor"&&j.instanceColor&&(be=j.instanceColor)),le===void 0||le.attribute!==be||be&&le.data!==be.data)return!0;U++}return h.attributesNum!==U||h.index!==ee}function M(j,K,ie,ee){const V={},_e=K.attributes;let U=0;const oe=ie.getAttributes();for(const ce in oe)if(oe[ce].location>=0){let le=_e[ce];le===void 0&&(ce==="instanceMatrix"&&j.instanceMatrix&&(le=j.instanceMatrix),ce==="instanceColor"&&j.instanceColor&&(le=j.instanceColor));const be={};be.attribute=le,le&&le.data&&(be.data=le.data),V[ce]=be,U++}h.attributes=V,h.attributesNum=U,h.index=ee}function D(){const j=h.newAttributes;for(let K=0,ie=j.length;K<ie;K++)j[K]=0}function C(j){P(j,0)}function P(j,K){const ie=h.newAttributes,ee=h.enabledAttributes,V=h.attributeDivisors;ie[j]=1,ee[j]===0&&(r.enableVertexAttribArray(j),ee[j]=1),V[j]!==K&&((i.isWebGL2?r:e.get("ANGLE_instanced_arrays"))[i.isWebGL2?"vertexAttribDivisor":"vertexAttribDivisorANGLE"](j,K),V[j]=K)}function I(){const j=h.newAttributes,K=h.enabledAttributes;for(let ie=0,ee=K.length;ie<ee;ie++)K[ie]!==j[ie]&&(r.disableVertexAttribArray(ie),K[ie]=0)}function F(j,K,ie,ee,V,_e){i.isWebGL2===!0&&(ie===5124||ie===5125)?r.vertexAttribIPointer(j,K,ie,V,_e):r.vertexAttribPointer(j,K,ie,ee,V,_e)}function A(j,K,ie,ee){if(i.isWebGL2===!1&&(j.isInstancedMesh||ee.isInstancedBufferGeometry)&&e.get("ANGLE_instanced_arrays")===null)return;D();const V=ee.attributes,_e=ie.getAttributes(),U=K.defaultAttributeValues;for(const oe in _e){const ce=_e[oe];if(ce.location>=0){let me=V[oe];if(me===void 0&&(oe==="instanceMatrix"&&j.instanceMatrix&&(me=j.instanceMatrix),oe==="instanceColor"&&j.instanceColor&&(me=j.instanceColor)),me!==void 0){const le=me.normalized,be=me.itemSize,ue=t.get(me);if(ue===void 0)continue;const We=ue.buffer,ye=ue.type,Ne=ue.bytesPerElement;if(me.isInterleavedBufferAttribute){const Ce=me.data,Ze=Ce.stride,Qe=me.offset;if(Ce.isInstancedInterleavedBuffer){for(let Pe=0;Pe<ce.locationSize;Pe++)P(ce.location+Pe,Ce.meshPerAttribute);j.isInstancedMesh!==!0&&ee._maxInstanceCount===void 0&&(ee._maxInstanceCount=Ce.meshPerAttribute*Ce.count)}else for(let Pe=0;Pe<ce.locationSize;Pe++)C(ce.location+Pe);r.bindBuffer(34962,We);for(let Pe=0;Pe<ce.locationSize;Pe++)F(ce.location+Pe,be/ce.locationSize,ye,le,Ze*Ne,(Qe+be/ce.locationSize*Pe)*Ne)}else{if(me.isInstancedBufferAttribute){for(let Ce=0;Ce<ce.locationSize;Ce++)P(ce.location+Ce,me.meshPerAttribute);j.isInstancedMesh!==!0&&ee._maxInstanceCount===void 0&&(ee._maxInstanceCount=me.meshPerAttribute*me.count)}else for(let Ce=0;Ce<ce.locationSize;Ce++)C(ce.location+Ce);r.bindBuffer(34962,We);for(let Ce=0;Ce<ce.locationSize;Ce++)F(ce.location+Ce,be/ce.locationSize,ye,le,be*Ne,be/ce.locationSize*Ce*Ne)}}else if(U!==void 0){const le=U[oe];if(le!==void 0)switch(le.length){case 2:r.vertexAttrib2fv(ce.location,le);break;case 3:r.vertexAttrib3fv(ce.location,le);break;case 4:r.vertexAttrib4fv(ce.location,le);break;default:r.vertexAttrib1fv(ce.location,le)}}}}I()}function k(){Q();for(const j in o){const K=o[j];for(const ie in K){const ee=K[ie];for(const V in ee)x(ee[V].object),delete ee[V];delete K[ie]}delete o[j]}}function O(j){if(o[j.id]===void 0)return;const K=o[j.id];for(const ie in K){const ee=K[ie];for(const V in ee)x(ee[V].object),delete ee[V];delete K[ie]}delete o[j.id]}function J(j){for(const K in o){const ie=o[K];if(ie[j.id]===void 0)continue;const ee=ie[j.id];for(const V in ee)x(ee[V].object),delete ee[V];delete ie[j.id]}}function Q(){X(),f=!0,h!==u&&(h=u,m(h.object))}function X(){u.geometry=null,u.program=null,u.wireframe=!1}return{setup:c,reset:Q,resetDefaultState:X,dispose:k,releaseStatesOfGeometry:O,releaseStatesOfProgram:J,initAttributes:D,enableAttribute:C,disableUnusedAttributes:I}}function KE(r,e,t,i){const n=i.isWebGL2;let s;function a(h){s=h}function o(h,f){r.drawArrays(s,h,f),t.update(f,s,1)}function u(h,f,c){if(c===0)return;let d,m;if(n)d=r,m="drawArraysInstanced";else if(d=e.get("ANGLE_instanced_arrays"),m="drawArraysInstancedANGLE",d===null){console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");return}d[m](s,h,f,c),t.update(f,s,c)}this.setMode=a,this.render=o,this.renderInstances=u}function ZE(r,e,t){let i;function n(){if(i!==void 0)return i;if(e.has("EXT_texture_filter_anisotropic")===!0){const F=e.get("EXT_texture_filter_anisotropic");i=r.getParameter(F.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else i=0;return i}function s(F){if(F==="highp"){if(r.getShaderPrecisionFormat(35633,36338).precision>0&&r.getShaderPrecisionFormat(35632,36338).precision>0)return"highp";F="mediump"}return F==="mediump"&&r.getShaderPrecisionFormat(35633,36337).precision>0&&r.getShaderPrecisionFormat(35632,36337).precision>0?"mediump":"lowp"}const a=typeof WebGL2RenderingContext<"u"&&r instanceof WebGL2RenderingContext||typeof WebGL2ComputeRenderingContext<"u"&&r instanceof WebGL2ComputeRenderingContext;let o=t.precision!==void 0?t.precision:"highp";const u=s(o);u!==o&&(console.warn("THREE.WebGLRenderer:",o,"not supported, using",u,"instead."),o=u);const h=a||e.has("WEBGL_draw_buffers"),f=t.logarithmicDepthBuffer===!0,c=r.getParameter(34930),d=r.getParameter(35660),m=r.getParameter(3379),x=r.getParameter(34076),_=r.getParameter(34921),b=r.getParameter(36347),y=r.getParameter(36348),M=r.getParameter(36349),D=d>0,C=a||e.has("OES_texture_float"),P=D&&C,I=a?r.getParameter(36183):0;return{isWebGL2:a,drawBuffers:h,getMaxAnisotropy:n,getMaxPrecision:s,precision:o,logarithmicDepthBuffer:f,maxTextures:c,maxVertexTextures:d,maxTextureSize:m,maxCubemapSize:x,maxAttributes:_,maxVertexUniforms:b,maxVaryings:y,maxFragmentUniforms:M,vertexTextures:D,floatFragmentTextures:C,floatVertexTextures:P,maxSamples:I}}function JE(r){const e=this;let t=null,i=0,n=!1,s=!1;const a=new So,o=new Nn,u={value:null,needsUpdate:!1};this.uniform=u,this.numPlanes=0,this.numIntersection=0,this.init=function(c,d,m){const x=c.length!==0||d||i!==0||n;return n=d,t=f(c,m,0),i=c.length,x},this.beginShadows=function(){s=!0,f(null)},this.endShadows=function(){s=!1,h()},this.setState=function(c,d,m){const x=c.clippingPlanes,_=c.clipIntersection,b=c.clipShadows,y=r.get(c);if(!n||x===null||x.length===0||s&&!b)s?f(null):h();else{const M=s?0:i,D=M*4;let C=y.clippingState||null;u.value=C,C=f(x,d,D,m);for(let P=0;P!==D;++P)C[P]=t[P];y.clippingState=C,this.numIntersection=_?this.numPlanes:0,this.numPlanes+=M}};function h(){u.value!==t&&(u.value=t,u.needsUpdate=i>0),e.numPlanes=i,e.numIntersection=0}function f(c,d,m,x){const _=c!==null?c.length:0;let b=null;if(_!==0){if(b=u.value,x!==!0||b===null){const y=m+_*4,M=d.matrixWorldInverse;o.getNormalMatrix(M),(b===null||b.length<y)&&(b=new Float32Array(y));for(let D=0,C=m;D!==_;++D,C+=4)a.copy(c[D]).applyMatrix4(M,o),a.normal.toArray(b,C),b[C+3]=a.constant}u.value=b,u.needsUpdate=!0}return e.numPlanes=_,e.numIntersection=0,b}}function QE(r){let e=new WeakMap;function t(a,o){return o===Mf?a.mapping=ol:o===Tf&&(a.mapping=al),a}function i(a){if(a&&a.isTexture&&a.isRenderTargetTexture===!1){const o=a.mapping;if(o===Mf||o===Tf)if(e.has(a)){const u=e.get(a).texture;return t(u,a.mapping)}else{const u=a.image;if(u&&u.height>0){const h=new dM(u.height/2);return h.fromEquirectangularTexture(r,a),e.set(a,h),a.addEventListener("dispose",n),t(h.texture,a.mapping)}else return null}}return a}function n(a){const o=a.target;o.removeEventListener("dispose",n);const u=e.get(o);u!==void 0&&(e.delete(o),u.dispose())}function s(){e=new WeakMap}return{get:i,dispose:s}}class wm extends bm{constructor(e=-1,t=1,i=1,n=-1,s=.1,a=2e3){super(),this.isOrthographicCamera=!0,this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=e,this.right=t,this.top=i,this.bottom=n,this.near=s,this.far=a,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.near=e.near,this.far=e.far,this.zoom=e.zoom,this.view=e.view===null?null:Object.assign({},e.view),this}setViewOffset(e,t,i,n,s,a){this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=i,this.view.offsetY=n,this.view.width=s,this.view.height=a,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=(this.right-this.left)/(2*this.zoom),t=(this.top-this.bottom)/(2*this.zoom),i=(this.right+this.left)/2,n=(this.top+this.bottom)/2;let s=i-e,a=i+e,o=n+t,u=n-t;if(this.view!==null&&this.view.enabled){const h=(this.right-this.left)/this.view.fullWidth/this.zoom,f=(this.top-this.bottom)/this.view.fullHeight/this.zoom;s+=h*this.view.offsetX,a=s+h*this.view.width,o-=f*this.view.offsetY,u=o-f*this.view.height}this.projectionMatrix.makeOrthographic(s,a,o,u,this.near,this.far),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const t=super.toJSON(e);return t.object.zoom=this.zoom,t.object.left=this.left,t.object.right=this.right,t.object.top=this.top,t.object.bottom=this.bottom,t.object.near=this.near,t.object.far=this.far,this.view!==null&&(t.object.view=Object.assign({},this.view)),t}}const qa=4,U_=[.125,.215,.35,.446,.526,.582],Do=20,Np=new wm,G_=new pt;let Bp=null;const Mo=(1+Math.sqrt(5))/2,Fa=1/Mo,H_=[new Z(1,1,1),new Z(-1,1,1),new Z(1,1,-1),new Z(-1,1,-1),new Z(0,Mo,Fa),new Z(0,Mo,-Fa),new Z(Fa,0,Mo),new Z(-Fa,0,Mo),new Z(Mo,Fa,0),new Z(-Mo,Fa,0)];class W_{constructor(e){this._renderer=e,this._pingPongRenderTarget=null,this._lodMax=0,this._cubeSize=0,this._lodPlanes=[],this._sizeLods=[],this._sigmas=[],this._blurMaterial=null,this._cubemapMaterial=null,this._equirectMaterial=null,this._compileMaterial(this._blurMaterial)}fromScene(e,t=0,i=.1,n=100){Bp=this._renderer.getRenderTarget(),this._setSize(256);const s=this._allocateTargets();return s.depthBuffer=!0,this._sceneToCubeUV(e,i,n,s),t>0&&this._blur(s,0,0,t),this._applyPMREM(s),this._cleanup(s),s}fromEquirectangular(e,t=null){return this._fromTexture(e,t)}fromCubemap(e,t=null){return this._fromTexture(e,t)}compileCubemapShader(){this._cubemapMaterial===null&&(this._cubemapMaterial=X_(),this._compileMaterial(this._cubemapMaterial))}compileEquirectangularShader(){this._equirectMaterial===null&&(this._equirectMaterial=q_(),this._compileMaterial(this._equirectMaterial))}dispose(){this._dispose(),this._cubemapMaterial!==null&&this._cubemapMaterial.dispose(),this._equirectMaterial!==null&&this._equirectMaterial.dispose()}_setSize(e){this._lodMax=Math.floor(Math.log2(e)),this._cubeSize=Math.pow(2,this._lodMax)}_dispose(){this._blurMaterial!==null&&this._blurMaterial.dispose(),this._pingPongRenderTarget!==null&&this._pingPongRenderTarget.dispose();for(let e=0;e<this._lodPlanes.length;e++)this._lodPlanes[e].dispose()}_cleanup(e){this._renderer.setRenderTarget(Bp),e.scissorTest=!1,ah(e,0,0,e.width,e.height)}_fromTexture(e,t){e.mapping===ol||e.mapping===al?this._setSize(e.image.length===0?16:e.image[0].width||e.image[0].image.width):this._setSize(e.image.width/4),Bp=this._renderer.getRenderTarget();const i=t||this._allocateTargets();return this._textureToCubeUV(e,i),this._applyPMREM(i),this._cleanup(i),i}_allocateTargets(){const e=3*Math.max(this._cubeSize,112),t=4*this._cubeSize,i={magFilter:Ui,minFilter:Ui,generateMipmaps:!1,type:Gc,format:es,encoding:pr,depthBuffer:!1},n=j_(e,t,i);if(this._pingPongRenderTarget===null||this._pingPongRenderTarget.width!==e){this._pingPongRenderTarget!==null&&this._dispose(),this._pingPongRenderTarget=j_(e,t,i);const{_lodMax:s}=this;({sizeLods:this._sizeLods,lodPlanes:this._lodPlanes,sigmas:this._sigmas}=eC(s)),this._blurMaterial=tC(s,e,t)}return n}_compileMaterial(e){const t=new Wi(this._lodPlanes[0],e);this._renderer.compile(t,Np)}_sceneToCubeUV(e,t,i,n){const o=new Gi(90,1,t,i),u=[1,-1,1,1,1,1],h=[1,1,1,-1,-1,-1],f=this._renderer,c=f.autoClear,d=f.toneMapping;f.getClearColor(G_),f.toneMapping=ur,f.autoClear=!1;const m=new ar({name:"PMREM.Background",side:Vn,depthWrite:!1,depthTest:!1}),x=new Wi(new cu,m);let _=!1;const b=e.background;b?b.isColor&&(m.color.copy(b),e.background=null,_=!0):(m.color.copy(G_),_=!0);for(let y=0;y<6;y++){const M=y%3;M===0?(o.up.set(0,u[y],0),o.lookAt(h[y],0,0)):M===1?(o.up.set(0,0,u[y]),o.lookAt(0,h[y],0)):(o.up.set(0,u[y],0),o.lookAt(0,0,h[y]));const D=this._cubeSize;ah(n,M*D,y>2?D:0,D,D),f.setRenderTarget(n),_&&f.render(x,o),f.render(e,o)}x.geometry.dispose(),x.material.dispose(),f.toneMapping=d,f.autoClear=c,e.background=b}_textureToCubeUV(e,t){const i=this._renderer,n=e.mapping===ol||e.mapping===al;n?(this._cubemapMaterial===null&&(this._cubemapMaterial=X_()),this._cubemapMaterial.uniforms.flipEnvMap.value=e.isRenderTargetTexture===!1?-1:1):this._equirectMaterial===null&&(this._equirectMaterial=q_());const s=n?this._cubemapMaterial:this._equirectMaterial,a=new Wi(this._lodPlanes[0],s),o=s.uniforms;o.envMap.value=e;const u=this._cubeSize;ah(t,0,0,3*u,2*u),i.setRenderTarget(t),i.render(a,Np)}_applyPMREM(e){const t=this._renderer,i=t.autoClear;t.autoClear=!1;for(let n=1;n<this._lodPlanes.length;n++){const s=Math.sqrt(this._sigmas[n]*this._sigmas[n]-this._sigmas[n-1]*this._sigmas[n-1]),a=H_[(n-1)%H_.length];this._blur(e,n-1,n,s,a)}t.autoClear=i}_blur(e,t,i,n,s){const a=this._pingPongRenderTarget;this._halfBlur(e,a,t,i,n,"latitudinal",s),this._halfBlur(a,e,i,i,n,"longitudinal",s)}_halfBlur(e,t,i,n,s,a,o){const u=this._renderer,h=this._blurMaterial;a!=="latitudinal"&&a!=="longitudinal"&&console.error("blur direction must be either latitudinal or longitudinal!");const f=3,c=new Wi(this._lodPlanes[n],h),d=h.uniforms,m=this._sizeLods[i]-1,x=isFinite(s)?Math.PI/(2*m):2*Math.PI/(2*Do-1),_=s/x,b=isFinite(s)?1+Math.floor(f*_):Do;b>Do&&console.warn(`sigmaRadians, ${s}, is too large and will clip, as it requested ${b} samples when the maximum is set to ${Do}`);const y=[];let M=0;for(let F=0;F<Do;++F){const A=F/_,k=Math.exp(-A*A/2);y.push(k),F===0?M+=k:F<b&&(M+=2*k)}for(let F=0;F<y.length;F++)y[F]=y[F]/M;d.envMap.value=e.texture,d.samples.value=b,d.weights.value=y,d.latitudinal.value=a==="latitudinal",o&&(d.poleAxis.value=o);const{_lodMax:D}=this;d.dTheta.value=x,d.mipInt.value=D-i;const C=this._sizeLods[n],P=3*C*(n>D-qa?n-D+qa:0),I=4*(this._cubeSize-C);ah(t,P,I,3*C,2*C),u.setRenderTarget(t),u.render(c,Np)}}function eC(r){const e=[],t=[],i=[];let n=r;const s=r-qa+1+U_.length;for(let a=0;a<s;a++){const o=Math.pow(2,n);t.push(o);let u=1/o;a>r-qa?u=U_[a-r+qa-1]:a===0&&(u=0),i.push(u);const h=1/(o-2),f=-h,c=1+h,d=[f,f,c,f,c,c,f,f,c,c,f,c],m=6,x=6,_=3,b=2,y=1,M=new Float32Array(_*x*m),D=new Float32Array(b*x*m),C=new Float32Array(y*x*m);for(let I=0;I<m;I++){const F=I%3*2/3-1,A=I>2?0:-1,k=[F,A,0,F+2/3,A,0,F+2/3,A+1,0,F,A,0,F+2/3,A+1,0,F,A+1,0];M.set(k,_*x*I),D.set(d,b*x*I);const O=[I,I,I,I,I,I];C.set(O,y*x*I)}const P=new un;P.setAttribute("position",new ln(M,_)),P.setAttribute("uv",new ln(D,b)),P.setAttribute("faceIndex",new ln(C,y)),e.push(P),n>qa&&n--}return{lodPlanes:e,sizeLods:t,sigmas:i}}function j_(r,e,t){const i=new Ko(r,e,t);return i.texture.mapping=cd,i.texture.name="PMREM.cubeUv",i.scissorTest=!0,i}function ah(r,e,t,i,n){r.viewport.set(e,t,i,n),r.scissor.set(e,t,i,n)}function tC(r,e,t){const i=new Float32Array(Do),n=new Z(0,1,0);return new fr({name:"SphericalGaussianBlur",defines:{n:Do,CUBEUV_TEXEL_WIDTH:1/e,CUBEUV_TEXEL_HEIGHT:1/t,CUBEUV_MAX_MIP:`${r}.0`},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:i},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:n}},vertexShader:ym(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;
			uniform int samples;
			uniform float weights[ n ];
			uniform bool latitudinal;
			uniform float dTheta;
			uniform float mipInt;
			uniform vec3 poleAxis;

			#define ENVMAP_TYPE_CUBE_UV
			#include <cube_uv_reflection_fragment>

			vec3 getSample( float theta, vec3 axis ) {

				float cosTheta = cos( theta );
				// Rodrigues' axis-angle rotation
				vec3 sampleDirection = vOutputDirection * cosTheta
					+ cross( axis, vOutputDirection ) * sin( theta )
					+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );

				return bilinearCubeUV( envMap, sampleDirection, mipInt );

			}

			void main() {

				vec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );

				if ( all( equal( axis, vec3( 0.0 ) ) ) ) {

					axis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );

				}

				axis = normalize( axis );

				gl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );
				gl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );

				for ( int i = 1; i < n; i++ ) {

					if ( i >= samples ) {

						break;

					}

					float theta = dTheta * float( i );
					gl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );
					gl_FragColor.rgb += weights[ i ] * getSample( theta, axis );

				}

			}
		`,blending:cr,depthTest:!1,depthWrite:!1})}function q_(){return new fr({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null}},vertexShader:ym(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;

			#include <common>

			void main() {

				vec3 outputDirection = normalize( vOutputDirection );
				vec2 uv = equirectUv( outputDirection );

				gl_FragColor = vec4( texture2D ( envMap, uv ).rgb, 1.0 );

			}
		`,blending:cr,depthTest:!1,depthWrite:!1})}function X_(){return new fr({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},flipEnvMap:{value:-1}},vertexShader:ym(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			uniform float flipEnvMap;

			varying vec3 vOutputDirection;

			uniform samplerCube envMap;

			void main() {

				gl_FragColor = textureCube( envMap, vec3( flipEnvMap * vOutputDirection.x, vOutputDirection.yz ) );

			}
		`,blending:cr,depthTest:!1,depthWrite:!1})}function ym(){return`

		precision mediump float;
		precision mediump int;

		attribute float faceIndex;

		varying vec3 vOutputDirection;

		// RH coordinate system; PMREM face-indexing convention
		vec3 getDirection( vec2 uv, float face ) {

			uv = 2.0 * uv - 1.0;

			vec3 direction = vec3( uv, 1.0 );

			if ( face == 0.0 ) {

				direction = direction.zyx; // ( 1, v, u ) pos x

			} else if ( face == 1.0 ) {

				direction = direction.xzy;
				direction.xz *= -1.0; // ( -u, 1, -v ) pos y

			} else if ( face == 2.0 ) {

				direction.x *= -1.0; // ( -u, v, 1 ) pos z

			} else if ( face == 3.0 ) {

				direction = direction.zyx;
				direction.xz *= -1.0; // ( -1, v, -u ) neg x

			} else if ( face == 4.0 ) {

				direction = direction.xzy;
				direction.xy *= -1.0; // ( -u, -1, v ) neg y

			} else if ( face == 5.0 ) {

				direction.z *= -1.0; // ( u, v, -1 ) neg z

			}

			return direction;

		}

		void main() {

			vOutputDirection = getDirection( uv, faceIndex );
			gl_Position = vec4( position, 1.0 );

		}
	`}function iC(r){let e=new WeakMap,t=null;function i(o){if(o&&o.isTexture){const u=o.mapping,h=u===Mf||u===Tf,f=u===ol||u===al;if(h||f)if(o.isRenderTargetTexture&&o.needsPMREMUpdate===!0){o.needsPMREMUpdate=!1;let c=e.get(o);return t===null&&(t=new W_(r)),c=h?t.fromEquirectangular(o,c):t.fromCubemap(o,c),e.set(o,c),c.texture}else{if(e.has(o))return e.get(o).texture;{const c=o.image;if(h&&c&&c.height>0||f&&c&&n(c)){t===null&&(t=new W_(r));const d=h?t.fromEquirectangular(o):t.fromCubemap(o);return e.set(o,d),o.addEventListener("dispose",s),d.texture}else return null}}}return o}function n(o){let u=0;const h=6;for(let f=0;f<h;f++)o[f]!==void 0&&u++;return u===h}function s(o){const u=o.target;u.removeEventListener("dispose",s);const h=e.get(u);h!==void 0&&(e.delete(u),h.dispose())}function a(){e=new WeakMap,t!==null&&(t.dispose(),t=null)}return{get:i,dispose:a}}function nC(r){const e={};function t(i){if(e[i]!==void 0)return e[i];let n;switch(i){case"WEBGL_depth_texture":n=r.getExtension("WEBGL_depth_texture")||r.getExtension("MOZ_WEBGL_depth_texture")||r.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":n=r.getExtension("EXT_texture_filter_anisotropic")||r.getExtension("MOZ_EXT_texture_filter_anisotropic")||r.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":n=r.getExtension("WEBGL_compressed_texture_s3tc")||r.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||r.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":n=r.getExtension("WEBGL_compressed_texture_pvrtc")||r.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:n=r.getExtension(i)}return e[i]=n,n}return{has:function(i){return t(i)!==null},init:function(i){i.isWebGL2?t("EXT_color_buffer_float"):(t("WEBGL_depth_texture"),t("OES_texture_float"),t("OES_texture_half_float"),t("OES_texture_half_float_linear"),t("OES_standard_derivatives"),t("OES_element_index_uint"),t("OES_vertex_array_object"),t("ANGLE_instanced_arrays")),t("OES_texture_float_linear"),t("EXT_color_buffer_half_float"),t("WEBGL_multisampled_render_to_texture")},get:function(i){const n=t(i);return n===null&&console.warn("THREE.WebGLRenderer: "+i+" extension not supported."),n}}}function sC(r,e,t,i){const n={},s=new WeakMap;function a(c){const d=c.target;d.index!==null&&e.remove(d.index);for(const x in d.attributes)e.remove(d.attributes[x]);d.removeEventListener("dispose",a),delete n[d.id];const m=s.get(d);m&&(e.remove(m),s.delete(d)),i.releaseStatesOfGeometry(d),d.isInstancedBufferGeometry===!0&&delete d._maxInstanceCount,t.memory.geometries--}function o(c,d){return n[d.id]===!0||(d.addEventListener("dispose",a),n[d.id]=!0,t.memory.geometries++),d}function u(c){const d=c.attributes;for(const x in d)e.update(d[x],34962);const m=c.morphAttributes;for(const x in m){const _=m[x];for(let b=0,y=_.length;b<y;b++)e.update(_[b],34962)}}function h(c){const d=[],m=c.index,x=c.attributes.position;let _=0;if(m!==null){const M=m.array;_=m.version;for(let D=0,C=M.length;D<C;D+=3){const P=M[D+0],I=M[D+1],F=M[D+2];d.push(P,I,I,F,F,P)}}else{const M=x.array;_=x.version;for(let D=0,C=M.length/3-1;D<C;D+=3){const P=D+0,I=D+1,F=D+2;d.push(P,I,I,F,F,P)}}const b=new(lb(d)?fb:pb)(d,1);b.version=_;const y=s.get(c);y&&e.remove(y),s.set(c,b)}function f(c){const d=s.get(c);if(d){const m=c.index;m!==null&&d.version<m.version&&h(c)}else h(c);return s.get(c)}return{get:o,update:u,getWireframeAttribute:f}}function rC(r,e,t,i){const n=i.isWebGL2;let s;function a(d){s=d}let o,u;function h(d){o=d.type,u=d.bytesPerElement}function f(d,m){r.drawElements(s,m,o,d*u),t.update(m,s,1)}function c(d,m,x){if(x===0)return;let _,b;if(n)_=r,b="drawElementsInstanced";else if(_=e.get("ANGLE_instanced_arrays"),b="drawElementsInstancedANGLE",_===null){console.error("THREE.WebGLIndexedBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");return}_[b](s,m,o,d*u,x),t.update(m,s,x)}this.setMode=a,this.setIndex=h,this.render=f,this.renderInstances=c}function oC(r){const e={geometries:0,textures:0},t={frame:0,calls:0,triangles:0,points:0,lines:0};function i(s,a,o){switch(t.calls++,a){case 4:t.triangles+=o*(s/3);break;case 1:t.lines+=o*(s/2);break;case 3:t.lines+=o*(s-1);break;case 2:t.lines+=o*s;break;case 0:t.points+=o*s;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",a);break}}function n(){t.frame++,t.calls=0,t.triangles=0,t.points=0,t.lines=0}return{memory:e,render:t,programs:null,autoReset:!0,reset:n,update:i}}function aC(r,e){return r[0]-e[0]}function lC(r,e){return Math.abs(e[1])-Math.abs(r[1])}function cC(r,e,t){const i={},n=new Float32Array(8),s=new WeakMap,a=new $t,o=[];for(let h=0;h<8;h++)o[h]=[h,0];function u(h,f,c,d){const m=h.morphTargetInfluences;if(e.isWebGL2===!0){const _=f.morphAttributes.position||f.morphAttributes.normal||f.morphAttributes.color,b=_!==void 0?_.length:0;let y=s.get(f);if(y===void 0||y.count!==b){let ie=function(){j.dispose(),s.delete(f),f.removeEventListener("dispose",ie)};var x=ie;y!==void 0&&y.texture.dispose();const C=f.morphAttributes.position!==void 0,P=f.morphAttributes.normal!==void 0,I=f.morphAttributes.color!==void 0,F=f.morphAttributes.position||[],A=f.morphAttributes.normal||[],k=f.morphAttributes.color||[];let O=0;C===!0&&(O=1),P===!0&&(O=2),I===!0&&(O=3);let J=f.attributes.position.count*O,Q=1;J>e.maxTextureSize&&(Q=Math.ceil(J/e.maxTextureSize),J=e.maxTextureSize);const X=new Float32Array(J*Q*4*b),j=new db(X,J,Q,b);j.type=zr,j.needsUpdate=!0;const K=O*4;for(let ee=0;ee<b;ee++){const V=F[ee],_e=A[ee],U=k[ee],oe=J*Q*4*ee;for(let ce=0;ce<V.count;ce++){const me=ce*K;C===!0&&(a.fromBufferAttribute(V,ce),X[oe+me+0]=a.x,X[oe+me+1]=a.y,X[oe+me+2]=a.z,X[oe+me+3]=0),P===!0&&(a.fromBufferAttribute(_e,ce),X[oe+me+4]=a.x,X[oe+me+5]=a.y,X[oe+me+6]=a.z,X[oe+me+7]=0),I===!0&&(a.fromBufferAttribute(U,ce),X[oe+me+8]=a.x,X[oe+me+9]=a.y,X[oe+me+10]=a.z,X[oe+me+11]=U.itemSize===4?a.w:1)}}y={count:b,texture:j,size:new Ue(J,Q)},s.set(f,y),f.addEventListener("dispose",ie)}let M=0;for(let C=0;C<m.length;C++)M+=m[C];const D=f.morphTargetsRelative?1:1-M;d.getUniforms().setValue(r,"morphTargetBaseInfluence",D),d.getUniforms().setValue(r,"morphTargetInfluences",m),d.getUniforms().setValue(r,"morphTargetsTexture",y.texture,t),d.getUniforms().setValue(r,"morphTargetsTextureSize",y.size)}else{const _=m===void 0?0:m.length;let b=i[f.id];if(b===void 0||b.length!==_){b=[];for(let P=0;P<_;P++)b[P]=[P,0];i[f.id]=b}for(let P=0;P<_;P++){const I=b[P];I[0]=P,I[1]=m[P]}b.sort(lC);for(let P=0;P<8;P++)P<_&&b[P][1]?(o[P][0]=b[P][0],o[P][1]=b[P][1]):(o[P][0]=Number.MAX_SAFE_INTEGER,o[P][1]=0);o.sort(aC);const y=f.morphAttributes.position,M=f.morphAttributes.normal;let D=0;for(let P=0;P<8;P++){const I=o[P],F=I[0],A=I[1];F!==Number.MAX_SAFE_INTEGER&&A?(y&&f.getAttribute("morphTarget"+P)!==y[F]&&f.setAttribute("morphTarget"+P,y[F]),M&&f.getAttribute("morphNormal"+P)!==M[F]&&f.setAttribute("morphNormal"+P,M[F]),n[P]=A,D+=A):(y&&f.hasAttribute("morphTarget"+P)===!0&&f.deleteAttribute("morphTarget"+P),M&&f.hasAttribute("morphNormal"+P)===!0&&f.deleteAttribute("morphNormal"+P),n[P]=0)}const C=f.morphTargetsRelative?1:1-D;d.getUniforms().setValue(r,"morphTargetBaseInfluence",C),d.getUniforms().setValue(r,"morphTargetInfluences",n)}}return{update:u}}function uC(r,e,t,i){let n=new WeakMap;function s(u){const h=i.render.frame,f=u.geometry,c=e.get(u,f);return n.get(c)!==h&&(e.update(c),n.set(c,h)),u.isInstancedMesh&&(u.hasEventListener("dispose",o)===!1&&u.addEventListener("dispose",o),t.update(u.instanceMatrix,34962),u.instanceColor!==null&&t.update(u.instanceColor,34962)),c}function a(){n=new WeakMap}function o(u){const h=u.target;h.removeEventListener("dispose",o),t.remove(h.instanceMatrix),h.instanceColor!==null&&t.remove(h.instanceColor)}return{update:s,dispose:a}}const vb=new vi,bb=new db,xb=new KS,wb=new gb,$_=[],Y_=[],K_=new Float32Array(16),Z_=new Float32Array(9),J_=new Float32Array(4);function Cl(r,e,t){const i=r[0];if(i<=0||i>0)return r;const n=e*t;let s=$_[n];if(s===void 0&&(s=new Float32Array(n),$_[n]=s),e!==0){i.toArray(s,0);for(let a=1,o=0;a!==e;++a)o+=t,r[a].toArray(s,o)}return s}function Si(r,e){if(r.length!==e.length)return!1;for(let t=0,i=r.length;t<i;t++)if(r[t]!==e[t])return!1;return!0}function Mi(r,e){for(let t=0,i=e.length;t<i;t++)r[t]=e[t]}function hd(r,e){let t=Y_[e];t===void 0&&(t=new Int32Array(e),Y_[e]=t);for(let i=0;i!==e;++i)t[i]=r.allocateTextureUnit();return t}function hC(r,e){const t=this.cache;t[0]!==e&&(r.uniform1f(this.addr,e),t[0]=e)}function dC(r,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y)&&(r.uniform2f(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(Si(t,e))return;r.uniform2fv(this.addr,e),Mi(t,e)}}function pC(r,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(r.uniform3f(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else if(e.r!==void 0)(t[0]!==e.r||t[1]!==e.g||t[2]!==e.b)&&(r.uniform3f(this.addr,e.r,e.g,e.b),t[0]=e.r,t[1]=e.g,t[2]=e.b);else{if(Si(t,e))return;r.uniform3fv(this.addr,e),Mi(t,e)}}function fC(r,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(r.uniform4f(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(Si(t,e))return;r.uniform4fv(this.addr,e),Mi(t,e)}}function mC(r,e){const t=this.cache,i=e.elements;if(i===void 0){if(Si(t,e))return;r.uniformMatrix2fv(this.addr,!1,e),Mi(t,e)}else{if(Si(t,i))return;J_.set(i),r.uniformMatrix2fv(this.addr,!1,J_),Mi(t,i)}}function gC(r,e){const t=this.cache,i=e.elements;if(i===void 0){if(Si(t,e))return;r.uniformMatrix3fv(this.addr,!1,e),Mi(t,e)}else{if(Si(t,i))return;Z_.set(i),r.uniformMatrix3fv(this.addr,!1,Z_),Mi(t,i)}}function _C(r,e){const t=this.cache,i=e.elements;if(i===void 0){if(Si(t,e))return;r.uniformMatrix4fv(this.addr,!1,e),Mi(t,e)}else{if(Si(t,i))return;K_.set(i),r.uniformMatrix4fv(this.addr,!1,K_),Mi(t,i)}}function vC(r,e){const t=this.cache;t[0]!==e&&(r.uniform1i(this.addr,e),t[0]=e)}function bC(r,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y)&&(r.uniform2i(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(Si(t,e))return;r.uniform2iv(this.addr,e),Mi(t,e)}}function xC(r,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(r.uniform3i(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else{if(Si(t,e))return;r.uniform3iv(this.addr,e),Mi(t,e)}}function wC(r,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(r.uniform4i(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(Si(t,e))return;r.uniform4iv(this.addr,e),Mi(t,e)}}function yC(r,e){const t=this.cache;t[0]!==e&&(r.uniform1ui(this.addr,e),t[0]=e)}function SC(r,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y)&&(r.uniform2ui(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(Si(t,e))return;r.uniform2uiv(this.addr,e),Mi(t,e)}}function MC(r,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(r.uniform3ui(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else{if(Si(t,e))return;r.uniform3uiv(this.addr,e),Mi(t,e)}}function TC(r,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(r.uniform4ui(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(Si(t,e))return;r.uniform4uiv(this.addr,e),Mi(t,e)}}function EC(r,e,t){const i=this.cache,n=t.allocateTextureUnit();i[0]!==n&&(r.uniform1i(this.addr,n),i[0]=n),t.setTexture2D(e||vb,n)}function CC(r,e,t){const i=this.cache,n=t.allocateTextureUnit();i[0]!==n&&(r.uniform1i(this.addr,n),i[0]=n),t.setTexture3D(e||xb,n)}function DC(r,e,t){const i=this.cache,n=t.allocateTextureUnit();i[0]!==n&&(r.uniform1i(this.addr,n),i[0]=n),t.setTextureCube(e||wb,n)}function PC(r,e,t){const i=this.cache,n=t.allocateTextureUnit();i[0]!==n&&(r.uniform1i(this.addr,n),i[0]=n),t.setTexture2DArray(e||bb,n)}function AC(r){switch(r){case 5126:return hC;case 35664:return dC;case 35665:return pC;case 35666:return fC;case 35674:return mC;case 35675:return gC;case 35676:return _C;case 5124:case 35670:return vC;case 35667:case 35671:return bC;case 35668:case 35672:return xC;case 35669:case 35673:return wC;case 5125:return yC;case 36294:return SC;case 36295:return MC;case 36296:return TC;case 35678:case 36198:case 36298:case 36306:case 35682:return EC;case 35679:case 36299:case 36307:return CC;case 35680:case 36300:case 36308:case 36293:return DC;case 36289:case 36303:case 36311:case 36292:return PC}}function LC(r,e){r.uniform1fv(this.addr,e)}function RC(r,e){const t=Cl(e,this.size,2);r.uniform2fv(this.addr,t)}function kC(r,e){const t=Cl(e,this.size,3);r.uniform3fv(this.addr,t)}function IC(r,e){const t=Cl(e,this.size,4);r.uniform4fv(this.addr,t)}function FC(r,e){const t=Cl(e,this.size,4);r.uniformMatrix2fv(this.addr,!1,t)}function OC(r,e){const t=Cl(e,this.size,9);r.uniformMatrix3fv(this.addr,!1,t)}function NC(r,e){const t=Cl(e,this.size,16);r.uniformMatrix4fv(this.addr,!1,t)}function BC(r,e){r.uniform1iv(this.addr,e)}function VC(r,e){r.uniform2iv(this.addr,e)}function zC(r,e){r.uniform3iv(this.addr,e)}function UC(r,e){r.uniform4iv(this.addr,e)}function GC(r,e){r.uniform1uiv(this.addr,e)}function HC(r,e){r.uniform2uiv(this.addr,e)}function WC(r,e){r.uniform3uiv(this.addr,e)}function jC(r,e){r.uniform4uiv(this.addr,e)}function qC(r,e,t){const i=this.cache,n=e.length,s=hd(t,n);Si(i,s)||(r.uniform1iv(this.addr,s),Mi(i,s));for(let a=0;a!==n;++a)t.setTexture2D(e[a]||vb,s[a])}function XC(r,e,t){const i=this.cache,n=e.length,s=hd(t,n);Si(i,s)||(r.uniform1iv(this.addr,s),Mi(i,s));for(let a=0;a!==n;++a)t.setTexture3D(e[a]||xb,s[a])}function $C(r,e,t){const i=this.cache,n=e.length,s=hd(t,n);Si(i,s)||(r.uniform1iv(this.addr,s),Mi(i,s));for(let a=0;a!==n;++a)t.setTextureCube(e[a]||wb,s[a])}function YC(r,e,t){const i=this.cache,n=e.length,s=hd(t,n);Si(i,s)||(r.uniform1iv(this.addr,s),Mi(i,s));for(let a=0;a!==n;++a)t.setTexture2DArray(e[a]||bb,s[a])}function KC(r){switch(r){case 5126:return LC;case 35664:return RC;case 35665:return kC;case 35666:return IC;case 35674:return FC;case 35675:return OC;case 35676:return NC;case 5124:case 35670:return BC;case 35667:case 35671:return VC;case 35668:case 35672:return zC;case 35669:case 35673:return UC;case 5125:return GC;case 36294:return HC;case 36295:return WC;case 36296:return jC;case 35678:case 36198:case 36298:case 36306:case 35682:return qC;case 35679:case 36299:case 36307:return XC;case 35680:case 36300:case 36308:case 36293:return $C;case 36289:case 36303:case 36311:case 36292:return YC}}class ZC{constructor(e,t,i){this.id=e,this.addr=i,this.cache=[],this.setValue=AC(t.type)}}class JC{constructor(e,t,i){this.id=e,this.addr=i,this.cache=[],this.size=t.size,this.setValue=KC(t.type)}}class QC{constructor(e){this.id=e,this.seq=[],this.map={}}setValue(e,t,i){const n=this.seq;for(let s=0,a=n.length;s!==a;++s){const o=n[s];o.setValue(e,t[o.id],i)}}}const Vp=/(\w+)(\])?(\[|\.)?/g;function Q_(r,e){r.seq.push(e),r.map[e.id]=e}function eD(r,e,t){const i=r.name,n=i.length;for(Vp.lastIndex=0;;){const s=Vp.exec(i),a=Vp.lastIndex;let o=s[1];const u=s[2]==="]",h=s[3];if(u&&(o=o|0),h===void 0||h==="["&&a+2===n){Q_(t,h===void 0?new ZC(o,r,e):new JC(o,r,e));break}else{let c=t.map[o];c===void 0&&(c=new QC(o),Q_(t,c)),t=c}}}class Fh{constructor(e,t){this.seq=[],this.map={};const i=e.getProgramParameter(t,35718);for(let n=0;n<i;++n){const s=e.getActiveUniform(t,n),a=e.getUniformLocation(t,s.name);eD(s,a,this)}}setValue(e,t,i,n){const s=this.map[t];s!==void 0&&s.setValue(e,i,n)}setOptional(e,t,i){const n=t[i];n!==void 0&&this.setValue(e,i,n)}static upload(e,t,i,n){for(let s=0,a=t.length;s!==a;++s){const o=t[s],u=i[o.id];u.needsUpdate!==!1&&o.setValue(e,u.value,n)}}static seqWithValue(e,t){const i=[];for(let n=0,s=e.length;n!==s;++n){const a=e[n];a.id in t&&i.push(a)}return i}}function ev(r,e,t){const i=r.createShader(e);return r.shaderSource(i,t),r.compileShader(i),i}let tD=0;function iD(r,e){const t=r.split(`
`),i=[],n=Math.max(e-6,0),s=Math.min(e+6,t.length);for(let a=n;a<s;a++){const o=a+1;i.push(`${o===e?">":" "} ${o}: ${t[a]}`)}return i.join(`
`)}function nD(r){switch(r){case pr:return["Linear","( value )"];case Gt:return["sRGB","( value )"];default:return console.warn("THREE.WebGLProgram: Unsupported encoding:",r),["Linear","( value )"]}}function tv(r,e,t){const i=r.getShaderParameter(e,35713),n=r.getShaderInfoLog(e).trim();if(i&&n==="")return"";const s=/ERROR: 0:(\d+)/.exec(n);if(s){const a=parseInt(s[1]);return t.toUpperCase()+`

`+n+`

`+iD(r.getShaderSource(e),a)}else return n}function sD(r,e){const t=nD(e);return"vec4 "+r+"( vec4 value ) { return LinearTo"+t[0]+t[1]+"; }"}function rD(r,e){let t;switch(e){case uS:t="Linear";break;case hS:t="Reinhard";break;case dS:t="OptimizedCineon";break;case pS:t="ACESFilmic";break;case fS:t="Custom";break;default:console.warn("THREE.WebGLProgram: Unsupported toneMapping:",e),t="Linear"}return"vec3 "+r+"( vec3 color ) { return "+t+"ToneMapping( color ); }"}function oD(r){return[r.extensionDerivatives||r.envMapCubeUVHeight||r.bumpMap||r.tangentSpaceNormalMap||r.clearcoatNormalMap||r.flatShading||r.shaderID==="physical"?"#extension GL_OES_standard_derivatives : enable":"",(r.extensionFragDepth||r.logarithmicDepthBuffer)&&r.rendererExtensionFragDepth?"#extension GL_EXT_frag_depth : enable":"",r.extensionDrawBuffers&&r.rendererExtensionDrawBuffers?"#extension GL_EXT_draw_buffers : require":"",(r.extensionShaderTextureLOD||r.envMap||r.transmission)&&r.rendererExtensionShaderTextureLod?"#extension GL_EXT_shader_texture_lod : enable":""].filter(_c).join(`
`)}function aD(r){const e=[];for(const t in r){const i=r[t];i!==!1&&e.push("#define "+t+" "+i)}return e.join(`
`)}function lD(r,e){const t={},i=r.getProgramParameter(e,35721);for(let n=0;n<i;n++){const s=r.getActiveAttrib(e,n),a=s.name;let o=1;s.type===35674&&(o=2),s.type===35675&&(o=3),s.type===35676&&(o=4),t[a]={type:s.type,location:r.getAttribLocation(e,a),locationSize:o}}return t}function _c(r){return r!==""}function iv(r,e){const t=e.numSpotLightShadows+e.numSpotLightMaps-e.numSpotLightShadowsWithMaps;return r.replace(/NUM_DIR_LIGHTS/g,e.numDirLights).replace(/NUM_SPOT_LIGHTS/g,e.numSpotLights).replace(/NUM_SPOT_LIGHT_MAPS/g,e.numSpotLightMaps).replace(/NUM_SPOT_LIGHT_COORDS/g,t).replace(/NUM_RECT_AREA_LIGHTS/g,e.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,e.numPointLights).replace(/NUM_HEMI_LIGHTS/g,e.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,e.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS/g,e.numSpotLightShadowsWithMaps).replace(/NUM_SPOT_LIGHT_SHADOWS/g,e.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,e.numPointLightShadows)}function nv(r,e){return r.replace(/NUM_CLIPPING_PLANES/g,e.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,e.numClippingPlanes-e.numClipIntersection)}const cD=/^[ \t]*#include +<([\w\d./]+)>/gm;function Af(r){return r.replace(cD,uD)}function uD(r,e){const t=Mt[e];if(t===void 0)throw new Error("Can not resolve #include <"+e+">");return Af(t)}const hD=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function sv(r){return r.replace(hD,dD)}function dD(r,e,t,i){let n="";for(let s=parseInt(e);s<parseInt(t);s++)n+=i.replace(/\[\s*i\s*\]/g,"[ "+s+" ]").replace(/UNROLLED_LOOP_INDEX/g,s);return n}function rv(r){let e="precision "+r.precision+` float;
precision `+r.precision+" int;";return r.precision==="highp"?e+=`
#define HIGH_PRECISION`:r.precision==="mediump"?e+=`
#define MEDIUM_PRECISION`:r.precision==="lowp"&&(e+=`
#define LOW_PRECISION`),e}function pD(r){let e="SHADOWMAP_TYPE_BASIC";return r.shadowMapType===Z0?e="SHADOWMAP_TYPE_PCF":r.shadowMapType===H1?e="SHADOWMAP_TYPE_PCF_SOFT":r.shadowMapType===gc&&(e="SHADOWMAP_TYPE_VSM"),e}function fD(r){let e="ENVMAP_TYPE_CUBE";if(r.envMap)switch(r.envMapMode){case ol:case al:e="ENVMAP_TYPE_CUBE";break;case cd:e="ENVMAP_TYPE_CUBE_UV";break}return e}function mD(r){let e="ENVMAP_MODE_REFLECTION";if(r.envMap)switch(r.envMapMode){case al:e="ENVMAP_MODE_REFRACTION";break}return e}function gD(r){let e="ENVMAP_BLENDING_NONE";if(r.envMap)switch(r.combine){case tb:e="ENVMAP_BLENDING_MULTIPLY";break;case lS:e="ENVMAP_BLENDING_MIX";break;case cS:e="ENVMAP_BLENDING_ADD";break}return e}function _D(r){const e=r.envMapCubeUVHeight;if(e===null)return null;const t=Math.log2(e)-2,i=1/e;return{texelWidth:1/(3*Math.max(Math.pow(2,t),7*16)),texelHeight:i,maxMip:t}}function vD(r,e,t,i){const n=r.getContext(),s=t.defines;let a=t.vertexShader,o=t.fragmentShader;const u=pD(t),h=fD(t),f=mD(t),c=gD(t),d=_D(t),m=t.isWebGL2?"":oD(t),x=aD(s),_=n.createProgram();let b,y,M=t.glslVersion?"#version "+t.glslVersion+`
`:"";t.isRawShaderMaterial?(b=[x].filter(_c).join(`
`),b.length>0&&(b+=`
`),y=[m,x].filter(_c).join(`
`),y.length>0&&(y+=`
`)):(b=[rv(t),"#define SHADER_NAME "+t.shaderName,x,t.instancing?"#define USE_INSTANCING":"",t.instancingColor?"#define USE_INSTANCING_COLOR":"",t.supportsVertexTextures?"#define VERTEX_TEXTURES":"",t.useFog&&t.fog?"#define USE_FOG":"",t.useFog&&t.fogExp2?"#define FOG_EXP2":"",t.map?"#define USE_MAP":"",t.envMap?"#define USE_ENVMAP":"",t.envMap?"#define "+f:"",t.lightMap?"#define USE_LIGHTMAP":"",t.aoMap?"#define USE_AOMAP":"",t.emissiveMap?"#define USE_EMISSIVEMAP":"",t.bumpMap?"#define USE_BUMPMAP":"",t.normalMap?"#define USE_NORMALMAP":"",t.normalMap&&t.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",t.normalMap&&t.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",t.clearcoatMap?"#define USE_CLEARCOATMAP":"",t.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",t.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",t.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",t.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",t.displacementMap&&t.supportsVertexTextures?"#define USE_DISPLACEMENTMAP":"",t.specularMap?"#define USE_SPECULARMAP":"",t.specularIntensityMap?"#define USE_SPECULARINTENSITYMAP":"",t.specularColorMap?"#define USE_SPECULARCOLORMAP":"",t.roughnessMap?"#define USE_ROUGHNESSMAP":"",t.metalnessMap?"#define USE_METALNESSMAP":"",t.alphaMap?"#define USE_ALPHAMAP":"",t.transmission?"#define USE_TRANSMISSION":"",t.transmissionMap?"#define USE_TRANSMISSIONMAP":"",t.thicknessMap?"#define USE_THICKNESSMAP":"",t.sheenColorMap?"#define USE_SHEENCOLORMAP":"",t.sheenRoughnessMap?"#define USE_SHEENROUGHNESSMAP":"",t.vertexTangents?"#define USE_TANGENT":"",t.vertexColors?"#define USE_COLOR":"",t.vertexAlphas?"#define USE_COLOR_ALPHA":"",t.vertexUvs?"#define USE_UV":"",t.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",t.flatShading?"#define FLAT_SHADED":"",t.skinning?"#define USE_SKINNING":"",t.morphTargets?"#define USE_MORPHTARGETS":"",t.morphNormals&&t.flatShading===!1?"#define USE_MORPHNORMALS":"",t.morphColors&&t.isWebGL2?"#define USE_MORPHCOLORS":"",t.morphTargetsCount>0&&t.isWebGL2?"#define MORPHTARGETS_TEXTURE":"",t.morphTargetsCount>0&&t.isWebGL2?"#define MORPHTARGETS_TEXTURE_STRIDE "+t.morphTextureStride:"",t.morphTargetsCount>0&&t.isWebGL2?"#define MORPHTARGETS_COUNT "+t.morphTargetsCount:"",t.doubleSided?"#define DOUBLE_SIDED":"",t.flipSided?"#define FLIP_SIDED":"",t.shadowMapEnabled?"#define USE_SHADOWMAP":"",t.shadowMapEnabled?"#define "+u:"",t.sizeAttenuation?"#define USE_SIZEATTENUATION":"",t.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",t.logarithmicDepthBuffer&&t.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","	attribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","	attribute vec3 instanceColor;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_TANGENT","	attribute vec4 tangent;","#endif","#if defined( USE_COLOR_ALPHA )","	attribute vec4 color;","#elif defined( USE_COLOR )","	attribute vec3 color;","#endif","#if ( defined( USE_MORPHTARGETS ) && ! defined( MORPHTARGETS_TEXTURE ) )","	attribute vec3 morphTarget0;","	attribute vec3 morphTarget1;","	attribute vec3 morphTarget2;","	attribute vec3 morphTarget3;","	#ifdef USE_MORPHNORMALS","		attribute vec3 morphNormal0;","		attribute vec3 morphNormal1;","		attribute vec3 morphNormal2;","		attribute vec3 morphNormal3;","	#else","		attribute vec3 morphTarget4;","		attribute vec3 morphTarget5;","		attribute vec3 morphTarget6;","		attribute vec3 morphTarget7;","	#endif","#endif","#ifdef USE_SKINNING","	attribute vec4 skinIndex;","	attribute vec4 skinWeight;","#endif",`
`].filter(_c).join(`
`),y=[m,rv(t),"#define SHADER_NAME "+t.shaderName,x,t.useFog&&t.fog?"#define USE_FOG":"",t.useFog&&t.fogExp2?"#define FOG_EXP2":"",t.map?"#define USE_MAP":"",t.matcap?"#define USE_MATCAP":"",t.envMap?"#define USE_ENVMAP":"",t.envMap?"#define "+h:"",t.envMap?"#define "+f:"",t.envMap?"#define "+c:"",d?"#define CUBEUV_TEXEL_WIDTH "+d.texelWidth:"",d?"#define CUBEUV_TEXEL_HEIGHT "+d.texelHeight:"",d?"#define CUBEUV_MAX_MIP "+d.maxMip+".0":"",t.lightMap?"#define USE_LIGHTMAP":"",t.aoMap?"#define USE_AOMAP":"",t.emissiveMap?"#define USE_EMISSIVEMAP":"",t.bumpMap?"#define USE_BUMPMAP":"",t.normalMap?"#define USE_NORMALMAP":"",t.normalMap&&t.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",t.normalMap&&t.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",t.clearcoat?"#define USE_CLEARCOAT":"",t.clearcoatMap?"#define USE_CLEARCOATMAP":"",t.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",t.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",t.iridescence?"#define USE_IRIDESCENCE":"",t.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",t.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",t.specularMap?"#define USE_SPECULARMAP":"",t.specularIntensityMap?"#define USE_SPECULARINTENSITYMAP":"",t.specularColorMap?"#define USE_SPECULARCOLORMAP":"",t.roughnessMap?"#define USE_ROUGHNESSMAP":"",t.metalnessMap?"#define USE_METALNESSMAP":"",t.alphaMap?"#define USE_ALPHAMAP":"",t.alphaTest?"#define USE_ALPHATEST":"",t.sheen?"#define USE_SHEEN":"",t.sheenColorMap?"#define USE_SHEENCOLORMAP":"",t.sheenRoughnessMap?"#define USE_SHEENROUGHNESSMAP":"",t.transmission?"#define USE_TRANSMISSION":"",t.transmissionMap?"#define USE_TRANSMISSIONMAP":"",t.thicknessMap?"#define USE_THICKNESSMAP":"",t.decodeVideoTexture?"#define DECODE_VIDEO_TEXTURE":"",t.vertexTangents?"#define USE_TANGENT":"",t.vertexColors||t.instancingColor?"#define USE_COLOR":"",t.vertexAlphas?"#define USE_COLOR_ALPHA":"",t.vertexUvs?"#define USE_UV":"",t.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",t.gradientMap?"#define USE_GRADIENTMAP":"",t.flatShading?"#define FLAT_SHADED":"",t.doubleSided?"#define DOUBLE_SIDED":"",t.flipSided?"#define FLIP_SIDED":"",t.shadowMapEnabled?"#define USE_SHADOWMAP":"",t.shadowMapEnabled?"#define "+u:"",t.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",t.physicallyCorrectLights?"#define PHYSICALLY_CORRECT_LIGHTS":"",t.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",t.logarithmicDepthBuffer&&t.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",t.toneMapping!==ur?"#define TONE_MAPPING":"",t.toneMapping!==ur?Mt.tonemapping_pars_fragment:"",t.toneMapping!==ur?rD("toneMapping",t.toneMapping):"",t.dithering?"#define DITHERING":"",t.opaque?"#define OPAQUE":"",Mt.encodings_pars_fragment,sD("linearToOutputTexel",t.outputEncoding),t.useDepthPacking?"#define DEPTH_PACKING "+t.depthPacking:"",`
`].filter(_c).join(`
`)),a=Af(a),a=iv(a,t),a=nv(a,t),o=Af(o),o=iv(o,t),o=nv(o,t),a=sv(a),o=sv(o),t.isWebGL2&&t.isRawShaderMaterial!==!0&&(M=`#version 300 es
`,b=["precision mediump sampler2DArray;","#define attribute in","#define varying out","#define texture2D texture"].join(`
`)+`
`+b,y=["#define varying in",t.glslVersion===P_?"":"layout(location = 0) out highp vec4 pc_fragColor;",t.glslVersion===P_?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join(`
`)+`
`+y);const D=M+b+a,C=M+y+o,P=ev(n,35633,D),I=ev(n,35632,C);if(n.attachShader(_,P),n.attachShader(_,I),t.index0AttributeName!==void 0?n.bindAttribLocation(_,0,t.index0AttributeName):t.morphTargets===!0&&n.bindAttribLocation(_,0,"position"),n.linkProgram(_),r.debug.checkShaderErrors){const k=n.getProgramInfoLog(_).trim(),O=n.getShaderInfoLog(P).trim(),J=n.getShaderInfoLog(I).trim();let Q=!0,X=!0;if(n.getProgramParameter(_,35714)===!1){Q=!1;const j=tv(n,P,"vertex"),K=tv(n,I,"fragment");console.error("THREE.WebGLProgram: Shader Error "+n.getError()+" - VALIDATE_STATUS "+n.getProgramParameter(_,35715)+`

Program Info Log: `+k+`
`+j+`
`+K)}else k!==""?console.warn("THREE.WebGLProgram: Program Info Log:",k):(O===""||J==="")&&(X=!1);X&&(this.diagnostics={runnable:Q,programLog:k,vertexShader:{log:O,prefix:b},fragmentShader:{log:J,prefix:y}})}n.deleteShader(P),n.deleteShader(I);let F;this.getUniforms=function(){return F===void 0&&(F=new Fh(n,_)),F};let A;return this.getAttributes=function(){return A===void 0&&(A=lD(n,_)),A},this.destroy=function(){i.releaseStatesOfProgram(this),n.deleteProgram(_),this.program=void 0},this.name=t.shaderName,this.id=tD++,this.cacheKey=e,this.usedTimes=1,this.program=_,this.vertexShader=P,this.fragmentShader=I,this}let bD=0;class xD{constructor(){this.shaderCache=new Map,this.materialCache=new Map}update(e){const t=e.vertexShader,i=e.fragmentShader,n=this._getShaderStage(t),s=this._getShaderStage(i),a=this._getShaderCacheForMaterial(e);return a.has(n)===!1&&(a.add(n),n.usedTimes++),a.has(s)===!1&&(a.add(s),s.usedTimes++),this}remove(e){const t=this.materialCache.get(e);for(const i of t)i.usedTimes--,i.usedTimes===0&&this.shaderCache.delete(i.code);return this.materialCache.delete(e),this}getVertexShaderID(e){return this._getShaderStage(e.vertexShader).id}getFragmentShaderID(e){return this._getShaderStage(e.fragmentShader).id}dispose(){this.shaderCache.clear(),this.materialCache.clear()}_getShaderCacheForMaterial(e){const t=this.materialCache;let i=t.get(e);return i===void 0&&(i=new Set,t.set(e,i)),i}_getShaderStage(e){const t=this.shaderCache;let i=t.get(e);return i===void 0&&(i=new wD(e),t.set(e,i)),i}}class wD{constructor(e){this.id=bD++,this.code=e,this.usedTimes=0}}function yD(r,e,t,i,n,s,a){const o=new vm,u=new xD,h=[],f=n.isWebGL2,c=n.logarithmicDepthBuffer,d=n.vertexTextures;let m=n.precision;const x={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"};function _(A,k,O,J,Q){const X=J.fog,j=Q.geometry,K=A.isMeshStandardMaterial?J.environment:null,ie=(A.isMeshStandardMaterial?t:e).get(A.envMap||K),ee=ie&&ie.mapping===cd?ie.image.height:null,V=x[A.type];A.precision!==null&&(m=n.getMaxPrecision(A.precision),m!==A.precision&&console.warn("THREE.WebGLProgram.getParameters:",A.precision,"not supported, using",m,"instead."));const _e=j.morphAttributes.position||j.morphAttributes.normal||j.morphAttributes.color,U=_e!==void 0?_e.length:0;let oe=0;j.morphAttributes.position!==void 0&&(oe=1),j.morphAttributes.normal!==void 0&&(oe=2),j.morphAttributes.color!==void 0&&(oe=3);let ce,me,le,be;if(V){const Ze=Ps[V];ce=Ze.vertexShader,me=Ze.fragmentShader}else ce=A.vertexShader,me=A.fragmentShader,u.update(A),le=u.getVertexShaderID(A),be=u.getFragmentShaderID(A);const ue=r.getRenderTarget(),We=A.alphaTest>0,ye=A.clearcoat>0,Ne=A.iridescence>0;return{isWebGL2:f,shaderID:V,shaderName:A.type,vertexShader:ce,fragmentShader:me,defines:A.defines,customVertexShaderID:le,customFragmentShaderID:be,isRawShaderMaterial:A.isRawShaderMaterial===!0,glslVersion:A.glslVersion,precision:m,instancing:Q.isInstancedMesh===!0,instancingColor:Q.isInstancedMesh===!0&&Q.instanceColor!==null,supportsVertexTextures:d,outputEncoding:ue===null?r.outputEncoding:ue.isXRRenderTarget===!0?ue.texture.encoding:pr,map:!!A.map,matcap:!!A.matcap,envMap:!!ie,envMapMode:ie&&ie.mapping,envMapCubeUVHeight:ee,lightMap:!!A.lightMap,aoMap:!!A.aoMap,emissiveMap:!!A.emissiveMap,bumpMap:!!A.bumpMap,normalMap:!!A.normalMap,objectSpaceNormalMap:A.normalMapType===IS,tangentSpaceNormalMap:A.normalMapType===ob,decodeVideoTexture:!!A.map&&A.map.isVideoTexture===!0&&A.map.encoding===Gt,clearcoat:ye,clearcoatMap:ye&&!!A.clearcoatMap,clearcoatRoughnessMap:ye&&!!A.clearcoatRoughnessMap,clearcoatNormalMap:ye&&!!A.clearcoatNormalMap,iridescence:Ne,iridescenceMap:Ne&&!!A.iridescenceMap,iridescenceThicknessMap:Ne&&!!A.iridescenceThicknessMap,displacementMap:!!A.displacementMap,roughnessMap:!!A.roughnessMap,metalnessMap:!!A.metalnessMap,specularMap:!!A.specularMap,specularIntensityMap:!!A.specularIntensityMap,specularColorMap:!!A.specularColorMap,opaque:A.transparent===!1&&A.blending===Fo,alphaMap:!!A.alphaMap,alphaTest:We,gradientMap:!!A.gradientMap,sheen:A.sheen>0,sheenColorMap:!!A.sheenColorMap,sheenRoughnessMap:!!A.sheenRoughnessMap,transmission:A.transmission>0,transmissionMap:!!A.transmissionMap,thicknessMap:!!A.thicknessMap,combine:A.combine,vertexTangents:!!A.normalMap&&!!j.attributes.tangent,vertexColors:A.vertexColors,vertexAlphas:A.vertexColors===!0&&!!j.attributes.color&&j.attributes.color.itemSize===4,vertexUvs:!!A.map||!!A.bumpMap||!!A.normalMap||!!A.specularMap||!!A.alphaMap||!!A.emissiveMap||!!A.roughnessMap||!!A.metalnessMap||!!A.clearcoatMap||!!A.clearcoatRoughnessMap||!!A.clearcoatNormalMap||!!A.iridescenceMap||!!A.iridescenceThicknessMap||!!A.displacementMap||!!A.transmissionMap||!!A.thicknessMap||!!A.specularIntensityMap||!!A.specularColorMap||!!A.sheenColorMap||!!A.sheenRoughnessMap,uvsVertexOnly:!(A.map||A.bumpMap||A.normalMap||A.specularMap||A.alphaMap||A.emissiveMap||A.roughnessMap||A.metalnessMap||A.clearcoatNormalMap||A.iridescenceMap||A.iridescenceThicknessMap||A.transmission>0||A.transmissionMap||A.thicknessMap||A.specularIntensityMap||A.specularColorMap||A.sheen>0||A.sheenColorMap||A.sheenRoughnessMap)&&!!A.displacementMap,fog:!!X,useFog:A.fog===!0,fogExp2:X&&X.isFogExp2,flatShading:!!A.flatShading,sizeAttenuation:A.sizeAttenuation,logarithmicDepthBuffer:c,skinning:Q.isSkinnedMesh===!0,morphTargets:j.morphAttributes.position!==void 0,morphNormals:j.morphAttributes.normal!==void 0,morphColors:j.morphAttributes.color!==void 0,morphTargetsCount:U,morphTextureStride:oe,numDirLights:k.directional.length,numPointLights:k.point.length,numSpotLights:k.spot.length,numSpotLightMaps:k.spotLightMap.length,numRectAreaLights:k.rectArea.length,numHemiLights:k.hemi.length,numDirLightShadows:k.directionalShadowMap.length,numPointLightShadows:k.pointShadowMap.length,numSpotLightShadows:k.spotShadowMap.length,numSpotLightShadowsWithMaps:k.numSpotLightShadowsWithMaps,numClippingPlanes:a.numPlanes,numClipIntersection:a.numIntersection,dithering:A.dithering,shadowMapEnabled:r.shadowMap.enabled&&O.length>0,shadowMapType:r.shadowMap.type,toneMapping:A.toneMapped?r.toneMapping:ur,physicallyCorrectLights:r.physicallyCorrectLights,premultipliedAlpha:A.premultipliedAlpha,doubleSided:A.side===lu,flipSided:A.side===Vn,useDepthPacking:!!A.depthPacking,depthPacking:A.depthPacking||0,index0AttributeName:A.index0AttributeName,extensionDerivatives:A.extensions&&A.extensions.derivatives,extensionFragDepth:A.extensions&&A.extensions.fragDepth,extensionDrawBuffers:A.extensions&&A.extensions.drawBuffers,extensionShaderTextureLOD:A.extensions&&A.extensions.shaderTextureLOD,rendererExtensionFragDepth:f||i.has("EXT_frag_depth"),rendererExtensionDrawBuffers:f||i.has("WEBGL_draw_buffers"),rendererExtensionShaderTextureLod:f||i.has("EXT_shader_texture_lod"),customProgramCacheKey:A.customProgramCacheKey()}}function b(A){const k=[];if(A.shaderID?k.push(A.shaderID):(k.push(A.customVertexShaderID),k.push(A.customFragmentShaderID)),A.defines!==void 0)for(const O in A.defines)k.push(O),k.push(A.defines[O]);return A.isRawShaderMaterial===!1&&(y(k,A),M(k,A),k.push(r.outputEncoding)),k.push(A.customProgramCacheKey),k.join()}function y(A,k){A.push(k.precision),A.push(k.outputEncoding),A.push(k.envMapMode),A.push(k.envMapCubeUVHeight),A.push(k.combine),A.push(k.vertexUvs),A.push(k.fogExp2),A.push(k.sizeAttenuation),A.push(k.morphTargetsCount),A.push(k.morphAttributeCount),A.push(k.numDirLights),A.push(k.numPointLights),A.push(k.numSpotLights),A.push(k.numSpotLightMaps),A.push(k.numHemiLights),A.push(k.numRectAreaLights),A.push(k.numDirLightShadows),A.push(k.numPointLightShadows),A.push(k.numSpotLightShadows),A.push(k.numSpotLightShadowsWithMaps),A.push(k.shadowMapType),A.push(k.toneMapping),A.push(k.numClippingPlanes),A.push(k.numClipIntersection),A.push(k.depthPacking)}function M(A,k){o.disableAll(),k.isWebGL2&&o.enable(0),k.supportsVertexTextures&&o.enable(1),k.instancing&&o.enable(2),k.instancingColor&&o.enable(3),k.map&&o.enable(4),k.matcap&&o.enable(5),k.envMap&&o.enable(6),k.lightMap&&o.enable(7),k.aoMap&&o.enable(8),k.emissiveMap&&o.enable(9),k.bumpMap&&o.enable(10),k.normalMap&&o.enable(11),k.objectSpaceNormalMap&&o.enable(12),k.tangentSpaceNormalMap&&o.enable(13),k.clearcoat&&o.enable(14),k.clearcoatMap&&o.enable(15),k.clearcoatRoughnessMap&&o.enable(16),k.clearcoatNormalMap&&o.enable(17),k.iridescence&&o.enable(18),k.iridescenceMap&&o.enable(19),k.iridescenceThicknessMap&&o.enable(20),k.displacementMap&&o.enable(21),k.specularMap&&o.enable(22),k.roughnessMap&&o.enable(23),k.metalnessMap&&o.enable(24),k.gradientMap&&o.enable(25),k.alphaMap&&o.enable(26),k.alphaTest&&o.enable(27),k.vertexColors&&o.enable(28),k.vertexAlphas&&o.enable(29),k.vertexUvs&&o.enable(30),k.vertexTangents&&o.enable(31),k.uvsVertexOnly&&o.enable(32),A.push(o.mask),o.disableAll(),k.fog&&o.enable(0),k.useFog&&o.enable(1),k.flatShading&&o.enable(2),k.logarithmicDepthBuffer&&o.enable(3),k.skinning&&o.enable(4),k.morphTargets&&o.enable(5),k.morphNormals&&o.enable(6),k.morphColors&&o.enable(7),k.premultipliedAlpha&&o.enable(8),k.shadowMapEnabled&&o.enable(9),k.physicallyCorrectLights&&o.enable(10),k.doubleSided&&o.enable(11),k.flipSided&&o.enable(12),k.useDepthPacking&&o.enable(13),k.dithering&&o.enable(14),k.specularIntensityMap&&o.enable(15),k.specularColorMap&&o.enable(16),k.transmission&&o.enable(17),k.transmissionMap&&o.enable(18),k.thicknessMap&&o.enable(19),k.sheen&&o.enable(20),k.sheenColorMap&&o.enable(21),k.sheenRoughnessMap&&o.enable(22),k.decodeVideoTexture&&o.enable(23),k.opaque&&o.enable(24),A.push(o.mask)}function D(A){const k=x[A.type];let O;if(k){const J=Ps[k];O=lM.clone(J.uniforms)}else O=A.uniforms;return O}function C(A,k){let O;for(let J=0,Q=h.length;J<Q;J++){const X=h[J];if(X.cacheKey===k){O=X,++O.usedTimes;break}}return O===void 0&&(O=new vD(r,k,A,s),h.push(O)),O}function P(A){if(--A.usedTimes===0){const k=h.indexOf(A);h[k]=h[h.length-1],h.pop(),A.destroy()}}function I(A){u.remove(A)}function F(){u.dispose()}return{getParameters:_,getProgramCacheKey:b,getUniforms:D,acquireProgram:C,releaseProgram:P,releaseShaderCache:I,programs:h,dispose:F}}function SD(){let r=new WeakMap;function e(s){let a=r.get(s);return a===void 0&&(a={},r.set(s,a)),a}function t(s){r.delete(s)}function i(s,a,o){r.get(s)[a]=o}function n(){r=new WeakMap}return{get:e,remove:t,update:i,dispose:n}}function MD(r,e){return r.groupOrder!==e.groupOrder?r.groupOrder-e.groupOrder:r.renderOrder!==e.renderOrder?r.renderOrder-e.renderOrder:r.material.id!==e.material.id?r.material.id-e.material.id:r.z!==e.z?r.z-e.z:r.id-e.id}function ov(r,e){return r.groupOrder!==e.groupOrder?r.groupOrder-e.groupOrder:r.renderOrder!==e.renderOrder?r.renderOrder-e.renderOrder:r.z!==e.z?e.z-r.z:r.id-e.id}function av(){const r=[];let e=0;const t=[],i=[],n=[];function s(){e=0,t.length=0,i.length=0,n.length=0}function a(c,d,m,x,_,b){let y=r[e];return y===void 0?(y={id:c.id,object:c,geometry:d,material:m,groupOrder:x,renderOrder:c.renderOrder,z:_,group:b},r[e]=y):(y.id=c.id,y.object=c,y.geometry=d,y.material=m,y.groupOrder=x,y.renderOrder=c.renderOrder,y.z=_,y.group=b),e++,y}function o(c,d,m,x,_,b){const y=a(c,d,m,x,_,b);m.transmission>0?i.push(y):m.transparent===!0?n.push(y):t.push(y)}function u(c,d,m,x,_,b){const y=a(c,d,m,x,_,b);m.transmission>0?i.unshift(y):m.transparent===!0?n.unshift(y):t.unshift(y)}function h(c,d){t.length>1&&t.sort(c||MD),i.length>1&&i.sort(d||ov),n.length>1&&n.sort(d||ov)}function f(){for(let c=e,d=r.length;c<d;c++){const m=r[c];if(m.id===null)break;m.id=null,m.object=null,m.geometry=null,m.material=null,m.group=null}}return{opaque:t,transmissive:i,transparent:n,init:s,push:o,unshift:u,finish:f,sort:h}}function TD(){let r=new WeakMap;function e(i,n){const s=r.get(i);let a;return s===void 0?(a=new av,r.set(i,[a])):n>=s.length?(a=new av,s.push(a)):a=s[n],a}function t(){r=new WeakMap}return{get:e,dispose:t}}function ED(){const r={};return{get:function(e){if(r[e.id]!==void 0)return r[e.id];let t;switch(e.type){case"DirectionalLight":t={direction:new Z,color:new pt};break;case"SpotLight":t={position:new Z,direction:new Z,color:new pt,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":t={position:new Z,color:new pt,distance:0,decay:0};break;case"HemisphereLight":t={direction:new Z,skyColor:new pt,groundColor:new pt};break;case"RectAreaLight":t={color:new pt,position:new Z,halfWidth:new Z,halfHeight:new Z};break}return r[e.id]=t,t}}}function CD(){const r={};return{get:function(e){if(r[e.id]!==void 0)return r[e.id];let t;switch(e.type){case"DirectionalLight":t={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Ue};break;case"SpotLight":t={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Ue};break;case"PointLight":t={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Ue,shadowCameraNear:1,shadowCameraFar:1e3};break}return r[e.id]=t,t}}}let DD=0;function PD(r,e){return(e.castShadow?2:0)-(r.castShadow?2:0)+(e.map?1:0)-(r.map?1:0)}function AD(r,e){const t=new ED,i=CD(),n={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1,numSpotMaps:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotLightMap:[],spotShadow:[],spotShadowMap:[],spotLightMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[],numSpotLightShadowsWithMaps:0};for(let f=0;f<9;f++)n.probe.push(new Z);const s=new Z,a=new Pt,o=new Pt;function u(f,c){let d=0,m=0,x=0;for(let J=0;J<9;J++)n.probe[J].set(0,0,0);let _=0,b=0,y=0,M=0,D=0,C=0,P=0,I=0,F=0,A=0;f.sort(PD);const k=c!==!0?Math.PI:1;for(let J=0,Q=f.length;J<Q;J++){const X=f[J],j=X.color,K=X.intensity,ie=X.distance,ee=X.shadow&&X.shadow.map?X.shadow.map.texture:null;if(X.isAmbientLight)d+=j.r*K*k,m+=j.g*K*k,x+=j.b*K*k;else if(X.isLightProbe)for(let V=0;V<9;V++)n.probe[V].addScaledVector(X.sh.coefficients[V],K);else if(X.isDirectionalLight){const V=t.get(X);if(V.color.copy(X.color).multiplyScalar(X.intensity*k),X.castShadow){const _e=X.shadow,U=i.get(X);U.shadowBias=_e.bias,U.shadowNormalBias=_e.normalBias,U.shadowRadius=_e.radius,U.shadowMapSize=_e.mapSize,n.directionalShadow[_]=U,n.directionalShadowMap[_]=ee,n.directionalShadowMatrix[_]=X.shadow.matrix,C++}n.directional[_]=V,_++}else if(X.isSpotLight){const V=t.get(X);V.position.setFromMatrixPosition(X.matrixWorld),V.color.copy(j).multiplyScalar(K*k),V.distance=ie,V.coneCos=Math.cos(X.angle),V.penumbraCos=Math.cos(X.angle*(1-X.penumbra)),V.decay=X.decay,n.spot[y]=V;const _e=X.shadow;if(X.map&&(n.spotLightMap[F]=X.map,F++,_e.updateMatrices(X),X.castShadow&&A++),n.spotLightMatrix[y]=_e.matrix,X.castShadow){const U=i.get(X);U.shadowBias=_e.bias,U.shadowNormalBias=_e.normalBias,U.shadowRadius=_e.radius,U.shadowMapSize=_e.mapSize,n.spotShadow[y]=U,n.spotShadowMap[y]=ee,I++}y++}else if(X.isRectAreaLight){const V=t.get(X);V.color.copy(j).multiplyScalar(K),V.halfWidth.set(X.width*.5,0,0),V.halfHeight.set(0,X.height*.5,0),n.rectArea[M]=V,M++}else if(X.isPointLight){const V=t.get(X);if(V.color.copy(X.color).multiplyScalar(X.intensity*k),V.distance=X.distance,V.decay=X.decay,X.castShadow){const _e=X.shadow,U=i.get(X);U.shadowBias=_e.bias,U.shadowNormalBias=_e.normalBias,U.shadowRadius=_e.radius,U.shadowMapSize=_e.mapSize,U.shadowCameraNear=_e.camera.near,U.shadowCameraFar=_e.camera.far,n.pointShadow[b]=U,n.pointShadowMap[b]=ee,n.pointShadowMatrix[b]=X.shadow.matrix,P++}n.point[b]=V,b++}else if(X.isHemisphereLight){const V=t.get(X);V.skyColor.copy(X.color).multiplyScalar(K*k),V.groundColor.copy(X.groundColor).multiplyScalar(K*k),n.hemi[D]=V,D++}}M>0&&(e.isWebGL2||r.has("OES_texture_float_linear")===!0?(n.rectAreaLTC1=Ve.LTC_FLOAT_1,n.rectAreaLTC2=Ve.LTC_FLOAT_2):r.has("OES_texture_half_float_linear")===!0?(n.rectAreaLTC1=Ve.LTC_HALF_1,n.rectAreaLTC2=Ve.LTC_HALF_2):console.error("THREE.WebGLRenderer: Unable to use RectAreaLight. Missing WebGL extensions.")),n.ambient[0]=d,n.ambient[1]=m,n.ambient[2]=x;const O=n.hash;(O.directionalLength!==_||O.pointLength!==b||O.spotLength!==y||O.rectAreaLength!==M||O.hemiLength!==D||O.numDirectionalShadows!==C||O.numPointShadows!==P||O.numSpotShadows!==I||O.numSpotMaps!==F)&&(n.directional.length=_,n.spot.length=y,n.rectArea.length=M,n.point.length=b,n.hemi.length=D,n.directionalShadow.length=C,n.directionalShadowMap.length=C,n.pointShadow.length=P,n.pointShadowMap.length=P,n.spotShadow.length=I,n.spotShadowMap.length=I,n.directionalShadowMatrix.length=C,n.pointShadowMatrix.length=P,n.spotLightMatrix.length=I+F-A,n.spotLightMap.length=F,n.numSpotLightShadowsWithMaps=A,O.directionalLength=_,O.pointLength=b,O.spotLength=y,O.rectAreaLength=M,O.hemiLength=D,O.numDirectionalShadows=C,O.numPointShadows=P,O.numSpotShadows=I,O.numSpotMaps=F,n.version=DD++)}function h(f,c){let d=0,m=0,x=0,_=0,b=0;const y=c.matrixWorldInverse;for(let M=0,D=f.length;M<D;M++){const C=f[M];if(C.isDirectionalLight){const P=n.directional[d];P.direction.setFromMatrixPosition(C.matrixWorld),s.setFromMatrixPosition(C.target.matrixWorld),P.direction.sub(s),P.direction.transformDirection(y),d++}else if(C.isSpotLight){const P=n.spot[x];P.position.setFromMatrixPosition(C.matrixWorld),P.position.applyMatrix4(y),P.direction.setFromMatrixPosition(C.matrixWorld),s.setFromMatrixPosition(C.target.matrixWorld),P.direction.sub(s),P.direction.transformDirection(y),x++}else if(C.isRectAreaLight){const P=n.rectArea[_];P.position.setFromMatrixPosition(C.matrixWorld),P.position.applyMatrix4(y),o.identity(),a.copy(C.matrixWorld),a.premultiply(y),o.extractRotation(a),P.halfWidth.set(C.width*.5,0,0),P.halfHeight.set(0,C.height*.5,0),P.halfWidth.applyMatrix4(o),P.halfHeight.applyMatrix4(o),_++}else if(C.isPointLight){const P=n.point[m];P.position.setFromMatrixPosition(C.matrixWorld),P.position.applyMatrix4(y),m++}else if(C.isHemisphereLight){const P=n.hemi[b];P.direction.setFromMatrixPosition(C.matrixWorld),P.direction.transformDirection(y),b++}}}return{setup:u,setupView:h,state:n}}function lv(r,e){const t=new AD(r,e),i=[],n=[];function s(){i.length=0,n.length=0}function a(c){i.push(c)}function o(c){n.push(c)}function u(c){t.setup(i,c)}function h(c){t.setupView(i,c)}return{init:s,state:{lightsArray:i,shadowsArray:n,lights:t},setupLights:u,setupLightsView:h,pushLight:a,pushShadow:o}}function LD(r,e){let t=new WeakMap;function i(s,a=0){const o=t.get(s);let u;return o===void 0?(u=new lv(r,e),t.set(s,[u])):a>=o.length?(u=new lv(r,e),o.push(u)):u=o[a],u}function n(){t=new WeakMap}return{get:i,dispose:n}}class RD extends ks{constructor(e){super(),this.isMeshDepthMaterial=!0,this.type="MeshDepthMaterial",this.depthPacking=RS,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.setValues(e)}copy(e){return super.copy(e),this.depthPacking=e.depthPacking,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this}}class kD extends ks{constructor(e){super(),this.isMeshDistanceMaterial=!0,this.type="MeshDistanceMaterial",this.referencePosition=new Z,this.nearDistance=1,this.farDistance=1e3,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.setValues(e)}copy(e){return super.copy(e),this.referencePosition.copy(e.referencePosition),this.nearDistance=e.nearDistance,this.farDistance=e.farDistance,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this}}const ID=`void main() {
	gl_Position = vec4( position, 1.0 );
}`,FD=`uniform sampler2D shadow_pass;
uniform vec2 resolution;
uniform float radius;
#include <packing>
void main() {
	const float samples = float( VSM_SAMPLES );
	float mean = 0.0;
	float squared_mean = 0.0;
	float uvStride = samples <= 1.0 ? 0.0 : 2.0 / ( samples - 1.0 );
	float uvStart = samples <= 1.0 ? 0.0 : - 1.0;
	for ( float i = 0.0; i < samples; i ++ ) {
		float uvOffset = uvStart + i * uvStride;
		#ifdef HORIZONTAL_PASS
			vec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( uvOffset, 0.0 ) * radius ) / resolution ) );
			mean += distribution.x;
			squared_mean += distribution.y * distribution.y + distribution.x * distribution.x;
		#else
			float depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, uvOffset ) * radius ) / resolution ) );
			mean += depth;
			squared_mean += depth * depth;
		#endif
	}
	mean = mean / samples;
	squared_mean = squared_mean / samples;
	float std_dev = sqrt( squared_mean - mean * mean );
	gl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );
}`;function OD(r,e,t){let i=new xm;const n=new Ue,s=new Ue,a=new $t,o=new RD({depthPacking:kS}),u=new kD,h={},f=t.maxTextureSize,c={0:Vn,1:Ns,2:lu},d=new fr({defines:{VSM_SAMPLES:8},uniforms:{shadow_pass:{value:null},resolution:{value:new Ue},radius:{value:4}},vertexShader:ID,fragmentShader:FD}),m=d.clone();m.defines.HORIZONTAL_PASS=1;const x=new un;x.setAttribute("position",new ln(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));const _=new Wi(x,d),b=this;this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=Z0,this.render=function(C,P,I){if(b.enabled===!1||b.autoUpdate===!1&&b.needsUpdate===!1||C.length===0)return;const F=r.getRenderTarget(),A=r.getActiveCubeFace(),k=r.getActiveMipmapLevel(),O=r.state;O.setBlending(cr),O.buffers.color.setClear(1,1,1,1),O.buffers.depth.setTest(!0),O.setScissorTest(!1);for(let J=0,Q=C.length;J<Q;J++){const X=C[J],j=X.shadow;if(j===void 0){console.warn("THREE.WebGLShadowMap:",X,"has no shadow.");continue}if(j.autoUpdate===!1&&j.needsUpdate===!1)continue;n.copy(j.mapSize);const K=j.getFrameExtents();if(n.multiply(K),s.copy(j.mapSize),(n.x>f||n.y>f)&&(n.x>f&&(s.x=Math.floor(f/K.x),n.x=s.x*K.x,j.mapSize.x=s.x),n.y>f&&(s.y=Math.floor(f/K.y),n.y=s.y*K.y,j.mapSize.y=s.y)),j.map===null){const ee=this.type!==gc?{minFilter:Ai,magFilter:Ai}:{};j.map=new Ko(n.x,n.y,ee),j.map.texture.name=X.name+".shadowMap",j.camera.updateProjectionMatrix()}r.setRenderTarget(j.map),r.clear();const ie=j.getViewportCount();for(let ee=0;ee<ie;ee++){const V=j.getViewport(ee);a.set(s.x*V.x,s.y*V.y,s.x*V.z,s.y*V.w),O.viewport(a),j.updateMatrices(X,ee),i=j.getFrustum(),D(P,I,j.camera,X,this.type)}j.isPointLightShadow!==!0&&this.type===gc&&y(j,I),j.needsUpdate=!1}b.needsUpdate=!1,r.setRenderTarget(F,A,k)};function y(C,P){const I=e.update(_);d.defines.VSM_SAMPLES!==C.blurSamples&&(d.defines.VSM_SAMPLES=C.blurSamples,m.defines.VSM_SAMPLES=C.blurSamples,d.needsUpdate=!0,m.needsUpdate=!0),C.mapPass===null&&(C.mapPass=new Ko(n.x,n.y)),d.uniforms.shadow_pass.value=C.map.texture,d.uniforms.resolution.value=C.mapSize,d.uniforms.radius.value=C.radius,r.setRenderTarget(C.mapPass),r.clear(),r.renderBufferDirect(P,null,I,d,_,null),m.uniforms.shadow_pass.value=C.mapPass.texture,m.uniforms.resolution.value=C.mapSize,m.uniforms.radius.value=C.radius,r.setRenderTarget(C.map),r.clear(),r.renderBufferDirect(P,null,I,m,_,null)}function M(C,P,I,F,A,k){let O=null;const J=I.isPointLight===!0?C.customDistanceMaterial:C.customDepthMaterial;if(J!==void 0)O=J;else if(O=I.isPointLight===!0?u:o,r.localClippingEnabled&&P.clipShadows===!0&&Array.isArray(P.clippingPlanes)&&P.clippingPlanes.length!==0||P.displacementMap&&P.displacementScale!==0||P.alphaMap&&P.alphaTest>0||P.map&&P.alphaTest>0){const Q=O.uuid,X=P.uuid;let j=h[Q];j===void 0&&(j={},h[Q]=j);let K=j[X];K===void 0&&(K=O.clone(),j[X]=K),O=K}return O.visible=P.visible,O.wireframe=P.wireframe,k===gc?O.side=P.shadowSide!==null?P.shadowSide:P.side:O.side=P.shadowSide!==null?P.shadowSide:c[P.side],O.alphaMap=P.alphaMap,O.alphaTest=P.alphaTest,O.map=P.map,O.clipShadows=P.clipShadows,O.clippingPlanes=P.clippingPlanes,O.clipIntersection=P.clipIntersection,O.displacementMap=P.displacementMap,O.displacementScale=P.displacementScale,O.displacementBias=P.displacementBias,O.wireframeLinewidth=P.wireframeLinewidth,O.linewidth=P.linewidth,I.isPointLight===!0&&O.isMeshDistanceMaterial===!0&&(O.referencePosition.setFromMatrixPosition(I.matrixWorld),O.nearDistance=F,O.farDistance=A),O}function D(C,P,I,F,A){if(C.visible===!1)return;if(C.layers.test(P.layers)&&(C.isMesh||C.isLine||C.isPoints)&&(C.castShadow||C.receiveShadow&&A===gc)&&(!C.frustumCulled||i.intersectsObject(C))){C.modelViewMatrix.multiplyMatrices(I.matrixWorldInverse,C.matrixWorld);const J=e.update(C),Q=C.material;if(Array.isArray(Q)){const X=J.groups;for(let j=0,K=X.length;j<K;j++){const ie=X[j],ee=Q[ie.materialIndex];if(ee&&ee.visible){const V=M(C,ee,F,I.near,I.far,A);r.renderBufferDirect(I,null,J,V,C,ie)}}}else if(Q.visible){const X=M(C,Q,F,I.near,I.far,A);r.renderBufferDirect(I,null,J,X,C,null)}}const O=C.children;for(let J=0,Q=O.length;J<Q;J++)D(O[J],P,I,F,A)}}function ND(r,e,t){const i=t.isWebGL2;function n(){let $=!1;const ge=new $t;let we=null;const ke=new $t(0,0,0,0);return{setMask:function(Ge){we!==Ge&&!$&&(r.colorMask(Ge,Ge,Ge,Ge),we=Ge)},setLocked:function(Ge){$=Ge},setClear:function(Ge,St,Vt,Lt,bi){bi===!0&&(Ge*=Lt,St*=Lt,Vt*=Lt),ge.set(Ge,St,Vt,Lt),ke.equals(ge)===!1&&(r.clearColor(Ge,St,Vt,Lt),ke.copy(ge))},reset:function(){$=!1,we=null,ke.set(-1,0,0,0)}}}function s(){let $=!1,ge=null,we=null,ke=null;return{setTest:function(Ge){Ge?We(2929):ye(2929)},setMask:function(Ge){ge!==Ge&&!$&&(r.depthMask(Ge),ge=Ge)},setFunc:function(Ge){if(we!==Ge){switch(Ge){case tS:r.depthFunc(512);break;case iS:r.depthFunc(519);break;case nS:r.depthFunc(513);break;case Sf:r.depthFunc(515);break;case sS:r.depthFunc(514);break;case rS:r.depthFunc(518);break;case oS:r.depthFunc(516);break;case aS:r.depthFunc(517);break;default:r.depthFunc(515)}we=Ge}},setLocked:function(Ge){$=Ge},setClear:function(Ge){ke!==Ge&&(r.clearDepth(Ge),ke=Ge)},reset:function(){$=!1,ge=null,we=null,ke=null}}}function a(){let $=!1,ge=null,we=null,ke=null,Ge=null,St=null,Vt=null,Lt=null,bi=null;return{setTest:function(Le){$||(Le?We(2960):ye(2960))},setMask:function(Le){ge!==Le&&!$&&(r.stencilMask(Le),ge=Le)},setFunc:function(Le,$e,it){(we!==Le||ke!==$e||Ge!==it)&&(r.stencilFunc(Le,$e,it),we=Le,ke=$e,Ge=it)},setOp:function(Le,$e,it){(St!==Le||Vt!==$e||Lt!==it)&&(r.stencilOp(Le,$e,it),St=Le,Vt=$e,Lt=it)},setLocked:function(Le){$=Le},setClear:function(Le){bi!==Le&&(r.clearStencil(Le),bi=Le)},reset:function(){$=!1,ge=null,we=null,ke=null,Ge=null,St=null,Vt=null,Lt=null,bi=null}}}const o=new n,u=new s,h=new a,f=new WeakMap,c=new WeakMap;let d={},m={},x=new WeakMap,_=[],b=null,y=!1,M=null,D=null,C=null,P=null,I=null,F=null,A=null,k=!1,O=null,J=null,Q=null,X=null,j=null;const K=r.getParameter(35661);let ie=!1,ee=0;const V=r.getParameter(7938);V.indexOf("WebGL")!==-1?(ee=parseFloat(/^WebGL (\d)/.exec(V)[1]),ie=ee>=1):V.indexOf("OpenGL ES")!==-1&&(ee=parseFloat(/^OpenGL ES (\d)/.exec(V)[1]),ie=ee>=2);let _e=null,U={};const oe=r.getParameter(3088),ce=r.getParameter(2978),me=new $t().fromArray(oe),le=new $t().fromArray(ce);function be($,ge,we){const ke=new Uint8Array(4),Ge=r.createTexture();r.bindTexture($,Ge),r.texParameteri($,10241,9728),r.texParameteri($,10240,9728);for(let St=0;St<we;St++)r.texImage2D(ge+St,0,6408,1,1,0,6408,5121,ke);return Ge}const ue={};ue[3553]=be(3553,3553,1),ue[34067]=be(34067,34069,6),o.setClear(0,0,0,1),u.setClear(1),h.setClear(0),We(2929),u.setFunc(Sf),mt(!1),he(i_),We(2884),ct(cr);function We($){d[$]!==!0&&(r.enable($),d[$]=!0)}function ye($){d[$]!==!1&&(r.disable($),d[$]=!1)}function Ne($,ge){return m[$]!==ge?(r.bindFramebuffer($,ge),m[$]=ge,i&&($===36009&&(m[36160]=ge),$===36160&&(m[36009]=ge)),!0):!1}function Ce($,ge){let we=_,ke=!1;if($)if(we=x.get(ge),we===void 0&&(we=[],x.set(ge,we)),$.isWebGLMultipleRenderTargets){const Ge=$.texture;if(we.length!==Ge.length||we[0]!==36064){for(let St=0,Vt=Ge.length;St<Vt;St++)we[St]=36064+St;we.length=Ge.length,ke=!0}}else we[0]!==36064&&(we[0]=36064,ke=!0);else we[0]!==1029&&(we[0]=1029,ke=!0);ke&&(t.isWebGL2?r.drawBuffers(we):e.get("WEBGL_draw_buffers").drawBuffersWEBGL(we))}function Ze($){return b!==$?(r.useProgram($),b=$,!0):!1}const Qe={[Ua]:32774,[W1]:32778,[j1]:32779};if(i)Qe[n_]=32775,Qe[s_]=32776;else{const $=e.get("EXT_blend_minmax");$!==null&&(Qe[n_]=$.MIN_EXT,Qe[s_]=$.MAX_EXT)}const Pe={[q1]:0,[X1]:1,[$1]:768,[Q0]:770,[eS]:776,[J1]:774,[K1]:772,[Y1]:769,[eb]:771,[Q1]:775,[Z1]:773};function ct($,ge,we,ke,Ge,St,Vt,Lt){if($===cr){y===!0&&(ye(3042),y=!1);return}if(y===!1&&(We(3042),y=!0),$!==J0){if($!==M||Lt!==k){if((D!==Ua||I!==Ua)&&(r.blendEquation(32774),D=Ua,I=Ua),Lt)switch($){case Fo:r.blendFuncSeparate(1,771,1,771);break;case xf:r.blendFunc(1,1);break;case wf:r.blendFuncSeparate(0,769,0,1);break;case yf:r.blendFuncSeparate(0,768,0,770);break;default:console.error("THREE.WebGLState: Invalid blending: ",$);break}else switch($){case Fo:r.blendFuncSeparate(770,771,1,771);break;case xf:r.blendFunc(770,1);break;case wf:r.blendFuncSeparate(0,769,0,1);break;case yf:r.blendFunc(0,768);break;default:console.error("THREE.WebGLState: Invalid blending: ",$);break}C=null,P=null,F=null,A=null,M=$,k=Lt}return}Ge=Ge||ge,St=St||we,Vt=Vt||ke,(ge!==D||Ge!==I)&&(r.blendEquationSeparate(Qe[ge],Qe[Ge]),D=ge,I=Ge),(we!==C||ke!==P||St!==F||Vt!==A)&&(r.blendFuncSeparate(Pe[we],Pe[ke],Pe[St],Pe[Vt]),C=we,P=ke,F=St,A=Vt),M=$,k=!1}function xt($,ge){$.side===lu?ye(2884):We(2884);let we=$.side===Vn;ge&&(we=!we),mt(we),$.blending===Fo&&$.transparent===!1?ct(cr):ct($.blending,$.blendEquation,$.blendSrc,$.blendDst,$.blendEquationAlpha,$.blendSrcAlpha,$.blendDstAlpha,$.premultipliedAlpha),u.setFunc($.depthFunc),u.setTest($.depthTest),u.setMask($.depthWrite),o.setMask($.colorWrite);const ke=$.stencilWrite;h.setTest(ke),ke&&(h.setMask($.stencilWriteMask),h.setFunc($.stencilFunc,$.stencilRef,$.stencilFuncMask),h.setOp($.stencilFail,$.stencilZFail,$.stencilZPass)),_t($.polygonOffset,$.polygonOffsetFactor,$.polygonOffsetUnits),$.alphaToCoverage===!0?We(32926):ye(32926)}function mt($){O!==$&&($?r.frontFace(2304):r.frontFace(2305),O=$)}function he($){$!==U1?(We(2884),$!==J&&($===i_?r.cullFace(1029):$===G1?r.cullFace(1028):r.cullFace(1032))):ye(2884),J=$}function Tt($){$!==Q&&(ie&&r.lineWidth($),Q=$)}function _t($,ge,we){$?(We(32823),(X!==ge||j!==we)&&(r.polygonOffset(ge,we),X=ge,j=we)):ye(32823)}function Ot($){$?We(3089):ye(3089)}function wt($){$===void 0&&($=33984+K-1),_e!==$&&(r.activeTexture($),_e=$)}function G($,ge,we){we===void 0&&(_e===null?we=33984+K-1:we=_e);let ke=U[we];ke===void 0&&(ke={type:void 0,texture:void 0},U[we]=ke),(ke.type!==$||ke.texture!==ge)&&(_e!==we&&(r.activeTexture(we),_e=we),r.bindTexture($,ge||ue[$]),ke.type=$,ke.texture=ge)}function N(){const $=U[_e];$!==void 0&&$.type!==void 0&&(r.bindTexture($.type,null),$.type=void 0,$.texture=void 0)}function fe(){try{r.compressedTexImage2D.apply(r,arguments)}catch($){console.error("THREE.WebGLState:",$)}}function xe(){try{r.compressedTexImage3D.apply(r,arguments)}catch($){console.error("THREE.WebGLState:",$)}}function Me(){try{r.texSubImage2D.apply(r,arguments)}catch($){console.error("THREE.WebGLState:",$)}}function Se(){try{r.texSubImage3D.apply(r,arguments)}catch($){console.error("THREE.WebGLState:",$)}}function je(){try{r.compressedTexSubImage2D.apply(r,arguments)}catch($){console.error("THREE.WebGLState:",$)}}function H(){try{r.compressedTexSubImage3D.apply(r,arguments)}catch($){console.error("THREE.WebGLState:",$)}}function ne(){try{r.texStorage2D.apply(r,arguments)}catch($){console.error("THREE.WebGLState:",$)}}function Fe(){try{r.texStorage3D.apply(r,arguments)}catch($){console.error("THREE.WebGLState:",$)}}function Te(){try{r.texImage2D.apply(r,arguments)}catch($){console.error("THREE.WebGLState:",$)}}function Re(){try{r.texImage3D.apply(r,arguments)}catch($){console.error("THREE.WebGLState:",$)}}function He($){me.equals($)===!1&&(r.scissor($.x,$.y,$.z,$.w),me.copy($))}function ze($){le.equals($)===!1&&(r.viewport($.x,$.y,$.z,$.w),le.copy($))}function ut($,ge){let we=c.get(ge);we===void 0&&(we=new WeakMap,c.set(ge,we));let ke=we.get($);ke===void 0&&(ke=r.getUniformBlockIndex(ge,$.name),we.set($,ke))}function ht($,ge){const ke=c.get(ge).get($);f.get(ge)!==ke&&(r.uniformBlockBinding(ge,ke,$.__bindingPointIndex),f.set(ge,ke))}function Ct(){r.disable(3042),r.disable(2884),r.disable(2929),r.disable(32823),r.disable(3089),r.disable(2960),r.disable(32926),r.blendEquation(32774),r.blendFunc(1,0),r.blendFuncSeparate(1,0,1,0),r.colorMask(!0,!0,!0,!0),r.clearColor(0,0,0,0),r.depthMask(!0),r.depthFunc(513),r.clearDepth(1),r.stencilMask(4294967295),r.stencilFunc(519,0,4294967295),r.stencilOp(7680,7680,7680),r.clearStencil(0),r.cullFace(1029),r.frontFace(2305),r.polygonOffset(0,0),r.activeTexture(33984),r.bindFramebuffer(36160,null),i===!0&&(r.bindFramebuffer(36009,null),r.bindFramebuffer(36008,null)),r.useProgram(null),r.lineWidth(1),r.scissor(0,0,r.canvas.width,r.canvas.height),r.viewport(0,0,r.canvas.width,r.canvas.height),d={},_e=null,U={},m={},x=new WeakMap,_=[],b=null,y=!1,M=null,D=null,C=null,P=null,I=null,F=null,A=null,k=!1,O=null,J=null,Q=null,X=null,j=null,me.set(0,0,r.canvas.width,r.canvas.height),le.set(0,0,r.canvas.width,r.canvas.height),o.reset(),u.reset(),h.reset()}return{buffers:{color:o,depth:u,stencil:h},enable:We,disable:ye,bindFramebuffer:Ne,drawBuffers:Ce,useProgram:Ze,setBlending:ct,setMaterial:xt,setFlipSided:mt,setCullFace:he,setLineWidth:Tt,setPolygonOffset:_t,setScissorTest:Ot,activeTexture:wt,bindTexture:G,unbindTexture:N,compressedTexImage2D:fe,compressedTexImage3D:xe,texImage2D:Te,texImage3D:Re,updateUBOMapping:ut,uniformBlockBinding:ht,texStorage2D:ne,texStorage3D:Fe,texSubImage2D:Me,texSubImage3D:Se,compressedTexSubImage2D:je,compressedTexSubImage3D:H,scissor:He,viewport:ze,reset:Ct}}function BD(r,e,t,i,n,s,a){const o=n.isWebGL2,u=n.maxTextures,h=n.maxCubemapSize,f=n.maxTextureSize,c=n.maxSamples,d=e.has("WEBGL_multisampled_render_to_texture")?e.get("WEBGL_multisampled_render_to_texture"):null,m=typeof navigator>"u"?!1:/OculusBrowser/g.test(navigator.userAgent),x=new WeakMap;let _;const b=new WeakMap;let y=!1;try{y=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")!==null}catch{}function M(G,N){return y?new OffscreenCanvas(G,N):qc("canvas")}function D(G,N,fe,xe){let Me=1;if((G.width>xe||G.height>xe)&&(Me=xe/Math.max(G.width,G.height)),Me<1||N===!0)if(typeof HTMLImageElement<"u"&&G instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&G instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&G instanceof ImageBitmap){const Se=N?Xh:Math.floor,je=Se(Me*G.width),H=Se(Me*G.height);_===void 0&&(_=M(je,H));const ne=fe?M(je,H):_;return ne.width=je,ne.height=H,ne.getContext("2d").drawImage(G,0,0,je,H),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+G.width+"x"+G.height+") to ("+je+"x"+H+")."),ne}else return"data"in G&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+G.width+"x"+G.height+")."),G;return G}function C(G){return Pf(G.width)&&Pf(G.height)}function P(G){return o?!1:G.wrapS!==bn||G.wrapT!==bn||G.minFilter!==Ai&&G.minFilter!==Ui}function I(G,N){return G.generateMipmaps&&N&&G.minFilter!==Ai&&G.minFilter!==Ui}function F(G){r.generateMipmap(G)}function A(G,N,fe,xe,Me=!1){if(o===!1)return N;if(G!==null){if(r[G]!==void 0)return r[G];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+G+"'")}let Se=N;return N===6403&&(fe===5126&&(Se=33326),fe===5131&&(Se=33325),fe===5121&&(Se=33321)),N===33319&&(fe===5126&&(Se=33328),fe===5131&&(Se=33327),fe===5121&&(Se=33323)),N===6408&&(fe===5126&&(Se=34836),fe===5131&&(Se=34842),fe===5121&&(Se=xe===Gt&&Me===!1?35907:32856),fe===32819&&(Se=32854),fe===32820&&(Se=32855)),(Se===33325||Se===33326||Se===33327||Se===33328||Se===34842||Se===34836)&&e.get("EXT_color_buffer_float"),Se}function k(G,N,fe){return I(G,fe)===!0||G.isFramebufferTexture&&G.minFilter!==Ai&&G.minFilter!==Ui?Math.log2(Math.max(N.width,N.height))+1:G.mipmaps!==void 0&&G.mipmaps.length>0?G.mipmaps.length:G.isCompressedTexture&&Array.isArray(G.image)?N.mipmaps.length:1}function O(G){return G===Ai||G===Ef||G===kh?9728:9729}function J(G){const N=G.target;N.removeEventListener("dispose",J),X(N),N.isVideoTexture&&x.delete(N)}function Q(G){const N=G.target;N.removeEventListener("dispose",Q),K(N)}function X(G){const N=i.get(G);if(N.__webglInit===void 0)return;const fe=G.source,xe=b.get(fe);if(xe){const Me=xe[N.__cacheKey];Me.usedTimes--,Me.usedTimes===0&&j(G),Object.keys(xe).length===0&&b.delete(fe)}i.remove(G)}function j(G){const N=i.get(G);r.deleteTexture(N.__webglTexture);const fe=G.source,xe=b.get(fe);delete xe[N.__cacheKey],a.memory.textures--}function K(G){const N=G.texture,fe=i.get(G),xe=i.get(N);if(xe.__webglTexture!==void 0&&(r.deleteTexture(xe.__webglTexture),a.memory.textures--),G.depthTexture&&G.depthTexture.dispose(),G.isWebGLCubeRenderTarget)for(let Me=0;Me<6;Me++)r.deleteFramebuffer(fe.__webglFramebuffer[Me]),fe.__webglDepthbuffer&&r.deleteRenderbuffer(fe.__webglDepthbuffer[Me]);else{if(r.deleteFramebuffer(fe.__webglFramebuffer),fe.__webglDepthbuffer&&r.deleteRenderbuffer(fe.__webglDepthbuffer),fe.__webglMultisampledFramebuffer&&r.deleteFramebuffer(fe.__webglMultisampledFramebuffer),fe.__webglColorRenderbuffer)for(let Me=0;Me<fe.__webglColorRenderbuffer.length;Me++)fe.__webglColorRenderbuffer[Me]&&r.deleteRenderbuffer(fe.__webglColorRenderbuffer[Me]);fe.__webglDepthRenderbuffer&&r.deleteRenderbuffer(fe.__webglDepthRenderbuffer)}if(G.isWebGLMultipleRenderTargets)for(let Me=0,Se=N.length;Me<Se;Me++){const je=i.get(N[Me]);je.__webglTexture&&(r.deleteTexture(je.__webglTexture),a.memory.textures--),i.remove(N[Me])}i.remove(N),i.remove(G)}let ie=0;function ee(){ie=0}function V(){const G=ie;return G>=u&&console.warn("THREE.WebGLTextures: Trying to use "+G+" texture units while this GPU supports only "+u),ie+=1,G}function _e(G){const N=[];return N.push(G.wrapS),N.push(G.wrapT),N.push(G.wrapR||0),N.push(G.magFilter),N.push(G.minFilter),N.push(G.anisotropy),N.push(G.internalFormat),N.push(G.format),N.push(G.type),N.push(G.generateMipmaps),N.push(G.premultiplyAlpha),N.push(G.flipY),N.push(G.unpackAlignment),N.push(G.encoding),N.join()}function U(G,N){const fe=i.get(G);if(G.isVideoTexture&&Ot(G),G.isRenderTargetTexture===!1&&G.version>0&&fe.__version!==G.version){const xe=G.image;if(xe===null)console.warn("THREE.WebGLRenderer: Texture marked for update but no image data found.");else if(xe.complete===!1)console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete");else{ye(fe,G,N);return}}t.bindTexture(3553,fe.__webglTexture,33984+N)}function oe(G,N){const fe=i.get(G);if(G.version>0&&fe.__version!==G.version){ye(fe,G,N);return}t.bindTexture(35866,fe.__webglTexture,33984+N)}function ce(G,N){const fe=i.get(G);if(G.version>0&&fe.__version!==G.version){ye(fe,G,N);return}t.bindTexture(32879,fe.__webglTexture,33984+N)}function me(G,N){const fe=i.get(G);if(G.version>0&&fe.__version!==G.version){Ne(fe,G,N);return}t.bindTexture(34067,fe.__webglTexture,33984+N)}const le={[Kr]:10497,[bn]:33071,[qh]:33648},be={[Ai]:9728,[Ef]:9984,[kh]:9986,[Ui]:9729,[nb]:9985,[dr]:9987};function ue(G,N,fe){if(fe?(r.texParameteri(G,10242,le[N.wrapS]),r.texParameteri(G,10243,le[N.wrapT]),(G===32879||G===35866)&&r.texParameteri(G,32882,le[N.wrapR]),r.texParameteri(G,10240,be[N.magFilter]),r.texParameteri(G,10241,be[N.minFilter])):(r.texParameteri(G,10242,33071),r.texParameteri(G,10243,33071),(G===32879||G===35866)&&r.texParameteri(G,32882,33071),(N.wrapS!==bn||N.wrapT!==bn)&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping."),r.texParameteri(G,10240,O(N.magFilter)),r.texParameteri(G,10241,O(N.minFilter)),N.minFilter!==Ai&&N.minFilter!==Ui&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter.")),e.has("EXT_texture_filter_anisotropic")===!0){const xe=e.get("EXT_texture_filter_anisotropic");if(N.magFilter===Ai||N.minFilter!==kh&&N.minFilter!==dr||N.type===zr&&e.has("OES_texture_float_linear")===!1||o===!1&&N.type===Gc&&e.has("OES_texture_half_float_linear")===!1)return;(N.anisotropy>1||i.get(N).__currentAnisotropy)&&(r.texParameterf(G,xe.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(N.anisotropy,n.getMaxAnisotropy())),i.get(N).__currentAnisotropy=N.anisotropy)}}function We(G,N){let fe=!1;G.__webglInit===void 0&&(G.__webglInit=!0,N.addEventListener("dispose",J));const xe=N.source;let Me=b.get(xe);Me===void 0&&(Me={},b.set(xe,Me));const Se=_e(N);if(Se!==G.__cacheKey){Me[Se]===void 0&&(Me[Se]={texture:r.createTexture(),usedTimes:0},a.memory.textures++,fe=!0),Me[Se].usedTimes++;const je=Me[G.__cacheKey];je!==void 0&&(Me[G.__cacheKey].usedTimes--,je.usedTimes===0&&j(N)),G.__cacheKey=Se,G.__webglTexture=Me[Se].texture}return fe}function ye(G,N,fe){let xe=3553;(N.isDataArrayTexture||N.isCompressedArrayTexture)&&(xe=35866),N.isData3DTexture&&(xe=32879);const Me=We(G,N),Se=N.source;t.bindTexture(xe,G.__webglTexture,33984+fe);const je=i.get(Se);if(Se.version!==je.__version||Me===!0){t.activeTexture(33984+fe),r.pixelStorei(37440,N.flipY),r.pixelStorei(37441,N.premultiplyAlpha),r.pixelStorei(3317,N.unpackAlignment),r.pixelStorei(37443,0);const H=P(N)&&C(N.image)===!1;let ne=D(N.image,H,!1,f);ne=wt(N,ne);const Fe=C(ne)||o,Te=s.convert(N.format,N.encoding);let Re=s.convert(N.type),He=A(N.internalFormat,Te,Re,N.encoding,N.isVideoTexture);ue(xe,N,Fe);let ze;const ut=N.mipmaps,ht=o&&N.isVideoTexture!==!0,Ct=je.__version===void 0||Me===!0,$=k(N,ne,Fe);if(N.isDepthTexture)He=6402,o?N.type===zr?He=36012:N.type===Lo?He=33190:N.type===Ja?He=35056:He=33189:N.type===zr&&console.error("WebGLRenderer: Floating point depth texture requires WebGL2."),N.format===Oo&&He===6402&&N.type!==sb&&N.type!==Lo&&(console.warn("THREE.WebGLRenderer: Use UnsignedShortType or UnsignedIntType for DepthFormat DepthTexture."),N.type=Lo,Re=s.convert(N.type)),N.format===ll&&He===6402&&(He=34041,N.type!==Ja&&(console.warn("THREE.WebGLRenderer: Use UnsignedInt248Type for DepthStencilFormat DepthTexture."),N.type=Ja,Re=s.convert(N.type))),Ct&&(ht?t.texStorage2D(3553,1,He,ne.width,ne.height):t.texImage2D(3553,0,He,ne.width,ne.height,0,Te,Re,null));else if(N.isDataTexture)if(ut.length>0&&Fe){ht&&Ct&&t.texStorage2D(3553,$,He,ut[0].width,ut[0].height);for(let ge=0,we=ut.length;ge<we;ge++)ze=ut[ge],ht?t.texSubImage2D(3553,ge,0,0,ze.width,ze.height,Te,Re,ze.data):t.texImage2D(3553,ge,He,ze.width,ze.height,0,Te,Re,ze.data);N.generateMipmaps=!1}else ht?(Ct&&t.texStorage2D(3553,$,He,ne.width,ne.height),t.texSubImage2D(3553,0,0,0,ne.width,ne.height,Te,Re,ne.data)):t.texImage2D(3553,0,He,ne.width,ne.height,0,Te,Re,ne.data);else if(N.isCompressedTexture)if(N.isCompressedArrayTexture){ht&&Ct&&t.texStorage3D(35866,$,He,ut[0].width,ut[0].height,ne.depth);for(let ge=0,we=ut.length;ge<we;ge++)ze=ut[ge],N.format!==es?Te!==null?ht?t.compressedTexSubImage3D(35866,ge,0,0,0,ze.width,ze.height,ne.depth,Te,ze.data,0,0):t.compressedTexImage3D(35866,ge,He,ze.width,ze.height,ne.depth,0,ze.data,0,0):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):ht?t.texSubImage3D(35866,ge,0,0,0,ze.width,ze.height,ne.depth,Te,Re,ze.data):t.texImage3D(35866,ge,He,ze.width,ze.height,ne.depth,0,Te,Re,ze.data)}else{ht&&Ct&&t.texStorage2D(3553,$,He,ut[0].width,ut[0].height);for(let ge=0,we=ut.length;ge<we;ge++)ze=ut[ge],N.format!==es?Te!==null?ht?t.compressedTexSubImage2D(3553,ge,0,0,ze.width,ze.height,Te,ze.data):t.compressedTexImage2D(3553,ge,He,ze.width,ze.height,0,ze.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):ht?t.texSubImage2D(3553,ge,0,0,ze.width,ze.height,Te,Re,ze.data):t.texImage2D(3553,ge,He,ze.width,ze.height,0,Te,Re,ze.data)}else if(N.isDataArrayTexture)ht?(Ct&&t.texStorage3D(35866,$,He,ne.width,ne.height,ne.depth),t.texSubImage3D(35866,0,0,0,0,ne.width,ne.height,ne.depth,Te,Re,ne.data)):t.texImage3D(35866,0,He,ne.width,ne.height,ne.depth,0,Te,Re,ne.data);else if(N.isData3DTexture)ht?(Ct&&t.texStorage3D(32879,$,He,ne.width,ne.height,ne.depth),t.texSubImage3D(32879,0,0,0,0,ne.width,ne.height,ne.depth,Te,Re,ne.data)):t.texImage3D(32879,0,He,ne.width,ne.height,ne.depth,0,Te,Re,ne.data);else if(N.isFramebufferTexture){if(Ct)if(ht)t.texStorage2D(3553,$,He,ne.width,ne.height);else{let ge=ne.width,we=ne.height;for(let ke=0;ke<$;ke++)t.texImage2D(3553,ke,He,ge,we,0,Te,Re,null),ge>>=1,we>>=1}}else if(ut.length>0&&Fe){ht&&Ct&&t.texStorage2D(3553,$,He,ut[0].width,ut[0].height);for(let ge=0,we=ut.length;ge<we;ge++)ze=ut[ge],ht?t.texSubImage2D(3553,ge,0,0,Te,Re,ze):t.texImage2D(3553,ge,He,Te,Re,ze);N.generateMipmaps=!1}else ht?(Ct&&t.texStorage2D(3553,$,He,ne.width,ne.height),t.texSubImage2D(3553,0,0,0,Te,Re,ne)):t.texImage2D(3553,0,He,Te,Re,ne);I(N,Fe)&&F(xe),je.__version=Se.version,N.onUpdate&&N.onUpdate(N)}G.__version=N.version}function Ne(G,N,fe){if(N.image.length!==6)return;const xe=We(G,N),Me=N.source;t.bindTexture(34067,G.__webglTexture,33984+fe);const Se=i.get(Me);if(Me.version!==Se.__version||xe===!0){t.activeTexture(33984+fe),r.pixelStorei(37440,N.flipY),r.pixelStorei(37441,N.premultiplyAlpha),r.pixelStorei(3317,N.unpackAlignment),r.pixelStorei(37443,0);const je=N.isCompressedTexture||N.image[0].isCompressedTexture,H=N.image[0]&&N.image[0].isDataTexture,ne=[];for(let ge=0;ge<6;ge++)!je&&!H?ne[ge]=D(N.image[ge],!1,!0,h):ne[ge]=H?N.image[ge].image:N.image[ge],ne[ge]=wt(N,ne[ge]);const Fe=ne[0],Te=C(Fe)||o,Re=s.convert(N.format,N.encoding),He=s.convert(N.type),ze=A(N.internalFormat,Re,He,N.encoding),ut=o&&N.isVideoTexture!==!0,ht=Se.__version===void 0||xe===!0;let Ct=k(N,Fe,Te);ue(34067,N,Te);let $;if(je){ut&&ht&&t.texStorage2D(34067,Ct,ze,Fe.width,Fe.height);for(let ge=0;ge<6;ge++){$=ne[ge].mipmaps;for(let we=0;we<$.length;we++){const ke=$[we];N.format!==es?Re!==null?ut?t.compressedTexSubImage2D(34069+ge,we,0,0,ke.width,ke.height,Re,ke.data):t.compressedTexImage2D(34069+ge,we,ze,ke.width,ke.height,0,ke.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):ut?t.texSubImage2D(34069+ge,we,0,0,ke.width,ke.height,Re,He,ke.data):t.texImage2D(34069+ge,we,ze,ke.width,ke.height,0,Re,He,ke.data)}}}else{$=N.mipmaps,ut&&ht&&($.length>0&&Ct++,t.texStorage2D(34067,Ct,ze,ne[0].width,ne[0].height));for(let ge=0;ge<6;ge++)if(H){ut?t.texSubImage2D(34069+ge,0,0,0,ne[ge].width,ne[ge].height,Re,He,ne[ge].data):t.texImage2D(34069+ge,0,ze,ne[ge].width,ne[ge].height,0,Re,He,ne[ge].data);for(let we=0;we<$.length;we++){const Ge=$[we].image[ge].image;ut?t.texSubImage2D(34069+ge,we+1,0,0,Ge.width,Ge.height,Re,He,Ge.data):t.texImage2D(34069+ge,we+1,ze,Ge.width,Ge.height,0,Re,He,Ge.data)}}else{ut?t.texSubImage2D(34069+ge,0,0,0,Re,He,ne[ge]):t.texImage2D(34069+ge,0,ze,Re,He,ne[ge]);for(let we=0;we<$.length;we++){const ke=$[we];ut?t.texSubImage2D(34069+ge,we+1,0,0,Re,He,ke.image[ge]):t.texImage2D(34069+ge,we+1,ze,Re,He,ke.image[ge])}}}I(N,Te)&&F(34067),Se.__version=Me.version,N.onUpdate&&N.onUpdate(N)}G.__version=N.version}function Ce(G,N,fe,xe,Me){const Se=s.convert(fe.format,fe.encoding),je=s.convert(fe.type),H=A(fe.internalFormat,Se,je,fe.encoding);i.get(N).__hasExternalTextures||(Me===32879||Me===35866?t.texImage3D(Me,0,H,N.width,N.height,N.depth,0,Se,je,null):t.texImage2D(Me,0,H,N.width,N.height,0,Se,je,null)),t.bindFramebuffer(36160,G),_t(N)?d.framebufferTexture2DMultisampleEXT(36160,xe,Me,i.get(fe).__webglTexture,0,Tt(N)):(Me===3553||Me>=34069&&Me<=34074)&&r.framebufferTexture2D(36160,xe,Me,i.get(fe).__webglTexture,0),t.bindFramebuffer(36160,null)}function Ze(G,N,fe){if(r.bindRenderbuffer(36161,G),N.depthBuffer&&!N.stencilBuffer){let xe=33189;if(fe||_t(N)){const Me=N.depthTexture;Me&&Me.isDepthTexture&&(Me.type===zr?xe=36012:Me.type===Lo&&(xe=33190));const Se=Tt(N);_t(N)?d.renderbufferStorageMultisampleEXT(36161,Se,xe,N.width,N.height):r.renderbufferStorageMultisample(36161,Se,xe,N.width,N.height)}else r.renderbufferStorage(36161,xe,N.width,N.height);r.framebufferRenderbuffer(36160,36096,36161,G)}else if(N.depthBuffer&&N.stencilBuffer){const xe=Tt(N);fe&&_t(N)===!1?r.renderbufferStorageMultisample(36161,xe,35056,N.width,N.height):_t(N)?d.renderbufferStorageMultisampleEXT(36161,xe,35056,N.width,N.height):r.renderbufferStorage(36161,34041,N.width,N.height),r.framebufferRenderbuffer(36160,33306,36161,G)}else{const xe=N.isWebGLMultipleRenderTargets===!0?N.texture:[N.texture];for(let Me=0;Me<xe.length;Me++){const Se=xe[Me],je=s.convert(Se.format,Se.encoding),H=s.convert(Se.type),ne=A(Se.internalFormat,je,H,Se.encoding),Fe=Tt(N);fe&&_t(N)===!1?r.renderbufferStorageMultisample(36161,Fe,ne,N.width,N.height):_t(N)?d.renderbufferStorageMultisampleEXT(36161,Fe,ne,N.width,N.height):r.renderbufferStorage(36161,ne,N.width,N.height)}}r.bindRenderbuffer(36161,null)}function Qe(G,N){if(N&&N.isWebGLCubeRenderTarget)throw new Error("Depth Texture with cube render targets is not supported");if(t.bindFramebuffer(36160,G),!(N.depthTexture&&N.depthTexture.isDepthTexture))throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");(!i.get(N.depthTexture).__webglTexture||N.depthTexture.image.width!==N.width||N.depthTexture.image.height!==N.height)&&(N.depthTexture.image.width=N.width,N.depthTexture.image.height=N.height,N.depthTexture.needsUpdate=!0),U(N.depthTexture,0);const xe=i.get(N.depthTexture).__webglTexture,Me=Tt(N);if(N.depthTexture.format===Oo)_t(N)?d.framebufferTexture2DMultisampleEXT(36160,36096,3553,xe,0,Me):r.framebufferTexture2D(36160,36096,3553,xe,0);else if(N.depthTexture.format===ll)_t(N)?d.framebufferTexture2DMultisampleEXT(36160,33306,3553,xe,0,Me):r.framebufferTexture2D(36160,33306,3553,xe,0);else throw new Error("Unknown depthTexture format")}function Pe(G){const N=i.get(G),fe=G.isWebGLCubeRenderTarget===!0;if(G.depthTexture&&!N.__autoAllocateDepthBuffer){if(fe)throw new Error("target.depthTexture not supported in Cube render targets");Qe(N.__webglFramebuffer,G)}else if(fe){N.__webglDepthbuffer=[];for(let xe=0;xe<6;xe++)t.bindFramebuffer(36160,N.__webglFramebuffer[xe]),N.__webglDepthbuffer[xe]=r.createRenderbuffer(),Ze(N.__webglDepthbuffer[xe],G,!1)}else t.bindFramebuffer(36160,N.__webglFramebuffer),N.__webglDepthbuffer=r.createRenderbuffer(),Ze(N.__webglDepthbuffer,G,!1);t.bindFramebuffer(36160,null)}function ct(G,N,fe){const xe=i.get(G);N!==void 0&&Ce(xe.__webglFramebuffer,G,G.texture,36064,3553),fe!==void 0&&Pe(G)}function xt(G){const N=G.texture,fe=i.get(G),xe=i.get(N);G.addEventListener("dispose",Q),G.isWebGLMultipleRenderTargets!==!0&&(xe.__webglTexture===void 0&&(xe.__webglTexture=r.createTexture()),xe.__version=N.version,a.memory.textures++);const Me=G.isWebGLCubeRenderTarget===!0,Se=G.isWebGLMultipleRenderTargets===!0,je=C(G)||o;if(Me){fe.__webglFramebuffer=[];for(let H=0;H<6;H++)fe.__webglFramebuffer[H]=r.createFramebuffer()}else{if(fe.__webglFramebuffer=r.createFramebuffer(),Se)if(n.drawBuffers){const H=G.texture;for(let ne=0,Fe=H.length;ne<Fe;ne++){const Te=i.get(H[ne]);Te.__webglTexture===void 0&&(Te.__webglTexture=r.createTexture(),a.memory.textures++)}}else console.warn("THREE.WebGLRenderer: WebGLMultipleRenderTargets can only be used with WebGL2 or WEBGL_draw_buffers extension.");if(o&&G.samples>0&&_t(G)===!1){const H=Se?N:[N];fe.__webglMultisampledFramebuffer=r.createFramebuffer(),fe.__webglColorRenderbuffer=[],t.bindFramebuffer(36160,fe.__webglMultisampledFramebuffer);for(let ne=0;ne<H.length;ne++){const Fe=H[ne];fe.__webglColorRenderbuffer[ne]=r.createRenderbuffer(),r.bindRenderbuffer(36161,fe.__webglColorRenderbuffer[ne]);const Te=s.convert(Fe.format,Fe.encoding),Re=s.convert(Fe.type),He=A(Fe.internalFormat,Te,Re,Fe.encoding,G.isXRRenderTarget===!0),ze=Tt(G);r.renderbufferStorageMultisample(36161,ze,He,G.width,G.height),r.framebufferRenderbuffer(36160,36064+ne,36161,fe.__webglColorRenderbuffer[ne])}r.bindRenderbuffer(36161,null),G.depthBuffer&&(fe.__webglDepthRenderbuffer=r.createRenderbuffer(),Ze(fe.__webglDepthRenderbuffer,G,!0)),t.bindFramebuffer(36160,null)}}if(Me){t.bindTexture(34067,xe.__webglTexture),ue(34067,N,je);for(let H=0;H<6;H++)Ce(fe.__webglFramebuffer[H],G,N,36064,34069+H);I(N,je)&&F(34067),t.unbindTexture()}else if(Se){const H=G.texture;for(let ne=0,Fe=H.length;ne<Fe;ne++){const Te=H[ne],Re=i.get(Te);t.bindTexture(3553,Re.__webglTexture),ue(3553,Te,je),Ce(fe.__webglFramebuffer,G,Te,36064+ne,3553),I(Te,je)&&F(3553)}t.unbindTexture()}else{let H=3553;(G.isWebGL3DRenderTarget||G.isWebGLArrayRenderTarget)&&(o?H=G.isWebGL3DRenderTarget?32879:35866:console.error("THREE.WebGLTextures: THREE.Data3DTexture and THREE.DataArrayTexture only supported with WebGL2.")),t.bindTexture(H,xe.__webglTexture),ue(H,N,je),Ce(fe.__webglFramebuffer,G,N,36064,H),I(N,je)&&F(H),t.unbindTexture()}G.depthBuffer&&Pe(G)}function mt(G){const N=C(G)||o,fe=G.isWebGLMultipleRenderTargets===!0?G.texture:[G.texture];for(let xe=0,Me=fe.length;xe<Me;xe++){const Se=fe[xe];if(I(Se,N)){const je=G.isWebGLCubeRenderTarget?34067:3553,H=i.get(Se).__webglTexture;t.bindTexture(je,H),F(je),t.unbindTexture()}}}function he(G){if(o&&G.samples>0&&_t(G)===!1){const N=G.isWebGLMultipleRenderTargets?G.texture:[G.texture],fe=G.width,xe=G.height;let Me=16384;const Se=[],je=G.stencilBuffer?33306:36096,H=i.get(G),ne=G.isWebGLMultipleRenderTargets===!0;if(ne)for(let Fe=0;Fe<N.length;Fe++)t.bindFramebuffer(36160,H.__webglMultisampledFramebuffer),r.framebufferRenderbuffer(36160,36064+Fe,36161,null),t.bindFramebuffer(36160,H.__webglFramebuffer),r.framebufferTexture2D(36009,36064+Fe,3553,null,0);t.bindFramebuffer(36008,H.__webglMultisampledFramebuffer),t.bindFramebuffer(36009,H.__webglFramebuffer);for(let Fe=0;Fe<N.length;Fe++){Se.push(36064+Fe),G.depthBuffer&&Se.push(je);const Te=H.__ignoreDepthValues!==void 0?H.__ignoreDepthValues:!1;if(Te===!1&&(G.depthBuffer&&(Me|=256),G.stencilBuffer&&(Me|=1024)),ne&&r.framebufferRenderbuffer(36008,36064,36161,H.__webglColorRenderbuffer[Fe]),Te===!0&&(r.invalidateFramebuffer(36008,[je]),r.invalidateFramebuffer(36009,[je])),ne){const Re=i.get(N[Fe]).__webglTexture;r.framebufferTexture2D(36009,36064,3553,Re,0)}r.blitFramebuffer(0,0,fe,xe,0,0,fe,xe,Me,9728),m&&r.invalidateFramebuffer(36008,Se)}if(t.bindFramebuffer(36008,null),t.bindFramebuffer(36009,null),ne)for(let Fe=0;Fe<N.length;Fe++){t.bindFramebuffer(36160,H.__webglMultisampledFramebuffer),r.framebufferRenderbuffer(36160,36064+Fe,36161,H.__webglColorRenderbuffer[Fe]);const Te=i.get(N[Fe]).__webglTexture;t.bindFramebuffer(36160,H.__webglFramebuffer),r.framebufferTexture2D(36009,36064+Fe,3553,Te,0)}t.bindFramebuffer(36009,H.__webglMultisampledFramebuffer)}}function Tt(G){return Math.min(c,G.samples)}function _t(G){const N=i.get(G);return o&&G.samples>0&&e.has("WEBGL_multisampled_render_to_texture")===!0&&N.__useRenderToTexture!==!1}function Ot(G){const N=a.render.frame;x.get(G)!==N&&(x.set(G,N),G.update())}function wt(G,N){const fe=G.encoding,xe=G.format,Me=G.type;return G.isCompressedTexture===!0||G.isVideoTexture===!0||G.format===Df||fe!==pr&&(fe===Gt?o===!1?e.has("EXT_sRGB")===!0&&xe===es?(G.format=Df,G.minFilter=Ui,G.generateMipmaps=!1):N=ub.sRGBToLinear(N):(xe!==es||Me!==Yo)&&console.warn("THREE.WebGLTextures: sRGB encoded textures have to use RGBAFormat and UnsignedByteType."):console.error("THREE.WebGLTextures: Unsupported texture encoding:",fe)),N}this.allocateTextureUnit=V,this.resetTextureUnits=ee,this.setTexture2D=U,this.setTexture2DArray=oe,this.setTexture3D=ce,this.setTextureCube=me,this.rebindTextures=ct,this.setupRenderTarget=xt,this.updateRenderTargetMipmap=mt,this.updateMultisampleRenderTarget=he,this.setupDepthRenderbuffer=Pe,this.setupFrameBufferTexture=Ce,this.useMultisampledRTT=_t}function VD(r,e,t){const i=t.isWebGL2;function n(s,a=null){let o;if(s===Yo)return 5121;if(s===vS)return 32819;if(s===bS)return 32820;if(s===mS)return 5120;if(s===gS)return 5122;if(s===sb)return 5123;if(s===_S)return 5124;if(s===Lo)return 5125;if(s===zr)return 5126;if(s===Gc)return i?5131:(o=e.get("OES_texture_half_float"),o!==null?o.HALF_FLOAT_OES:null);if(s===xS)return 6406;if(s===es)return 6408;if(s===yS)return 6409;if(s===SS)return 6410;if(s===Oo)return 6402;if(s===ll)return 34041;if(s===wS)return console.warn("THREE.WebGLRenderer: THREE.RGBFormat has been removed. Use THREE.RGBAFormat instead. https://github.com/mrdoob/three.js/pull/23228"),6408;if(s===Df)return o=e.get("EXT_sRGB"),o!==null?o.SRGB_ALPHA_EXT:null;if(s===MS)return 6403;if(s===TS)return 36244;if(s===ES)return 33319;if(s===CS)return 33320;if(s===DS)return 36249;if(s===hp||s===dp||s===pp||s===fp)if(a===Gt)if(o=e.get("WEBGL_compressed_texture_s3tc_srgb"),o!==null){if(s===hp)return o.COMPRESSED_SRGB_S3TC_DXT1_EXT;if(s===dp)return o.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;if(s===pp)return o.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;if(s===fp)return o.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT}else return null;else if(o=e.get("WEBGL_compressed_texture_s3tc"),o!==null){if(s===hp)return o.COMPRESSED_RGB_S3TC_DXT1_EXT;if(s===dp)return o.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(s===pp)return o.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(s===fp)return o.COMPRESSED_RGBA_S3TC_DXT5_EXT}else return null;if(s===r_||s===o_||s===a_||s===l_)if(o=e.get("WEBGL_compressed_texture_pvrtc"),o!==null){if(s===r_)return o.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(s===o_)return o.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(s===a_)return o.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(s===l_)return o.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}else return null;if(s===PS)return o=e.get("WEBGL_compressed_texture_etc1"),o!==null?o.COMPRESSED_RGB_ETC1_WEBGL:null;if(s===c_||s===u_)if(o=e.get("WEBGL_compressed_texture_etc"),o!==null){if(s===c_)return a===Gt?o.COMPRESSED_SRGB8_ETC2:o.COMPRESSED_RGB8_ETC2;if(s===u_)return a===Gt?o.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:o.COMPRESSED_RGBA8_ETC2_EAC}else return null;if(s===h_||s===d_||s===p_||s===f_||s===m_||s===g_||s===__||s===v_||s===b_||s===x_||s===w_||s===y_||s===S_||s===M_)if(o=e.get("WEBGL_compressed_texture_astc"),o!==null){if(s===h_)return a===Gt?o.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR:o.COMPRESSED_RGBA_ASTC_4x4_KHR;if(s===d_)return a===Gt?o.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR:o.COMPRESSED_RGBA_ASTC_5x4_KHR;if(s===p_)return a===Gt?o.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR:o.COMPRESSED_RGBA_ASTC_5x5_KHR;if(s===f_)return a===Gt?o.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR:o.COMPRESSED_RGBA_ASTC_6x5_KHR;if(s===m_)return a===Gt?o.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR:o.COMPRESSED_RGBA_ASTC_6x6_KHR;if(s===g_)return a===Gt?o.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR:o.COMPRESSED_RGBA_ASTC_8x5_KHR;if(s===__)return a===Gt?o.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR:o.COMPRESSED_RGBA_ASTC_8x6_KHR;if(s===v_)return a===Gt?o.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR:o.COMPRESSED_RGBA_ASTC_8x8_KHR;if(s===b_)return a===Gt?o.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR:o.COMPRESSED_RGBA_ASTC_10x5_KHR;if(s===x_)return a===Gt?o.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR:o.COMPRESSED_RGBA_ASTC_10x6_KHR;if(s===w_)return a===Gt?o.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR:o.COMPRESSED_RGBA_ASTC_10x8_KHR;if(s===y_)return a===Gt?o.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR:o.COMPRESSED_RGBA_ASTC_10x10_KHR;if(s===S_)return a===Gt?o.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR:o.COMPRESSED_RGBA_ASTC_12x10_KHR;if(s===M_)return a===Gt?o.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR:o.COMPRESSED_RGBA_ASTC_12x12_KHR}else return null;if(s===T_)if(o=e.get("EXT_texture_compression_bptc"),o!==null){if(s===T_)return a===Gt?o.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT:o.COMPRESSED_RGBA_BPTC_UNORM_EXT}else return null;return s===Ja?i?34042:(o=e.get("WEBGL_depth_texture"),o!==null?o.UNSIGNED_INT_24_8_WEBGL:null):r[s]!==void 0?r[s]:null}return{convert:n}}class zD extends Gi{constructor(e=[]){super(),this.isArrayCamera=!0,this.cameras=e}}class ts extends ei{constructor(){super(),this.isGroup=!0,this.type="Group"}}const UD={type:"move"};class zp{constructor(){this._targetRay=null,this._grip=null,this._hand=null}getHandSpace(){return this._hand===null&&(this._hand=new ts,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand}getTargetRaySpace(){return this._targetRay===null&&(this._targetRay=new ts,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1,this._targetRay.hasLinearVelocity=!1,this._targetRay.linearVelocity=new Z,this._targetRay.hasAngularVelocity=!1,this._targetRay.angularVelocity=new Z),this._targetRay}getGripSpace(){return this._grip===null&&(this._grip=new ts,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1,this._grip.hasLinearVelocity=!1,this._grip.linearVelocity=new Z,this._grip.hasAngularVelocity=!1,this._grip.angularVelocity=new Z),this._grip}dispatchEvent(e){return this._targetRay!==null&&this._targetRay.dispatchEvent(e),this._grip!==null&&this._grip.dispatchEvent(e),this._hand!==null&&this._hand.dispatchEvent(e),this}connect(e){if(e&&e.hand){const t=this._hand;if(t)for(const i of e.hand.values())this._getHandJoint(t,i)}return this.dispatchEvent({type:"connected",data:e}),this}disconnect(e){return this.dispatchEvent({type:"disconnected",data:e}),this._targetRay!==null&&(this._targetRay.visible=!1),this._grip!==null&&(this._grip.visible=!1),this._hand!==null&&(this._hand.visible=!1),this}update(e,t,i){let n=null,s=null,a=null;const o=this._targetRay,u=this._grip,h=this._hand;if(e&&t.session.visibilityState!=="visible-blurred"){if(h&&e.hand){a=!0;for(const _ of e.hand.values()){const b=t.getJointPose(_,i),y=this._getHandJoint(h,_);b!==null&&(y.matrix.fromArray(b.transform.matrix),y.matrix.decompose(y.position,y.rotation,y.scale),y.jointRadius=b.radius),y.visible=b!==null}const f=h.joints["index-finger-tip"],c=h.joints["thumb-tip"],d=f.position.distanceTo(c.position),m=.02,x=.005;h.inputState.pinching&&d>m+x?(h.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:e.handedness,target:this})):!h.inputState.pinching&&d<=m-x&&(h.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:e.handedness,target:this}))}else u!==null&&e.gripSpace&&(s=t.getPose(e.gripSpace,i),s!==null&&(u.matrix.fromArray(s.transform.matrix),u.matrix.decompose(u.position,u.rotation,u.scale),s.linearVelocity?(u.hasLinearVelocity=!0,u.linearVelocity.copy(s.linearVelocity)):u.hasLinearVelocity=!1,s.angularVelocity?(u.hasAngularVelocity=!0,u.angularVelocity.copy(s.angularVelocity)):u.hasAngularVelocity=!1));o!==null&&(n=t.getPose(e.targetRaySpace,i),n===null&&s!==null&&(n=s),n!==null&&(o.matrix.fromArray(n.transform.matrix),o.matrix.decompose(o.position,o.rotation,o.scale),n.linearVelocity?(o.hasLinearVelocity=!0,o.linearVelocity.copy(n.linearVelocity)):o.hasLinearVelocity=!1,n.angularVelocity?(o.hasAngularVelocity=!0,o.angularVelocity.copy(n.angularVelocity)):o.hasAngularVelocity=!1,this.dispatchEvent(UD)))}return o!==null&&(o.visible=n!==null),u!==null&&(u.visible=s!==null),h!==null&&(h.visible=a!==null),this}_getHandJoint(e,t){if(e.joints[t.jointName]===void 0){const i=new ts;i.matrixAutoUpdate=!1,i.visible=!1,e.joints[t.jointName]=i,e.add(i)}return e.joints[t.jointName]}}class GD extends vi{constructor(e,t,i,n,s,a,o,u,h,f){if(f=f!==void 0?f:Oo,f!==Oo&&f!==ll)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");i===void 0&&f===Oo&&(i=Lo),i===void 0&&f===ll&&(i=Ja),super(null,n,s,a,o,u,f,i,h),this.isDepthTexture=!0,this.image={width:e,height:t},this.magFilter=o!==void 0?o:Ai,this.minFilter=u!==void 0?u:Ai,this.flipY=!1,this.generateMipmaps=!1}}class HD extends ra{constructor(e,t){super();const i=this;let n=null,s=1,a=null,o="local-floor",u=null,h=null,f=null,c=null,d=null,m=null;const x=t.getContextAttributes();let _=null,b=null;const y=[],M=[],D=new Set,C=new Map,P=new Gi;P.layers.enable(1),P.viewport=new $t;const I=new Gi;I.layers.enable(2),I.viewport=new $t;const F=[P,I],A=new zD;A.layers.enable(1),A.layers.enable(2);let k=null,O=null;this.cameraAutoUpdate=!0,this.enabled=!1,this.isPresenting=!1,this.getController=function(oe){let ce=y[oe];return ce===void 0&&(ce=new zp,y[oe]=ce),ce.getTargetRaySpace()},this.getControllerGrip=function(oe){let ce=y[oe];return ce===void 0&&(ce=new zp,y[oe]=ce),ce.getGripSpace()},this.getHand=function(oe){let ce=y[oe];return ce===void 0&&(ce=new zp,y[oe]=ce),ce.getHandSpace()};function J(oe){const ce=M.indexOf(oe.inputSource);if(ce===-1)return;const me=y[ce];me!==void 0&&me.dispatchEvent({type:oe.type,data:oe.inputSource})}function Q(){n.removeEventListener("select",J),n.removeEventListener("selectstart",J),n.removeEventListener("selectend",J),n.removeEventListener("squeeze",J),n.removeEventListener("squeezestart",J),n.removeEventListener("squeezeend",J),n.removeEventListener("end",Q),n.removeEventListener("inputsourceschange",X);for(let oe=0;oe<y.length;oe++){const ce=M[oe];ce!==null&&(M[oe]=null,y[oe].disconnect(ce))}k=null,O=null,e.setRenderTarget(_),d=null,c=null,f=null,n=null,b=null,U.stop(),i.isPresenting=!1,i.dispatchEvent({type:"sessionend"})}this.setFramebufferScaleFactor=function(oe){s=oe,i.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(oe){o=oe,i.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return u||a},this.setReferenceSpace=function(oe){u=oe},this.getBaseLayer=function(){return c!==null?c:d},this.getBinding=function(){return f},this.getFrame=function(){return m},this.getSession=function(){return n},this.setSession=async function(oe){if(n=oe,n!==null){if(_=e.getRenderTarget(),n.addEventListener("select",J),n.addEventListener("selectstart",J),n.addEventListener("selectend",J),n.addEventListener("squeeze",J),n.addEventListener("squeezestart",J),n.addEventListener("squeezeend",J),n.addEventListener("end",Q),n.addEventListener("inputsourceschange",X),x.xrCompatible!==!0&&await t.makeXRCompatible(),n.renderState.layers===void 0||e.capabilities.isWebGL2===!1){const ce={antialias:n.renderState.layers===void 0?x.antialias:!0,alpha:x.alpha,depth:x.depth,stencil:x.stencil,framebufferScaleFactor:s};d=new XRWebGLLayer(n,t,ce),n.updateRenderState({baseLayer:d}),b=new Ko(d.framebufferWidth,d.framebufferHeight,{format:es,type:Yo,encoding:e.outputEncoding,stencilBuffer:x.stencil})}else{let ce=null,me=null,le=null;x.depth&&(le=x.stencil?35056:33190,ce=x.stencil?ll:Oo,me=x.stencil?Ja:Lo);const be={colorFormat:32856,depthFormat:le,scaleFactor:s};f=new XRWebGLBinding(n,t),c=f.createProjectionLayer(be),n.updateRenderState({layers:[c]}),b=new Ko(c.textureWidth,c.textureHeight,{format:es,type:Yo,depthTexture:new GD(c.textureWidth,c.textureHeight,me,void 0,void 0,void 0,void 0,void 0,void 0,ce),stencilBuffer:x.stencil,encoding:e.outputEncoding,samples:x.antialias?4:0});const ue=e.properties.get(b);ue.__ignoreDepthValues=c.ignoreDepthValues}b.isXRRenderTarget=!0,this.setFoveation(1),u=null,a=await n.requestReferenceSpace(o),U.setContext(n),U.start(),i.isPresenting=!0,i.dispatchEvent({type:"sessionstart"})}};function X(oe){for(let ce=0;ce<oe.removed.length;ce++){const me=oe.removed[ce],le=M.indexOf(me);le>=0&&(M[le]=null,y[le].disconnect(me))}for(let ce=0;ce<oe.added.length;ce++){const me=oe.added[ce];let le=M.indexOf(me);if(le===-1){for(let ue=0;ue<y.length;ue++)if(ue>=M.length){M.push(me),le=ue;break}else if(M[ue]===null){M[ue]=me,le=ue;break}if(le===-1)break}const be=y[le];be&&be.connect(me)}}const j=new Z,K=new Z;function ie(oe,ce,me){j.setFromMatrixPosition(ce.matrixWorld),K.setFromMatrixPosition(me.matrixWorld);const le=j.distanceTo(K),be=ce.projectionMatrix.elements,ue=me.projectionMatrix.elements,We=be[14]/(be[10]-1),ye=be[14]/(be[10]+1),Ne=(be[9]+1)/be[5],Ce=(be[9]-1)/be[5],Ze=(be[8]-1)/be[0],Qe=(ue[8]+1)/ue[0],Pe=We*Ze,ct=We*Qe,xt=le/(-Ze+Qe),mt=xt*-Ze;ce.matrixWorld.decompose(oe.position,oe.quaternion,oe.scale),oe.translateX(mt),oe.translateZ(xt),oe.matrixWorld.compose(oe.position,oe.quaternion,oe.scale),oe.matrixWorldInverse.copy(oe.matrixWorld).invert();const he=We+xt,Tt=ye+xt,_t=Pe-mt,Ot=ct+(le-mt),wt=Ne*ye/Tt*he,G=Ce*ye/Tt*he;oe.projectionMatrix.makePerspective(_t,Ot,wt,G,he,Tt)}function ee(oe,ce){ce===null?oe.matrixWorld.copy(oe.matrix):oe.matrixWorld.multiplyMatrices(ce.matrixWorld,oe.matrix),oe.matrixWorldInverse.copy(oe.matrixWorld).invert()}this.updateCamera=function(oe){if(n===null)return;A.near=I.near=P.near=oe.near,A.far=I.far=P.far=oe.far,(k!==A.near||O!==A.far)&&(n.updateRenderState({depthNear:A.near,depthFar:A.far}),k=A.near,O=A.far);const ce=oe.parent,me=A.cameras;ee(A,ce);for(let be=0;be<me.length;be++)ee(me[be],ce);A.matrixWorld.decompose(A.position,A.quaternion,A.scale),oe.matrix.copy(A.matrix),oe.matrix.decompose(oe.position,oe.quaternion,oe.scale);const le=oe.children;for(let be=0,ue=le.length;be<ue;be++)le[be].updateMatrixWorld(!0);me.length===2?ie(A,P,I):A.projectionMatrix.copy(P.projectionMatrix)},this.getCamera=function(){return A},this.getFoveation=function(){if(c!==null)return c.fixedFoveation;if(d!==null)return d.fixedFoveation},this.setFoveation=function(oe){c!==null&&(c.fixedFoveation=oe),d!==null&&d.fixedFoveation!==void 0&&(d.fixedFoveation=oe)},this.getPlanes=function(){return D};let V=null;function _e(oe,ce){if(h=ce.getViewerPose(u||a),m=ce,h!==null){const me=h.views;d!==null&&(e.setRenderTargetFramebuffer(b,d.framebuffer),e.setRenderTarget(b));let le=!1;me.length!==A.cameras.length&&(A.cameras.length=0,le=!0);for(let be=0;be<me.length;be++){const ue=me[be];let We=null;if(d!==null)We=d.getViewport(ue);else{const Ne=f.getViewSubImage(c,ue);We=Ne.viewport,be===0&&(e.setRenderTargetTextures(b,Ne.colorTexture,c.ignoreDepthValues?void 0:Ne.depthStencilTexture),e.setRenderTarget(b))}let ye=F[be];ye===void 0&&(ye=new Gi,ye.layers.enable(be),ye.viewport=new $t,F[be]=ye),ye.matrix.fromArray(ue.transform.matrix),ye.projectionMatrix.fromArray(ue.projectionMatrix),ye.viewport.set(We.x,We.y,We.width,We.height),be===0&&A.matrix.copy(ye.matrix),le===!0&&A.cameras.push(ye)}}for(let me=0;me<y.length;me++){const le=M[me],be=y[me];le!==null&&be!==void 0&&be.update(le,ce,u||a)}if(V&&V(oe,ce),ce.detectedPlanes){i.dispatchEvent({type:"planesdetected",data:ce.detectedPlanes});let me=null;for(const le of D)ce.detectedPlanes.has(le)||(me===null&&(me=[]),me.push(le));if(me!==null)for(const le of me)D.delete(le),C.delete(le),i.dispatchEvent({type:"planeremoved",data:le});for(const le of ce.detectedPlanes)if(!D.has(le))D.add(le),C.set(le,ce.lastChangedTime),i.dispatchEvent({type:"planeadded",data:le});else{const be=C.get(le);le.lastChangedTime>be&&(C.set(le,le.lastChangedTime),i.dispatchEvent({type:"planechanged",data:le}))}}m=null}const U=new _b;U.setAnimationLoop(_e),this.setAnimationLoop=function(oe){V=oe},this.dispose=function(){}}}function WD(r,e){function t(_,b){b.color.getRGB(_.fogColor.value,mb(r)),b.isFog?(_.fogNear.value=b.near,_.fogFar.value=b.far):b.isFogExp2&&(_.fogDensity.value=b.density)}function i(_,b,y,M,D){b.isMeshBasicMaterial||b.isMeshLambertMaterial?n(_,b):b.isMeshToonMaterial?(n(_,b),f(_,b)):b.isMeshPhongMaterial?(n(_,b),h(_,b)):b.isMeshStandardMaterial?(n(_,b),c(_,b),b.isMeshPhysicalMaterial&&d(_,b,D)):b.isMeshMatcapMaterial?(n(_,b),m(_,b)):b.isMeshDepthMaterial?n(_,b):b.isMeshDistanceMaterial?(n(_,b),x(_,b)):b.isMeshNormalMaterial?n(_,b):b.isLineBasicMaterial?(s(_,b),b.isLineDashedMaterial&&a(_,b)):b.isPointsMaterial?o(_,b,y,M):b.isSpriteMaterial?u(_,b):b.isShadowMaterial?(_.color.value.copy(b.color),_.opacity.value=b.opacity):b.isShaderMaterial&&(b.uniformsNeedUpdate=!1)}function n(_,b){_.opacity.value=b.opacity,b.color&&_.diffuse.value.copy(b.color),b.emissive&&_.emissive.value.copy(b.emissive).multiplyScalar(b.emissiveIntensity),b.map&&(_.map.value=b.map),b.alphaMap&&(_.alphaMap.value=b.alphaMap),b.bumpMap&&(_.bumpMap.value=b.bumpMap,_.bumpScale.value=b.bumpScale,b.side===Vn&&(_.bumpScale.value*=-1)),b.displacementMap&&(_.displacementMap.value=b.displacementMap,_.displacementScale.value=b.displacementScale,_.displacementBias.value=b.displacementBias),b.emissiveMap&&(_.emissiveMap.value=b.emissiveMap),b.normalMap&&(_.normalMap.value=b.normalMap,_.normalScale.value.copy(b.normalScale),b.side===Vn&&_.normalScale.value.negate()),b.specularMap&&(_.specularMap.value=b.specularMap),b.alphaTest>0&&(_.alphaTest.value=b.alphaTest);const y=e.get(b).envMap;if(y&&(_.envMap.value=y,_.flipEnvMap.value=y.isCubeTexture&&y.isRenderTargetTexture===!1?-1:1,_.reflectivity.value=b.reflectivity,_.ior.value=b.ior,_.refractionRatio.value=b.refractionRatio),b.lightMap){_.lightMap.value=b.lightMap;const C=r.physicallyCorrectLights!==!0?Math.PI:1;_.lightMapIntensity.value=b.lightMapIntensity*C}b.aoMap&&(_.aoMap.value=b.aoMap,_.aoMapIntensity.value=b.aoMapIntensity);let M;b.map?M=b.map:b.specularMap?M=b.specularMap:b.displacementMap?M=b.displacementMap:b.normalMap?M=b.normalMap:b.bumpMap?M=b.bumpMap:b.roughnessMap?M=b.roughnessMap:b.metalnessMap?M=b.metalnessMap:b.alphaMap?M=b.alphaMap:b.emissiveMap?M=b.emissiveMap:b.clearcoatMap?M=b.clearcoatMap:b.clearcoatNormalMap?M=b.clearcoatNormalMap:b.clearcoatRoughnessMap?M=b.clearcoatRoughnessMap:b.iridescenceMap?M=b.iridescenceMap:b.iridescenceThicknessMap?M=b.iridescenceThicknessMap:b.specularIntensityMap?M=b.specularIntensityMap:b.specularColorMap?M=b.specularColorMap:b.transmissionMap?M=b.transmissionMap:b.thicknessMap?M=b.thicknessMap:b.sheenColorMap?M=b.sheenColorMap:b.sheenRoughnessMap&&(M=b.sheenRoughnessMap),M!==void 0&&(M.isWebGLRenderTarget&&(M=M.texture),M.matrixAutoUpdate===!0&&M.updateMatrix(),_.uvTransform.value.copy(M.matrix));let D;b.aoMap?D=b.aoMap:b.lightMap&&(D=b.lightMap),D!==void 0&&(D.isWebGLRenderTarget&&(D=D.texture),D.matrixAutoUpdate===!0&&D.updateMatrix(),_.uv2Transform.value.copy(D.matrix))}function s(_,b){_.diffuse.value.copy(b.color),_.opacity.value=b.opacity}function a(_,b){_.dashSize.value=b.dashSize,_.totalSize.value=b.dashSize+b.gapSize,_.scale.value=b.scale}function o(_,b,y,M){_.diffuse.value.copy(b.color),_.opacity.value=b.opacity,_.size.value=b.size*y,_.scale.value=M*.5,b.map&&(_.map.value=b.map),b.alphaMap&&(_.alphaMap.value=b.alphaMap),b.alphaTest>0&&(_.alphaTest.value=b.alphaTest);let D;b.map?D=b.map:b.alphaMap&&(D=b.alphaMap),D!==void 0&&(D.matrixAutoUpdate===!0&&D.updateMatrix(),_.uvTransform.value.copy(D.matrix))}function u(_,b){_.diffuse.value.copy(b.color),_.opacity.value=b.opacity,_.rotation.value=b.rotation,b.map&&(_.map.value=b.map),b.alphaMap&&(_.alphaMap.value=b.alphaMap),b.alphaTest>0&&(_.alphaTest.value=b.alphaTest);let y;b.map?y=b.map:b.alphaMap&&(y=b.alphaMap),y!==void 0&&(y.matrixAutoUpdate===!0&&y.updateMatrix(),_.uvTransform.value.copy(y.matrix))}function h(_,b){_.specular.value.copy(b.specular),_.shininess.value=Math.max(b.shininess,1e-4)}function f(_,b){b.gradientMap&&(_.gradientMap.value=b.gradientMap)}function c(_,b){_.roughness.value=b.roughness,_.metalness.value=b.metalness,b.roughnessMap&&(_.roughnessMap.value=b.roughnessMap),b.metalnessMap&&(_.metalnessMap.value=b.metalnessMap),e.get(b).envMap&&(_.envMapIntensity.value=b.envMapIntensity)}function d(_,b,y){_.ior.value=b.ior,b.sheen>0&&(_.sheenColor.value.copy(b.sheenColor).multiplyScalar(b.sheen),_.sheenRoughness.value=b.sheenRoughness,b.sheenColorMap&&(_.sheenColorMap.value=b.sheenColorMap),b.sheenRoughnessMap&&(_.sheenRoughnessMap.value=b.sheenRoughnessMap)),b.clearcoat>0&&(_.clearcoat.value=b.clearcoat,_.clearcoatRoughness.value=b.clearcoatRoughness,b.clearcoatMap&&(_.clearcoatMap.value=b.clearcoatMap),b.clearcoatRoughnessMap&&(_.clearcoatRoughnessMap.value=b.clearcoatRoughnessMap),b.clearcoatNormalMap&&(_.clearcoatNormalScale.value.copy(b.clearcoatNormalScale),_.clearcoatNormalMap.value=b.clearcoatNormalMap,b.side===Vn&&_.clearcoatNormalScale.value.negate())),b.iridescence>0&&(_.iridescence.value=b.iridescence,_.iridescenceIOR.value=b.iridescenceIOR,_.iridescenceThicknessMinimum.value=b.iridescenceThicknessRange[0],_.iridescenceThicknessMaximum.value=b.iridescenceThicknessRange[1],b.iridescenceMap&&(_.iridescenceMap.value=b.iridescenceMap),b.iridescenceThicknessMap&&(_.iridescenceThicknessMap.value=b.iridescenceThicknessMap)),b.transmission>0&&(_.transmission.value=b.transmission,_.transmissionSamplerMap.value=y.texture,_.transmissionSamplerSize.value.set(y.width,y.height),b.transmissionMap&&(_.transmissionMap.value=b.transmissionMap),_.thickness.value=b.thickness,b.thicknessMap&&(_.thicknessMap.value=b.thicknessMap),_.attenuationDistance.value=b.attenuationDistance,_.attenuationColor.value.copy(b.attenuationColor)),_.specularIntensity.value=b.specularIntensity,_.specularColor.value.copy(b.specularColor),b.specularIntensityMap&&(_.specularIntensityMap.value=b.specularIntensityMap),b.specularColorMap&&(_.specularColorMap.value=b.specularColorMap)}function m(_,b){b.matcap&&(_.matcap.value=b.matcap)}function x(_,b){_.referencePosition.value.copy(b.referencePosition),_.nearDistance.value=b.nearDistance,_.farDistance.value=b.farDistance}return{refreshFogUniforms:t,refreshMaterialUniforms:i}}function jD(r,e,t,i){let n={},s={},a=[];const o=t.isWebGL2?r.getParameter(35375):0;function u(M,D){const C=D.program;i.uniformBlockBinding(M,C)}function h(M,D){let C=n[M.id];C===void 0&&(x(M),C=f(M),n[M.id]=C,M.addEventListener("dispose",b));const P=D.program;i.updateUBOMapping(M,P);const I=e.render.frame;s[M.id]!==I&&(d(M),s[M.id]=I)}function f(M){const D=c();M.__bindingPointIndex=D;const C=r.createBuffer(),P=M.__size,I=M.usage;return r.bindBuffer(35345,C),r.bufferData(35345,P,I),r.bindBuffer(35345,null),r.bindBufferBase(35345,D,C),C}function c(){for(let M=0;M<o;M++)if(a.indexOf(M)===-1)return a.push(M),M;return console.error("THREE.WebGLRenderer: Maximum number of simultaneously usable uniforms groups reached."),0}function d(M){const D=n[M.id],C=M.uniforms,P=M.__cache;r.bindBuffer(35345,D);for(let I=0,F=C.length;I<F;I++){const A=C[I];if(m(A,I,P)===!0){const k=A.__offset,O=Array.isArray(A.value)?A.value:[A.value];let J=0;for(let Q=0;Q<O.length;Q++){const X=O[Q],j=_(X);typeof X=="number"?(A.__data[0]=X,r.bufferSubData(35345,k+J,A.__data)):X.isMatrix3?(A.__data[0]=X.elements[0],A.__data[1]=X.elements[1],A.__data[2]=X.elements[2],A.__data[3]=X.elements[0],A.__data[4]=X.elements[3],A.__data[5]=X.elements[4],A.__data[6]=X.elements[5],A.__data[7]=X.elements[0],A.__data[8]=X.elements[6],A.__data[9]=X.elements[7],A.__data[10]=X.elements[8],A.__data[11]=X.elements[0]):(X.toArray(A.__data,J),J+=j.storage/Float32Array.BYTES_PER_ELEMENT)}r.bufferSubData(35345,k,A.__data)}}r.bindBuffer(35345,null)}function m(M,D,C){const P=M.value;if(C[D]===void 0){if(typeof P=="number")C[D]=P;else{const I=Array.isArray(P)?P:[P],F=[];for(let A=0;A<I.length;A++)F.push(I[A].clone());C[D]=F}return!0}else if(typeof P=="number"){if(C[D]!==P)return C[D]=P,!0}else{const I=Array.isArray(C[D])?C[D]:[C[D]],F=Array.isArray(P)?P:[P];for(let A=0;A<I.length;A++){const k=I[A];if(k.equals(F[A])===!1)return k.copy(F[A]),!0}}return!1}function x(M){const D=M.uniforms;let C=0;const P=16;let I=0;for(let F=0,A=D.length;F<A;F++){const k=D[F],O={boundary:0,storage:0},J=Array.isArray(k.value)?k.value:[k.value];for(let Q=0,X=J.length;Q<X;Q++){const j=J[Q],K=_(j);O.boundary+=K.boundary,O.storage+=K.storage}if(k.__data=new Float32Array(O.storage/Float32Array.BYTES_PER_ELEMENT),k.__offset=C,F>0){I=C%P;const Q=P-I;I!==0&&Q-O.boundary<0&&(C+=P-I,k.__offset=C)}C+=O.storage}return I=C%P,I>0&&(C+=P-I),M.__size=C,M.__cache={},this}function _(M){const D={boundary:0,storage:0};return typeof M=="number"?(D.boundary=4,D.storage=4):M.isVector2?(D.boundary=8,D.storage=8):M.isVector3||M.isColor?(D.boundary=16,D.storage=12):M.isVector4?(D.boundary=16,D.storage=16):M.isMatrix3?(D.boundary=48,D.storage=48):M.isMatrix4?(D.boundary=64,D.storage=64):M.isTexture?console.warn("THREE.WebGLRenderer: Texture samplers can not be part of an uniforms group."):console.warn("THREE.WebGLRenderer: Unsupported uniform value type.",M),D}function b(M){const D=M.target;D.removeEventListener("dispose",b);const C=a.indexOf(D.__bindingPointIndex);a.splice(C,1),r.deleteBuffer(n[D.id]),delete n[D.id],delete s[D.id]}function y(){for(const M in n)r.deleteBuffer(n[M]);a=[],n={},s={}}return{bind:u,update:h,dispose:y}}function qD(){const r=qc("canvas");return r.style.display="block",r}function Sm(r={}){this.isWebGLRenderer=!0;const e=r.canvas!==void 0?r.canvas:qD(),t=r.context!==void 0?r.context:null,i=r.depth!==void 0?r.depth:!0,n=r.stencil!==void 0?r.stencil:!0,s=r.antialias!==void 0?r.antialias:!1,a=r.premultipliedAlpha!==void 0?r.premultipliedAlpha:!0,o=r.preserveDrawingBuffer!==void 0?r.preserveDrawingBuffer:!1,u=r.powerPreference!==void 0?r.powerPreference:"default",h=r.failIfMajorPerformanceCaveat!==void 0?r.failIfMajorPerformanceCaveat:!1;let f;t!==null?f=t.getContextAttributes().alpha:f=r.alpha!==void 0?r.alpha:!1;let c=null,d=null;const m=[],x=[];this.domElement=e,this.debug={checkShaderErrors:!0},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.outputEncoding=pr,this.physicallyCorrectLights=!1,this.toneMapping=ur,this.toneMappingExposure=1;const _=this;let b=!1,y=0,M=0,D=null,C=-1,P=null;const I=new $t,F=new $t;let A=null,k=e.width,O=e.height,J=1,Q=null,X=null;const j=new $t(0,0,k,O),K=new $t(0,0,k,O);let ie=!1;const ee=new xm;let V=!1,_e=!1,U=null;const oe=new Pt,ce=new Ue,me=new Z,le={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};function be(){return D===null?J:1}let ue=t;function We(B,te){for(let de=0;de<B.length;de++){const se=B[de],pe=e.getContext(se,te);if(pe!==null)return pe}return null}try{const B={alpha:!0,depth:i,stencil:n,antialias:s,premultipliedAlpha:a,preserveDrawingBuffer:o,powerPreference:u,failIfMajorPerformanceCaveat:h};if("setAttribute"in e&&e.setAttribute("data-engine",`three.js r${gm}`),e.addEventListener("webglcontextlost",He,!1),e.addEventListener("webglcontextrestored",ze,!1),e.addEventListener("webglcontextcreationerror",ut,!1),ue===null){const te=["webgl2","webgl","experimental-webgl"];if(_.isWebGL1Renderer===!0&&te.shift(),ue=We(te,B),ue===null)throw We(te)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}ue.getShaderPrecisionFormat===void 0&&(ue.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}})}catch(B){throw console.error("THREE.WebGLRenderer: "+B.message),B}let ye,Ne,Ce,Ze,Qe,Pe,ct,xt,mt,he,Tt,_t,Ot,wt,G,N,fe,xe,Me,Se,je,H,ne,Fe;function Te(){ye=new nC(ue),Ne=new ZE(ue,ye,r),ye.init(Ne),H=new VD(ue,ye,Ne),Ce=new ND(ue,ye,Ne),Ze=new oC,Qe=new SD,Pe=new BD(ue,ye,Ce,Qe,Ne,H,Ze),ct=new QE(_),xt=new iC(_),mt=new mM(ue,Ne),ne=new YE(ue,ye,mt,Ne),he=new sC(ue,mt,Ze,ne),Tt=new uC(ue,he,mt,Ze),Me=new cC(ue,Ne,Pe),N=new JE(Qe),_t=new yD(_,ct,xt,ye,Ne,ne,N),Ot=new WD(_,Qe),wt=new TD,G=new LD(ye,Ne),xe=new $E(_,ct,xt,Ce,Tt,f,a),fe=new OD(_,Tt,Ne),Fe=new jD(ue,Ze,Ne,Ce),Se=new KE(ue,ye,Ze,Ne),je=new rC(ue,ye,Ze,Ne),Ze.programs=_t.programs,_.capabilities=Ne,_.extensions=ye,_.properties=Qe,_.renderLists=wt,_.shadowMap=fe,_.state=Ce,_.info=Ze}Te();const Re=new HD(_,ue);this.xr=Re,this.getContext=function(){return ue},this.getContextAttributes=function(){return ue.getContextAttributes()},this.forceContextLoss=function(){const B=ye.get("WEBGL_lose_context");B&&B.loseContext()},this.forceContextRestore=function(){const B=ye.get("WEBGL_lose_context");B&&B.restoreContext()},this.getPixelRatio=function(){return J},this.setPixelRatio=function(B){B!==void 0&&(J=B,this.setSize(k,O,!1))},this.getSize=function(B){return B.set(k,O)},this.setSize=function(B,te,de){if(Re.isPresenting){console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting.");return}k=B,O=te,e.width=Math.floor(B*J),e.height=Math.floor(te*J),de!==!1&&(e.style.width=B+"px",e.style.height=te+"px"),this.setViewport(0,0,B,te)},this.getDrawingBufferSize=function(B){return B.set(k*J,O*J).floor()},this.setDrawingBufferSize=function(B,te,de){k=B,O=te,J=de,e.width=Math.floor(B*de),e.height=Math.floor(te*de),this.setViewport(0,0,B,te)},this.getCurrentViewport=function(B){return B.copy(I)},this.getViewport=function(B){return B.copy(j)},this.setViewport=function(B,te,de,se){B.isVector4?j.set(B.x,B.y,B.z,B.w):j.set(B,te,de,se),Ce.viewport(I.copy(j).multiplyScalar(J).floor())},this.getScissor=function(B){return B.copy(K)},this.setScissor=function(B,te,de,se){B.isVector4?K.set(B.x,B.y,B.z,B.w):K.set(B,te,de,se),Ce.scissor(F.copy(K).multiplyScalar(J).floor())},this.getScissorTest=function(){return ie},this.setScissorTest=function(B){Ce.setScissorTest(ie=B)},this.setOpaqueSort=function(B){Q=B},this.setTransparentSort=function(B){X=B},this.getClearColor=function(B){return B.copy(xe.getClearColor())},this.setClearColor=function(){xe.setClearColor.apply(xe,arguments)},this.getClearAlpha=function(){return xe.getClearAlpha()},this.setClearAlpha=function(){xe.setClearAlpha.apply(xe,arguments)},this.clear=function(B=!0,te=!0,de=!0){let se=0;B&&(se|=16384),te&&(se|=256),de&&(se|=1024),ue.clear(se)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){e.removeEventListener("webglcontextlost",He,!1),e.removeEventListener("webglcontextrestored",ze,!1),e.removeEventListener("webglcontextcreationerror",ut,!1),wt.dispose(),G.dispose(),Qe.dispose(),ct.dispose(),xt.dispose(),Tt.dispose(),ne.dispose(),Fe.dispose(),_t.dispose(),Re.dispose(),Re.removeEventListener("sessionstart",ke),Re.removeEventListener("sessionend",Ge),U&&(U.dispose(),U=null),St.stop()};function He(B){B.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),b=!0}function ze(){console.log("THREE.WebGLRenderer: Context Restored."),b=!1;const B=Ze.autoReset,te=fe.enabled,de=fe.autoUpdate,se=fe.needsUpdate,pe=fe.type;Te(),Ze.autoReset=B,fe.enabled=te,fe.autoUpdate=de,fe.needsUpdate=se,fe.type=pe}function ut(B){console.error("THREE.WebGLRenderer: A WebGL context could not be created. Reason: ",B.statusMessage)}function ht(B){const te=B.target;te.removeEventListener("dispose",ht),Ct(te)}function Ct(B){$(B),Qe.remove(B)}function $(B){const te=Qe.get(B).programs;te!==void 0&&(te.forEach(function(de){_t.releaseProgram(de)}),B.isShaderMaterial&&_t.releaseShaderCache(B))}this.renderBufferDirect=function(B,te,de,se,pe,Oe){te===null&&(te=le);const Be=pe.isMesh&&pe.matrixWorld.determinant()<0,rt=at(B,te,de,se,pe);Ce.setMaterial(se,Be);let Ye=de.index,ot=1;se.wireframe===!0&&(Ye=he.getWireframeAttribute(de),ot=2);const gt=de.drawRange,nt=de.attributes.position;let bt=gt.start*ot,Ft=(gt.start+gt.count)*ot;Oe!==null&&(bt=Math.max(bt,Oe.start*ot),Ft=Math.min(Ft,(Oe.start+Oe.count)*ot)),Ye!==null?(bt=Math.max(bt,0),Ft=Math.min(Ft,Ye.count)):nt!=null&&(bt=Math.max(bt,0),Ft=Math.min(Ft,nt.count));const Yt=Ft-bt;if(Yt<0||Yt===1/0)return;ne.setup(pe,se,rt,de,Ye);let Ii,yt=Se;if(Ye!==null&&(Ii=mt.get(Ye),yt=je,yt.setIndex(Ii)),pe.isMesh)se.wireframe===!0?(Ce.setLineWidth(se.wireframeLinewidth*be()),yt.setMode(1)):yt.setMode(4);else if(pe.isLine){let tt=se.linewidth;tt===void 0&&(tt=1),Ce.setLineWidth(tt*be()),pe.isLineSegments?yt.setMode(1):pe.isLineLoop?yt.setMode(2):yt.setMode(3)}else pe.isPoints?yt.setMode(0):pe.isSprite&&yt.setMode(4);if(pe.isInstancedMesh)yt.renderInstances(bt,Yt,pe.count);else if(de.isInstancedBufferGeometry){const tt=de._maxInstanceCount!==void 0?de._maxInstanceCount:1/0,ai=Math.min(de.instanceCount,tt);yt.renderInstances(bt,Yt,ai)}else yt.render(bt,Yt)},this.compile=function(B,te){function de(se,pe,Oe){se.transparent===!0&&se.side===Hu?(se.side=Vn,se.needsUpdate=!0,it(se,pe,Oe),se.side=Ns,se.needsUpdate=!0,it(se,pe,Oe),se.side=Hu):it(se,pe,Oe)}d=G.get(B),d.init(),x.push(d),B.traverseVisible(function(se){se.isLight&&se.layers.test(te.layers)&&(d.pushLight(se),se.castShadow&&d.pushShadow(se))}),d.setupLights(_.physicallyCorrectLights),B.traverse(function(se){const pe=se.material;if(pe)if(Array.isArray(pe))for(let Oe=0;Oe<pe.length;Oe++){const Be=pe[Oe];de(Be,B,se)}else de(pe,B,se)}),x.pop(),d=null};let ge=null;function we(B){ge&&ge(B)}function ke(){St.stop()}function Ge(){St.start()}const St=new _b;St.setAnimationLoop(we),typeof self<"u"&&St.setContext(self),this.setAnimationLoop=function(B){ge=B,Re.setAnimationLoop(B),B===null?St.stop():St.start()},Re.addEventListener("sessionstart",ke),Re.addEventListener("sessionend",Ge),this.render=function(B,te){if(te!==void 0&&te.isCamera!==!0){console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.");return}if(b===!0)return;B.matrixWorldAutoUpdate===!0&&B.updateMatrixWorld(),te.parent===null&&te.matrixWorldAutoUpdate===!0&&te.updateMatrixWorld(),Re.enabled===!0&&Re.isPresenting===!0&&(Re.cameraAutoUpdate===!0&&Re.updateCamera(te),te=Re.getCamera()),B.isScene===!0&&B.onBeforeRender(_,B,te,D),d=G.get(B,x.length),d.init(),x.push(d),oe.multiplyMatrices(te.projectionMatrix,te.matrixWorldInverse),ee.setFromProjectionMatrix(oe),_e=this.localClippingEnabled,V=N.init(this.clippingPlanes,_e,te),c=wt.get(B,m.length),c.init(),m.push(c),Vt(B,te,0,_.sortObjects),c.finish(),_.sortObjects===!0&&c.sort(Q,X),V===!0&&N.beginShadows();const de=d.state.shadowsArray;if(fe.render(de,B,te),V===!0&&N.endShadows(),this.info.autoReset===!0&&this.info.reset(),xe.render(c,B),d.setupLights(_.physicallyCorrectLights),te.isArrayCamera){const se=te.cameras;for(let pe=0,Oe=se.length;pe<Oe;pe++){const Be=se[pe];Lt(c,B,Be,Be.viewport)}}else Lt(c,B,te);D!==null&&(Pe.updateMultisampleRenderTarget(D),Pe.updateRenderTargetMipmap(D)),B.isScene===!0&&B.onAfterRender(_,B,te),ne.resetDefaultState(),C=-1,P=null,x.pop(),x.length>0?d=x[x.length-1]:d=null,m.pop(),m.length>0?c=m[m.length-1]:c=null};function Vt(B,te,de,se){if(B.visible===!1)return;if(B.layers.test(te.layers)){if(B.isGroup)de=B.renderOrder;else if(B.isLOD)B.autoUpdate===!0&&B.update(te);else if(B.isLight)d.pushLight(B),B.castShadow&&d.pushShadow(B);else if(B.isSprite){if(!B.frustumCulled||ee.intersectsSprite(B)){se&&me.setFromMatrixPosition(B.matrixWorld).applyMatrix4(oe);const Be=Tt.update(B),rt=B.material;rt.visible&&c.push(B,Be,rt,de,me.z,null)}}else if((B.isMesh||B.isLine||B.isPoints)&&(B.isSkinnedMesh&&B.skeleton.frame!==Ze.render.frame&&(B.skeleton.update(),B.skeleton.frame=Ze.render.frame),!B.frustumCulled||ee.intersectsObject(B))){se&&me.setFromMatrixPosition(B.matrixWorld).applyMatrix4(oe);const Be=Tt.update(B),rt=B.material;if(Array.isArray(rt)){const Ye=Be.groups;for(let ot=0,gt=Ye.length;ot<gt;ot++){const nt=Ye[ot],bt=rt[nt.materialIndex];bt&&bt.visible&&c.push(B,Be,bt,de,me.z,nt)}}else rt.visible&&c.push(B,Be,rt,de,me.z,null)}}const Oe=B.children;for(let Be=0,rt=Oe.length;Be<rt;Be++)Vt(Oe[Be],te,de,se)}function Lt(B,te,de,se){const pe=B.opaque,Oe=B.transmissive,Be=B.transparent;d.setupLightsView(de),Oe.length>0&&bi(pe,te,de),se&&Ce.viewport(I.copy(se)),pe.length>0&&Le(pe,te,de),Oe.length>0&&Le(Oe,te,de),Be.length>0&&Le(Be,te,de),Ce.buffers.depth.setTest(!0),Ce.buffers.depth.setMask(!0),Ce.buffers.color.setMask(!0),Ce.setPolygonOffset(!1)}function bi(B,te,de){const se=Ne.isWebGL2;U===null&&(U=new Ko(1,1,{generateMipmaps:!0,type:ye.has("EXT_color_buffer_half_float")?Gc:Yo,minFilter:dr,samples:se&&s===!0?4:0})),_.getDrawingBufferSize(ce),se?U.setSize(ce.x,ce.y):U.setSize(Xh(ce.x),Xh(ce.y));const pe=_.getRenderTarget();_.setRenderTarget(U),_.clear();const Oe=_.toneMapping;_.toneMapping=ur,Le(B,te,de),_.toneMapping=Oe,Pe.updateMultisampleRenderTarget(U),Pe.updateRenderTargetMipmap(U),_.setRenderTarget(pe)}function Le(B,te,de){const se=te.isScene===!0?te.overrideMaterial:null;for(let pe=0,Oe=B.length;pe<Oe;pe++){const Be=B[pe],rt=Be.object,Ye=Be.geometry,ot=se===null?Be.material:se,gt=Be.group;rt.layers.test(de.layers)&&$e(rt,te,de,Ye,ot,gt)}}function $e(B,te,de,se,pe,Oe){B.onBeforeRender(_,te,de,se,pe,Oe),B.modelViewMatrix.multiplyMatrices(de.matrixWorldInverse,B.matrixWorld),B.normalMatrix.getNormalMatrix(B.modelViewMatrix),pe.onBeforeRender(_,te,de,se,B,Oe),pe.transparent===!0&&pe.side===Hu?(pe.side=Vn,pe.needsUpdate=!0,_.renderBufferDirect(de,te,se,pe,B,Oe),pe.side=Ns,pe.needsUpdate=!0,_.renderBufferDirect(de,te,se,pe,B,Oe),pe.side=Hu):_.renderBufferDirect(de,te,se,pe,B,Oe),B.onAfterRender(_,te,de,se,pe,Oe)}function it(B,te,de){te.isScene!==!0&&(te=le);const se=Qe.get(B),pe=d.state.lights,Oe=d.state.shadowsArray,Be=pe.state.version,rt=_t.getParameters(B,pe.state,Oe,te,de),Ye=_t.getProgramCacheKey(rt);let ot=se.programs;se.environment=B.isMeshStandardMaterial?te.environment:null,se.fog=te.fog,se.envMap=(B.isMeshStandardMaterial?xt:ct).get(B.envMap||se.environment),ot===void 0&&(B.addEventListener("dispose",ht),ot=new Map,se.programs=ot);let gt=ot.get(Ye);if(gt!==void 0){if(se.currentProgram===gt&&se.lightsStateVersion===Be)return Ie(B,rt),gt}else rt.uniforms=_t.getUniforms(B),B.onBuild(de,rt,_),B.onBeforeCompile(rt,_),gt=_t.acquireProgram(rt,Ye),ot.set(Ye,gt),se.uniforms=rt.uniforms;const nt=se.uniforms;(!B.isShaderMaterial&&!B.isRawShaderMaterial||B.clipping===!0)&&(nt.clippingPlanes=N.uniform),Ie(B,rt),se.needsLights=lt(B),se.lightsStateVersion=Be,se.needsLights&&(nt.ambientLightColor.value=pe.state.ambient,nt.lightProbe.value=pe.state.probe,nt.directionalLights.value=pe.state.directional,nt.directionalLightShadows.value=pe.state.directionalShadow,nt.spotLights.value=pe.state.spot,nt.spotLightShadows.value=pe.state.spotShadow,nt.rectAreaLights.value=pe.state.rectArea,nt.ltc_1.value=pe.state.rectAreaLTC1,nt.ltc_2.value=pe.state.rectAreaLTC2,nt.pointLights.value=pe.state.point,nt.pointLightShadows.value=pe.state.pointShadow,nt.hemisphereLights.value=pe.state.hemi,nt.directionalShadowMap.value=pe.state.directionalShadowMap,nt.directionalShadowMatrix.value=pe.state.directionalShadowMatrix,nt.spotShadowMap.value=pe.state.spotShadowMap,nt.spotLightMatrix.value=pe.state.spotLightMatrix,nt.spotLightMap.value=pe.state.spotLightMap,nt.pointShadowMap.value=pe.state.pointShadowMap,nt.pointShadowMatrix.value=pe.state.pointShadowMatrix);const bt=gt.getUniforms(),Ft=Fh.seqWithValue(bt.seq,nt);return se.currentProgram=gt,se.uniformsList=Ft,gt}function Ie(B,te){const de=Qe.get(B);de.outputEncoding=te.outputEncoding,de.instancing=te.instancing,de.skinning=te.skinning,de.morphTargets=te.morphTargets,de.morphNormals=te.morphNormals,de.morphColors=te.morphColors,de.morphTargetsCount=te.morphTargetsCount,de.numClippingPlanes=te.numClippingPlanes,de.numIntersection=te.numClipIntersection,de.vertexAlphas=te.vertexAlphas,de.vertexTangents=te.vertexTangents,de.toneMapping=te.toneMapping}function at(B,te,de,se,pe){te.isScene!==!0&&(te=le),Pe.resetTextureUnits();const Oe=te.fog,Be=se.isMeshStandardMaterial?te.environment:null,rt=D===null?_.outputEncoding:D.isXRRenderTarget===!0?D.texture.encoding:pr,Ye=(se.isMeshStandardMaterial?xt:ct).get(se.envMap||Be),ot=se.vertexColors===!0&&!!de.attributes.color&&de.attributes.color.itemSize===4,gt=!!se.normalMap&&!!de.attributes.tangent,nt=!!de.morphAttributes.position,bt=!!de.morphAttributes.normal,Ft=!!de.morphAttributes.color,Yt=se.toneMapped?_.toneMapping:ur,Ii=de.morphAttributes.position||de.morphAttributes.normal||de.morphAttributes.color,yt=Ii!==void 0?Ii.length:0,tt=Qe.get(se),ai=d.state.lights;if(V===!0&&(_e===!0||B!==P)){const Fi=B===P&&se.id===C;N.setState(se,B,Fi)}let Kt=!1;se.version===tt.__version?(tt.needsLights&&tt.lightsStateVersion!==ai.state.version||tt.outputEncoding!==rt||pe.isInstancedMesh&&tt.instancing===!1||!pe.isInstancedMesh&&tt.instancing===!0||pe.isSkinnedMesh&&tt.skinning===!1||!pe.isSkinnedMesh&&tt.skinning===!0||tt.envMap!==Ye||se.fog===!0&&tt.fog!==Oe||tt.numClippingPlanes!==void 0&&(tt.numClippingPlanes!==N.numPlanes||tt.numIntersection!==N.numIntersection)||tt.vertexAlphas!==ot||tt.vertexTangents!==gt||tt.morphTargets!==nt||tt.morphNormals!==bt||tt.morphColors!==Ft||tt.toneMapping!==Yt||Ne.isWebGL2===!0&&tt.morphTargetsCount!==yt)&&(Kt=!0):(Kt=!0,tt.__version=se.version);let zt=tt.currentProgram;Kt===!0&&(zt=it(se,te,pe));let Hn=!1,ii=!1,hn=!1;const Zt=zt.getUniforms(),Ti=tt.uniforms;if(Ce.useProgram(zt.program)&&(Hn=!0,ii=!0,hn=!0),se.id!==C&&(C=se.id,ii=!0),Hn||P!==B){if(Zt.setValue(ue,"projectionMatrix",B.projectionMatrix),Ne.logarithmicDepthBuffer&&Zt.setValue(ue,"logDepthBufFC",2/(Math.log(B.far+1)/Math.LN2)),P!==B&&(P=B,ii=!0,hn=!0),se.isShaderMaterial||se.isMeshPhongMaterial||se.isMeshToonMaterial||se.isMeshStandardMaterial||se.envMap){const Fi=Zt.map.cameraPosition;Fi!==void 0&&Fi.setValue(ue,me.setFromMatrixPosition(B.matrixWorld))}(se.isMeshPhongMaterial||se.isMeshToonMaterial||se.isMeshLambertMaterial||se.isMeshBasicMaterial||se.isMeshStandardMaterial||se.isShaderMaterial)&&Zt.setValue(ue,"isOrthographic",B.isOrthographicCamera===!0),(se.isMeshPhongMaterial||se.isMeshToonMaterial||se.isMeshLambertMaterial||se.isMeshBasicMaterial||se.isMeshStandardMaterial||se.isShaderMaterial||se.isShadowMaterial||pe.isSkinnedMesh)&&Zt.setValue(ue,"viewMatrix",B.matrixWorldInverse)}if(pe.isSkinnedMesh){Zt.setOptional(ue,pe,"bindMatrix"),Zt.setOptional(ue,pe,"bindMatrixInverse");const Fi=pe.skeleton;Fi&&(Ne.floatVertexTextures?(Fi.boneTexture===null&&Fi.computeBoneTexture(),Zt.setValue(ue,"boneTexture",Fi.boneTexture,Pe),Zt.setValue(ue,"boneTextureSize",Fi.boneTextureSize)):console.warn("THREE.WebGLRenderer: SkinnedMesh can only be used with WebGL 2. With WebGL 1 OES_texture_float and vertex textures support is required."))}const br=de.morphAttributes;if((br.position!==void 0||br.normal!==void 0||br.color!==void 0&&Ne.isWebGL2===!0)&&Me.update(pe,de,se,zt),(ii||tt.receiveShadow!==pe.receiveShadow)&&(tt.receiveShadow=pe.receiveShadow,Zt.setValue(ue,"receiveShadow",pe.receiveShadow)),se.isMeshGouraudMaterial&&se.envMap!==null&&(Ti.envMap.value=Ye,Ti.flipEnvMap.value=Ye.isCubeTexture&&Ye.isRenderTargetTexture===!1?-1:1),ii&&(Zt.setValue(ue,"toneMappingExposure",_.toneMappingExposure),tt.needsLights&&et(Ti,hn),Oe&&se.fog===!0&&Ot.refreshFogUniforms(Ti,Oe),Ot.refreshMaterialUniforms(Ti,se,J,O,U),Fh.upload(ue,tt.uniformsList,Ti,Pe)),se.isShaderMaterial&&se.uniformsNeedUpdate===!0&&(Fh.upload(ue,tt.uniformsList,Ti,Pe),se.uniformsNeedUpdate=!1),se.isSpriteMaterial&&Zt.setValue(ue,"center",pe.center),Zt.setValue(ue,"modelViewMatrix",pe.modelViewMatrix),Zt.setValue(ue,"normalMatrix",pe.normalMatrix),Zt.setValue(ue,"modelMatrix",pe.matrixWorld),se.isShaderMaterial||se.isRawShaderMaterial){const Fi=se.uniformsGroups;for(let Wn=0,bs=Fi.length;Wn<bs;Wn++)if(Ne.isWebGL2){const xs=Fi[Wn];Fe.update(xs,zt),Fe.bind(xs,zt)}else console.warn("THREE.WebGLRenderer: Uniform Buffer Objects can only be used with WebGL 2.")}return zt}function et(B,te){B.ambientLightColor.needsUpdate=te,B.lightProbe.needsUpdate=te,B.directionalLights.needsUpdate=te,B.directionalLightShadows.needsUpdate=te,B.pointLights.needsUpdate=te,B.pointLightShadows.needsUpdate=te,B.spotLights.needsUpdate=te,B.spotLightShadows.needsUpdate=te,B.rectAreaLights.needsUpdate=te,B.hemisphereLights.needsUpdate=te}function lt(B){return B.isMeshLambertMaterial||B.isMeshToonMaterial||B.isMeshPhongMaterial||B.isMeshStandardMaterial||B.isShadowMaterial||B.isShaderMaterial&&B.lights===!0}this.getActiveCubeFace=function(){return y},this.getActiveMipmapLevel=function(){return M},this.getRenderTarget=function(){return D},this.setRenderTargetTextures=function(B,te,de){Qe.get(B.texture).__webglTexture=te,Qe.get(B.depthTexture).__webglTexture=de;const se=Qe.get(B);se.__hasExternalTextures=!0,se.__hasExternalTextures&&(se.__autoAllocateDepthBuffer=de===void 0,se.__autoAllocateDepthBuffer||ye.has("WEBGL_multisampled_render_to_texture")===!0&&(console.warn("THREE.WebGLRenderer: Render-to-texture extension was disabled because an external texture was provided"),se.__useRenderToTexture=!1))},this.setRenderTargetFramebuffer=function(B,te){const de=Qe.get(B);de.__webglFramebuffer=te,de.__useDefaultFramebuffer=te===void 0},this.setRenderTarget=function(B,te=0,de=0){D=B,y=te,M=de;let se=!0,pe=null,Oe=!1,Be=!1;if(B){const Ye=Qe.get(B);Ye.__useDefaultFramebuffer!==void 0?(Ce.bindFramebuffer(36160,null),se=!1):Ye.__webglFramebuffer===void 0?Pe.setupRenderTarget(B):Ye.__hasExternalTextures&&Pe.rebindTextures(B,Qe.get(B.texture).__webglTexture,Qe.get(B.depthTexture).__webglTexture);const ot=B.texture;(ot.isData3DTexture||ot.isDataArrayTexture||ot.isCompressedArrayTexture)&&(Be=!0);const gt=Qe.get(B).__webglFramebuffer;B.isWebGLCubeRenderTarget?(pe=gt[te],Oe=!0):Ne.isWebGL2&&B.samples>0&&Pe.useMultisampledRTT(B)===!1?pe=Qe.get(B).__webglMultisampledFramebuffer:pe=gt,I.copy(B.viewport),F.copy(B.scissor),A=B.scissorTest}else I.copy(j).multiplyScalar(J).floor(),F.copy(K).multiplyScalar(J).floor(),A=ie;if(Ce.bindFramebuffer(36160,pe)&&Ne.drawBuffers&&se&&Ce.drawBuffers(B,pe),Ce.viewport(I),Ce.scissor(F),Ce.setScissorTest(A),Oe){const Ye=Qe.get(B.texture);ue.framebufferTexture2D(36160,36064,34069+te,Ye.__webglTexture,de)}else if(Be){const Ye=Qe.get(B.texture),ot=te||0;ue.framebufferTextureLayer(36160,36064,Ye.__webglTexture,de||0,ot)}C=-1},this.readRenderTargetPixels=function(B,te,de,se,pe,Oe,Be){if(!(B&&B.isWebGLRenderTarget)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");return}let rt=Qe.get(B).__webglFramebuffer;if(B.isWebGLCubeRenderTarget&&Be!==void 0&&(rt=rt[Be]),rt){Ce.bindFramebuffer(36160,rt);try{const Ye=B.texture,ot=Ye.format,gt=Ye.type;if(ot!==es&&H.convert(ot)!==ue.getParameter(35739)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");return}const nt=gt===Gc&&(ye.has("EXT_color_buffer_half_float")||Ne.isWebGL2&&ye.has("EXT_color_buffer_float"));if(gt!==Yo&&H.convert(gt)!==ue.getParameter(35738)&&!(gt===zr&&(Ne.isWebGL2||ye.has("OES_texture_float")||ye.has("WEBGL_color_buffer_float")))&&!nt){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");return}te>=0&&te<=B.width-se&&de>=0&&de<=B.height-pe&&ue.readPixels(te,de,se,pe,H.convert(ot),H.convert(gt),Oe)}finally{const Ye=D!==null?Qe.get(D).__webglFramebuffer:null;Ce.bindFramebuffer(36160,Ye)}}},this.copyFramebufferToTexture=function(B,te,de=0){const se=Math.pow(2,-de),pe=Math.floor(te.image.width*se),Oe=Math.floor(te.image.height*se);Pe.setTexture2D(te,0),ue.copyTexSubImage2D(3553,de,0,0,B.x,B.y,pe,Oe),Ce.unbindTexture()},this.copyTextureToTexture=function(B,te,de,se=0){const pe=te.image.width,Oe=te.image.height,Be=H.convert(de.format),rt=H.convert(de.type);Pe.setTexture2D(de,0),ue.pixelStorei(37440,de.flipY),ue.pixelStorei(37441,de.premultiplyAlpha),ue.pixelStorei(3317,de.unpackAlignment),te.isDataTexture?ue.texSubImage2D(3553,se,B.x,B.y,pe,Oe,Be,rt,te.image.data):te.isCompressedTexture?ue.compressedTexSubImage2D(3553,se,B.x,B.y,te.mipmaps[0].width,te.mipmaps[0].height,Be,te.mipmaps[0].data):ue.texSubImage2D(3553,se,B.x,B.y,Be,rt,te.image),se===0&&de.generateMipmaps&&ue.generateMipmap(3553),Ce.unbindTexture()},this.copyTextureToTexture3D=function(B,te,de,se,pe=0){if(_.isWebGL1Renderer){console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: can only be used with WebGL2.");return}const Oe=B.max.x-B.min.x+1,Be=B.max.y-B.min.y+1,rt=B.max.z-B.min.z+1,Ye=H.convert(se.format),ot=H.convert(se.type);let gt;if(se.isData3DTexture)Pe.setTexture3D(se,0),gt=32879;else if(se.isDataArrayTexture)Pe.setTexture2DArray(se,0),gt=35866;else{console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: only supports THREE.DataTexture3D and THREE.DataTexture2DArray.");return}ue.pixelStorei(37440,se.flipY),ue.pixelStorei(37441,se.premultiplyAlpha),ue.pixelStorei(3317,se.unpackAlignment);const nt=ue.getParameter(3314),bt=ue.getParameter(32878),Ft=ue.getParameter(3316),Yt=ue.getParameter(3315),Ii=ue.getParameter(32877),yt=de.isCompressedTexture?de.mipmaps[0]:de.image;ue.pixelStorei(3314,yt.width),ue.pixelStorei(32878,yt.height),ue.pixelStorei(3316,B.min.x),ue.pixelStorei(3315,B.min.y),ue.pixelStorei(32877,B.min.z),de.isDataTexture||de.isData3DTexture?ue.texSubImage3D(gt,pe,te.x,te.y,te.z,Oe,Be,rt,Ye,ot,yt.data):de.isCompressedArrayTexture?(console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: untested support for compressed srcTexture."),ue.compressedTexSubImage3D(gt,pe,te.x,te.y,te.z,Oe,Be,rt,Ye,yt.data)):ue.texSubImage3D(gt,pe,te.x,te.y,te.z,Oe,Be,rt,Ye,ot,yt),ue.pixelStorei(3314,nt),ue.pixelStorei(32878,bt),ue.pixelStorei(3316,Ft),ue.pixelStorei(3315,Yt),ue.pixelStorei(32877,Ii),pe===0&&se.generateMipmaps&&ue.generateMipmap(gt),Ce.unbindTexture()},this.initTexture=function(B){B.isCubeTexture?Pe.setTextureCube(B,0):B.isData3DTexture?Pe.setTexture3D(B,0):B.isDataArrayTexture||B.isCompressedArrayTexture?Pe.setTexture2DArray(B,0):Pe.setTexture2D(B,0),Ce.unbindTexture()},this.resetState=function(){y=0,M=0,D=null,Ce.reset(),ne.reset()},typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}class XD extends Sm{}XD.prototype.isWebGL1Renderer=!0;class dd{constructor(e,t=1,i=1e3){this.isFog=!0,this.name="",this.color=new pt(e),this.near=t,this.far=i}clone(){return new dd(this.color,this.near,this.far)}toJSON(){return{type:"Fog",color:this.color.getHex(),near:this.near,far:this.far}}}class $D extends ei{constructor(){super(),this.isScene=!0,this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.backgroundBlurriness=0,this.backgroundIntensity=1,this.overrideMaterial=null,typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}copy(e,t){return super.copy(e,t),e.background!==null&&(this.background=e.background.clone()),e.environment!==null&&(this.environment=e.environment.clone()),e.fog!==null&&(this.fog=e.fog.clone()),this.backgroundBlurriness=e.backgroundBlurriness,this.backgroundIntensity=e.backgroundIntensity,e.overrideMaterial!==null&&(this.overrideMaterial=e.overrideMaterial.clone()),this.matrixAutoUpdate=e.matrixAutoUpdate,this}toJSON(e){const t=super.toJSON(e);return this.fog!==null&&(t.object.fog=this.fog.toJSON()),this.backgroundBlurriness>0&&(t.backgroundBlurriness=this.backgroundBlurriness),this.backgroundIntensity!==1&&(t.backgroundIntensity=this.backgroundIntensity),t}get autoUpdate(){return console.warn("THREE.Scene: autoUpdate was renamed to matrixWorldAutoUpdate in r144."),this.matrixWorldAutoUpdate}set autoUpdate(e){console.warn("THREE.Scene: autoUpdate was renamed to matrixWorldAutoUpdate in r144."),this.matrixWorldAutoUpdate=e}}class YD{constructor(e,t){this.isInterleavedBuffer=!0,this.array=e,this.stride=t,this.count=e!==void 0?e.length/t:0,this.usage=Cf,this.updateRange={offset:0,count:-1},this.version=0,this.uuid=_s()}onUploadCallback(){}set needsUpdate(e){e===!0&&this.version++}setUsage(e){return this.usage=e,this}copy(e){return this.array=new e.array.constructor(e.array),this.count=e.count,this.stride=e.stride,this.usage=e.usage,this}copyAt(e,t,i){e*=this.stride,i*=t.stride;for(let n=0,s=this.stride;n<s;n++)this.array[e+n]=t.array[i+n];return this}set(e,t=0){return this.array.set(e,t),this}clone(e){e.arrayBuffers===void 0&&(e.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=_s()),e.arrayBuffers[this.array.buffer._uuid]===void 0&&(e.arrayBuffers[this.array.buffer._uuid]=this.array.slice(0).buffer);const t=new this.array.constructor(e.arrayBuffers[this.array.buffer._uuid]),i=new this.constructor(t,this.stride);return i.setUsage(this.usage),i}onUpload(e){return this.onUploadCallback=e,this}toJSON(e){return e.arrayBuffers===void 0&&(e.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=_s()),e.arrayBuffers[this.array.buffer._uuid]===void 0&&(e.arrayBuffers[this.array.buffer._uuid]=Array.from(new Uint32Array(this.array.buffer))),{uuid:this.uuid,buffer:this.array.buffer._uuid,type:this.array.constructor.name,stride:this.stride}}}const Zi=new Z;class Mm{constructor(e,t,i,n=!1){this.isInterleavedBufferAttribute=!0,this.name="",this.data=e,this.itemSize=t,this.offset=i,this.normalized=n}get count(){return this.data.count}get array(){return this.data.array}set needsUpdate(e){this.data.needsUpdate=e}applyMatrix4(e){for(let t=0,i=this.data.count;t<i;t++)Zi.fromBufferAttribute(this,t),Zi.applyMatrix4(e),this.setXYZ(t,Zi.x,Zi.y,Zi.z);return this}applyNormalMatrix(e){for(let t=0,i=this.count;t<i;t++)Zi.fromBufferAttribute(this,t),Zi.applyNormalMatrix(e),this.setXYZ(t,Zi.x,Zi.y,Zi.z);return this}transformDirection(e){for(let t=0,i=this.count;t<i;t++)Zi.fromBufferAttribute(this,t),Zi.transformDirection(e),this.setXYZ(t,Zi.x,Zi.y,Zi.z);return this}setX(e,t){return this.normalized&&(t=Xt(t,this.array)),this.data.array[e*this.data.stride+this.offset]=t,this}setY(e,t){return this.normalized&&(t=Xt(t,this.array)),this.data.array[e*this.data.stride+this.offset+1]=t,this}setZ(e,t){return this.normalized&&(t=Xt(t,this.array)),this.data.array[e*this.data.stride+this.offset+2]=t,this}setW(e,t){return this.normalized&&(t=Xt(t,this.array)),this.data.array[e*this.data.stride+this.offset+3]=t,this}getX(e){let t=this.data.array[e*this.data.stride+this.offset];return this.normalized&&(t=or(t,this.array)),t}getY(e){let t=this.data.array[e*this.data.stride+this.offset+1];return this.normalized&&(t=or(t,this.array)),t}getZ(e){let t=this.data.array[e*this.data.stride+this.offset+2];return this.normalized&&(t=or(t,this.array)),t}getW(e){let t=this.data.array[e*this.data.stride+this.offset+3];return this.normalized&&(t=or(t,this.array)),t}setXY(e,t,i){return e=e*this.data.stride+this.offset,this.normalized&&(t=Xt(t,this.array),i=Xt(i,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=i,this}setXYZ(e,t,i,n){return e=e*this.data.stride+this.offset,this.normalized&&(t=Xt(t,this.array),i=Xt(i,this.array),n=Xt(n,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=i,this.data.array[e+2]=n,this}setXYZW(e,t,i,n,s){return e=e*this.data.stride+this.offset,this.normalized&&(t=Xt(t,this.array),i=Xt(i,this.array),n=Xt(n,this.array),s=Xt(s,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=i,this.data.array[e+2]=n,this.data.array[e+3]=s,this}clone(e){if(e===void 0){console.log("THREE.InterleavedBufferAttribute.clone(): Cloning an interleaved buffer attribute will de-interleave buffer data.");const t=[];for(let i=0;i<this.count;i++){const n=i*this.data.stride+this.offset;for(let s=0;s<this.itemSize;s++)t.push(this.data.array[n+s])}return new ln(new this.array.constructor(t),this.itemSize,this.normalized)}else return e.interleavedBuffers===void 0&&(e.interleavedBuffers={}),e.interleavedBuffers[this.data.uuid]===void 0&&(e.interleavedBuffers[this.data.uuid]=this.data.clone(e)),new Mm(e.interleavedBuffers[this.data.uuid],this.itemSize,this.offset,this.normalized)}toJSON(e){if(e===void 0){console.log("THREE.InterleavedBufferAttribute.toJSON(): Serializing an interleaved buffer attribute will de-interleave buffer data.");const t=[];for(let i=0;i<this.count;i++){const n=i*this.data.stride+this.offset;for(let s=0;s<this.itemSize;s++)t.push(this.data.array[n+s])}return{itemSize:this.itemSize,type:this.array.constructor.name,array:t,normalized:this.normalized}}else return e.interleavedBuffers===void 0&&(e.interleavedBuffers={}),e.interleavedBuffers[this.data.uuid]===void 0&&(e.interleavedBuffers[this.data.uuid]=this.data.toJSON(e)),{isInterleavedBufferAttribute:!0,itemSize:this.itemSize,data:this.data.uuid,offset:this.offset,normalized:this.normalized}}}const cv=new Z,uv=new $t,hv=new $t,KD=new Z,dv=new Pt;class ZD extends Wi{constructor(e,t){super(e,t),this.isSkinnedMesh=!0,this.type="SkinnedMesh",this.bindMode="attached",this.bindMatrix=new Pt,this.bindMatrixInverse=new Pt}copy(e,t){return super.copy(e,t),this.bindMode=e.bindMode,this.bindMatrix.copy(e.bindMatrix),this.bindMatrixInverse.copy(e.bindMatrixInverse),this.skeleton=e.skeleton,this}bind(e,t){this.skeleton=e,t===void 0&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),t=this.matrixWorld),this.bindMatrix.copy(t),this.bindMatrixInverse.copy(t).invert()}pose(){this.skeleton.pose()}normalizeSkinWeights(){const e=new $t,t=this.geometry.attributes.skinWeight;for(let i=0,n=t.count;i<n;i++){e.fromBufferAttribute(t,i);const s=1/e.manhattanLength();s!==1/0?e.multiplyScalar(s):e.set(1,0,0,0),t.setXYZW(i,e.x,e.y,e.z,e.w)}}updateMatrixWorld(e){super.updateMatrixWorld(e),this.bindMode==="attached"?this.bindMatrixInverse.copy(this.matrixWorld).invert():this.bindMode==="detached"?this.bindMatrixInverse.copy(this.bindMatrix).invert():console.warn("THREE.SkinnedMesh: Unrecognized bindMode: "+this.bindMode)}boneTransform(e,t){const i=this.skeleton,n=this.geometry;uv.fromBufferAttribute(n.attributes.skinIndex,e),hv.fromBufferAttribute(n.attributes.skinWeight,e),cv.copy(t).applyMatrix4(this.bindMatrix),t.set(0,0,0);for(let s=0;s<4;s++){const a=hv.getComponent(s);if(a!==0){const o=uv.getComponent(s);dv.multiplyMatrices(i.bones[o].matrixWorld,i.boneInverses[o]),t.addScaledVector(KD.copy(cv).applyMatrix4(dv),a)}}return t.applyMatrix4(this.bindMatrixInverse)}}class yb extends ei{constructor(){super(),this.isBone=!0,this.type="Bone"}}class JD extends vi{constructor(e=null,t=1,i=1,n,s,a,o,u,h=Ai,f=Ai,c,d){super(null,a,o,u,h,f,n,s,c,d),this.isDataTexture=!0,this.image={data:e,width:t,height:i},this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}const pv=new Pt,QD=new Pt;class Tm{constructor(e=[],t=[]){this.uuid=_s(),this.bones=e.slice(0),this.boneInverses=t,this.boneMatrices=null,this.boneTexture=null,this.boneTextureSize=0,this.frame=-1,this.init()}init(){const e=this.bones,t=this.boneInverses;if(this.boneMatrices=new Float32Array(e.length*16),t.length===0)this.calculateInverses();else if(e.length!==t.length){console.warn("THREE.Skeleton: Number of inverse bone matrices does not match amount of bones."),this.boneInverses=[];for(let i=0,n=this.bones.length;i<n;i++)this.boneInverses.push(new Pt)}}calculateInverses(){this.boneInverses.length=0;for(let e=0,t=this.bones.length;e<t;e++){const i=new Pt;this.bones[e]&&i.copy(this.bones[e].matrixWorld).invert(),this.boneInverses.push(i)}}pose(){for(let e=0,t=this.bones.length;e<t;e++){const i=this.bones[e];i&&i.matrixWorld.copy(this.boneInverses[e]).invert()}for(let e=0,t=this.bones.length;e<t;e++){const i=this.bones[e];i&&(i.parent&&i.parent.isBone?(i.matrix.copy(i.parent.matrixWorld).invert(),i.matrix.multiply(i.matrixWorld)):i.matrix.copy(i.matrixWorld),i.matrix.decompose(i.position,i.quaternion,i.scale))}}update(){const e=this.bones,t=this.boneInverses,i=this.boneMatrices,n=this.boneTexture;for(let s=0,a=e.length;s<a;s++){const o=e[s]?e[s].matrixWorld:QD;pv.multiplyMatrices(o,t[s]),pv.toArray(i,s*16)}n!==null&&(n.needsUpdate=!0)}clone(){return new Tm(this.bones,this.boneInverses)}computeBoneTexture(){let e=Math.sqrt(this.bones.length*4);e=ab(e),e=Math.max(e,4);const t=new Float32Array(e*e*4);t.set(this.boneMatrices);const i=new JD(t,e,e,es,zr);return i.needsUpdate=!0,this.boneMatrices=t,this.boneTexture=i,this.boneTextureSize=e,this}getBoneByName(e){for(let t=0,i=this.bones.length;t<i;t++){const n=this.bones[t];if(n.name===e)return n}}dispose(){this.boneTexture!==null&&(this.boneTexture.dispose(),this.boneTexture=null)}fromJSON(e,t){this.uuid=e.uuid;for(let i=0,n=e.bones.length;i<n;i++){const s=e.bones[i];let a=t[s];a===void 0&&(console.warn("THREE.Skeleton: No bone found with UUID:",s),a=new yb),this.bones.push(a),this.boneInverses.push(new Pt().fromArray(e.boneInverses[i]))}return this.init(),this}toJSON(){const e={metadata:{version:4.5,type:"Skeleton",generator:"Skeleton.toJSON"},bones:[],boneInverses:[]};e.uuid=this.uuid;const t=this.bones,i=this.boneInverses;for(let n=0,s=t.length;n<s;n++){const a=t[n];e.bones.push(a.uuid);const o=i[n];e.boneInverses.push(o.toArray())}return e}}class Vo extends ln{constructor(e,t,i,n=1){super(e,t,i),this.isInstancedBufferAttribute=!0,this.meshPerAttribute=n}copy(e){return super.copy(e),this.meshPerAttribute=e.meshPerAttribute,this}toJSON(){const e=super.toJSON();return e.meshPerAttribute=this.meshPerAttribute,e.isInstancedBufferAttribute=!0,e}}const fv=new Pt,mv=new Pt,lh=[],eP=new Pt,oc=new Wi;class Sb extends Wi{constructor(e,t,i){super(e,t),this.isInstancedMesh=!0,this.instanceMatrix=new Vo(new Float32Array(i*16),16),this.instanceColor=null,this.count=i,this.frustumCulled=!1;for(let n=0;n<i;n++)this.setMatrixAt(n,eP)}copy(e,t){return super.copy(e,t),this.instanceMatrix.copy(e.instanceMatrix),e.instanceColor!==null&&(this.instanceColor=e.instanceColor.clone()),this.count=e.count,this}getColorAt(e,t){t.fromArray(this.instanceColor.array,e*3)}getMatrixAt(e,t){t.fromArray(this.instanceMatrix.array,e*16)}raycast(e,t){const i=this.matrixWorld,n=this.count;if(oc.geometry=this.geometry,oc.material=this.material,oc.material!==void 0)for(let s=0;s<n;s++){this.getMatrixAt(s,fv),mv.multiplyMatrices(i,fv),oc.matrixWorld=mv,oc.raycast(e,lh);for(let a=0,o=lh.length;a<o;a++){const u=lh[a];u.instanceId=s,u.object=this,t.push(u)}lh.length=0}}setColorAt(e,t){this.instanceColor===null&&(this.instanceColor=new Vo(new Float32Array(this.instanceMatrix.count*3),3)),t.toArray(this.instanceColor.array,e*3)}setMatrixAt(e,t){t.toArray(this.instanceMatrix.array,e*16)}updateMorphTargets(){}dispose(){this.dispatchEvent({type:"dispose"})}}class hu extends ks{constructor(e){super(),this.isLineBasicMaterial=!0,this.type="LineBasicMaterial",this.color=new pt(16777215),this.linewidth=1,this.linecap="round",this.linejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.linewidth=e.linewidth,this.linecap=e.linecap,this.linejoin=e.linejoin,this.fog=e.fog,this}}const gv=new Z,_v=new Z,vv=new Pt,Up=new ud,ch=new Tl;class du extends ei{constructor(e=new un,t=new hu){super(),this.isLine=!0,this.type="Line",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),this.material=e.material,this.geometry=e.geometry,this}computeLineDistances(){const e=this.geometry;if(e.index===null){const t=e.attributes.position,i=[0];for(let n=1,s=t.count;n<s;n++)gv.fromBufferAttribute(t,n-1),_v.fromBufferAttribute(t,n),i[n]=i[n-1],i[n]+=gv.distanceTo(_v);e.setAttribute("lineDistance",new xn(i,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}raycast(e,t){const i=this.geometry,n=this.matrixWorld,s=e.params.Line.threshold,a=i.drawRange;if(i.boundingSphere===null&&i.computeBoundingSphere(),ch.copy(i.boundingSphere),ch.applyMatrix4(n),ch.radius+=s,e.ray.intersectsSphere(ch)===!1)return;vv.copy(n).invert(),Up.copy(e.ray).applyMatrix4(vv);const o=s/((this.scale.x+this.scale.y+this.scale.z)/3),u=o*o,h=new Z,f=new Z,c=new Z,d=new Z,m=this.isLineSegments?2:1,x=i.index,b=i.attributes.position;if(x!==null){const y=Math.max(0,a.start),M=Math.min(x.count,a.start+a.count);for(let D=y,C=M-1;D<C;D+=m){const P=x.getX(D),I=x.getX(D+1);if(h.fromBufferAttribute(b,P),f.fromBufferAttribute(b,I),Up.distanceSqToSegment(h,f,d,c)>u)continue;d.applyMatrix4(this.matrixWorld);const A=e.ray.origin.distanceTo(d);A<e.near||A>e.far||t.push({distance:A,point:c.clone().applyMatrix4(this.matrixWorld),index:D,face:null,faceIndex:null,object:this})}}else{const y=Math.max(0,a.start),M=Math.min(b.count,a.start+a.count);for(let D=y,C=M-1;D<C;D+=m){if(h.fromBufferAttribute(b,D),f.fromBufferAttribute(b,D+1),Up.distanceSqToSegment(h,f,d,c)>u)continue;d.applyMatrix4(this.matrixWorld);const I=e.ray.origin.distanceTo(d);I<e.near||I>e.far||t.push({distance:I,point:c.clone().applyMatrix4(this.matrixWorld),index:D,face:null,faceIndex:null,object:this})}}}updateMorphTargets(){const t=this.geometry.morphAttributes,i=Object.keys(t);if(i.length>0){const n=t[i[0]];if(n!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let s=0,a=n.length;s<a;s++){const o=n[s].name||String(s);this.morphTargetInfluences.push(0),this.morphTargetDictionary[o]=s}}}}}const bv=new Z,xv=new Z;class Mb extends du{constructor(e,t){super(e,t),this.isLineSegments=!0,this.type="LineSegments"}computeLineDistances(){const e=this.geometry;if(e.index===null){const t=e.attributes.position,i=[];for(let n=0,s=t.count;n<s;n+=2)bv.fromBufferAttribute(t,n),xv.fromBufferAttribute(t,n+1),i[n]=n===0?0:i[n-1],i[n+1]=i[n]+bv.distanceTo(xv);e.setAttribute("lineDistance",new xn(i,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}}class tP extends du{constructor(e,t){super(e,t),this.isLineLoop=!0,this.type="LineLoop"}}class Tb extends ks{constructor(e){super(),this.isPointsMaterial=!0,this.type="PointsMaterial",this.color=new pt(16777215),this.map=null,this.alphaMap=null,this.size=1,this.sizeAttenuation=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.size=e.size,this.sizeAttenuation=e.sizeAttenuation,this.fog=e.fog,this}}const wv=new Pt,Lf=new ud,uh=new Tl,hh=new Z;class iP extends ei{constructor(e=new un,t=new Tb){super(),this.isPoints=!0,this.type="Points",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),this.material=e.material,this.geometry=e.geometry,this}raycast(e,t){const i=this.geometry,n=this.matrixWorld,s=e.params.Points.threshold,a=i.drawRange;if(i.boundingSphere===null&&i.computeBoundingSphere(),uh.copy(i.boundingSphere),uh.applyMatrix4(n),uh.radius+=s,e.ray.intersectsSphere(uh)===!1)return;wv.copy(n).invert(),Lf.copy(e.ray).applyMatrix4(wv);const o=s/((this.scale.x+this.scale.y+this.scale.z)/3),u=o*o,h=i.index,c=i.attributes.position;if(h!==null){const d=Math.max(0,a.start),m=Math.min(h.count,a.start+a.count);for(let x=d,_=m;x<_;x++){const b=h.getX(x);hh.fromBufferAttribute(c,b),yv(hh,b,u,n,e,t,this)}}else{const d=Math.max(0,a.start),m=Math.min(c.count,a.start+a.count);for(let x=d,_=m;x<_;x++)hh.fromBufferAttribute(c,x),yv(hh,x,u,n,e,t,this)}}updateMorphTargets(){const t=this.geometry.morphAttributes,i=Object.keys(t);if(i.length>0){const n=t[i[0]];if(n!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let s=0,a=n.length;s<a;s++){const o=n[s].name||String(s);this.morphTargetInfluences.push(0),this.morphTargetDictionary[o]=s}}}}}function yv(r,e,t,i,n,s,a){const o=Lf.distanceSqToPoint(r);if(o<t){const u=new Z;Lf.closestPointToPoint(r,u),u.applyMatrix4(i);const h=n.ray.origin.distanceTo(u);if(h<n.near||h>n.far)return;s.push({distance:h,distanceToRay:Math.sqrt(o),point:u,index:e,face:null,object:a})}}class Em{constructor(){this.type="Curve",this.arcLengthDivisions=200}getPoint(){return console.warn("THREE.Curve: .getPoint() not implemented."),null}getPointAt(e,t){const i=this.getUtoTmapping(e);return this.getPoint(i,t)}getPoints(e=5){const t=[];for(let i=0;i<=e;i++)t.push(this.getPoint(i/e));return t}getSpacedPoints(e=5){const t=[];for(let i=0;i<=e;i++)t.push(this.getPointAt(i/e));return t}getLength(){const e=this.getLengths();return e[e.length-1]}getLengths(e=this.arcLengthDivisions){if(this.cacheArcLengths&&this.cacheArcLengths.length===e+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;const t=[];let i,n=this.getPoint(0),s=0;t.push(0);for(let a=1;a<=e;a++)i=this.getPoint(a/e),s+=i.distanceTo(n),t.push(s),n=i;return this.cacheArcLengths=t,t}updateArcLengths(){this.needsUpdate=!0,this.getLengths()}getUtoTmapping(e,t){const i=this.getLengths();let n=0;const s=i.length;let a;t?a=t:a=e*i[s-1];let o=0,u=s-1,h;for(;o<=u;)if(n=Math.floor(o+(u-o)/2),h=i[n]-a,h<0)o=n+1;else if(h>0)u=n-1;else{u=n;break}if(n=u,i[n]===a)return n/(s-1);const f=i[n],d=i[n+1]-f,m=(a-f)/d;return(n+m)/(s-1)}getTangent(e,t){let n=e-1e-4,s=e+1e-4;n<0&&(n=0),s>1&&(s=1);const a=this.getPoint(n),o=this.getPoint(s),u=t||(a.isVector2?new Ue:new Z);return u.copy(o).sub(a).normalize(),u}getTangentAt(e,t){const i=this.getUtoTmapping(e);return this.getTangent(i,t)}computeFrenetFrames(e,t){const i=new Z,n=[],s=[],a=[],o=new Z,u=new Pt;for(let m=0;m<=e;m++){const x=m/e;n[m]=this.getTangentAt(x,new Z)}s[0]=new Z,a[0]=new Z;let h=Number.MAX_VALUE;const f=Math.abs(n[0].x),c=Math.abs(n[0].y),d=Math.abs(n[0].z);f<=h&&(h=f,i.set(1,0,0)),c<=h&&(h=c,i.set(0,1,0)),d<=h&&i.set(0,0,1),o.crossVectors(n[0],i).normalize(),s[0].crossVectors(n[0],o),a[0].crossVectors(n[0],s[0]);for(let m=1;m<=e;m++){if(s[m]=s[m-1].clone(),a[m]=a[m-1].clone(),o.crossVectors(n[m-1],n[m]),o.length()>Number.EPSILON){o.normalize();const x=Math.acos(Li(n[m-1].dot(n[m]),-1,1));s[m].applyMatrix4(u.makeRotationAxis(o,x))}a[m].crossVectors(n[m],s[m])}if(t===!0){let m=Math.acos(Li(s[0].dot(s[e]),-1,1));m/=e,n[0].dot(o.crossVectors(s[0],s[e]))>0&&(m=-m);for(let x=1;x<=e;x++)s[x].applyMatrix4(u.makeRotationAxis(n[x],m*x)),a[x].crossVectors(n[x],s[x])}return{tangents:n,normals:s,binormals:a}}clone(){return new this.constructor().copy(this)}copy(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}toJSON(){const e={metadata:{version:4.5,type:"Curve",generator:"Curve.toJSON"}};return e.arcLengthDivisions=this.arcLengthDivisions,e.type=this.type,e}fromJSON(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}}function Cm(){let r=0,e=0,t=0,i=0;function n(s,a,o,u){r=s,e=o,t=-3*s+3*a-2*o-u,i=2*s-2*a+o+u}return{initCatmullRom:function(s,a,o,u,h){n(a,o,h*(o-s),h*(u-a))},initNonuniformCatmullRom:function(s,a,o,u,h,f,c){let d=(a-s)/h-(o-s)/(h+f)+(o-a)/f,m=(o-a)/f-(u-a)/(f+c)+(u-o)/c;d*=f,m*=f,n(a,o,d,m)},calc:function(s){const a=s*s,o=a*s;return r+e*s+t*a+i*o}}}const dh=new Z,Gp=new Cm,Hp=new Cm,Wp=new Cm;class Eb extends Em{constructor(e=[],t=!1,i="centripetal",n=.5){super(),this.isCatmullRomCurve3=!0,this.type="CatmullRomCurve3",this.points=e,this.closed=t,this.curveType=i,this.tension=n}getPoint(e,t=new Z){const i=t,n=this.points,s=n.length,a=(s-(this.closed?0:1))*e;let o=Math.floor(a),u=a-o;this.closed?o+=o>0?0:(Math.floor(Math.abs(o)/s)+1)*s:u===0&&o===s-1&&(o=s-2,u=1);let h,f;this.closed||o>0?h=n[(o-1)%s]:(dh.subVectors(n[0],n[1]).add(n[0]),h=dh);const c=n[o%s],d=n[(o+1)%s];if(this.closed||o+2<s?f=n[(o+2)%s]:(dh.subVectors(n[s-1],n[s-2]).add(n[s-1]),f=dh),this.curveType==="centripetal"||this.curveType==="chordal"){const m=this.curveType==="chordal"?.5:.25;let x=Math.pow(h.distanceToSquared(c),m),_=Math.pow(c.distanceToSquared(d),m),b=Math.pow(d.distanceToSquared(f),m);_<1e-4&&(_=1),x<1e-4&&(x=_),b<1e-4&&(b=_),Gp.initNonuniformCatmullRom(h.x,c.x,d.x,f.x,x,_,b),Hp.initNonuniformCatmullRom(h.y,c.y,d.y,f.y,x,_,b),Wp.initNonuniformCatmullRom(h.z,c.z,d.z,f.z,x,_,b)}else this.curveType==="catmullrom"&&(Gp.initCatmullRom(h.x,c.x,d.x,f.x,this.tension),Hp.initCatmullRom(h.y,c.y,d.y,f.y,this.tension),Wp.initCatmullRom(h.z,c.z,d.z,f.z,this.tension));return i.set(Gp.calc(u),Hp.calc(u),Wp.calc(u)),i}copy(e){super.copy(e),this.points=[];for(let t=0,i=e.points.length;t<i;t++){const n=e.points[t];this.points.push(n.clone())}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}toJSON(){const e=super.toJSON();e.points=[];for(let t=0,i=this.points.length;t<i;t++){const n=this.points[t];e.points.push(n.toArray())}return e.closed=this.closed,e.curveType=this.curveType,e.tension=this.tension,e}fromJSON(e){super.fromJSON(e),this.points=[];for(let t=0,i=e.points.length;t<i;t++){const n=e.points[t];this.points.push(new Z().fromArray(n))}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}}function Sv(r,e,t,i,n){const s=(i-e)*.5,a=(n-t)*.5,o=r*r,u=r*o;return(2*t-2*i+s+a)*u+(-3*t+3*i-2*s-a)*o+s*r+t}function nP(r,e){const t=1-r;return t*t*t*e}function sP(r,e){const t=1-r;return 3*t*t*r*e}function rP(r,e){return 3*(1-r)*r*r*e}function oP(r,e){return r*r*r*e}function Mv(r,e,t,i,n){return nP(r,e)+sP(r,t)+rP(r,i)+oP(r,n)}class aP extends Em{constructor(e=new Ue,t=new Ue,i=new Ue,n=new Ue){super(),this.isCubicBezierCurve=!0,this.type="CubicBezierCurve",this.v0=e,this.v1=t,this.v2=i,this.v3=n}getPoint(e,t=new Ue){const i=t,n=this.v0,s=this.v1,a=this.v2,o=this.v3;return i.set(Mv(e,n.x,s.x,a.x,o.x),Mv(e,n.y,s.y,a.y,o.y)),i}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}}class lP extends Em{constructor(e=[]){super(),this.isSplineCurve=!0,this.type="SplineCurve",this.points=e}getPoint(e,t=new Ue){const i=t,n=this.points,s=(n.length-1)*e,a=Math.floor(s),o=s-a,u=n[a===0?a:a-1],h=n[a],f=n[a>n.length-2?n.length-1:a+1],c=n[a>n.length-3?n.length-1:a+2];return i.set(Sv(o,u.x,h.x,f.x,c.x),Sv(o,u.y,h.y,f.y,c.y)),i}copy(e){super.copy(e),this.points=[];for(let t=0,i=e.points.length;t<i;t++){const n=e.points[t];this.points.push(n.clone())}return this}toJSON(){const e=super.toJSON();e.points=[];for(let t=0,i=this.points.length;t<i;t++){const n=this.points[t];e.points.push(n.toArray())}return e}fromJSON(e){super.fromJSON(e),this.points=[];for(let t=0,i=e.points.length;t<i;t++){const n=e.points[t];this.points.push(new Ue().fromArray(n))}return this}}class pd extends un{constructor(e=1,t=32,i=16,n=0,s=Math.PI*2,a=0,o=Math.PI){super(),this.type="SphereGeometry",this.parameters={radius:e,widthSegments:t,heightSegments:i,phiStart:n,phiLength:s,thetaStart:a,thetaLength:o},t=Math.max(3,Math.floor(t)),i=Math.max(2,Math.floor(i));const u=Math.min(a+o,Math.PI);let h=0;const f=[],c=new Z,d=new Z,m=[],x=[],_=[],b=[];for(let y=0;y<=i;y++){const M=[],D=y/i;let C=0;y==0&&a==0?C=.5/t:y==i&&u==Math.PI&&(C=-.5/t);for(let P=0;P<=t;P++){const I=P/t;c.x=-e*Math.cos(n+I*s)*Math.sin(a+D*o),c.y=e*Math.cos(a+D*o),c.z=e*Math.sin(n+I*s)*Math.sin(a+D*o),x.push(c.x,c.y,c.z),d.copy(c).normalize(),_.push(d.x,d.y,d.z),b.push(I+C,1-D),M.push(h++)}f.push(M)}for(let y=0;y<i;y++)for(let M=0;M<t;M++){const D=f[y][M+1],C=f[y][M],P=f[y+1][M],I=f[y+1][M+1];(y!==0||a>0)&&m.push(D,C,I),(y!==i-1||u<Math.PI)&&m.push(C,P,I)}this.setIndex(m),this.setAttribute("position",new xn(x,3)),this.setAttribute("normal",new xn(_,3)),this.setAttribute("uv",new xn(b,2))}static fromJSON(e){return new pd(e.radius,e.widthSegments,e.heightSegments,e.phiStart,e.phiLength,e.thetaStart,e.thetaLength)}}class cP extends fr{constructor(e){super(e),this.isRawShaderMaterial=!0,this.type="RawShaderMaterial"}}class fd extends ks{constructor(e){super(),this.isMeshStandardMaterial=!0,this.defines={STANDARD:""},this.type="MeshStandardMaterial",this.color=new pt(16777215),this.roughness=1,this.metalness=0,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new pt(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=ob,this.normalScale=new Ue(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapIntensity=1,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.defines={STANDARD:""},this.color.copy(e.color),this.roughness=e.roughness,this.metalness=e.metalness,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.roughnessMap=e.roughnessMap,this.metalnessMap=e.metalnessMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapIntensity=e.envMapIntensity,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class oa extends fd{constructor(e){super(),this.isMeshPhysicalMaterial=!0,this.defines={STANDARD:"",PHYSICAL:""},this.type="MeshPhysicalMaterial",this.clearcoatMap=null,this.clearcoatRoughness=0,this.clearcoatRoughnessMap=null,this.clearcoatNormalScale=new Ue(1,1),this.clearcoatNormalMap=null,this.ior=1.5,Object.defineProperty(this,"reflectivity",{get:function(){return Li(2.5*(this.ior-1)/(this.ior+1),0,1)},set:function(t){this.ior=(1+.4*t)/(1-.4*t)}}),this.iridescenceMap=null,this.iridescenceIOR=1.3,this.iridescenceThicknessRange=[100,400],this.iridescenceThicknessMap=null,this.sheenColor=new pt(0),this.sheenColorMap=null,this.sheenRoughness=1,this.sheenRoughnessMap=null,this.transmissionMap=null,this.thickness=0,this.thicknessMap=null,this.attenuationDistance=1/0,this.attenuationColor=new pt(1,1,1),this.specularIntensity=1,this.specularIntensityMap=null,this.specularColor=new pt(1,1,1),this.specularColorMap=null,this._sheen=0,this._clearcoat=0,this._iridescence=0,this._transmission=0,this.setValues(e)}get sheen(){return this._sheen}set sheen(e){this._sheen>0!=e>0&&this.version++,this._sheen=e}get clearcoat(){return this._clearcoat}set clearcoat(e){this._clearcoat>0!=e>0&&this.version++,this._clearcoat=e}get iridescence(){return this._iridescence}set iridescence(e){this._iridescence>0!=e>0&&this.version++,this._iridescence=e}get transmission(){return this._transmission}set transmission(e){this._transmission>0!=e>0&&this.version++,this._transmission=e}copy(e){return super.copy(e),this.defines={STANDARD:"",PHYSICAL:""},this.clearcoat=e.clearcoat,this.clearcoatMap=e.clearcoatMap,this.clearcoatRoughness=e.clearcoatRoughness,this.clearcoatRoughnessMap=e.clearcoatRoughnessMap,this.clearcoatNormalMap=e.clearcoatNormalMap,this.clearcoatNormalScale.copy(e.clearcoatNormalScale),this.ior=e.ior,this.iridescence=e.iridescence,this.iridescenceMap=e.iridescenceMap,this.iridescenceIOR=e.iridescenceIOR,this.iridescenceThicknessRange=[...e.iridescenceThicknessRange],this.iridescenceThicknessMap=e.iridescenceThicknessMap,this.sheen=e.sheen,this.sheenColor.copy(e.sheenColor),this.sheenColorMap=e.sheenColorMap,this.sheenRoughness=e.sheenRoughness,this.sheenRoughnessMap=e.sheenRoughnessMap,this.transmission=e.transmission,this.transmissionMap=e.transmissionMap,this.thickness=e.thickness,this.thicknessMap=e.thicknessMap,this.attenuationDistance=e.attenuationDistance,this.attenuationColor.copy(e.attenuationColor),this.specularIntensity=e.specularIntensity,this.specularIntensityMap=e.specularIntensityMap,this.specularColor.copy(e.specularColor),this.specularColorMap=e.specularColorMap,this}}function kr(r,e,t){return Cb(r)?new r.constructor(r.subarray(e,t!==void 0?t:r.length)):r.slice(e,t)}function ph(r,e,t){return!r||!t&&r.constructor===e?r:typeof e.BYTES_PER_ELEMENT=="number"?new e(r):Array.prototype.slice.call(r)}function Cb(r){return ArrayBuffer.isView(r)&&!(r instanceof DataView)}function uP(r){function e(n,s){return r[n]-r[s]}const t=r.length,i=new Array(t);for(let n=0;n!==t;++n)i[n]=n;return i.sort(e),i}function Tv(r,e,t){const i=r.length,n=new r.constructor(i);for(let s=0,a=0;a!==i;++s){const o=t[s]*e;for(let u=0;u!==e;++u)n[a++]=r[o+u]}return n}function Db(r,e,t,i){let n=1,s=r[0];for(;s!==void 0&&s[i]===void 0;)s=r[n++];if(s===void 0)return;let a=s[i];if(a!==void 0)if(Array.isArray(a))do a=s[i],a!==void 0&&(e.push(s.time),t.push.apply(t,a)),s=r[n++];while(s!==void 0);else if(a.toArray!==void 0)do a=s[i],a!==void 0&&(e.push(s.time),a.toArray(t,t.length)),s=r[n++];while(s!==void 0);else do a=s[i],a!==void 0&&(e.push(s.time),t.push(a)),s=r[n++];while(s!==void 0)}class pu{constructor(e,t,i,n){this.parameterPositions=e,this._cachedIndex=0,this.resultBuffer=n!==void 0?n:new t.constructor(i),this.sampleValues=t,this.valueSize=i,this.settings=null,this.DefaultSettings_={}}evaluate(e){const t=this.parameterPositions;let i=this._cachedIndex,n=t[i],s=t[i-1];i:{e:{let a;t:{n:if(!(e<n)){for(let o=i+2;;){if(n===void 0){if(e<s)break n;return i=t.length,this._cachedIndex=i,this.copySampleValue_(i-1)}if(i===o)break;if(s=n,n=t[++i],e<n)break e}a=t.length;break t}if(!(e>=s)){const o=t[1];e<o&&(i=2,s=o);for(let u=i-2;;){if(s===void 0)return this._cachedIndex=0,this.copySampleValue_(0);if(i===u)break;if(n=s,s=t[--i-1],e>=s)break e}a=i,i=0;break t}break i}for(;i<a;){const o=i+a>>>1;e<t[o]?a=o:i=o+1}if(n=t[i],s=t[i-1],s===void 0)return this._cachedIndex=0,this.copySampleValue_(0);if(n===void 0)return i=t.length,this._cachedIndex=i,this.copySampleValue_(i-1)}this._cachedIndex=i,this.intervalChanged_(i,s,n)}return this.interpolate_(i,s,e,n)}getSettings_(){return this.settings||this.DefaultSettings_}copySampleValue_(e){const t=this.resultBuffer,i=this.sampleValues,n=this.valueSize,s=e*n;for(let a=0;a!==n;++a)t[a]=i[s+a];return t}interpolate_(){throw new Error("call to abstract method")}intervalChanged_(){}}class hP extends pu{constructor(e,t,i,n){super(e,t,i,n),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0,this.DefaultSettings_={endingStart:E_,endingEnd:E_}}intervalChanged_(e,t,i){const n=this.parameterPositions;let s=e-2,a=e+1,o=n[s],u=n[a];if(o===void 0)switch(this.getSettings_().endingStart){case C_:s=e,o=2*t-i;break;case D_:s=n.length-2,o=t+n[s]-n[s+1];break;default:s=e,o=i}if(u===void 0)switch(this.getSettings_().endingEnd){case C_:a=e,u=2*i-t;break;case D_:a=1,u=i+n[1]-n[0];break;default:a=e-1,u=t}const h=(i-t)*.5,f=this.valueSize;this._weightPrev=h/(t-o),this._weightNext=h/(u-i),this._offsetPrev=s*f,this._offsetNext=a*f}interpolate_(e,t,i,n){const s=this.resultBuffer,a=this.sampleValues,o=this.valueSize,u=e*o,h=u-o,f=this._offsetPrev,c=this._offsetNext,d=this._weightPrev,m=this._weightNext,x=(i-t)/(n-t),_=x*x,b=_*x,y=-d*b+2*d*_-d*x,M=(1+d)*b+(-1.5-2*d)*_+(-.5+d)*x+1,D=(-1-m)*b+(1.5+m)*_+.5*x,C=m*b-m*_;for(let P=0;P!==o;++P)s[P]=y*a[f+P]+M*a[h+P]+D*a[u+P]+C*a[c+P];return s}}class dP extends pu{constructor(e,t,i,n){super(e,t,i,n)}interpolate_(e,t,i,n){const s=this.resultBuffer,a=this.sampleValues,o=this.valueSize,u=e*o,h=u-o,f=(i-t)/(n-t),c=1-f;for(let d=0;d!==o;++d)s[d]=a[h+d]*c+a[u+d]*f;return s}}class pP extends pu{constructor(e,t,i,n){super(e,t,i,n)}interpolate_(e){return this.copySampleValue_(e-1)}}class zs{constructor(e,t,i,n){if(e===void 0)throw new Error("THREE.KeyframeTrack: track name is undefined");if(t===void 0||t.length===0)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+e);this.name=e,this.times=ph(t,this.TimeBufferType),this.values=ph(i,this.ValueBufferType),this.setInterpolation(n||this.DefaultInterpolation)}static toJSON(e){const t=e.constructor;let i;if(t.toJSON!==this.toJSON)i=t.toJSON(e);else{i={name:e.name,times:ph(e.times,Array),values:ph(e.values,Array)};const n=e.getInterpolation();n!==e.DefaultInterpolation&&(i.interpolation=n)}return i.type=e.ValueTypeName,i}InterpolantFactoryMethodDiscrete(e){return new pP(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodLinear(e){return new dP(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodSmooth(e){return new hP(this.times,this.values,this.getValueSize(),e)}setInterpolation(e){let t;switch(e){case Hc:t=this.InterpolantFactoryMethodDiscrete;break;case cl:t=this.InterpolantFactoryMethodLinear;break;case mp:t=this.InterpolantFactoryMethodSmooth;break}if(t===void 0){const i="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(this.createInterpolant===void 0)if(e!==this.DefaultInterpolation)this.setInterpolation(this.DefaultInterpolation);else throw new Error(i);return console.warn("THREE.KeyframeTrack:",i),this}return this.createInterpolant=t,this}getInterpolation(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return Hc;case this.InterpolantFactoryMethodLinear:return cl;case this.InterpolantFactoryMethodSmooth:return mp}}getValueSize(){return this.values.length/this.times.length}shift(e){if(e!==0){const t=this.times;for(let i=0,n=t.length;i!==n;++i)t[i]+=e}return this}scale(e){if(e!==1){const t=this.times;for(let i=0,n=t.length;i!==n;++i)t[i]*=e}return this}trim(e,t){const i=this.times,n=i.length;let s=0,a=n-1;for(;s!==n&&i[s]<e;)++s;for(;a!==-1&&i[a]>t;)--a;if(++a,s!==0||a!==n){s>=a&&(a=Math.max(a,1),s=a-1);const o=this.getValueSize();this.times=kr(i,s,a),this.values=kr(this.values,s*o,a*o)}return this}validate(){let e=!0;const t=this.getValueSize();t-Math.floor(t)!==0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),e=!1);const i=this.times,n=this.values,s=i.length;s===0&&(console.error("THREE.KeyframeTrack: Track is empty.",this),e=!1);let a=null;for(let o=0;o!==s;o++){const u=i[o];if(typeof u=="number"&&isNaN(u)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,o,u),e=!1;break}if(a!==null&&a>u){console.error("THREE.KeyframeTrack: Out of order keys.",this,o,u,a),e=!1;break}a=u}if(n!==void 0&&Cb(n))for(let o=0,u=n.length;o!==u;++o){const h=n[o];if(isNaN(h)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,o,h),e=!1;break}}return e}optimize(){const e=kr(this.times),t=kr(this.values),i=this.getValueSize(),n=this.getInterpolation()===mp,s=e.length-1;let a=1;for(let o=1;o<s;++o){let u=!1;const h=e[o],f=e[o+1];if(h!==f&&(o!==1||h!==e[0]))if(n)u=!0;else{const c=o*i,d=c-i,m=c+i;for(let x=0;x!==i;++x){const _=t[c+x];if(_!==t[d+x]||_!==t[m+x]){u=!0;break}}}if(u){if(o!==a){e[a]=e[o];const c=o*i,d=a*i;for(let m=0;m!==i;++m)t[d+m]=t[c+m]}++a}}if(s>0){e[a]=e[s];for(let o=s*i,u=a*i,h=0;h!==i;++h)t[u+h]=t[o+h];++a}return a!==e.length?(this.times=kr(e,0,a),this.values=kr(t,0,a*i)):(this.times=e,this.values=t),this}clone(){const e=kr(this.times,0),t=kr(this.values,0),i=this.constructor,n=new i(this.name,e,t);return n.createInterpolant=this.createInterpolant,n}}zs.prototype.TimeBufferType=Float32Array;zs.prototype.ValueBufferType=Float32Array;zs.prototype.DefaultInterpolation=cl;class Dl extends zs{}Dl.prototype.ValueTypeName="bool";Dl.prototype.ValueBufferType=Array;Dl.prototype.DefaultInterpolation=Hc;Dl.prototype.InterpolantFactoryMethodLinear=void 0;Dl.prototype.InterpolantFactoryMethodSmooth=void 0;class Pb extends zs{}Pb.prototype.ValueTypeName="color";class Xc extends zs{}Xc.prototype.ValueTypeName="number";class fP extends pu{constructor(e,t,i,n){super(e,t,i,n)}interpolate_(e,t,i,n){const s=this.resultBuffer,a=this.sampleValues,o=this.valueSize,u=(i-t)/(n-t);let h=e*o;for(let f=h+o;h!==f;h+=4)vs.slerpFlat(s,0,a,h-o,a,h,u);return s}}class Zo extends zs{InterpolantFactoryMethodLinear(e){return new fP(this.times,this.values,this.getValueSize(),e)}}Zo.prototype.ValueTypeName="quaternion";Zo.prototype.DefaultInterpolation=cl;Zo.prototype.InterpolantFactoryMethodSmooth=void 0;class Pl extends zs{}Pl.prototype.ValueTypeName="string";Pl.prototype.ValueBufferType=Array;Pl.prototype.DefaultInterpolation=Hc;Pl.prototype.InterpolantFactoryMethodLinear=void 0;Pl.prototype.InterpolantFactoryMethodSmooth=void 0;class $c extends zs{}$c.prototype.ValueTypeName="vector";class mP{constructor(e,t=-1,i,n=AS){this.name=e,this.tracks=i,this.duration=t,this.blendMode=n,this.uuid=_s(),this.duration<0&&this.resetDuration()}static parse(e){const t=[],i=e.tracks,n=1/(e.fps||1);for(let a=0,o=i.length;a!==o;++a)t.push(_P(i[a]).scale(n));const s=new this(e.name,e.duration,t,e.blendMode);return s.uuid=e.uuid,s}static toJSON(e){const t=[],i=e.tracks,n={name:e.name,duration:e.duration,tracks:t,uuid:e.uuid,blendMode:e.blendMode};for(let s=0,a=i.length;s!==a;++s)t.push(zs.toJSON(i[s]));return n}static CreateFromMorphTargetSequence(e,t,i,n){const s=t.length,a=[];for(let o=0;o<s;o++){let u=[],h=[];u.push((o+s-1)%s,o,(o+1)%s),h.push(0,1,0);const f=uP(u);u=Tv(u,1,f),h=Tv(h,1,f),!n&&u[0]===0&&(u.push(s),h.push(h[0])),a.push(new Xc(".morphTargetInfluences["+t[o].name+"]",u,h).scale(1/i))}return new this(e,-1,a)}static findByName(e,t){let i=e;if(!Array.isArray(e)){const n=e;i=n.geometry&&n.geometry.animations||n.animations}for(let n=0;n<i.length;n++)if(i[n].name===t)return i[n];return null}static CreateClipsFromMorphTargetSequences(e,t,i){const n={},s=/^([\w-]*?)([\d]+)$/;for(let o=0,u=e.length;o<u;o++){const h=e[o],f=h.name.match(s);if(f&&f.length>1){const c=f[1];let d=n[c];d||(n[c]=d=[]),d.push(h)}}const a=[];for(const o in n)a.push(this.CreateFromMorphTargetSequence(o,n[o],t,i));return a}static parseAnimation(e,t){if(!e)return console.error("THREE.AnimationClip: No animation in JSONLoader data."),null;const i=function(c,d,m,x,_){if(m.length!==0){const b=[],y=[];Db(m,b,y,x),b.length!==0&&_.push(new c(d,b,y))}},n=[],s=e.name||"default",a=e.fps||30,o=e.blendMode;let u=e.length||-1;const h=e.hierarchy||[];for(let c=0;c<h.length;c++){const d=h[c].keys;if(!(!d||d.length===0))if(d[0].morphTargets){const m={};let x;for(x=0;x<d.length;x++)if(d[x].morphTargets)for(let _=0;_<d[x].morphTargets.length;_++)m[d[x].morphTargets[_]]=-1;for(const _ in m){const b=[],y=[];for(let M=0;M!==d[x].morphTargets.length;++M){const D=d[x];b.push(D.time),y.push(D.morphTarget===_?1:0)}n.push(new Xc(".morphTargetInfluence["+_+"]",b,y))}u=m.length*a}else{const m=".bones["+t[c].name+"]";i($c,m+".position",d,"pos",n),i(Zo,m+".quaternion",d,"rot",n),i($c,m+".scale",d,"scl",n)}}return n.length===0?null:new this(s,u,n,o)}resetDuration(){const e=this.tracks;let t=0;for(let i=0,n=e.length;i!==n;++i){const s=this.tracks[i];t=Math.max(t,s.times[s.times.length-1])}return this.duration=t,this}trim(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].trim(0,this.duration);return this}validate(){let e=!0;for(let t=0;t<this.tracks.length;t++)e=e&&this.tracks[t].validate();return e}optimize(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].optimize();return this}clone(){const e=[];for(let t=0;t<this.tracks.length;t++)e.push(this.tracks[t].clone());return new this.constructor(this.name,this.duration,e,this.blendMode)}toJSON(){return this.constructor.toJSON(this)}}function gP(r){switch(r.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return Xc;case"vector":case"vector2":case"vector3":case"vector4":return $c;case"color":return Pb;case"quaternion":return Zo;case"bool":case"boolean":return Dl;case"string":return Pl}throw new Error("THREE.KeyframeTrack: Unsupported typeName: "+r)}function _P(r){if(r.type===void 0)throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");const e=gP(r.type);if(r.times===void 0){const t=[],i=[];Db(r.keys,t,i,"value"),r.times=t,r.values=i}return e.parse!==void 0?e.parse(r):new e(r.name,r.times,r.values,r.interpolation)}const hl={enabled:!1,files:{},add:function(r,e){this.enabled!==!1&&(this.files[r]=e)},get:function(r){if(this.enabled!==!1)return this.files[r]},remove:function(r){delete this.files[r]},clear:function(){this.files={}}};class vP{constructor(e,t,i){const n=this;let s=!1,a=0,o=0,u;const h=[];this.onStart=void 0,this.onLoad=e,this.onProgress=t,this.onError=i,this.itemStart=function(f){o++,s===!1&&n.onStart!==void 0&&n.onStart(f,a,o),s=!0},this.itemEnd=function(f){a++,n.onProgress!==void 0&&n.onProgress(f,a,o),a===o&&(s=!1,n.onLoad!==void 0&&n.onLoad())},this.itemError=function(f){n.onError!==void 0&&n.onError(f)},this.resolveURL=function(f){return u?u(f):f},this.setURLModifier=function(f){return u=f,this},this.addHandler=function(f,c){return h.push(f,c),this},this.removeHandler=function(f){const c=h.indexOf(f);return c!==-1&&h.splice(c,2),this},this.getHandler=function(f){for(let c=0,d=h.length;c<d;c+=2){const m=h[c],x=h[c+1];if(m.global&&(m.lastIndex=0),m.test(f))return x}return null}}}const bP=new vP;class fu{constructor(e){this.manager=e!==void 0?e:bP,this.crossOrigin="anonymous",this.withCredentials=!1,this.path="",this.resourcePath="",this.requestHeader={}}load(){}loadAsync(e,t){const i=this;return new Promise(function(n,s){i.load(e,n,t,s)})}parse(){}setCrossOrigin(e){return this.crossOrigin=e,this}setWithCredentials(e){return this.withCredentials=e,this}setPath(e){return this.path=e,this}setResourcePath(e){return this.resourcePath=e,this}setRequestHeader(e){return this.requestHeader=e,this}}const Qs={};class xP extends Error{constructor(e,t){super(e),this.response=t}}class Ab extends fu{constructor(e){super(e)}load(e,t,i,n){e===void 0&&(e=""),this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);const s=hl.get(e);if(s!==void 0)return this.manager.itemStart(e),setTimeout(()=>{t&&t(s),this.manager.itemEnd(e)},0),s;if(Qs[e]!==void 0){Qs[e].push({onLoad:t,onProgress:i,onError:n});return}Qs[e]=[],Qs[e].push({onLoad:t,onProgress:i,onError:n});const a=new Request(e,{headers:new Headers(this.requestHeader),credentials:this.withCredentials?"include":"same-origin"}),o=this.mimeType,u=this.responseType;fetch(a).then(h=>{if(h.status===200||h.status===0){if(h.status===0&&console.warn("THREE.FileLoader: HTTP Status 0 received."),typeof ReadableStream>"u"||h.body===void 0||h.body.getReader===void 0)return h;const f=Qs[e],c=h.body.getReader(),d=h.headers.get("Content-Length")||h.headers.get("X-File-Size"),m=d?parseInt(d):0,x=m!==0;let _=0;const b=new ReadableStream({start(y){M();function M(){c.read().then(({done:D,value:C})=>{if(D)y.close();else{_+=C.byteLength;const P=new ProgressEvent("progress",{lengthComputable:x,loaded:_,total:m});for(let I=0,F=f.length;I<F;I++){const A=f[I];A.onProgress&&A.onProgress(P)}y.enqueue(C),M()}})}}});return new Response(b)}else throw new xP(`fetch for "${h.url}" responded with ${h.status}: ${h.statusText}`,h)}).then(h=>{switch(u){case"arraybuffer":return h.arrayBuffer();case"blob":return h.blob();case"document":return h.text().then(f=>new DOMParser().parseFromString(f,o));case"json":return h.json();default:if(o===void 0)return h.text();{const c=/charset="?([^;"\s]*)"?/i.exec(o),d=c&&c[1]?c[1].toLowerCase():void 0,m=new TextDecoder(d);return h.arrayBuffer().then(x=>m.decode(x))}}}).then(h=>{hl.add(e,h);const f=Qs[e];delete Qs[e];for(let c=0,d=f.length;c<d;c++){const m=f[c];m.onLoad&&m.onLoad(h)}}).catch(h=>{const f=Qs[e];if(f===void 0)throw this.manager.itemError(e),h;delete Qs[e];for(let c=0,d=f.length;c<d;c++){const m=f[c];m.onError&&m.onError(h)}this.manager.itemError(e)}).finally(()=>{this.manager.itemEnd(e)}),this.manager.itemStart(e)}setResponseType(e){return this.responseType=e,this}setMimeType(e){return this.mimeType=e,this}}class wP extends fu{constructor(e){super(e)}load(e,t,i,n){this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);const s=this,a=hl.get(e);if(a!==void 0)return s.manager.itemStart(e),setTimeout(function(){t&&t(a),s.manager.itemEnd(e)},0),a;const o=qc("img");function u(){f(),hl.add(e,this),t&&t(this),s.manager.itemEnd(e)}function h(c){f(),n&&n(c),s.manager.itemError(e),s.manager.itemEnd(e)}function f(){o.removeEventListener("load",u,!1),o.removeEventListener("error",h,!1)}return o.addEventListener("load",u,!1),o.addEventListener("error",h,!1),e.slice(0,5)!=="data:"&&this.crossOrigin!==void 0&&(o.crossOrigin=this.crossOrigin),s.manager.itemStart(e),o.src=e,o}}class Lb extends fu{constructor(e){super(e)}load(e,t,i,n){const s=new vi,a=new wP(this.manager);return a.setCrossOrigin(this.crossOrigin),a.setPath(this.path),a.load(e,function(o){s.image=o,s.needsUpdate=!0,t!==void 0&&t(s)},i,n),s}}class md extends ei{constructor(e,t=1){super(),this.isLight=!0,this.type="Light",this.color=new pt(e),this.intensity=t}dispose(){}copy(e,t){return super.copy(e,t),this.color.copy(e.color),this.intensity=e.intensity,this}toJSON(e){const t=super.toJSON(e);return t.object.color=this.color.getHex(),t.object.intensity=this.intensity,this.groundColor!==void 0&&(t.object.groundColor=this.groundColor.getHex()),this.distance!==void 0&&(t.object.distance=this.distance),this.angle!==void 0&&(t.object.angle=this.angle),this.decay!==void 0&&(t.object.decay=this.decay),this.penumbra!==void 0&&(t.object.penumbra=this.penumbra),this.shadow!==void 0&&(t.object.shadow=this.shadow.toJSON()),t}}const jp=new Pt,Ev=new Z,Cv=new Z;class Dm{constructor(e){this.camera=e,this.bias=0,this.normalBias=0,this.radius=1,this.blurSamples=8,this.mapSize=new Ue(512,512),this.map=null,this.mapPass=null,this.matrix=new Pt,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new xm,this._frameExtents=new Ue(1,1),this._viewportCount=1,this._viewports=[new $t(0,0,1,1)]}getViewportCount(){return this._viewportCount}getFrustum(){return this._frustum}updateMatrices(e){const t=this.camera,i=this.matrix;Ev.setFromMatrixPosition(e.matrixWorld),t.position.copy(Ev),Cv.setFromMatrixPosition(e.target.matrixWorld),t.lookAt(Cv),t.updateMatrixWorld(),jp.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),this._frustum.setFromProjectionMatrix(jp),i.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),i.multiply(jp)}getViewport(e){return this._viewports[e]}getFrameExtents(){return this._frameExtents}dispose(){this.map&&this.map.dispose(),this.mapPass&&this.mapPass.dispose()}copy(e){return this.camera=e.camera.clone(),this.bias=e.bias,this.radius=e.radius,this.mapSize.copy(e.mapSize),this}clone(){return new this.constructor().copy(this)}toJSON(){const e={};return this.bias!==0&&(e.bias=this.bias),this.normalBias!==0&&(e.normalBias=this.normalBias),this.radius!==1&&(e.radius=this.radius),(this.mapSize.x!==512||this.mapSize.y!==512)&&(e.mapSize=this.mapSize.toArray()),e.camera=this.camera.toJSON(!1).object,delete e.camera.matrix,e}}class yP extends Dm{constructor(){super(new Gi(50,1,.5,500)),this.isSpotLightShadow=!0,this.focus=1}updateMatrices(e){const t=this.camera,i=jc*2*e.angle*this.focus,n=this.mapSize.width/this.mapSize.height,s=e.distance||t.far;(i!==t.fov||n!==t.aspect||s!==t.far)&&(t.fov=i,t.aspect=n,t.far=s,t.updateProjectionMatrix()),super.updateMatrices(e)}copy(e){return super.copy(e),this.focus=e.focus,this}}class Rb extends md{constructor(e,t,i=0,n=Math.PI/3,s=0,a=2){super(e,t),this.isSpotLight=!0,this.type="SpotLight",this.position.copy(ei.DefaultUp),this.updateMatrix(),this.target=new ei,this.distance=i,this.angle=n,this.penumbra=s,this.decay=a,this.map=null,this.shadow=new yP}get power(){return this.intensity*Math.PI}set power(e){this.intensity=e/Math.PI}dispose(){this.shadow.dispose()}copy(e,t){return super.copy(e,t),this.distance=e.distance,this.angle=e.angle,this.penumbra=e.penumbra,this.decay=e.decay,this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}const Dv=new Pt,ac=new Z,qp=new Z;class SP extends Dm{constructor(){super(new Gi(90,1,.5,500)),this.isPointLightShadow=!0,this._frameExtents=new Ue(4,2),this._viewportCount=6,this._viewports=[new $t(2,1,1,1),new $t(0,1,1,1),new $t(3,1,1,1),new $t(1,1,1,1),new $t(3,0,1,1),new $t(1,0,1,1)],this._cubeDirections=[new Z(1,0,0),new Z(-1,0,0),new Z(0,0,1),new Z(0,0,-1),new Z(0,1,0),new Z(0,-1,0)],this._cubeUps=[new Z(0,1,0),new Z(0,1,0),new Z(0,1,0),new Z(0,1,0),new Z(0,0,1),new Z(0,0,-1)]}updateMatrices(e,t=0){const i=this.camera,n=this.matrix,s=e.distance||i.far;s!==i.far&&(i.far=s,i.updateProjectionMatrix()),ac.setFromMatrixPosition(e.matrixWorld),i.position.copy(ac),qp.copy(i.position),qp.add(this._cubeDirections[t]),i.up.copy(this._cubeUps[t]),i.lookAt(qp),i.updateMatrixWorld(),n.makeTranslation(-ac.x,-ac.y,-ac.z),Dv.multiplyMatrices(i.projectionMatrix,i.matrixWorldInverse),this._frustum.setFromProjectionMatrix(Dv)}}class MP extends md{constructor(e,t,i=0,n=2){super(e,t),this.isPointLight=!0,this.type="PointLight",this.distance=i,this.decay=n,this.shadow=new SP}get power(){return this.intensity*4*Math.PI}set power(e){this.intensity=e/(4*Math.PI)}dispose(){this.shadow.dispose()}copy(e,t){return super.copy(e,t),this.distance=e.distance,this.decay=e.decay,this.shadow=e.shadow.clone(),this}}class TP extends Dm{constructor(){super(new wm(-5,5,5,-5,.5,500)),this.isDirectionalLightShadow=!0}}class kb extends md{constructor(e,t){super(e,t),this.isDirectionalLight=!0,this.type="DirectionalLight",this.position.copy(ei.DefaultUp),this.updateMatrix(),this.target=new ei,this.shadow=new TP}dispose(){this.shadow.dispose()}copy(e){return super.copy(e),this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}class EP extends md{constructor(e,t){super(e,t),this.isAmbientLight=!0,this.type="AmbientLight"}}class zo{static decodeText(e){if(typeof TextDecoder<"u")return new TextDecoder().decode(e);let t="";for(let i=0,n=e.length;i<n;i++)t+=String.fromCharCode(e[i]);try{return decodeURIComponent(escape(t))}catch{return t}}static extractUrlBase(e){const t=e.lastIndexOf("/");return t===-1?"./":e.slice(0,t+1)}static resolveURL(e,t){return typeof e!="string"||e===""?"":(/^https?:\/\//i.test(t)&&/^\//.test(e)&&(t=t.replace(/(^https?:\/\/[^\/]+).*/i,"$1")),/^(https?:)?\/\//i.test(e)||/^data:.*,.*$/i.test(e)||/^blob:.*$/i.test(e)?e:t+e)}}class CP extends un{constructor(){super(),this.isInstancedBufferGeometry=!0,this.type="InstancedBufferGeometry",this.instanceCount=1/0}copy(e){return super.copy(e),this.instanceCount=e.instanceCount,this}toJSON(){const e=super.toJSON();return e.instanceCount=this.instanceCount,e.isInstancedBufferGeometry=!0,e}}class DP extends fu{constructor(e){super(e),this.isImageBitmapLoader=!0,typeof createImageBitmap>"u"&&console.warn("THREE.ImageBitmapLoader: createImageBitmap() not supported."),typeof fetch>"u"&&console.warn("THREE.ImageBitmapLoader: fetch() not supported."),this.options={premultiplyAlpha:"none"}}setOptions(e){return this.options=e,this}load(e,t,i,n){e===void 0&&(e=""),this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);const s=this,a=hl.get(e);if(a!==void 0)return s.manager.itemStart(e),setTimeout(function(){t&&t(a),s.manager.itemEnd(e)},0),a;const o={};o.credentials=this.crossOrigin==="anonymous"?"same-origin":"include",o.headers=this.requestHeader,fetch(e,o).then(function(u){return u.blob()}).then(function(u){return createImageBitmap(u,Object.assign(s.options,{colorSpaceConversion:"none"}))}).then(function(u){hl.add(e,u),t&&t(u),s.manager.itemEnd(e)}).catch(function(u){n&&n(u),s.manager.itemError(e),s.manager.itemEnd(e)}),s.manager.itemStart(e)}}class PP{constructor(e=!0){this.autoStart=e,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1}start(){this.startTime=Pv(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0}stop(){this.getElapsedTime(),this.running=!1,this.autoStart=!1}getElapsedTime(){return this.getDelta(),this.elapsedTime}getDelta(){let e=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){const t=Pv();e=(t-this.oldTime)/1e3,this.oldTime=t,this.elapsedTime+=e}return e}}function Pv(){return(typeof performance>"u"?Date:performance).now()}const Pm="\\[\\]\\.:\\/",AP=new RegExp("["+Pm+"]","g"),Am="[^"+Pm+"]",LP="[^"+Pm.replace("\\.","")+"]",RP=/((?:WC+[\/:])*)/.source.replace("WC",Am),kP=/(WCOD+)?/.source.replace("WCOD",LP),IP=/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",Am),FP=/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",Am),OP=new RegExp("^"+RP+kP+IP+FP+"$"),NP=["material","materials","bones","map"];class BP{constructor(e,t,i){const n=i||Ht.parseTrackName(t);this._targetGroup=e,this._bindings=e.subscribe_(t,n)}getValue(e,t){this.bind();const i=this._targetGroup.nCachedObjects_,n=this._bindings[i];n!==void 0&&n.getValue(e,t)}setValue(e,t){const i=this._bindings;for(let n=this._targetGroup.nCachedObjects_,s=i.length;n!==s;++n)i[n].setValue(e,t)}bind(){const e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,i=e.length;t!==i;++t)e[t].bind()}unbind(){const e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,i=e.length;t!==i;++t)e[t].unbind()}}class Ht{constructor(e,t,i){this.path=t,this.parsedPath=i||Ht.parseTrackName(t),this.node=Ht.findNode(e,this.parsedPath.nodeName)||e,this.rootNode=e,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}static create(e,t,i){return e&&e.isAnimationObjectGroup?new Ht.Composite(e,t,i):new Ht(e,t,i)}static sanitizeNodeName(e){return e.replace(/\s/g,"_").replace(AP,"")}static parseTrackName(e){const t=OP.exec(e);if(t===null)throw new Error("PropertyBinding: Cannot parse trackName: "+e);const i={nodeName:t[2],objectName:t[3],objectIndex:t[4],propertyName:t[5],propertyIndex:t[6]},n=i.nodeName&&i.nodeName.lastIndexOf(".");if(n!==void 0&&n!==-1){const s=i.nodeName.substring(n+1);NP.indexOf(s)!==-1&&(i.nodeName=i.nodeName.substring(0,n),i.objectName=s)}if(i.propertyName===null||i.propertyName.length===0)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+e);return i}static findNode(e,t){if(t===void 0||t===""||t==="."||t===-1||t===e.name||t===e.uuid)return e;if(e.skeleton){const i=e.skeleton.getBoneByName(t);if(i!==void 0)return i}if(e.children){const i=function(s){for(let a=0;a<s.length;a++){const o=s[a];if(o.name===t||o.uuid===t)return o;const u=i(o.children);if(u)return u}return null},n=i(e.children);if(n)return n}return null}_getValue_unavailable(){}_setValue_unavailable(){}_getValue_direct(e,t){e[t]=this.targetObject[this.propertyName]}_getValue_array(e,t){const i=this.resolvedProperty;for(let n=0,s=i.length;n!==s;++n)e[t++]=i[n]}_getValue_arrayElement(e,t){e[t]=this.resolvedProperty[this.propertyIndex]}_getValue_toArray(e,t){this.resolvedProperty.toArray(e,t)}_setValue_direct(e,t){this.targetObject[this.propertyName]=e[t]}_setValue_direct_setNeedsUpdate(e,t){this.targetObject[this.propertyName]=e[t],this.targetObject.needsUpdate=!0}_setValue_direct_setMatrixWorldNeedsUpdate(e,t){this.targetObject[this.propertyName]=e[t],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_array(e,t){const i=this.resolvedProperty;for(let n=0,s=i.length;n!==s;++n)i[n]=e[t++]}_setValue_array_setNeedsUpdate(e,t){const i=this.resolvedProperty;for(let n=0,s=i.length;n!==s;++n)i[n]=e[t++];this.targetObject.needsUpdate=!0}_setValue_array_setMatrixWorldNeedsUpdate(e,t){const i=this.resolvedProperty;for(let n=0,s=i.length;n!==s;++n)i[n]=e[t++];this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_arrayElement(e,t){this.resolvedProperty[this.propertyIndex]=e[t]}_setValue_arrayElement_setNeedsUpdate(e,t){this.resolvedProperty[this.propertyIndex]=e[t],this.targetObject.needsUpdate=!0}_setValue_arrayElement_setMatrixWorldNeedsUpdate(e,t){this.resolvedProperty[this.propertyIndex]=e[t],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_fromArray(e,t){this.resolvedProperty.fromArray(e,t)}_setValue_fromArray_setNeedsUpdate(e,t){this.resolvedProperty.fromArray(e,t),this.targetObject.needsUpdate=!0}_setValue_fromArray_setMatrixWorldNeedsUpdate(e,t){this.resolvedProperty.fromArray(e,t),this.targetObject.matrixWorldNeedsUpdate=!0}_getValue_unbound(e,t){this.bind(),this.getValue(e,t)}_setValue_unbound(e,t){this.bind(),this.setValue(e,t)}bind(){let e=this.node;const t=this.parsedPath,i=t.objectName,n=t.propertyName;let s=t.propertyIndex;if(e||(e=Ht.findNode(this.rootNode,t.nodeName)||this.rootNode,this.node=e),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,!e){console.error("THREE.PropertyBinding: Trying to update node for track: "+this.path+" but it wasn't found.");return}if(i){let h=t.objectIndex;switch(i){case"materials":if(!e.material){console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!e.material.materials){console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);return}e=e.material.materials;break;case"bones":if(!e.skeleton){console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);return}e=e.skeleton.bones;for(let f=0;f<e.length;f++)if(e[f].name===h){h=f;break}break;case"map":if("map"in e){e=e.map;break}if(!e.material){console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!e.material.map){console.error("THREE.PropertyBinding: Can not bind to material.map as node.material does not have a map.",this);return}e=e.material.map;break;default:if(e[i]===void 0){console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);return}e=e[i]}if(h!==void 0){if(e[h]===void 0){console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,e);return}e=e[h]}}const a=e[n];if(a===void 0){const h=t.nodeName;console.error("THREE.PropertyBinding: Trying to update property for track: "+h+"."+n+" but it wasn't found.",e);return}let o=this.Versioning.None;this.targetObject=e,e.needsUpdate!==void 0?o=this.Versioning.NeedsUpdate:e.matrixWorldNeedsUpdate!==void 0&&(o=this.Versioning.MatrixWorldNeedsUpdate);let u=this.BindingType.Direct;if(s!==void 0){if(n==="morphTargetInfluences"){if(!e.geometry){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);return}if(!e.geometry.morphAttributes){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);return}e.morphTargetDictionary[s]!==void 0&&(s=e.morphTargetDictionary[s])}u=this.BindingType.ArrayElement,this.resolvedProperty=a,this.propertyIndex=s}else a.fromArray!==void 0&&a.toArray!==void 0?(u=this.BindingType.HasFromToArray,this.resolvedProperty=a):Array.isArray(a)?(u=this.BindingType.EntireArray,this.resolvedProperty=a):this.propertyName=n;this.getValue=this.GetterByBindingType[u],this.setValue=this.SetterByBindingTypeAndVersioning[u][o]}unbind(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}Ht.Composite=BP;Ht.prototype.BindingType={Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3};Ht.prototype.Versioning={None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2};Ht.prototype.GetterByBindingType=[Ht.prototype._getValue_direct,Ht.prototype._getValue_array,Ht.prototype._getValue_arrayElement,Ht.prototype._getValue_toArray];Ht.prototype.SetterByBindingTypeAndVersioning=[[Ht.prototype._setValue_direct,Ht.prototype._setValue_direct_setNeedsUpdate,Ht.prototype._setValue_direct_setMatrixWorldNeedsUpdate],[Ht.prototype._setValue_array,Ht.prototype._setValue_array_setNeedsUpdate,Ht.prototype._setValue_array_setMatrixWorldNeedsUpdate],[Ht.prototype._setValue_arrayElement,Ht.prototype._setValue_arrayElement_setNeedsUpdate,Ht.prototype._setValue_arrayElement_setMatrixWorldNeedsUpdate],[Ht.prototype._setValue_fromArray,Ht.prototype._setValue_fromArray_setNeedsUpdate,Ht.prototype._setValue_fromArray_setMatrixWorldNeedsUpdate]];class VP{constructor(e,t,i=0,n=1/0){this.ray=new ud(e,t),this.near=i,this.far=n,this.camera=null,this.layers=new vm,this.params={Mesh:{},Line:{threshold:1},LOD:{},Points:{threshold:1},Sprite:{}}}set(e,t){this.ray.set(e,t)}setFromCamera(e,t){t.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(t.matrixWorld),this.ray.direction.set(e.x,e.y,.5).unproject(t).sub(this.ray.origin).normalize(),this.camera=t):t.isOrthographicCamera?(this.ray.origin.set(e.x,e.y,(t.near+t.far)/(t.near-t.far)).unproject(t),this.ray.direction.set(0,0,-1).transformDirection(t.matrixWorld),this.camera=t):console.error("THREE.Raycaster: Unsupported camera type: "+t.type)}intersectObject(e,t=!0,i=[]){return Rf(e,this,i,t),i.sort(Av),i}intersectObjects(e,t=!0,i=[]){for(let n=0,s=e.length;n<s;n++)Rf(e[n],this,i,t);return i.sort(Av),i}}function Av(r,e){return r.distance-e.distance}function Rf(r,e,t,i){if(r.layers.test(e.layers)&&r.raycast(e,t),i===!0){const n=r.children;for(let s=0,a=n.length;s<a;s++)Rf(n[s],e,t,!0)}}class Lv{constructor(e=1,t=0,i=0){return this.radius=e,this.phi=t,this.theta=i,this}set(e,t,i){return this.radius=e,this.phi=t,this.theta=i,this}copy(e){return this.radius=e.radius,this.phi=e.phi,this.theta=e.theta,this}makeSafe(){return this.phi=Math.max(1e-6,Math.min(Math.PI-1e-6,this.phi)),this}setFromVector3(e){return this.setFromCartesianCoords(e.x,e.y,e.z)}setFromCartesianCoords(e,t,i){return this.radius=Math.sqrt(e*e+t*t+i*i),this.radius===0?(this.theta=0,this.phi=0):(this.theta=Math.atan2(e,i),this.phi=Math.acos(Li(t/this.radius,-1,1))),this}clone(){return new this.constructor().copy(this)}}const fh=new Z,ui=new bm;class zP extends Mb{constructor(e){const t=new un,i=new hu({color:16777215,vertexColors:!0,toneMapped:!1}),n=[],s=[],a={};o("n1","n2"),o("n2","n4"),o("n4","n3"),o("n3","n1"),o("f1","f2"),o("f2","f4"),o("f4","f3"),o("f3","f1"),o("n1","f1"),o("n2","f2"),o("n3","f3"),o("n4","f4"),o("p","n1"),o("p","n2"),o("p","n3"),o("p","n4"),o("u1","u2"),o("u2","u3"),o("u3","u1"),o("c","t"),o("p","c"),o("cn1","cn2"),o("cn3","cn4"),o("cf1","cf2"),o("cf3","cf4");function o(x,_){u(x),u(_)}function u(x){n.push(0,0,0),s.push(0,0,0),a[x]===void 0&&(a[x]=[]),a[x].push(n.length/3-1)}t.setAttribute("position",new xn(n,3)),t.setAttribute("color",new xn(s,3)),super(t,i),this.type="CameraHelper",this.camera=e,this.camera.updateProjectionMatrix&&this.camera.updateProjectionMatrix(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.pointMap=a,this.update();const h=new pt(16755200),f=new pt(16711680),c=new pt(43775),d=new pt(16777215),m=new pt(3355443);this.setColors(h,f,c,d,m)}setColors(e,t,i,n,s){const o=this.geometry.getAttribute("color");o.setXYZ(0,e.r,e.g,e.b),o.setXYZ(1,e.r,e.g,e.b),o.setXYZ(2,e.r,e.g,e.b),o.setXYZ(3,e.r,e.g,e.b),o.setXYZ(4,e.r,e.g,e.b),o.setXYZ(5,e.r,e.g,e.b),o.setXYZ(6,e.r,e.g,e.b),o.setXYZ(7,e.r,e.g,e.b),o.setXYZ(8,e.r,e.g,e.b),o.setXYZ(9,e.r,e.g,e.b),o.setXYZ(10,e.r,e.g,e.b),o.setXYZ(11,e.r,e.g,e.b),o.setXYZ(12,e.r,e.g,e.b),o.setXYZ(13,e.r,e.g,e.b),o.setXYZ(14,e.r,e.g,e.b),o.setXYZ(15,e.r,e.g,e.b),o.setXYZ(16,e.r,e.g,e.b),o.setXYZ(17,e.r,e.g,e.b),o.setXYZ(18,e.r,e.g,e.b),o.setXYZ(19,e.r,e.g,e.b),o.setXYZ(20,e.r,e.g,e.b),o.setXYZ(21,e.r,e.g,e.b),o.setXYZ(22,e.r,e.g,e.b),o.setXYZ(23,e.r,e.g,e.b),o.setXYZ(24,t.r,t.g,t.b),o.setXYZ(25,t.r,t.g,t.b),o.setXYZ(26,t.r,t.g,t.b),o.setXYZ(27,t.r,t.g,t.b),o.setXYZ(28,t.r,t.g,t.b),o.setXYZ(29,t.r,t.g,t.b),o.setXYZ(30,t.r,t.g,t.b),o.setXYZ(31,t.r,t.g,t.b),o.setXYZ(32,i.r,i.g,i.b),o.setXYZ(33,i.r,i.g,i.b),o.setXYZ(34,i.r,i.g,i.b),o.setXYZ(35,i.r,i.g,i.b),o.setXYZ(36,i.r,i.g,i.b),o.setXYZ(37,i.r,i.g,i.b),o.setXYZ(38,n.r,n.g,n.b),o.setXYZ(39,n.r,n.g,n.b),o.setXYZ(40,s.r,s.g,s.b),o.setXYZ(41,s.r,s.g,s.b),o.setXYZ(42,s.r,s.g,s.b),o.setXYZ(43,s.r,s.g,s.b),o.setXYZ(44,s.r,s.g,s.b),o.setXYZ(45,s.r,s.g,s.b),o.setXYZ(46,s.r,s.g,s.b),o.setXYZ(47,s.r,s.g,s.b),o.setXYZ(48,s.r,s.g,s.b),o.setXYZ(49,s.r,s.g,s.b),o.needsUpdate=!0}update(){const e=this.geometry,t=this.pointMap,i=1,n=1;ui.projectionMatrixInverse.copy(this.camera.projectionMatrixInverse),di("c",t,e,ui,0,0,-1),di("t",t,e,ui,0,0,1),di("n1",t,e,ui,-i,-n,-1),di("n2",t,e,ui,i,-n,-1),di("n3",t,e,ui,-i,n,-1),di("n4",t,e,ui,i,n,-1),di("f1",t,e,ui,-i,-n,1),di("f2",t,e,ui,i,-n,1),di("f3",t,e,ui,-i,n,1),di("f4",t,e,ui,i,n,1),di("u1",t,e,ui,i*.7,n*1.1,-1),di("u2",t,e,ui,-i*.7,n*1.1,-1),di("u3",t,e,ui,0,n*2,-1),di("cf1",t,e,ui,-i,0,1),di("cf2",t,e,ui,i,0,1),di("cf3",t,e,ui,0,-n,1),di("cf4",t,e,ui,0,n,1),di("cn1",t,e,ui,-i,0,-1),di("cn2",t,e,ui,i,0,-1),di("cn3",t,e,ui,0,-n,-1),di("cn4",t,e,ui,0,n,-1),e.getAttribute("position").needsUpdate=!0}dispose(){this.geometry.dispose(),this.material.dispose()}}function di(r,e,t,i,n,s,a){fh.set(n,s,a).unproject(i);const o=e[r];if(o!==void 0){const u=t.getAttribute("position");for(let h=0,f=o.length;h<f;h++)u.setXYZ(o[h],fh.x,fh.y,fh.z)}}typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:gm}}));typeof window<"u"&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__=gm);const E={html:document.documentElement,body:document.body,window:{w:window.innerWidth,h:window.innerHeight,dpr:window.devicePixelRatio},keys:{UP:38,DOWN:40,ENTER:13,ESC:27,HOME:36,END:35},isTouch:!1,isIOS:["iPad Simulator","iPhone Simulator","iPod Simulator","iPad","iPhone","iPod"].includes(navigator.platform)||navigator.userAgent.includes("Mac")&&"ontouchend"in document,isAndroid:/(android)/i.test(navigator.userAgent),isDarkMode:!0,isSafari:/^((?!chrome|android).)*safari/i.test(navigator.userAgent),pointer:{x:0,y:0,isDragging:!1,gl:new Ue,glNormalized:new Ue},cookieNoticeAccepted:!1,staticComponents:null,components:null,ASS:null,Taxi:null,AssetLoader:null,RAFCollection:null,SmoothScroll:null,WebGL:null,urlParams:null,mq:{},pinType:"transform",isShyHeaderActive:!1,scrollToActive:!1,isHeaderHidden:!1};function cn(){if(!(this instanceof cn))return new cn;this.size=0,this.uid=0,this.selectors=[],this.selectorObjects={},this.indexes=Object.create(this.indexes),this.activeIndexes=[]}var lc=window.document.documentElement,UP=lc.matches||lc.webkitMatchesSelector||lc.mozMatchesSelector||lc.oMatchesSelector||lc.msMatchesSelector;cn.prototype.matchesSelector=function(r,e){return UP.call(r,e)};cn.prototype.querySelectorAll=function(r,e){return e.querySelectorAll(r)};cn.prototype.indexes=[];var GP=/^#((?:[\w\u00c0-\uFFFF\-]|\\.)+)/g;cn.prototype.indexes.push({name:"ID",selector:function(e){var t;if(t=e.match(GP))return t[0].slice(1)},element:function(e){if(e.id)return[e.id]}});var HP=/^\.((?:[\w\u00c0-\uFFFF\-]|\\.)+)/g;cn.prototype.indexes.push({name:"CLASS",selector:function(e){var t;if(t=e.match(HP))return t[0].slice(1)},element:function(e){var t=e.className;if(t){if(typeof t=="string")return t.split(/\s/);if(typeof t=="object"&&"baseVal"in t)return t.baseVal.split(/\s/)}}});var WP=/^((?:[\w\u00c0-\uFFFF\-]|\\.)+)/g;cn.prototype.indexes.push({name:"TAG",selector:function(e){var t;if(t=e.match(WP))return t[0].toUpperCase()},element:function(e){return[e.nodeName.toUpperCase()]}});cn.prototype.indexes.default={name:"UNIVERSAL",selector:function(){return!0},element:function(){return[!0]}};var kf;typeof window.Map=="function"?kf=window.Map:kf=function(){function r(){this.map={}}return r.prototype.get=function(e){return this.map[e+" "]},r.prototype.set=function(e,t){this.map[e+" "]=t},r}();var Rv=/((?:\((?:\([^()]+\)|[^()]+)+\)|\[(?:\[[^\[\]]*\]|['"][^'"]*['"]|[^\[\]'"]+)+\]|\\.|[^ >+~,(\[\\]+)+|[>+~])(\s*,\s*)?((?:.|\r|\n)*)/g;function Ib(r,e){r=r.slice(0).concat(r.default);var t=r.length,i,n,s,a,o=e,u,h,f=[];do if(Rv.exec(""),(s=Rv.exec(o))&&(o=s[3],s[2]||!o)){for(i=0;i<t;i++)if(h=r[i],u=h.selector(s[1])){for(n=f.length,a=!1;n--;)if(f[n].index===h&&f[n].key===u){a=!0;break}a||f.push({index:h,key:u});break}}while(s);return f}function jP(r,e){var t,i,n;for(t=0,i=r.length;t<i;t++)if(n=r[t],e.isPrototypeOf(n))return n}cn.prototype.logDefaultIndexUsed=function(){};cn.prototype.add=function(r,e){var t,i,n,s,a,o,u,h,f=this.activeIndexes,c=this.selectors,d=this.selectorObjects;if(typeof r=="string"){for(t={id:this.uid++,selector:r,data:e},d[t.id]=t,u=Ib(this.indexes,r),i=0;i<u.length;i++)h=u[i],s=h.key,n=h.index,a=jP(f,n),a||(a=Object.create(n),a.map=new kf,f.push(a)),n===this.indexes.default&&this.logDefaultIndexUsed(t),o=a.map.get(s),o||(o=[],a.map.set(s,o)),o.push(t);this.size++,c.push(r)}};cn.prototype.remove=function(r,e){if(typeof r=="string"){var t,i,n,s,a,o,u,h,f=this.activeIndexes,c=this.selectors=[],d=this.selectorObjects,m={},x=arguments.length===1;for(t=Ib(this.indexes,r),n=0;n<t.length;n++)for(i=t[n],s=f.length;s--;)if(o=f[s],i.index.isPrototypeOf(o)){if(u=o.map.get(i.key),u)for(a=u.length;a--;)h=u[a],h.selector===r&&(x||h.data===e)&&(u.splice(a,1),m[h.id]=!0);break}for(n in m)delete d[n],this.size--;for(n in d)c.push(d[n].selector)}};function Fb(r,e){return r.id-e.id}cn.prototype.queryAll=function(r){if(!this.selectors.length)return[];var e={},t=[],i=this.querySelectorAll(this.selectors.join(", "),r),n,s,a,o,u,h,f,c;for(n=0,a=i.length;n<a;n++)for(u=i[n],h=this.matches(u),s=0,o=h.length;s<o;s++)c=h[s],e[c.id]?f=e[c.id]:(f={id:c.id,selector:c.selector,data:c.data,elements:[]},e[c.id]=f,t.push(f)),f.elements.push(u);return t.sort(Fb)};cn.prototype.matches=function(r){if(!r)return[];var e,t,i,n,s,a,o,u,h,f,c,d=this.activeIndexes,m={},x=[];for(e=0,n=d.length;e<n;e++)if(o=d[e],u=o.element(r),u){for(t=0,s=u.length;t<s;t++)if(h=o.map.get(u[t]))for(i=0,a=h.length;i<a;i++)f=h[i],c=f.id,!m[c]&&this.matchesSelector(r,f.selector)&&(m[c]=!0,x.push(f))}return x.sort(Fb)};const Ga={},Ur={},If=["mouseenter","mouseleave","pointerenter","pointerleave","blur","focus"];function kv(r){Ur[r]===void 0&&(Ur[r]=new Set)}function qP(r,e){Ur[r]&&Ur[r].forEach(t=>{t(...e)})}function Iv(r){return typeof r=="string"?document.querySelectorAll(r):r}function mh(r){let e=XP(Ga[r.type],r.target);if(e.length)for(let t=0;t<e.length;t++)for(let i=0;i<e[t].stack.length;i++)If.indexOf(r.type)!==-1?(Fv(r,e[t].delegatedTarget),r.target===e[t].delegatedTarget&&e[t].stack[i].data(r)):(Fv(r,e[t].delegatedTarget),e[t].stack[i].data(r))}function XP(r,e){const t=[];let i=e;do{if(i.nodeType!==1)break;const n=r.matches(i);n.length&&t.push({delegatedTarget:i,stack:n})}while(i=i.parentElement);return t}function Fv(r,e){Object.defineProperty(r,"currentTarget",{configurable:!0,enumerable:!0,get:()=>e})}function $P(r){const e={};for(const t in r)e[t]=[...r[t]];return e}class YP{bindAll(e,t){t||(t=Object.getOwnPropertyNames(Object.getPrototypeOf(e)));for(let i=0;i<t.length;i++)e[t[i]]=e[t[i]].bind(e)}on(e,t,i,n){const s=e.split(" ");for(let a=0;a<s.length;a++){if(typeof t=="function"&&i===void 0){kv(s[a]),Ur[s[a]].add(t);continue}if(t.nodeType&&t.nodeType===1||t===window||t===document){t.addEventListener(s[a],i,n);continue}t=Iv(t);for(let o=0;o<t.length;o++)t[o].addEventListener(s[a],i,n)}}delegate(e,t,i){const n=e.split(" ");for(let s=0;s<n.length;s++){let a=Ga[n[s]];a===void 0&&(a=new cn,Ga[n[s]]=a,If.indexOf(n[s])!==-1?document.addEventListener(n[s],mh,!0):document.addEventListener(n[s],mh)),a.add(t,i)}}off(e,t,i,n){var a;const s=e.split(" ");for(let o=0;o<s.length;o++){if(t===void 0){(a=Ur[s[o]])==null||a.clear();continue}if(typeof t=="function"){kv(s[o]),Ur[s[o]].delete(t);continue}const u=Ga[s[o]];if(u!==void 0&&(u.remove(t,i),u.size===0)){delete Ga[s[o]],If.indexOf(s[o])!==-1?document.removeEventListener(s[o],mh,!0):document.removeEventListener(s[o],mh);continue}if(t.removeEventListener!==void 0){t.removeEventListener(s[o],i,n);continue}t=Iv(t);for(let h=0;h<t.length;h++)t[h].removeEventListener(s[o],i,n)}}emit(e,...t){qP(e,t)}debugDelegated(){return JSON.parse(JSON.stringify(Ga))}debugBus(){return $P(Ur)}hasBus(e){return this.debugBus().hasOwnProperty(e)}}const De=new YP,qe=class qe{static enablePointerEvents(){typeof qe.enabled.pointerEvents>"u"&&(qe.enabled.pointerEvents=!0,De.on("mousemove touchmove",window,D2(e=>qe.handleMousemove(e),16),{passive:!0}),De.on("mousedown touchstart",window,qe.handleMousedown),De.on("mouseup touchend",window,qe.handleMouseup))}static enableResize(e=!1){this.newHeight=E.window.h,this.newWidth=E.window.w,typeof qe.enabled.resize>"u"&&(qe.enabled.resize=!0,this.isFullscreen=window.outerWidth===window.screen.availWidth&&window.outerHeight===window.screen.availHeight,e?De.on("resize",window,C2(t=>qe.handleResize(t),e)):De.on("resize",window,qe.handleResize))}static enableRAF(e=null){typeof qe.enabled.raf>"u"&&(qe.enabled.raf=!0,E.RAFCollection=new PA,e?(qe.currentRafId=null,e.ticker.add(qe.handleRaf)):qe.currentRafId=window.requestAnimationFrame(qe.handleRaf))}static enableDrag(){typeof qe.enabled.drag>"u"&&(qe.enabled.drag=!0)}static handleMousemove(e){if(E.pointer.x=e.changedTouches?e.changedTouches[0].clientX:e.clientX,E.pointer.y=e.changedTouches?e.changedTouches[0].clientY:e.clientY,E.pointer.gl.set(E.pointer.x-E.window.w/2,-E.pointer.y+E.window.h/2),E.pointer.glNormalized.set(E.pointer.x/E.window.w*2-1,-(E.pointer.y/E.window.h)*2+1),e.changedTouches?De.emit(qe.TOUCHMOVE,e):De.emit(qe.MOUSEMOVE,e),E.pointer.isDragging){const t={deltaX:E.pointer.x-qe.dragInfo.px,deltaY:E.pointer.y-qe.dragInfo.py,startX:qe.dragInfo.x,startY:qe.dragInfo.y,totalX:E.pointer.x-qe.dragInfo.x,totalY:E.pointer.y-qe.dragInfo.y};De.emit(e.changedTouches?qe.TOUCHDRAG:qe.MOUSEDRAG,e,t),qe.dragInfo.px=E.pointer.x,qe.dragInfo.py=E.pointer.y}}static handleMousedown(e){if(e.type==="touchstart")this.stopMouseDown=!0;else{if(this.stopMouseDown){this.stopMouseDown=!1;return}this.stopMouseDown=!1}qe.handleMousemove(e),qe.enabled.drag&&(E.pointer.isDragging=!0,qe.dragInfo.x=qe.dragInfo.px=E.pointer.x,qe.dragInfo.y=qe.dragInfo.py=E.pointer.y),De.emit(qe.POINTERDOWN,e)}static handleMouseup(e){if(E.pointer.isDragging=!1,e.type==="touchend")this.stopMouseUp=!0;else{if(this.stopMouseUp){this.stopMouseUp=!1;return}this.stopMouseUp=!1}this.stopMouseDown=!1,qe.handleMousemove(e),qe.dragInfo={x:0,y:0,px:0,py:0},De.emit(qe.POINTERUP,e)}static handleResize(e){this.oldHeight=this.newHeight,this.oldWidth=this.newWidth,this.newHeight=window.innerHeight,this.newWidth=window.innerWidth;const t=this.oldHeight-this.newHeight;this.isFullscreen=window.outerWidth===window.screen.availWidth&&window.outerHeight===window.screen.availHeight,!(this.isFullscreen&&E.window.w===window.innerWidth)&&(E.isTouch&&E.window.w===window.innerWidth||t<50&&t>-50&&this.oldWidth===this.newWidth||(E.window.w=window.innerWidth,E.window.h=window.innerHeight,document.documentElement.style.setProperty("--vh",`${window.innerHeight*.01}px`),E.window.fullHeight=document.querySelector(".height-div").clientHeight,E.isIOS&&E.window.fullHeight===E.window.h&&(E.window.fullHeight*=1.2),De.emit(qe.RESIZE,e)))}static handleRaf(e){var t,i;(t=E.Gui)==null||t.perfBegin(),De.emit(qe.RAF,e),qe.currentRafId!==null&&(qe.currentRafId=window.requestAnimationFrame(qe.handleRaf)),(i=E.Gui)==null||i.perfEnd(qe.currentRafId===null?e*1e3:e)}static detectTouchDevice(){"ontouchstart"in document.documentElement&&(E.isTouch=!0,E.html.classList.add("is-touch"))}};q(qe,"MOUSEMOVE","global:mousemove"),q(qe,"TOUCHMOVE","global:touchmove"),q(qe,"MOUSEDRAG","global:mousedrag"),q(qe,"TOUCHDRAG","global:touchdrag"),q(qe,"POINTERMOVE",`${qe.MOUSEMOVE} ${qe.TOUCHMOVE}`),q(qe,"POINTERDRAG",`${qe.TOUCHDRAG} ${qe.MOUSEDRAG}`),q(qe,"POINTERDOWN","global:pointerdown"),q(qe,"POINTERUP","global:pointerup"),q(qe,"RAF","global:raf"),q(qe,"RESIZE","global:resize"),q(qe,"currentRafId",null),q(qe,"enabled",{}),q(qe,"dragInfo",{x:0,y:0,px:0,py:0}),q(qe,"stopMouseDown",!1),q(qe,"stopMouseUp",!1),q(qe,"isFullscreen",!1);let Je=qe;class $h{constructor(e){q(this,"components",[]);q(this,"args",[]);q(this,"negationSelector",null);if(e.selector===void 0)throw new Error(`The component "${e.name}" does not implement the selector property, or it is not available statically`);this.Component=e,this.inited=!1}init(e=document){if(this.inited)return this;if(this.inited=!0,this.Component.isSingleton){const i=st(this.Component.selector,e);return i&&(this.components=[new this.Component(i,...this.args)]),this}const t=ad(this.Component.selector,e);this.components=[];for(let i=0;i<t.length;i++)(this.negationSelector===null||t[i].matches(this.negationSelector)===!1)&&this.components.push(new this.Component(t[i],...this.args));return this}with(...e){return this.args=[...e],this}not(e){return this.negationSelector=e,this}make(e,...t){const i=new this.Component(e,...t);return this.components.push(i),i}get(e=null){return e!==null?this.components[e]||null:this.components}first(){return this.get(0)}forEach(e){for(let t=0;t<this.components.length;t++)e(this.components[t]);return this}callAll(e,...t){for(let i=0;i<this.components.length;i++)this.components[i][e](...t);return this}destroy(){return this.callAll("destroy"),this}reInit(){this.destroy(),this.inited=!1,this.init()}[Symbol.iterator](){return this.components.values()}}class Ln{static init(){document.location.hash&&Ln.focus(document.getElementById(window.location.hash.replace("#","")),!0),De.on("hashchange",window,()=>{Ln.focus(document.getElementById(window.location.hash.replace("#","")),!0)})}static isFocusable(e){return Element.prototype.matches||(Element.prototype.matches=Element.prototype.msMatchesSelector),e.matches("input:not([disabled]), a, button, textarea, select, iframe, object, [tabindex]")}static focusTrapElement(e){const t=e.parentNode,i=document.createElement("div");i.setAttribute("data-focus-trap","pre"),i.setAttribute("tabindex","0");const n=document.createElement("div");n.setAttribute("data-focus-trap","post"),n.setAttribute("tabindex","0"),De.on("focus",n,()=>this.focusFirstChild(e)),De.on("focus",i,()=>this.focusLastChild(e)),t.insertBefore(i,e),t.insertBefore(n,e.nextSibling)}static focusFirstChild(e){for(let t=0;t<e.children.length;t++){const i=e.children[t];if(Ln.focus(i)||Ln.focusFirstChild(i))return!0}return!1}static focusLastChild(e){for(let t=e.children.length-1;t>=0;t--){const i=e.children[t];if(Ln.focus(i)||Ln.focusLastChild(i))return!0}return!1}static focus(e,t=!1){if(e==null)return!1;t===!0&&Ln.isFocusable(e)===!1&&(e.setAttribute("tabindex","-1"),De.on("blur",e,Ln.removeTabIndex),De.on("focusout",e,Ln.removeTabIndex));try{e.focus()}catch{}return document.activeElement===e}static removeTabIndex(){this.removeAttribute("tabindex"),De.off("blur",this,Ln.removeTabIndex),De.off("focusout",this,Ln.removeTabIndex)}}class Ov{constructor(){q(this,"_store",{})}add(...e){for(let t=0;t<e.length;t++){if(e[t].negationSelector!==void 0){this._store[e[t].Component.name]=e[t].init();continue}if(e[t].selector){this._store[e[t].name]=new $h(e[t]).init();continue}this._store[e[t].constructor.name||e[t].name]=e[t]}}get(e){return typeof e=="string"?this._store[e]??null:this._store[e.name]??null}[Symbol.iterator](){return Object.values(this._store).values()}}class KP{constructor(e="AssetsProgress"){q(this,"progressCallback",e=>{De.emit(this.progressEventName,{percent:Math.floor(e)})});q(this,"retry",async(e,t=2)=>{try{return await e()}catch(i){if(t<=0)throw i;return this.retry(e,t-1)}});q(this,"loadJson",e=>(this.jsons[e]||(this.jsons[e]=this.add(new Promise((t,i)=>{fetch(e,{headers:{"Content-Type":"application/json"}}).then(n=>{n.ok?t(n.json()):i(new Error("Network response was not ok for request",{cause:{url:e,response:n}}))},i)}))),this.jsons[e]));this.promisesToLoad=[],this.fontsLoaded=!1,this.loaded=!1,this.progressEventName=e,this.jsons={}}load({element:e=document.body,progress:t=!0}={}){e&&(this.element=e,this.addFonts(),this.addMedia());let i=0;if(t)for(let n=0;n<this.promisesToLoad.length;n++)this.promisesToLoad[n].then(()=>{i++,this.progressCallback(i*100/this.promisesToLoad.length)}).catch(s=>{s instanceof Error?console.error(s.message,s.cause):console.error(s)});return this.loaded=new Promise(n=>{Promise.all(this.promisesToLoad).then(()=>{this.reset(),n()}).catch(s=>{s instanceof Error?console.error(s.message,s.cause):console.error(s)})}),this.loaded}add(e){return this.promisesToLoad.push(e),e}addMedia(){const e=this.element.querySelectorAll('img:not([lazy="full"])');for(let i=0;i<e.length;i++)(e[i].getAttribute("src")||e[i].dataset.src)&&this.addImage(e[i]);const t=this.element.querySelectorAll("video");for(let i=0;i<t.length;i++)(t[i].getAttribute("src")||t[i].dataset.src)&&this.addVideo(t[i])}addImage(e){return this.add(new Promise((t,i)=>{e.complete?e.naturalWidth!==0||e.currentSrc.includes("svg")?t(e):i(new Error("Image not loaded: element has no dimensions",{cause:e})):(e.addEventListener("load",()=>{t(e)},{once:!0}),e.addEventListener("error",n=>{i(new Error("Image not loaded",{cause:n}))},{once:!0}))}))}addVideo(e){const t=new Promise((i,n)=>{e.addEventListener("canplaythrough",()=>{e.addEventListener("timeupdate",()=>{e.pause(),e.currentTime=.05,i(e)},{once:!0})},{once:!0}),e.addEventListener("error",s=>{n(new Error("Video not loaded",{cause:s}))},{once:!0}),E.isSafari&&e.addEventListener("suspend",()=>{window.addEventListener("click",()=>{e.currentTime<.01&&(e.currentTime=.05)},{once:!0}),i()}),e.src===""&&e.dataset.src&&(e.src=e.dataset.src),e.load(),e.play().then(()=>i).catch(()=>i)});return this.add(t)}addFonts(){document.fonts&&this.add(document.fonts.ready),!this.fontsLoaded&&window.Typekit&&this.add(new Promise(e=>{window.Typekit.load({active:()=>{this.fontsLoaded=!0,e()}})}))}reset(){this.promisesToLoad=[]}}class ZP extends fu{constructor(e){super(e),this.dracoLoader=null,this.ktx2Loader=null,this.meshoptDecoder=null,this.pluginCallbacks=[],this.register(function(t){return new iA(t)}),this.register(function(t){return new cA(t)}),this.register(function(t){return new uA(t)}),this.register(function(t){return new sA(t)}),this.register(function(t){return new rA(t)}),this.register(function(t){return new oA(t)}),this.register(function(t){return new aA(t)}),this.register(function(t){return new tA(t)}),this.register(function(t){return new lA(t)}),this.register(function(t){return new nA(t)}),this.register(function(t){return new QP(t)}),this.register(function(t){return new hA(t)}),this.register(function(t){return new dA(t)})}load(e,t,i,n){const s=this;let a;this.resourcePath!==""?a=this.resourcePath:this.path!==""?a=this.path:a=zo.extractUrlBase(e),this.manager.itemStart(e);const o=function(h){n?n(h):console.error(h),s.manager.itemError(e),s.manager.itemEnd(e)},u=new Ab(this.manager);u.setPath(this.path),u.setResponseType("arraybuffer"),u.setRequestHeader(this.requestHeader),u.setWithCredentials(this.withCredentials),u.load(e,function(h){try{s.parse(h,a,function(f){t(f),s.manager.itemEnd(e)},o)}catch(f){o(f)}},i,o)}setDRACOLoader(e){return this.dracoLoader=e,this}setDDSLoader(){throw new Error('THREE.GLTFLoader: "MSFT_texture_dds" no longer supported. Please update to "KHR_texture_basisu".')}setKTX2Loader(e){return this.ktx2Loader=e,this}setMeshoptDecoder(e){return this.meshoptDecoder=e,this}register(e){return this.pluginCallbacks.indexOf(e)===-1&&this.pluginCallbacks.push(e),this}unregister(e){return this.pluginCallbacks.indexOf(e)!==-1&&this.pluginCallbacks.splice(this.pluginCallbacks.indexOf(e),1),this}parse(e,t,i,n){let s;const a={},o={};if(typeof e=="string")s=JSON.parse(e);else if(e instanceof ArrayBuffer)if(zo.decodeText(new Uint8Array(e,0,4))===Ob){try{a[Nt.KHR_BINARY_GLTF]=new pA(e)}catch(f){n&&n(f);return}s=JSON.parse(a[Nt.KHR_BINARY_GLTF].content)}else s=JSON.parse(zo.decodeText(new Uint8Array(e)));else s=e;if(s.asset===void 0||s.asset.version[0]<2){n&&n(new Error("THREE.GLTFLoader: Unsupported asset. glTF versions >=2.0 are supported."));return}const u=new EA(s,{path:t||this.resourcePath||"",crossOrigin:this.crossOrigin,requestHeader:this.requestHeader,manager:this.manager,ktx2Loader:this.ktx2Loader,meshoptDecoder:this.meshoptDecoder});u.fileLoader.setRequestHeader(this.requestHeader);for(let h=0;h<this.pluginCallbacks.length;h++){const f=this.pluginCallbacks[h](u);o[f.name]=f,a[f.name]=!0}if(s.extensionsUsed)for(let h=0;h<s.extensionsUsed.length;++h){const f=s.extensionsUsed[h],c=s.extensionsRequired||[];switch(f){case Nt.KHR_MATERIALS_UNLIT:a[f]=new eA;break;case Nt.KHR_DRACO_MESH_COMPRESSION:a[f]=new fA(s,this.dracoLoader);break;case Nt.KHR_TEXTURE_TRANSFORM:a[f]=new mA;break;case Nt.KHR_MESH_QUANTIZATION:a[f]=new gA;break;default:c.indexOf(f)>=0&&o[f]===void 0&&console.warn('THREE.GLTFLoader: Unknown extension "'+f+'".')}}u.setExtensions(a),u.setPlugins(o),u.parse(i,n)}parseAsync(e,t){const i=this;return new Promise(function(n,s){i.parse(e,t,n,s)})}}function JP(){let r={};return{get:function(e){return r[e]},add:function(e,t){r[e]=t},remove:function(e){delete r[e]},removeAll:function(){r={}}}}const Nt={KHR_BINARY_GLTF:"KHR_binary_glTF",KHR_DRACO_MESH_COMPRESSION:"KHR_draco_mesh_compression",KHR_LIGHTS_PUNCTUAL:"KHR_lights_punctual",KHR_MATERIALS_CLEARCOAT:"KHR_materials_clearcoat",KHR_MATERIALS_IOR:"KHR_materials_ior",KHR_MATERIALS_SHEEN:"KHR_materials_sheen",KHR_MATERIALS_SPECULAR:"KHR_materials_specular",KHR_MATERIALS_TRANSMISSION:"KHR_materials_transmission",KHR_MATERIALS_IRIDESCENCE:"KHR_materials_iridescence",KHR_MATERIALS_UNLIT:"KHR_materials_unlit",KHR_MATERIALS_VOLUME:"KHR_materials_volume",KHR_TEXTURE_BASISU:"KHR_texture_basisu",KHR_TEXTURE_TRANSFORM:"KHR_texture_transform",KHR_MESH_QUANTIZATION:"KHR_mesh_quantization",KHR_MATERIALS_EMISSIVE_STRENGTH:"KHR_materials_emissive_strength",EXT_TEXTURE_WEBP:"EXT_texture_webp",EXT_MESHOPT_COMPRESSION:"EXT_meshopt_compression",EXT_MESH_GPU_INSTANCING:"EXT_mesh_gpu_instancing"};class QP{constructor(e){this.parser=e,this.name=Nt.KHR_LIGHTS_PUNCTUAL,this.cache={refs:{},uses:{}}}_markDefs(){const e=this.parser,t=this.parser.json.nodes||[];for(let i=0,n=t.length;i<n;i++){const s=t[i];s.extensions&&s.extensions[this.name]&&s.extensions[this.name].light!==void 0&&e._addNodeRef(this.cache,s.extensions[this.name].light)}}_loadLight(e){const t=this.parser,i="light:"+e;let n=t.cache.get(i);if(n)return n;const s=t.json,u=((s.extensions&&s.extensions[this.name]||{}).lights||[])[e];let h;const f=new pt(16777215);u.color!==void 0&&f.fromArray(u.color);const c=u.range!==void 0?u.range:0;switch(u.type){case"directional":h=new kb(f),h.target.position.set(0,0,-1),h.add(h.target);break;case"point":h=new MP(f),h.distance=c;break;case"spot":h=new Rb(f),h.distance=c,u.spot=u.spot||{},u.spot.innerConeAngle=u.spot.innerConeAngle!==void 0?u.spot.innerConeAngle:0,u.spot.outerConeAngle=u.spot.outerConeAngle!==void 0?u.spot.outerConeAngle:Math.PI/4,h.angle=u.spot.outerConeAngle,h.penumbra=1-u.spot.innerConeAngle/u.spot.outerConeAngle,h.target.position.set(0,0,-1),h.add(h.target);break;default:throw new Error("THREE.GLTFLoader: Unexpected light type: "+u.type)}return h.position.set(0,0,0),h.decay=2,Vr(h,u),u.intensity!==void 0&&(h.intensity=u.intensity),h.name=t.createUniqueName(u.name||"light_"+e),n=Promise.resolve(h),t.cache.add(i,n),n}getDependency(e,t){if(e==="light")return this._loadLight(t)}createNodeAttachment(e){const t=this,i=this.parser,s=i.json.nodes[e],o=(s.extensions&&s.extensions[this.name]||{}).light;return o===void 0?null:this._loadLight(o).then(function(u){return i._getNodeRef(t.cache,o,u)})}}class eA{constructor(){this.name=Nt.KHR_MATERIALS_UNLIT}getMaterialType(){return ar}extendParams(e,t,i){const n=[];e.color=new pt(1,1,1),e.opacity=1;const s=t.pbrMetallicRoughness;if(s){if(Array.isArray(s.baseColorFactor)){const a=s.baseColorFactor;e.color.fromArray(a),e.opacity=a[3]}s.baseColorTexture!==void 0&&n.push(i.assignTexture(e,"map",s.baseColorTexture,Gt))}return Promise.all(n)}}class tA{constructor(e){this.parser=e,this.name=Nt.KHR_MATERIALS_EMISSIVE_STRENGTH}extendMaterialParams(e,t){const n=this.parser.json.materials[e];if(!n.extensions||!n.extensions[this.name])return Promise.resolve();const s=n.extensions[this.name].emissiveStrength;return s!==void 0&&(t.emissiveIntensity=s),Promise.resolve()}}class iA{constructor(e){this.parser=e,this.name=Nt.KHR_MATERIALS_CLEARCOAT}getMaterialType(e){const i=this.parser.json.materials[e];return!i.extensions||!i.extensions[this.name]?null:oa}extendMaterialParams(e,t){const i=this.parser,n=i.json.materials[e];if(!n.extensions||!n.extensions[this.name])return Promise.resolve();const s=[],a=n.extensions[this.name];if(a.clearcoatFactor!==void 0&&(t.clearcoat=a.clearcoatFactor),a.clearcoatTexture!==void 0&&s.push(i.assignTexture(t,"clearcoatMap",a.clearcoatTexture)),a.clearcoatRoughnessFactor!==void 0&&(t.clearcoatRoughness=a.clearcoatRoughnessFactor),a.clearcoatRoughnessTexture!==void 0&&s.push(i.assignTexture(t,"clearcoatRoughnessMap",a.clearcoatRoughnessTexture)),a.clearcoatNormalTexture!==void 0&&(s.push(i.assignTexture(t,"clearcoatNormalMap",a.clearcoatNormalTexture)),a.clearcoatNormalTexture.scale!==void 0)){const o=a.clearcoatNormalTexture.scale;t.clearcoatNormalScale=new Ue(o,o)}return Promise.all(s)}}class nA{constructor(e){this.parser=e,this.name=Nt.KHR_MATERIALS_IRIDESCENCE}getMaterialType(e){const i=this.parser.json.materials[e];return!i.extensions||!i.extensions[this.name]?null:oa}extendMaterialParams(e,t){const i=this.parser,n=i.json.materials[e];if(!n.extensions||!n.extensions[this.name])return Promise.resolve();const s=[],a=n.extensions[this.name];return a.iridescenceFactor!==void 0&&(t.iridescence=a.iridescenceFactor),a.iridescenceTexture!==void 0&&s.push(i.assignTexture(t,"iridescenceMap",a.iridescenceTexture)),a.iridescenceIor!==void 0&&(t.iridescenceIOR=a.iridescenceIor),t.iridescenceThicknessRange===void 0&&(t.iridescenceThicknessRange=[100,400]),a.iridescenceThicknessMinimum!==void 0&&(t.iridescenceThicknessRange[0]=a.iridescenceThicknessMinimum),a.iridescenceThicknessMaximum!==void 0&&(t.iridescenceThicknessRange[1]=a.iridescenceThicknessMaximum),a.iridescenceThicknessTexture!==void 0&&s.push(i.assignTexture(t,"iridescenceThicknessMap",a.iridescenceThicknessTexture)),Promise.all(s)}}class sA{constructor(e){this.parser=e,this.name=Nt.KHR_MATERIALS_SHEEN}getMaterialType(e){const i=this.parser.json.materials[e];return!i.extensions||!i.extensions[this.name]?null:oa}extendMaterialParams(e,t){const i=this.parser,n=i.json.materials[e];if(!n.extensions||!n.extensions[this.name])return Promise.resolve();const s=[];t.sheenColor=new pt(0,0,0),t.sheenRoughness=0,t.sheen=1;const a=n.extensions[this.name];return a.sheenColorFactor!==void 0&&t.sheenColor.fromArray(a.sheenColorFactor),a.sheenRoughnessFactor!==void 0&&(t.sheenRoughness=a.sheenRoughnessFactor),a.sheenColorTexture!==void 0&&s.push(i.assignTexture(t,"sheenColorMap",a.sheenColorTexture,Gt)),a.sheenRoughnessTexture!==void 0&&s.push(i.assignTexture(t,"sheenRoughnessMap",a.sheenRoughnessTexture)),Promise.all(s)}}class rA{constructor(e){this.parser=e,this.name=Nt.KHR_MATERIALS_TRANSMISSION}getMaterialType(e){const i=this.parser.json.materials[e];return!i.extensions||!i.extensions[this.name]?null:oa}extendMaterialParams(e,t){const i=this.parser,n=i.json.materials[e];if(!n.extensions||!n.extensions[this.name])return Promise.resolve();const s=[],a=n.extensions[this.name];return a.transmissionFactor!==void 0&&(t.transmission=a.transmissionFactor),a.transmissionTexture!==void 0&&s.push(i.assignTexture(t,"transmissionMap",a.transmissionTexture)),Promise.all(s)}}class oA{constructor(e){this.parser=e,this.name=Nt.KHR_MATERIALS_VOLUME}getMaterialType(e){const i=this.parser.json.materials[e];return!i.extensions||!i.extensions[this.name]?null:oa}extendMaterialParams(e,t){const i=this.parser,n=i.json.materials[e];if(!n.extensions||!n.extensions[this.name])return Promise.resolve();const s=[],a=n.extensions[this.name];t.thickness=a.thicknessFactor!==void 0?a.thicknessFactor:0,a.thicknessTexture!==void 0&&s.push(i.assignTexture(t,"thicknessMap",a.thicknessTexture)),t.attenuationDistance=a.attenuationDistance||1/0;const o=a.attenuationColor||[1,1,1];return t.attenuationColor=new pt(o[0],o[1],o[2]),Promise.all(s)}}class aA{constructor(e){this.parser=e,this.name=Nt.KHR_MATERIALS_IOR}getMaterialType(e){const i=this.parser.json.materials[e];return!i.extensions||!i.extensions[this.name]?null:oa}extendMaterialParams(e,t){const n=this.parser.json.materials[e];if(!n.extensions||!n.extensions[this.name])return Promise.resolve();const s=n.extensions[this.name];return t.ior=s.ior!==void 0?s.ior:1.5,Promise.resolve()}}class lA{constructor(e){this.parser=e,this.name=Nt.KHR_MATERIALS_SPECULAR}getMaterialType(e){const i=this.parser.json.materials[e];return!i.extensions||!i.extensions[this.name]?null:oa}extendMaterialParams(e,t){const i=this.parser,n=i.json.materials[e];if(!n.extensions||!n.extensions[this.name])return Promise.resolve();const s=[],a=n.extensions[this.name];t.specularIntensity=a.specularFactor!==void 0?a.specularFactor:1,a.specularTexture!==void 0&&s.push(i.assignTexture(t,"specularIntensityMap",a.specularTexture));const o=a.specularColorFactor||[1,1,1];return t.specularColor=new pt(o[0],o[1],o[2]),a.specularColorTexture!==void 0&&s.push(i.assignTexture(t,"specularColorMap",a.specularColorTexture,Gt)),Promise.all(s)}}class cA{constructor(e){this.parser=e,this.name=Nt.KHR_TEXTURE_BASISU}loadTexture(e){const t=this.parser,i=t.json,n=i.textures[e];if(!n.extensions||!n.extensions[this.name])return null;const s=n.extensions[this.name],a=t.options.ktx2Loader;if(!a){if(i.extensionsRequired&&i.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setKTX2Loader must be called before loading KTX2 textures");return null}return t.loadTextureImage(e,s.source,a)}}class uA{constructor(e){this.parser=e,this.name=Nt.EXT_TEXTURE_WEBP,this.isSupported=null}loadTexture(e){const t=this.name,i=this.parser,n=i.json,s=n.textures[e];if(!s.extensions||!s.extensions[t])return null;const a=s.extensions[t],o=n.images[a.source];let u=i.textureLoader;if(o.uri){const h=i.options.manager.getHandler(o.uri);h!==null&&(u=h)}return this.detectSupport().then(function(h){if(h)return i.loadTextureImage(e,a.source,u);if(n.extensionsRequired&&n.extensionsRequired.indexOf(t)>=0)throw new Error("THREE.GLTFLoader: WebP required by asset but unsupported.");return i.loadTexture(e)})}detectSupport(){return this.isSupported||(this.isSupported=new Promise(function(e){const t=new Image;t.src="data:image/webp;base64,UklGRiIAAABXRUJQVlA4IBYAAAAwAQCdASoBAAEADsD+JaQAA3AAAAAA",t.onload=t.onerror=function(){e(t.height===1)}})),this.isSupported}}class hA{constructor(e){this.name=Nt.EXT_MESHOPT_COMPRESSION,this.parser=e}loadBufferView(e){const t=this.parser.json,i=t.bufferViews[e];if(i.extensions&&i.extensions[this.name]){const n=i.extensions[this.name],s=this.parser.getDependency("buffer",n.buffer),a=this.parser.options.meshoptDecoder;if(!a||!a.supported){if(t.extensionsRequired&&t.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setMeshoptDecoder must be called before loading compressed files");return null}return s.then(function(o){const u=n.byteOffset||0,h=n.byteLength||0,f=n.count,c=n.byteStride,d=new Uint8Array(o,u,h);return a.decodeGltfBufferAsync?a.decodeGltfBufferAsync(f,c,d,n.mode,n.filter).then(function(m){return m.buffer}):a.ready.then(function(){const m=new ArrayBuffer(f*c);return a.decodeGltfBuffer(new Uint8Array(m),f,c,d,n.mode,n.filter),m})})}else return null}}class dA{constructor(e){this.name=Nt.EXT_MESH_GPU_INSTANCING,this.parser=e}createNodeMesh(e){const t=this.parser.json,i=t.nodes[e];if(!i.extensions||!i.extensions[this.name]||i.mesh===void 0)return null;const n=t.meshes[i.mesh];for(const h of n.primitives)if(h.mode!==Zn.TRIANGLES&&h.mode!==Zn.TRIANGLE_STRIP&&h.mode!==Zn.TRIANGLE_FAN&&h.mode!==void 0)return null;const a=i.extensions[this.name].attributes,o=[],u={};for(const h in a)o.push(this.parser.getDependency("accessor",a[h]).then(f=>(u[h]=f,u[h])));return o.length<1?null:(o.push(this.parser.createNodeMesh(e)),Promise.all(o).then(h=>{const f=h.pop(),c=f.isGroup?f.children:[f],d=h[0].count,m=[];for(const x of c){const _=new Pt,b=new Z,y=new vs,M=new Z(1,1,1),D=new Sb(x.geometry,x.material,d);for(let C=0;C<d;C++)u.TRANSLATION&&b.fromBufferAttribute(u.TRANSLATION,C),u.ROTATION&&y.fromBufferAttribute(u.ROTATION,C),u.SCALE&&M.fromBufferAttribute(u.SCALE,C),D.setMatrixAt(C,_.compose(b,y,M));for(const C in u)C!=="TRANSLATION"&&C!=="ROTATION"&&C!=="SCALE"&&x.geometry.setAttribute(C,u[C]);ei.prototype.copy.call(D,x),D.frustumCulled=!1,this.parser.assignFinalMaterial(D),m.push(D)}return f.isGroup?(f.clear(),f.add(...m),f):m[0]}))}}const Ob="glTF",cc=12,Nv={JSON:1313821514,BIN:5130562};class pA{constructor(e){this.name=Nt.KHR_BINARY_GLTF,this.content=null,this.body=null;const t=new DataView(e,0,cc);if(this.header={magic:zo.decodeText(new Uint8Array(e.slice(0,4))),version:t.getUint32(4,!0),length:t.getUint32(8,!0)},this.header.magic!==Ob)throw new Error("THREE.GLTFLoader: Unsupported glTF-Binary header.");if(this.header.version<2)throw new Error("THREE.GLTFLoader: Legacy binary file detected.");const i=this.header.length-cc,n=new DataView(e,cc);let s=0;for(;s<i;){const a=n.getUint32(s,!0);s+=4;const o=n.getUint32(s,!0);if(s+=4,o===Nv.JSON){const u=new Uint8Array(e,cc+s,a);this.content=zo.decodeText(u)}else if(o===Nv.BIN){const u=cc+s;this.body=e.slice(u,u+a)}s+=a}if(this.content===null)throw new Error("THREE.GLTFLoader: JSON content not found.")}}class fA{constructor(e,t){if(!t)throw new Error("THREE.GLTFLoader: No DRACOLoader instance provided.");this.name=Nt.KHR_DRACO_MESH_COMPRESSION,this.json=e,this.dracoLoader=t,this.dracoLoader.preload()}decodePrimitive(e,t){const i=this.json,n=this.dracoLoader,s=e.extensions[this.name].bufferView,a=e.extensions[this.name].attributes,o={},u={},h={};for(const f in a){const c=Ff[f]||f.toLowerCase();o[c]=a[f]}for(const f in e.attributes){const c=Ff[f]||f.toLowerCase();if(a[f]!==void 0){const d=i.accessors[e.attributes[f]],m=Qa[d.componentType];h[c]=m.name,u[c]=d.normalized===!0}}return t.getDependency("bufferView",s).then(function(f){return new Promise(function(c){n.decodeDracoFile(f,function(d){for(const m in d.attributes){const x=d.attributes[m],_=u[m];_!==void 0&&(x.normalized=_)}c(d)},o,h)})})}}class mA{constructor(){this.name=Nt.KHR_TEXTURE_TRANSFORM}extendTexture(e,t){return t.texCoord!==void 0&&console.warn('THREE.GLTFLoader: Custom UV sets in "'+this.name+'" extension not yet supported.'),t.offset===void 0&&t.rotation===void 0&&t.scale===void 0||(e=e.clone(),t.offset!==void 0&&e.offset.fromArray(t.offset),t.rotation!==void 0&&(e.rotation=t.rotation),t.scale!==void 0&&e.repeat.fromArray(t.scale),e.needsUpdate=!0),e}}class gA{constructor(){this.name=Nt.KHR_MESH_QUANTIZATION}}class Nb extends pu{constructor(e,t,i,n){super(e,t,i,n)}copySampleValue_(e){const t=this.resultBuffer,i=this.sampleValues,n=this.valueSize,s=e*n*3+n;for(let a=0;a!==n;a++)t[a]=i[s+a];return t}interpolate_(e,t,i,n){const s=this.resultBuffer,a=this.sampleValues,o=this.valueSize,u=o*2,h=o*3,f=n-t,c=(i-t)/f,d=c*c,m=d*c,x=e*h,_=x-h,b=-2*m+3*d,y=m-d,M=1-b,D=y-d+c;for(let C=0;C!==o;C++){const P=a[_+C+o],I=a[_+C+u]*f,F=a[x+C+o],A=a[x+C]*f;s[C]=M*P+D*I+b*F+y*A}return s}}const _A=new vs;class vA extends Nb{interpolate_(e,t,i,n){const s=super.interpolate_(e,t,i,n);return _A.fromArray(s).normalize().toArray(s),s}}const Zn={FLOAT:5126,FLOAT_MAT3:35675,FLOAT_MAT4:35676,FLOAT_VEC2:35664,FLOAT_VEC3:35665,FLOAT_VEC4:35666,LINEAR:9729,REPEAT:10497,SAMPLER_2D:35678,POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6,UNSIGNED_BYTE:5121,UNSIGNED_SHORT:5123},Qa={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},Bv={9728:Ai,9729:Ui,9984:Ef,9985:nb,9986:kh,9987:dr},Vv={33071:bn,33648:qh,10497:Kr},Xp={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},Ff={POSITION:"position",NORMAL:"normal",TANGENT:"tangent",TEXCOORD_0:"uv",TEXCOORD_1:"uv2",COLOR_0:"color",WEIGHTS_0:"skinWeight",JOINTS_0:"skinIndex"},Ir={scale:"scale",translation:"position",rotation:"quaternion",weights:"morphTargetInfluences"},bA={CUBICSPLINE:void 0,LINEAR:cl,STEP:Hc},$p={OPAQUE:"OPAQUE",MASK:"MASK",BLEND:"BLEND"};function xA(r){return r.DefaultMaterial===void 0&&(r.DefaultMaterial=new fd({color:16777215,emissive:0,metalness:1,roughness:1,transparent:!1,depthTest:!0,side:Ns})),r.DefaultMaterial}function uc(r,e,t){for(const i in t.extensions)r[i]===void 0&&(e.userData.gltfExtensions=e.userData.gltfExtensions||{},e.userData.gltfExtensions[i]=t.extensions[i])}function Vr(r,e){e.extras!==void 0&&(typeof e.extras=="object"?Object.assign(r.userData,e.extras):console.warn("THREE.GLTFLoader: Ignoring primitive type .extras, "+e.extras))}function wA(r,e,t){let i=!1,n=!1,s=!1;for(let h=0,f=e.length;h<f;h++){const c=e[h];if(c.POSITION!==void 0&&(i=!0),c.NORMAL!==void 0&&(n=!0),c.COLOR_0!==void 0&&(s=!0),i&&n&&s)break}if(!i&&!n&&!s)return Promise.resolve(r);const a=[],o=[],u=[];for(let h=0,f=e.length;h<f;h++){const c=e[h];if(i){const d=c.POSITION!==void 0?t.getDependency("accessor",c.POSITION):r.attributes.position;a.push(d)}if(n){const d=c.NORMAL!==void 0?t.getDependency("accessor",c.NORMAL):r.attributes.normal;o.push(d)}if(s){const d=c.COLOR_0!==void 0?t.getDependency("accessor",c.COLOR_0):r.attributes.color;u.push(d)}}return Promise.all([Promise.all(a),Promise.all(o),Promise.all(u)]).then(function(h){const f=h[0],c=h[1],d=h[2];return i&&(r.morphAttributes.position=f),n&&(r.morphAttributes.normal=c),s&&(r.morphAttributes.color=d),r.morphTargetsRelative=!0,r})}function yA(r,e){if(r.updateMorphTargets(),e.weights!==void 0)for(let t=0,i=e.weights.length;t<i;t++)r.morphTargetInfluences[t]=e.weights[t];if(e.extras&&Array.isArray(e.extras.targetNames)){const t=e.extras.targetNames;if(r.morphTargetInfluences.length===t.length){r.morphTargetDictionary={};for(let i=0,n=t.length;i<n;i++)r.morphTargetDictionary[t[i]]=i}else console.warn("THREE.GLTFLoader: Invalid extras.targetNames length. Ignoring names.")}}function SA(r){const e=r.extensions&&r.extensions[Nt.KHR_DRACO_MESH_COMPRESSION];let t;return e?t="draco:"+e.bufferView+":"+e.indices+":"+zv(e.attributes):t=r.indices+":"+zv(r.attributes)+":"+r.mode,t}function zv(r){let e="";const t=Object.keys(r).sort();for(let i=0,n=t.length;i<n;i++)e+=t[i]+":"+r[t[i]]+";";return e}function Of(r){switch(r){case Int8Array:return 1/127;case Uint8Array:return 1/255;case Int16Array:return 1/32767;case Uint16Array:return 1/65535;default:throw new Error("THREE.GLTFLoader: Unsupported normalized accessor component type.")}}function MA(r){return r.search(/\.jpe?g($|\?)/i)>0||r.search(/^data\:image\/jpeg/)===0?"image/jpeg":r.search(/\.webp($|\?)/i)>0||r.search(/^data\:image\/webp/)===0?"image/webp":"image/png"}const TA=new Pt;class EA{constructor(e={},t={}){this.json=e,this.extensions={},this.plugins={},this.options=t,this.cache=new JP,this.associations=new Map,this.primitiveCache={},this.meshCache={refs:{},uses:{}},this.cameraCache={refs:{},uses:{}},this.lightCache={refs:{},uses:{}},this.sourceCache={},this.textureCache={},this.nodeNamesUsed={};let i=!1,n=!1,s=-1;typeof navigator<"u"&&(i=/^((?!chrome|android).)*safari/i.test(navigator.userAgent)===!0,n=navigator.userAgent.indexOf("Firefox")>-1,s=n?navigator.userAgent.match(/Firefox\/([0-9]+)\./)[1]:-1),typeof createImageBitmap>"u"||i||n&&s<98?this.textureLoader=new Lb(this.options.manager):this.textureLoader=new DP(this.options.manager),this.textureLoader.setCrossOrigin(this.options.crossOrigin),this.textureLoader.setRequestHeader(this.options.requestHeader),this.fileLoader=new Ab(this.options.manager),this.fileLoader.setResponseType("arraybuffer"),this.options.crossOrigin==="use-credentials"&&this.fileLoader.setWithCredentials(!0)}setExtensions(e){this.extensions=e}setPlugins(e){this.plugins=e}parse(e,t){const i=this,n=this.json,s=this.extensions;this.cache.removeAll(),this._invokeAll(function(a){return a._markDefs&&a._markDefs()}),Promise.all(this._invokeAll(function(a){return a.beforeRoot&&a.beforeRoot()})).then(function(){return Promise.all([i.getDependencies("scene"),i.getDependencies("animation"),i.getDependencies("camera")])}).then(function(a){const o={scene:a[0][n.scene||0],scenes:a[0],animations:a[1],cameras:a[2],asset:n.asset,parser:i,userData:{}};uc(s,o,n),Vr(o,n),Promise.all(i._invokeAll(function(u){return u.afterRoot&&u.afterRoot(o)})).then(function(){e(o)})}).catch(t)}_markDefs(){const e=this.json.nodes||[],t=this.json.skins||[],i=this.json.meshes||[];for(let n=0,s=t.length;n<s;n++){const a=t[n].joints;for(let o=0,u=a.length;o<u;o++)e[a[o]].isBone=!0}for(let n=0,s=e.length;n<s;n++){const a=e[n];a.mesh!==void 0&&(this._addNodeRef(this.meshCache,a.mesh),a.skin!==void 0&&(i[a.mesh].isSkinnedMesh=!0)),a.camera!==void 0&&this._addNodeRef(this.cameraCache,a.camera)}}_addNodeRef(e,t){t!==void 0&&(e.refs[t]===void 0&&(e.refs[t]=e.uses[t]=0),e.refs[t]++)}_getNodeRef(e,t,i){if(e.refs[t]<=1)return i;const n=i.clone(),s=(a,o)=>{const u=this.associations.get(a);u!=null&&this.associations.set(o,u);for(const[h,f]of a.children.entries())s(f,o.children[h])};return s(i,n),n.name+="_instance_"+e.uses[t]++,n}_invokeOne(e){const t=Object.values(this.plugins);t.push(this);for(let i=0;i<t.length;i++){const n=e(t[i]);if(n)return n}return null}_invokeAll(e){const t=Object.values(this.plugins);t.unshift(this);const i=[];for(let n=0;n<t.length;n++){const s=e(t[n]);s&&i.push(s)}return i}getDependency(e,t){const i=e+":"+t;let n=this.cache.get(i);if(!n){switch(e){case"scene":n=this.loadScene(t);break;case"node":n=this._invokeOne(function(s){return s.loadNode&&s.loadNode(t)});break;case"mesh":n=this._invokeOne(function(s){return s.loadMesh&&s.loadMesh(t)});break;case"accessor":n=this.loadAccessor(t);break;case"bufferView":n=this._invokeOne(function(s){return s.loadBufferView&&s.loadBufferView(t)});break;case"buffer":n=this.loadBuffer(t);break;case"material":n=this._invokeOne(function(s){return s.loadMaterial&&s.loadMaterial(t)});break;case"texture":n=this._invokeOne(function(s){return s.loadTexture&&s.loadTexture(t)});break;case"skin":n=this.loadSkin(t);break;case"animation":n=this._invokeOne(function(s){return s.loadAnimation&&s.loadAnimation(t)});break;case"camera":n=this.loadCamera(t);break;default:if(n=this._invokeOne(function(s){return s!=this&&s.getDependency&&s.getDependency(e,t)}),!n)throw new Error("Unknown type: "+e);break}this.cache.add(i,n)}return n}getDependencies(e){let t=this.cache.get(e);if(!t){const i=this,n=this.json[e+(e==="mesh"?"es":"s")]||[];t=Promise.all(n.map(function(s,a){return i.getDependency(e,a)})),this.cache.add(e,t)}return t}loadBuffer(e){const t=this.json.buffers[e],i=this.fileLoader;if(t.type&&t.type!=="arraybuffer")throw new Error("THREE.GLTFLoader: "+t.type+" buffer type is not supported.");if(t.uri===void 0&&e===0)return Promise.resolve(this.extensions[Nt.KHR_BINARY_GLTF].body);const n=this.options;return new Promise(function(s,a){i.load(zo.resolveURL(t.uri,n.path),s,void 0,function(){a(new Error('THREE.GLTFLoader: Failed to load buffer "'+t.uri+'".'))})})}loadBufferView(e){const t=this.json.bufferViews[e];return this.getDependency("buffer",t.buffer).then(function(i){const n=t.byteLength||0,s=t.byteOffset||0;return i.slice(s,s+n)})}loadAccessor(e){const t=this,i=this.json,n=this.json.accessors[e];if(n.bufferView===void 0&&n.sparse===void 0){const a=Xp[n.type],o=Qa[n.componentType],u=n.normalized===!0,h=new o(n.count*a);return Promise.resolve(new ln(h,a,u))}const s=[];return n.bufferView!==void 0?s.push(this.getDependency("bufferView",n.bufferView)):s.push(null),n.sparse!==void 0&&(s.push(this.getDependency("bufferView",n.sparse.indices.bufferView)),s.push(this.getDependency("bufferView",n.sparse.values.bufferView))),Promise.all(s).then(function(a){const o=a[0],u=Xp[n.type],h=Qa[n.componentType],f=h.BYTES_PER_ELEMENT,c=f*u,d=n.byteOffset||0,m=n.bufferView!==void 0?i.bufferViews[n.bufferView].byteStride:void 0,x=n.normalized===!0;let _,b;if(m&&m!==c){const y=Math.floor(d/m),M="InterleavedBuffer:"+n.bufferView+":"+n.componentType+":"+y+":"+n.count;let D=t.cache.get(M);D||(_=new h(o,y*m,n.count*m/f),D=new YD(_,m/f),t.cache.add(M,D)),b=new Mm(D,u,d%m/f,x)}else o===null?_=new h(n.count*u):_=new h(o,d,n.count*u),b=new ln(_,u,x);if(n.sparse!==void 0){const y=Xp.SCALAR,M=Qa[n.sparse.indices.componentType],D=n.sparse.indices.byteOffset||0,C=n.sparse.values.byteOffset||0,P=new M(a[1],D,n.sparse.count*y),I=new h(a[2],C,n.sparse.count*u);o!==null&&(b=new ln(b.array.slice(),b.itemSize,b.normalized));for(let F=0,A=P.length;F<A;F++){const k=P[F];if(b.setX(k,I[F*u]),u>=2&&b.setY(k,I[F*u+1]),u>=3&&b.setZ(k,I[F*u+2]),u>=4&&b.setW(k,I[F*u+3]),u>=5)throw new Error("THREE.GLTFLoader: Unsupported itemSize in sparse BufferAttribute.")}}return b})}loadTexture(e){const t=this.json,i=this.options,s=t.textures[e].source,a=t.images[s];let o=this.textureLoader;if(a.uri){const u=i.manager.getHandler(a.uri);u!==null&&(o=u)}return this.loadTextureImage(e,s,o)}loadTextureImage(e,t,i){const n=this,s=this.json,a=s.textures[e],o=s.images[t],u=(o.uri||o.bufferView)+":"+a.sampler;if(this.textureCache[u])return this.textureCache[u];const h=this.loadImageSource(t,i).then(function(f){f.flipY=!1,f.name=a.name||o.name||"";const d=(s.samplers||{})[a.sampler]||{};return f.magFilter=Bv[d.magFilter]||Ui,f.minFilter=Bv[d.minFilter]||dr,f.wrapS=Vv[d.wrapS]||Kr,f.wrapT=Vv[d.wrapT]||Kr,n.associations.set(f,{textures:e}),f}).catch(function(){return null});return this.textureCache[u]=h,h}loadImageSource(e,t){const i=this,n=this.json,s=this.options;if(this.sourceCache[e]!==void 0)return this.sourceCache[e].then(c=>c.clone());const a=n.images[e],o=self.URL||self.webkitURL;let u=a.uri||"",h=!1;if(a.bufferView!==void 0)u=i.getDependency("bufferView",a.bufferView).then(function(c){h=!0;const d=new Blob([c],{type:a.mimeType});return u=o.createObjectURL(d),u});else if(a.uri===void 0)throw new Error("THREE.GLTFLoader: Image "+e+" is missing URI and bufferView");const f=Promise.resolve(u).then(function(c){return new Promise(function(d,m){let x=d;t.isImageBitmapLoader===!0&&(x=function(_){const b=new vi(_);b.needsUpdate=!0,d(b)}),t.load(zo.resolveURL(c,s.path),x,void 0,m)})}).then(function(c){return h===!0&&o.revokeObjectURL(u),c.userData.mimeType=a.mimeType||MA(a.uri),c}).catch(function(c){throw console.error("THREE.GLTFLoader: Couldn't load texture",u),c});return this.sourceCache[e]=f,f}assignTexture(e,t,i,n){const s=this;return this.getDependency("texture",i.index).then(function(a){if(!a)return null;if(i.texCoord!==void 0&&i.texCoord!=0&&!(t==="aoMap"&&i.texCoord==1)&&console.warn("THREE.GLTFLoader: Custom UV set "+i.texCoord+" for texture "+t+" not yet supported."),s.extensions[Nt.KHR_TEXTURE_TRANSFORM]){const o=i.extensions!==void 0?i.extensions[Nt.KHR_TEXTURE_TRANSFORM]:void 0;if(o){const u=s.associations.get(a);a=s.extensions[Nt.KHR_TEXTURE_TRANSFORM].extendTexture(a,o),s.associations.set(a,u)}}return n!==void 0&&(a.encoding=n),e[t]=a,a})}assignFinalMaterial(e){const t=e.geometry;let i=e.material;const n=t.attributes.tangent===void 0,s=t.attributes.color!==void 0,a=t.attributes.normal===void 0;if(e.isPoints){const o="PointsMaterial:"+i.uuid;let u=this.cache.get(o);u||(u=new Tb,ks.prototype.copy.call(u,i),u.color.copy(i.color),u.map=i.map,u.sizeAttenuation=!1,this.cache.add(o,u)),i=u}else if(e.isLine){const o="LineBasicMaterial:"+i.uuid;let u=this.cache.get(o);u||(u=new hu,ks.prototype.copy.call(u,i),u.color.copy(i.color),this.cache.add(o,u)),i=u}if(n||s||a){let o="ClonedMaterial:"+i.uuid+":";n&&(o+="derivative-tangents:"),s&&(o+="vertex-colors:"),a&&(o+="flat-shading:");let u=this.cache.get(o);u||(u=i.clone(),s&&(u.vertexColors=!0),a&&(u.flatShading=!0),n&&(u.normalScale&&(u.normalScale.y*=-1),u.clearcoatNormalScale&&(u.clearcoatNormalScale.y*=-1)),this.cache.add(o,u),this.associations.set(u,this.associations.get(i))),i=u}i.aoMap&&t.attributes.uv2===void 0&&t.attributes.uv!==void 0&&t.setAttribute("uv2",t.attributes.uv),e.material=i}getMaterialType(){return fd}loadMaterial(e){const t=this,i=this.json,n=this.extensions,s=i.materials[e];let a;const o={},u=s.extensions||{},h=[];if(u[Nt.KHR_MATERIALS_UNLIT]){const c=n[Nt.KHR_MATERIALS_UNLIT];a=c.getMaterialType(),h.push(c.extendParams(o,s,t))}else{const c=s.pbrMetallicRoughness||{};if(o.color=new pt(1,1,1),o.opacity=1,Array.isArray(c.baseColorFactor)){const d=c.baseColorFactor;o.color.fromArray(d),o.opacity=d[3]}c.baseColorTexture!==void 0&&h.push(t.assignTexture(o,"map",c.baseColorTexture,Gt)),o.metalness=c.metallicFactor!==void 0?c.metallicFactor:1,o.roughness=c.roughnessFactor!==void 0?c.roughnessFactor:1,c.metallicRoughnessTexture!==void 0&&(h.push(t.assignTexture(o,"metalnessMap",c.metallicRoughnessTexture)),h.push(t.assignTexture(o,"roughnessMap",c.metallicRoughnessTexture))),a=this._invokeOne(function(d){return d.getMaterialType&&d.getMaterialType(e)}),h.push(Promise.all(this._invokeAll(function(d){return d.extendMaterialParams&&d.extendMaterialParams(e,o)})))}s.doubleSided===!0&&(o.side=lu);const f=s.alphaMode||$p.OPAQUE;if(f===$p.BLEND?(o.transparent=!0,o.depthWrite=!1):(o.transparent=!1,f===$p.MASK&&(o.alphaTest=s.alphaCutoff!==void 0?s.alphaCutoff:.5)),s.normalTexture!==void 0&&a!==ar&&(h.push(t.assignTexture(o,"normalMap",s.normalTexture)),o.normalScale=new Ue(1,1),s.normalTexture.scale!==void 0)){const c=s.normalTexture.scale;o.normalScale.set(c,c)}return s.occlusionTexture!==void 0&&a!==ar&&(h.push(t.assignTexture(o,"aoMap",s.occlusionTexture)),s.occlusionTexture.strength!==void 0&&(o.aoMapIntensity=s.occlusionTexture.strength)),s.emissiveFactor!==void 0&&a!==ar&&(o.emissive=new pt().fromArray(s.emissiveFactor)),s.emissiveTexture!==void 0&&a!==ar&&h.push(t.assignTexture(o,"emissiveMap",s.emissiveTexture,Gt)),Promise.all(h).then(function(){const c=new a(o);return s.name&&(c.name=s.name),Vr(c,s),t.associations.set(c,{materials:e}),s.extensions&&uc(n,c,s),c})}createUniqueName(e){const t=Ht.sanitizeNodeName(e||"");let i=t;for(let n=1;this.nodeNamesUsed[i];++n)i=t+"_"+n;return this.nodeNamesUsed[i]=!0,i}loadGeometries(e){const t=this,i=this.extensions,n=this.primitiveCache;function s(o){return i[Nt.KHR_DRACO_MESH_COMPRESSION].decodePrimitive(o,t).then(function(u){return Uv(u,o,t)})}const a=[];for(let o=0,u=e.length;o<u;o++){const h=e[o],f=SA(h),c=n[f];if(c)a.push(c.promise);else{let d;h.extensions&&h.extensions[Nt.KHR_DRACO_MESH_COMPRESSION]?d=s(h):d=Uv(new un,h,t),n[f]={primitive:h,promise:d},a.push(d)}}return Promise.all(a)}loadMesh(e){const t=this,i=this.json,n=this.extensions,s=i.meshes[e],a=s.primitives,o=[];for(let u=0,h=a.length;u<h;u++){const f=a[u].material===void 0?xA(this.cache):this.getDependency("material",a[u].material);o.push(f)}return o.push(t.loadGeometries(a)),Promise.all(o).then(function(u){const h=u.slice(0,u.length-1),f=u[u.length-1],c=[];for(let m=0,x=f.length;m<x;m++){const _=f[m],b=a[m];let y;const M=h[m];if(b.mode===Zn.TRIANGLES||b.mode===Zn.TRIANGLE_STRIP||b.mode===Zn.TRIANGLE_FAN||b.mode===void 0)y=s.isSkinnedMesh===!0?new ZD(_,M):new Wi(_,M),y.isSkinnedMesh===!0&&!y.geometry.attributes.skinWeight.normalized&&y.normalizeSkinWeights(),b.mode===Zn.TRIANGLE_STRIP?y.geometry=Gv(y.geometry,LS):b.mode===Zn.TRIANGLE_FAN&&(y.geometry=Gv(y.geometry,rb));else if(b.mode===Zn.LINES)y=new Mb(_,M);else if(b.mode===Zn.LINE_STRIP)y=new du(_,M);else if(b.mode===Zn.LINE_LOOP)y=new tP(_,M);else if(b.mode===Zn.POINTS)y=new iP(_,M);else throw new Error("THREE.GLTFLoader: Primitive mode unsupported: "+b.mode);Object.keys(y.geometry.morphAttributes).length>0&&yA(y,s),y.name=t.createUniqueName(s.name||"mesh_"+e),Vr(y,s),b.extensions&&uc(n,y,b),t.assignFinalMaterial(y),c.push(y)}for(let m=0,x=c.length;m<x;m++)t.associations.set(c[m],{meshes:e,primitives:m});if(c.length===1)return c[0];const d=new ts;t.associations.set(d,{meshes:e});for(let m=0,x=c.length;m<x;m++)d.add(c[m]);return d})}loadCamera(e){let t;const i=this.json.cameras[e],n=i[i.type];if(!n){console.warn("THREE.GLTFLoader: Missing camera parameters.");return}return i.type==="perspective"?t=new Gi(No.radToDeg(n.yfov),n.aspectRatio||1,n.znear||1,n.zfar||2e6):i.type==="orthographic"&&(t=new wm(-n.xmag,n.xmag,n.ymag,-n.ymag,n.znear,n.zfar)),i.name&&(t.name=this.createUniqueName(i.name)),Vr(t,i),Promise.resolve(t)}loadSkin(e){const t=this.json.skins[e],i=[];for(let n=0,s=t.joints.length;n<s;n++)i.push(this.getDependency("node",t.joints[n]));return t.inverseBindMatrices!==void 0?i.push(this.getDependency("accessor",t.inverseBindMatrices)):i.push(null),Promise.all(i).then(function(n){const s=n.pop(),a=n,o=[],u=[];for(let h=0,f=a.length;h<f;h++){const c=a[h];if(c){o.push(c);const d=new Pt;s!==null&&d.fromArray(s.array,h*16),u.push(d)}else console.warn('THREE.GLTFLoader: Joint "%s" could not be found.',t.joints[h])}return new Tm(o,u)})}loadAnimation(e){const i=this.json.animations[e],n=[],s=[],a=[],o=[],u=[];for(let h=0,f=i.channels.length;h<f;h++){const c=i.channels[h],d=i.samplers[c.sampler],m=c.target,x=m.node,_=i.parameters!==void 0?i.parameters[d.input]:d.input,b=i.parameters!==void 0?i.parameters[d.output]:d.output;n.push(this.getDependency("node",x)),s.push(this.getDependency("accessor",_)),a.push(this.getDependency("accessor",b)),o.push(d),u.push(m)}return Promise.all([Promise.all(n),Promise.all(s),Promise.all(a),Promise.all(o),Promise.all(u)]).then(function(h){const f=h[0],c=h[1],d=h[2],m=h[3],x=h[4],_=[];for(let y=0,M=f.length;y<M;y++){const D=f[y],C=c[y],P=d[y],I=m[y],F=x[y];if(D===void 0)continue;D.updateMatrix();let A;switch(Ir[F.path]){case Ir.weights:A=Xc;break;case Ir.rotation:A=Zo;break;case Ir.position:case Ir.scale:default:A=$c;break}const k=D.name?D.name:D.uuid,O=I.interpolation!==void 0?bA[I.interpolation]:cl,J=[];Ir[F.path]===Ir.weights?D.traverse(function(X){X.morphTargetInfluences&&J.push(X.name?X.name:X.uuid)}):J.push(k);let Q=P.array;if(P.normalized){const X=Of(Q.constructor),j=new Float32Array(Q.length);for(let K=0,ie=Q.length;K<ie;K++)j[K]=Q[K]*X;Q=j}for(let X=0,j=J.length;X<j;X++){const K=new A(J[X]+"."+Ir[F.path],C.array,Q,O);I.interpolation==="CUBICSPLINE"&&(K.createInterpolant=function(ee){const V=this instanceof Zo?vA:Nb;return new V(this.times,this.values,this.getValueSize()/3,ee)},K.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline=!0),_.push(K)}}const b=i.name?i.name:"animation_"+e;return new mP(b,void 0,_)})}createNodeMesh(e){const t=this.json,i=this,n=t.nodes[e];return n.mesh===void 0?null:i.getDependency("mesh",n.mesh).then(function(s){const a=i._getNodeRef(i.meshCache,n.mesh,s);return n.weights!==void 0&&a.traverse(function(o){if(o.isMesh)for(let u=0,h=n.weights.length;u<h;u++)o.morphTargetInfluences[u]=n.weights[u]}),a})}loadNode(e){const t=this.json,i=this.extensions,n=this,s=t.nodes[e],a=s.name?n.createUniqueName(s.name):"";return function(){const o=[],u=n._invokeOne(function(d){return d.createNodeMesh&&d.createNodeMesh(e)});u&&o.push(u),s.camera!==void 0&&o.push(n.getDependency("camera",s.camera).then(function(d){return n._getNodeRef(n.cameraCache,s.camera,d)})),n._invokeAll(function(d){return d.createNodeAttachment&&d.createNodeAttachment(e)}).forEach(function(d){o.push(d)});const h=[],f=s.children||[];for(let d=0,m=f.length;d<m;d++)h.push(n.getDependency("node",f[d]));const c=s.skin===void 0?Promise.resolve(null):n.getDependency("skin",s.skin);return Promise.all([Promise.all(o),Promise.all(h),c])}().then(function(o){const u=o[0],h=o[1],f=o[2];let c;if(s.isBone===!0?c=new yb:u.length>1?c=new ts:u.length===1?c=u[0]:c=new ei,c!==u[0])for(let d=0,m=u.length;d<m;d++)c.add(u[d]);if(s.name&&(c.userData.name=s.name,c.name=a),Vr(c,s),s.extensions&&uc(i,c,s),s.matrix!==void 0){const d=new Pt;d.fromArray(s.matrix),c.applyMatrix4(d)}else s.translation!==void 0&&c.position.fromArray(s.translation),s.rotation!==void 0&&c.quaternion.fromArray(s.rotation),s.scale!==void 0&&c.scale.fromArray(s.scale);n.associations.has(c)||n.associations.set(c,{}),n.associations.get(c).nodes=e,f!==null&&c.traverse(function(d){d.isSkinnedMesh&&d.bind(f,TA)});for(let d=0,m=h.length;d<m;d++)c.add(h[d]);return c})}loadScene(e){const t=this.extensions,i=this.json.scenes[e],n=this,s=new ts;i.name&&(s.name=n.createUniqueName(i.name)),Vr(s,i),i.extensions&&uc(t,s,i);const a=i.nodes||[],o=[];for(let u=0,h=a.length;u<h;u++)o.push(n.getDependency("node",a[u]));return Promise.all(o).then(function(u){for(let f=0,c=u.length;f<c;f++)s.add(u[f]);const h=f=>{const c=new Map;for(const[d,m]of n.associations)(d instanceof ks||d instanceof vi)&&c.set(d,m);return f.traverse(d=>{const m=n.associations.get(d);m!=null&&c.set(d,m)}),c};return n.associations=h(s),s})}}function CA(r,e,t){const i=e.attributes,n=new Ml;if(i.POSITION!==void 0){const o=t.json.accessors[i.POSITION],u=o.min,h=o.max;if(u!==void 0&&h!==void 0){if(n.set(new Z(u[0],u[1],u[2]),new Z(h[0],h[1],h[2])),o.normalized){const f=Of(Qa[o.componentType]);n.min.multiplyScalar(f),n.max.multiplyScalar(f)}}else{console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.");return}}else return;const s=e.targets;if(s!==void 0){const o=new Z,u=new Z;for(let h=0,f=s.length;h<f;h++){const c=s[h];if(c.POSITION!==void 0){const d=t.json.accessors[c.POSITION],m=d.min,x=d.max;if(m!==void 0&&x!==void 0){if(u.setX(Math.max(Math.abs(m[0]),Math.abs(x[0]))),u.setY(Math.max(Math.abs(m[1]),Math.abs(x[1]))),u.setZ(Math.max(Math.abs(m[2]),Math.abs(x[2]))),d.normalized){const _=Of(Qa[d.componentType]);u.multiplyScalar(_)}o.max(u)}else console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.")}}n.expandByVector(o)}r.boundingBox=n;const a=new Tl;n.getCenter(a.center),a.radius=n.min.distanceTo(n.max)/2,r.boundingSphere=a}function Uv(r,e,t){const i=e.attributes,n=[];function s(a,o){return t.getDependency("accessor",a).then(function(u){r.setAttribute(o,u)})}for(const a in i){const o=Ff[a]||a.toLowerCase();o in r.attributes||n.push(s(i[a],o))}if(e.indices!==void 0&&!r.index){const a=t.getDependency("accessor",e.indices).then(function(o){r.setIndex(o)});n.push(a)}return Vr(r,e),CA(r,e,t),Promise.all(n).then(function(){return e.targets!==void 0?wA(r,e.targets,t):r})}function Gv(r,e){let t=r.getIndex();if(t===null){const a=[],o=r.getAttribute("position");if(o!==void 0){for(let u=0;u<o.count;u++)a.push(u);r.setIndex(a),t=r.getIndex()}else return console.error("THREE.GLTFLoader.toTrianglesDrawMode(): Undefined position attribute. Processing not possible."),r}const i=t.count-2,n=[];if(e===rb)for(let a=1;a<=i;a++)n.push(t.getX(0)),n.push(t.getX(a)),n.push(t.getX(a+1));else for(let a=0;a<i;a++)a%2===0?(n.push(t.getX(a)),n.push(t.getX(a+1)),n.push(t.getX(a+2))):(n.push(t.getX(a+2)),n.push(t.getX(a+1)),n.push(t.getX(a)));n.length/3!==i&&console.error("THREE.GLTFLoader.toTrianglesDrawMode(): Unable to generate correct amount of triangles.");const s=r.clone();return s.setIndex(n),s}class DA extends KP{constructor(t){super(t);q(this,"loadGltf",t=>(this.gltfs[t]||(this.gltfs[t]=this.add(new Promise((i,n)=>{this.gltfLoader.load(t,s=>{i(s)},void 0,s=>{n(new Error("glTF not loaded",{cause:{error:s,url:t}}))})}))),this.gltfs[t]));q(this,"loadTexture",(t,i)=>{console.log("Calling loadTexture",t);return (this.textures[t]||(this.textures[t]=this.add(new Promise((n,s)=>{this.textureLoader.load(t,a=>{console.log("Loaded",t),n(E.WebGL.generateTexture(a,i))},void 0,a=>{console.error("Failed",t),s(new Error("Texture not loaded",{cause:{error:a,url:t}}))})}))),this.textures[t])});this.gltfs={},this.textures={},this.ktxTextures={},this.textureLoader=new Lb,this.gltfLoader=new ZP}reset(){this.promisesToLoad=[]}}class PA{constructor(){q(this,"fire",e=>{let t=0;const i=this.callbacks.length;for(t;t<i;t++)this.callbacks[t]&&this.callbacks[t].cb(e)});this.callbacks=[],De.on(Je.RAF,this.fire)}add(e,t){for(let i=0;i<this.callbacks.length;i++)this.callbacks[i].cb===e&&console.warn("Duplicate RAFCollection callback detected");this.callbacks.push({index:t||0,cb:e}),this.callbacks.sort(this.sort)}remove(e){for(let t=0;t<this.callbacks.length;t++)this.callbacks[t].cb===e&&this.callbacks.splice(t,1)}sort(e,t){return e.index>t.index?1:-1}}function Bb(r,e,t){return Math.max(r,Math.min(e,t))}class AA{advance(e){var o;if(!this.isRunning)return;let t=!1;if(this.lerp)this.value=(i=this.value,n=this.to,s=60*this.lerp,a=e,function(u,h,f){return(1-f)*u+f*h}(i,n,1-Math.exp(-s*a))),Math.round(this.value)===this.to&&(this.value=this.to,t=!0);else{this.currentTime+=e;const u=Bb(0,this.currentTime/this.duration,1);t=u>=1;const h=t?1:this.easing(u);this.value=this.from+(this.to-this.from)*h}var i,n,s,a;(o=this.onUpdate)==null||o.call(this,this.value,t),t&&this.stop()}stop(){this.isRunning=!1}fromTo(e,t,{lerp:i=.1,duration:n=1,easing:s=u=>u,onStart:a,onUpdate:o}){this.from=this.value=e,this.to=t,this.lerp=i,this.duration=n,this.easing=s,this.currentTime=0,this.isRunning=!0,a==null||a(),this.onUpdate=o}}class LA{constructor({wrapper:e,content:t,autoResize:i=!0,debounce:n=250}={}){q(this,"resize",()=>{this.onWrapperResize(),this.onContentResize()});q(this,"onWrapperResize",()=>{this.wrapper===window?(this.width=window.innerWidth,this.height=window.innerHeight):(this.width=this.wrapper.clientWidth,this.height=this.wrapper.clientHeight)});q(this,"onContentResize",()=>{this.wrapper===window?(this.scrollHeight=this.content.scrollHeight,this.scrollWidth=this.content.scrollWidth):(this.scrollHeight=this.wrapper.scrollHeight,this.scrollWidth=this.wrapper.scrollWidth)});this.wrapper=e,this.content=t,i&&(this.debouncedResize=function(s,a){let o;return function(){let u=arguments,h=this;clearTimeout(o),o=setTimeout(function(){s.apply(h,u)},a)}}(this.resize,n),this.wrapper===window?window.addEventListener("resize",this.debouncedResize,!1):(this.wrapperResizeObserver=new ResizeObserver(this.debouncedResize),this.wrapperResizeObserver.observe(this.wrapper)),this.contentResizeObserver=new ResizeObserver(this.debouncedResize),this.contentResizeObserver.observe(this.content)),this.resize()}destroy(){var e,t;(e=this.wrapperResizeObserver)==null||e.disconnect(),(t=this.contentResizeObserver)==null||t.disconnect(),window.removeEventListener("resize",this.debouncedResize,!1)}get limit(){return{x:this.scrollWidth-this.width,y:this.scrollHeight-this.height}}}class Vb{constructor(){this.events={}}emit(e,...t){let i=this.events[e]||[];for(let n=0,s=i.length;n<s;n++)i[n](...t)}on(e,t){var i;return(i=this.events[e])!=null&&i.push(t)||(this.events[e]=[t]),()=>{var n;this.events[e]=(n=this.events[e])==null?void 0:n.filter(s=>t!==s)}}off(e,t){var i;this.events[e]=(i=this.events[e])==null?void 0:i.filter(n=>t!==n)}destroy(){this.events={}}}const Hv=100/6;class RA{constructor(e,{wheelMultiplier:t=1,touchMultiplier:i=1}){q(this,"onTouchStart",e=>{const{clientX:t,clientY:i}=e.targetTouches?e.targetTouches[0]:e;this.touchStart.x=t,this.touchStart.y=i,this.lastDelta={x:0,y:0},this.emitter.emit("scroll",{deltaX:0,deltaY:0,event:e})});q(this,"onTouchMove",e=>{const{clientX:t,clientY:i}=e.targetTouches?e.targetTouches[0]:e,n=-(t-this.touchStart.x)*this.touchMultiplier,s=-(i-this.touchStart.y)*this.touchMultiplier;this.touchStart.x=t,this.touchStart.y=i,this.lastDelta={x:n,y:s},this.emitter.emit("scroll",{deltaX:n,deltaY:s,event:e})});q(this,"onTouchEnd",e=>{this.emitter.emit("scroll",{deltaX:this.lastDelta.x,deltaY:this.lastDelta.y,event:e})});q(this,"onWheel",e=>{let{deltaX:t,deltaY:i,deltaMode:n}=e;t*=n===1?Hv:n===2?this.windowWidth:1,i*=n===1?Hv:n===2?this.windowHeight:1,t*=this.wheelMultiplier,i*=this.wheelMultiplier,this.emitter.emit("scroll",{deltaX:t,deltaY:i,event:e})});q(this,"onWindowResize",()=>{this.windowWidth=window.innerWidth,this.windowHeight=window.innerHeight});this.element=e,this.wheelMultiplier=t,this.touchMultiplier=i,this.touchStart={x:null,y:null},this.emitter=new Vb,window.addEventListener("resize",this.onWindowResize,!1),this.onWindowResize(),this.element.addEventListener("wheel",this.onWheel,{passive:!1}),this.element.addEventListener("touchstart",this.onTouchStart,{passive:!1}),this.element.addEventListener("touchmove",this.onTouchMove,{passive:!1}),this.element.addEventListener("touchend",this.onTouchEnd,{passive:!1})}on(e,t){return this.emitter.on(e,t)}destroy(){this.emitter.destroy(),window.removeEventListener("resize",this.onWindowResize,!1),this.element.removeEventListener("wheel",this.onWheel,{passive:!1}),this.element.removeEventListener("touchstart",this.onTouchStart,{passive:!1}),this.element.removeEventListener("touchmove",this.onTouchMove,{passive:!1}),this.element.removeEventListener("touchend",this.onTouchEnd,{passive:!1})}}class Wv{constructor({wrapper:e=window,content:t=document.documentElement,wheelEventsTarget:i=e,eventsTarget:n=i,smoothWheel:s=!0,syncTouch:a=!1,syncTouchLerp:o=.075,touchInertiaMultiplier:u=35,duration:h,easing:f=D=>Math.min(1,1.001-Math.pow(2,-10*D)),lerp:c=!h&&.1,infinite:d=!1,orientation:m="vertical",gestureOrientation:x="vertical",touchMultiplier:_=1,wheelMultiplier:b=1,autoResize:y=!0,__experimental__naiveDimensions:M=!1}={}){this.__isSmooth=!1,this.__isScrolling=!1,this.__isStopped=!1,this.__isLocked=!1,this.onVirtualScroll=({deltaX:D,deltaY:C,event:P})=>{if(P.ctrlKey)return;const I=P.type.includes("touch"),F=P.type.includes("wheel");if(this.options.syncTouch&&I&&P.type==="touchstart"&&!this.isStopped&&!this.isLocked)return void this.reset();const A=D===0&&C===0,k=this.options.gestureOrientation==="vertical"&&C===0||this.options.gestureOrientation==="horizontal"&&D===0;if(A||k)return;let O=P.composedPath();if(O=O.slice(0,O.indexOf(this.rootElement)),O.find(j=>{var K,ie,ee,V,_e;return((K=j.hasAttribute)===null||K===void 0?void 0:K.call(j,"data-lenis-prevent"))||I&&((ie=j.hasAttribute)===null||ie===void 0?void 0:ie.call(j,"data-lenis-prevent-touch"))||F&&((ee=j.hasAttribute)===null||ee===void 0?void 0:ee.call(j,"data-lenis-prevent-wheel"))||((V=j.classList)===null||V===void 0?void 0:V.contains("lenis"))&&!(!((_e=j.classList)===null||_e===void 0)&&_e.contains("lenis-stopped"))}))return;if(this.isStopped||this.isLocked)return void P.preventDefault();if(this.isSmooth=this.options.syncTouch&&I||this.options.smoothWheel&&F,!this.isSmooth)return this.isScrolling=!1,void this.animate.stop();P.preventDefault();let J=C;this.options.gestureOrientation==="both"?J=Math.abs(C)>Math.abs(D)?C:D:this.options.gestureOrientation==="horizontal"&&(J=D);const Q=I&&this.options.syncTouch,X=I&&P.type==="touchend"&&Math.abs(J)>5;X&&(J=this.velocity*this.options.touchInertiaMultiplier),this.scrollTo(this.targetScroll+J,Object.assign({programmatic:!1},Q?{lerp:X?this.options.syncTouchLerp:1}:{lerp:this.options.lerp,duration:this.options.duration,easing:this.options.easing}))},this.onNativeScroll=()=>{if(!this.__preventNextScrollEvent&&!this.isScrolling){const D=this.animatedScroll;this.animatedScroll=this.targetScroll=this.actualScroll,this.velocity=0,this.direction=Math.sign(this.animatedScroll-D),this.emit()}},window.lenisVersion="1.0.42",e!==document.documentElement&&e!==document.body||(e=window),this.options={wrapper:e,content:t,wheelEventsTarget:i,eventsTarget:n,smoothWheel:s,syncTouch:a,syncTouchLerp:o,touchInertiaMultiplier:u,duration:h,easing:f,lerp:c,infinite:d,gestureOrientation:x,orientation:m,touchMultiplier:_,wheelMultiplier:b,autoResize:y,__experimental__naiveDimensions:M},this.animate=new AA,this.emitter=new Vb,this.dimensions=new LA({wrapper:e,content:t,autoResize:y}),this.toggleClassName("lenis",!0),this.velocity=0,this.isLocked=!1,this.isStopped=!1,this.isSmooth=a||s,this.isScrolling=!1,this.targetScroll=this.animatedScroll=this.actualScroll,this.options.wrapper.addEventListener("scroll",this.onNativeScroll,!1),this.virtualScroll=new RA(n,{touchMultiplier:_,wheelMultiplier:b}),this.virtualScroll.on("scroll",this.onVirtualScroll)}destroy(){this.emitter.destroy(),this.options.wrapper.removeEventListener("scroll",this.onNativeScroll,!1),this.virtualScroll.destroy(),this.dimensions.destroy(),this.toggleClassName("lenis",!1),this.toggleClassName("lenis-smooth",!1),this.toggleClassName("lenis-scrolling",!1),this.toggleClassName("lenis-stopped",!1),this.toggleClassName("lenis-locked",!1)}on(e,t){return this.emitter.on(e,t)}off(e,t){return this.emitter.off(e,t)}setScroll(e){this.isHorizontal?this.rootElement.scrollLeft=e:this.rootElement.scrollTop=e}resize(){this.dimensions.resize()}emit(){this.emitter.emit("scroll",this)}reset(){this.isLocked=!1,this.isScrolling=!1,this.animatedScroll=this.targetScroll=this.actualScroll,this.velocity=0,this.animate.stop()}start(){this.isStopped&&(this.isStopped=!1,this.reset())}stop(){this.isStopped||(this.isStopped=!0,this.animate.stop(),this.reset())}raf(e){const t=e-(this.time||e);this.time=e,this.animate.advance(.001*t)}scrollTo(e,{offset:t=0,immediate:i=!1,lock:n=!1,duration:s=this.options.duration,easing:a=this.options.easing,lerp:o=!s&&this.options.lerp,onComplete:u,force:h=!1,programmatic:f=!0}={}){if(!this.isStopped&&!this.isLocked||h){if(["top","left","start"].includes(e))e=0;else if(["bottom","right","end"].includes(e))e=this.limit;else{let c;if(typeof e=="string"?c=document.querySelector(e):e!=null&&e.nodeType&&(c=e),c){if(this.options.wrapper!==window){const m=this.options.wrapper.getBoundingClientRect();t-=this.isHorizontal?m.left:m.top}const d=c.getBoundingClientRect();e=(this.isHorizontal?d.left:d.top)+this.animatedScroll}}if(typeof e=="number"){if(e+=t,e=Math.round(e),this.options.infinite?f&&(this.targetScroll=this.animatedScroll=this.scroll):e=Bb(0,e,this.limit),i)return this.animatedScroll=this.targetScroll=e,this.setScroll(this.scroll),this.reset(),void(u==null||u(this));if(!f){if(e===this.targetScroll)return;this.targetScroll=e}this.animate.fromTo(this.animatedScroll,e,{duration:s,easing:a,lerp:o,onStart:()=>{n&&(this.isLocked=!0),this.isScrolling=!0},onUpdate:(c,d)=>{this.isScrolling=!0,this.velocity=c-this.animatedScroll,this.direction=Math.sign(this.velocity),this.animatedScroll=c,this.setScroll(this.scroll),f&&(this.targetScroll=c),d||this.emit(),d&&(this.reset(),this.emit(),u==null||u(this),this.__preventNextScrollEvent=!0,requestAnimationFrame(()=>{delete this.__preventNextScrollEvent}))}})}}}get rootElement(){return this.options.wrapper===window?document.documentElement:this.options.wrapper}get limit(){return this.options.__experimental__naiveDimensions?this.isHorizontal?this.rootElement.scrollWidth-this.rootElement.clientWidth:this.rootElement.scrollHeight-this.rootElement.clientHeight:this.dimensions.limit[this.isHorizontal?"x":"y"]}get isHorizontal(){return this.options.orientation==="horizontal"}get actualScroll(){return this.isHorizontal?this.rootElement.scrollLeft:this.rootElement.scrollTop}get scroll(){return this.options.infinite?(e=this.animatedScroll,t=this.limit,(e%t+t)%t):this.animatedScroll;var e,t}get progress(){return this.limit===0?1:this.scroll/this.limit}get isSmooth(){return this.__isSmooth}set isSmooth(e){this.__isSmooth!==e&&(this.__isSmooth=e,this.toggleClassName("lenis-smooth",e))}get isScrolling(){return this.__isScrolling}set isScrolling(e){this.__isScrolling!==e&&(this.__isScrolling=e,this.toggleClassName("lenis-scrolling",e))}get isStopped(){return this.__isStopped}set isStopped(e){this.__isStopped!==e&&(this.__isStopped=e,this.toggleClassName("lenis-stopped",e))}get isLocked(){return this.__isLocked}set isLocked(e){this.__isLocked!==e&&(this.__isLocked=e,this.toggleClassName("lenis-locked",e))}get className(){let e="lenis";return this.isStopped&&(e+=" lenis-stopped"),this.isLocked&&(e+=" lenis-locked"),this.isScrolling&&(e+=" lenis-scrolling"),this.isSmooth&&(e+=" lenis-smooth"),e}toggleClassName(e,t){this.rootElement.classList.toggle(e,t),this.emitter.emit("className change",this)}}function jv(r,e){for(var t=0;t<e.length;t++){var i=e[t];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(r,i.key,i)}}function kA(r,e,t){return e&&jv(r.prototype,e),t&&jv(r,t),r}/*!
 * Observer 3.12.5
 * https://gsap.com
 *
 * @license Copyright 2008-2024, GreenSock. All rights reserved.
 * Subject to the terms at https://gsap.com/standard-license or for
 * Club GSAP members, the agreement issued with that membership.
 * @author: Jack Doyle, jack@greensock.com
*/var Oi,Oh,Fn,Gr,Hr,el,zb,To,Cc,Ub,lr,ms,Gb,Hb=function(){return Oi||typeof window<"u"&&(Oi=window.gsap)&&Oi.registerPlugin&&Oi},Wb=1,Xa=[],At=[],Is=[],Dc=Date.now,Nf=function(e,t){return t},IA=function(){var e=Cc.core,t=e.bridge||{},i=e._scrollers,n=e._proxies;i.push.apply(i,At),n.push.apply(n,Is),At=i,Is=n,Nf=function(a,o){return t[a](o)}},Xr=function(e,t){return~Is.indexOf(e)&&Is[Is.indexOf(e)+1][t]},Pc=function(e){return!!~Ub.indexOf(e)},Qi=function(e,t,i,n,s){return e.addEventListener(t,i,{passive:n!==!1,capture:!!s})},Ji=function(e,t,i,n){return e.removeEventListener(t,i,!!n)},gh="scrollLeft",_h="scrollTop",Bf=function(){return lr&&lr.isPressed||At.cache++},Yh=function(e,t){var i=function n(s){if(s||s===0){Wb&&(Fn.history.scrollRestoration="manual");var a=lr&&lr.isPressed;s=n.v=Math.round(s)||(lr&&lr.iOS?1:0),e(s),n.cacheID=At.cache,a&&Nf("ss",s)}else(t||At.cache!==n.cacheID||Nf("ref"))&&(n.cacheID=At.cache,n.v=e());return n.v+n.offset};return i.offset=0,e&&i},rn={s:gh,p:"left",p2:"Left",os:"right",os2:"Right",d:"width",d2:"Width",a:"x",sc:Yh(function(r){return arguments.length?Fn.scrollTo(r,yi.sc()):Fn.pageXOffset||Gr[gh]||Hr[gh]||el[gh]||0})},yi={s:_h,p:"top",p2:"Top",os:"bottom",os2:"Bottom",d:"height",d2:"Height",a:"y",op:rn,sc:Yh(function(r){return arguments.length?Fn.scrollTo(rn.sc(),r):Fn.pageYOffset||Gr[_h]||Hr[_h]||el[_h]||0})},_n=function(e,t){return(t&&t._ctx&&t._ctx.selector||Oi.utils.toArray)(e)[0]||(typeof e=="string"&&Oi.config().nullTargetWarn!==!1?console.warn("Element not found:",e):null)},Zr=function(e,t){var i=t.s,n=t.sc;Pc(e)&&(e=Gr.scrollingElement||Hr);var s=At.indexOf(e),a=n===yi.sc?1:2;!~s&&(s=At.push(e)-1),At[s+a]||Qi(e,"scroll",Bf);var o=At[s+a],u=o||(At[s+a]=Yh(Xr(e,i),!0)||(Pc(e)?n:Yh(function(h){return arguments.length?e[i]=h:e[i]})));return u.target=e,o||(u.smooth=Oi.getProperty(e,"scrollBehavior")==="smooth"),u},Vf=function(e,t,i){var n=e,s=e,a=Dc(),o=a,u=t||50,h=Math.max(500,u*3),f=function(x,_){var b=Dc();_||b-a>u?(s=n,n=x,o=a,a=b):i?n+=x:n=s+(x-s)/(b-o)*(a-o)},c=function(){s=n=i?0:n,o=a=0},d=function(x){var _=o,b=s,y=Dc();return(x||x===0)&&x!==n&&f(x),a===o||y-o>h?0:(n+(i?b:-b))/((i?y:a)-_)*1e3};return{update:f,reset:c,getVelocity:d}},hc=function(e,t){return t&&!e._gsapAllow&&e.preventDefault(),e.changedTouches?e.changedTouches[0]:e},qv=function(e){var t=Math.max.apply(Math,e),i=Math.min.apply(Math,e);return Math.abs(t)>=Math.abs(i)?t:i},jb=function(){Cc=Oi.core.globals().ScrollTrigger,Cc&&Cc.core&&IA()},qb=function(e){return Oi=e||Hb(),!Oh&&Oi&&typeof document<"u"&&document.body&&(Fn=window,Gr=document,Hr=Gr.documentElement,el=Gr.body,Ub=[Fn,Gr,Hr,el],Oi.utils.clamp,Gb=Oi.core.context||function(){},To="onpointerenter"in el?"pointer":"mouse",zb=oi.isTouch=Fn.matchMedia&&Fn.matchMedia("(hover: none), (pointer: coarse)").matches?1:"ontouchstart"in Fn||navigator.maxTouchPoints>0||navigator.msMaxTouchPoints>0?2:0,ms=oi.eventTypes=("ontouchstart"in Hr?"touchstart,touchmove,touchcancel,touchend":"onpointerdown"in Hr?"pointerdown,pointermove,pointercancel,pointerup":"mousedown,mousemove,mouseup,mouseup").split(","),setTimeout(function(){return Wb=0},500),jb(),Oh=1),Oh};rn.op=yi;At.cache=0;var oi=function(){function r(t){this.init(t)}var e=r.prototype;return e.init=function(i){Oh||qb(Oi)||console.warn("Please gsap.registerPlugin(Observer)"),Cc||jb();var n=i.tolerance,s=i.dragMinimum,a=i.type,o=i.target,u=i.lineHeight,h=i.debounce,f=i.preventDefault,c=i.onStop,d=i.onStopDelay,m=i.ignore,x=i.wheelSpeed,_=i.event,b=i.onDragStart,y=i.onDragEnd,M=i.onDrag,D=i.onPress,C=i.onRelease,P=i.onRight,I=i.onLeft,F=i.onUp,A=i.onDown,k=i.onChangeX,O=i.onChangeY,J=i.onChange,Q=i.onToggleX,X=i.onToggleY,j=i.onHover,K=i.onHoverEnd,ie=i.onMove,ee=i.ignoreCheck,V=i.isNormalizer,_e=i.onGestureStart,U=i.onGestureEnd,oe=i.onWheel,ce=i.onEnable,me=i.onDisable,le=i.onClick,be=i.scrollSpeed,ue=i.capture,We=i.allowClicks,ye=i.lockAxis,Ne=i.onLockAxis;this.target=o=_n(o)||Hr,this.vars=i,m&&(m=Oi.utils.toArray(m)),n=n||1e-9,s=s||0,x=x||1,be=be||1,a=a||"wheel,touch,pointer",h=h!==!1,u||(u=parseFloat(Fn.getComputedStyle(el).lineHeight)||22);var Ce,Ze,Qe,Pe,ct,xt,mt,he=this,Tt=0,_t=0,Ot=i.passive||!f,wt=Zr(o,rn),G=Zr(o,yi),N=wt(),fe=G(),xe=~a.indexOf("touch")&&!~a.indexOf("pointer")&&ms[0]==="pointerdown",Me=Pc(o),Se=o.ownerDocument||Gr,je=[0,0,0],H=[0,0,0],ne=0,Fe=function(){return ne=Dc()},Te=function($e,it){return(he.event=$e)&&m&&~m.indexOf($e.target)||it&&xe&&$e.pointerType!=="touch"||ee&&ee($e,it)},Re=function(){he._vx.reset(),he._vy.reset(),Ze.pause(),c&&c(he)},He=function(){var $e=he.deltaX=qv(je),it=he.deltaY=qv(H),Ie=Math.abs($e)>=n,at=Math.abs(it)>=n;J&&(Ie||at)&&J(he,$e,it,je,H),Ie&&(P&&he.deltaX>0&&P(he),I&&he.deltaX<0&&I(he),k&&k(he),Q&&he.deltaX<0!=Tt<0&&Q(he),Tt=he.deltaX,je[0]=je[1]=je[2]=0),at&&(A&&he.deltaY>0&&A(he),F&&he.deltaY<0&&F(he),O&&O(he),X&&he.deltaY<0!=_t<0&&X(he),_t=he.deltaY,H[0]=H[1]=H[2]=0),(Pe||Qe)&&(ie&&ie(he),Qe&&(M(he),Qe=!1),Pe=!1),xt&&!(xt=!1)&&Ne&&Ne(he),ct&&(oe(he),ct=!1),Ce=0},ze=function($e,it,Ie){je[Ie]+=$e,H[Ie]+=it,he._vx.update($e),he._vy.update(it),h?Ce||(Ce=requestAnimationFrame(He)):He()},ut=function($e,it){ye&&!mt&&(he.axis=mt=Math.abs($e)>Math.abs(it)?"x":"y",xt=!0),mt!=="y"&&(je[2]+=$e,he._vx.update($e,!0)),mt!=="x"&&(H[2]+=it,he._vy.update(it,!0)),h?Ce||(Ce=requestAnimationFrame(He)):He()},ht=function($e){if(!Te($e,1)){$e=hc($e,f);var it=$e.clientX,Ie=$e.clientY,at=it-he.x,et=Ie-he.y,lt=he.isDragging;he.x=it,he.y=Ie,(lt||Math.abs(he.startX-it)>=s||Math.abs(he.startY-Ie)>=s)&&(M&&(Qe=!0),lt||(he.isDragging=!0),ut(at,et),lt||b&&b(he))}},Ct=he.onPress=function(Le){Te(Le,1)||Le&&Le.button||(he.axis=mt=null,Ze.pause(),he.isPressed=!0,Le=hc(Le),Tt=_t=0,he.startX=he.x=Le.clientX,he.startY=he.y=Le.clientY,he._vx.reset(),he._vy.reset(),Qi(V?o:Se,ms[1],ht,Ot,!0),he.deltaX=he.deltaY=0,D&&D(he))},$=he.onRelease=function(Le){if(!Te(Le,1)){Ji(V?o:Se,ms[1],ht,!0);var $e=!isNaN(he.y-he.startY),it=he.isDragging,Ie=it&&(Math.abs(he.x-he.startX)>3||Math.abs(he.y-he.startY)>3),at=hc(Le);!Ie&&$e&&(he._vx.reset(),he._vy.reset(),f&&We&&Oi.delayedCall(.08,function(){if(Dc()-ne>300&&!Le.defaultPrevented){if(Le.target.click)Le.target.click();else if(Se.createEvent){var et=Se.createEvent("MouseEvents");et.initMouseEvent("click",!0,!0,Fn,1,at.screenX,at.screenY,at.clientX,at.clientY,!1,!1,!1,!1,0,null),Le.target.dispatchEvent(et)}}})),he.isDragging=he.isGesturing=he.isPressed=!1,c&&it&&!V&&Ze.restart(!0),y&&it&&y(he),C&&C(he,Ie)}},ge=function($e){return $e.touches&&$e.touches.length>1&&(he.isGesturing=!0)&&_e($e,he.isDragging)},we=function(){return(he.isGesturing=!1)||U(he)},ke=function($e){if(!Te($e)){var it=wt(),Ie=G();ze((it-N)*be,(Ie-fe)*be,1),N=it,fe=Ie,c&&Ze.restart(!0)}},Ge=function($e){if(!Te($e)){$e=hc($e,f),oe&&(ct=!0);var it=($e.deltaMode===1?u:$e.deltaMode===2?Fn.innerHeight:1)*x;ze($e.deltaX*it,$e.deltaY*it,0),c&&!V&&Ze.restart(!0)}},St=function($e){if(!Te($e)){var it=$e.clientX,Ie=$e.clientY,at=it-he.x,et=Ie-he.y;he.x=it,he.y=Ie,Pe=!0,c&&Ze.restart(!0),(at||et)&&ut(at,et)}},Vt=function($e){he.event=$e,j(he)},Lt=function($e){he.event=$e,K(he)},bi=function($e){return Te($e)||hc($e,f)&&le(he)};Ze=he._dc=Oi.delayedCall(d||.25,Re).pause(),he.deltaX=he.deltaY=0,he._vx=Vf(0,50,!0),he._vy=Vf(0,50,!0),he.scrollX=wt,he.scrollY=G,he.isDragging=he.isGesturing=he.isPressed=!1,Gb(this),he.enable=function(Le){return he.isEnabled||(Qi(Me?Se:o,"scroll",Bf),a.indexOf("scroll")>=0&&Qi(Me?Se:o,"scroll",ke,Ot,ue),a.indexOf("wheel")>=0&&Qi(o,"wheel",Ge,Ot,ue),(a.indexOf("touch")>=0&&zb||a.indexOf("pointer")>=0)&&(Qi(o,ms[0],Ct,Ot,ue),Qi(Se,ms[2],$),Qi(Se,ms[3],$),We&&Qi(o,"click",Fe,!0,!0),le&&Qi(o,"click",bi),_e&&Qi(Se,"gesturestart",ge),U&&Qi(Se,"gestureend",we),j&&Qi(o,To+"enter",Vt),K&&Qi(o,To+"leave",Lt),ie&&Qi(o,To+"move",St)),he.isEnabled=!0,Le&&Le.type&&Ct(Le),ce&&ce(he)),he},he.disable=function(){he.isEnabled&&(Xa.filter(function(Le){return Le!==he&&Pc(Le.target)}).length||Ji(Me?Se:o,"scroll",Bf),he.isPressed&&(he._vx.reset(),he._vy.reset(),Ji(V?o:Se,ms[1],ht,!0)),Ji(Me?Se:o,"scroll",ke,ue),Ji(o,"wheel",Ge,ue),Ji(o,ms[0],Ct,ue),Ji(Se,ms[2],$),Ji(Se,ms[3],$),Ji(o,"click",Fe,!0),Ji(o,"click",bi),Ji(Se,"gesturestart",ge),Ji(Se,"gestureend",we),Ji(o,To+"enter",Vt),Ji(o,To+"leave",Lt),Ji(o,To+"move",St),he.isEnabled=he.isPressed=he.isDragging=!1,me&&me(he))},he.kill=he.revert=function(){he.disable();var Le=Xa.indexOf(he);Le>=0&&Xa.splice(Le,1),lr===he&&(lr=0)},Xa.push(he),V&&Pc(o)&&(lr=he),he.enable(_)},kA(r,[{key:"velocityX",get:function(){return this._vx.getVelocity()}},{key:"velocityY",get:function(){return this._vy.getVelocity()}}]),r}();oi.version="3.12.5";oi.create=function(r){return new oi(r)};oi.register=qb;oi.getAll=function(){return Xa.slice()};oi.getById=function(r){return Xa.filter(function(e){return e.vars.id===r})[0]};Hb()&&Oi.registerPlugin(oi);/*!
 * ScrollTrigger 3.12.5
 * https://gsap.com
 *
 * @license Copyright 2008-2024, GreenSock. All rights reserved.
 * Subject to the terms at https://gsap.com/standard-license or for
 * Club GSAP members, the agreement issued with that membership.
 * @author: Jack Doyle, jack@greensock.com
*/var Ke,Ha,kt,ni,gs,Qt,Xb,Kh,Yc,Ac,vc,vh,Vi,gd,zf,nn,Xv,$v,Wa,$b,Yp,Yb,tn,Uf,Kb,Zb,Nr,Gf,Lm,tl,Rm,Zh,Hf,Kp,bh=1,zi=Date.now,Zp=zi(),ss=0,bc=0,Yv=function(e,t,i){var n=kn(e)&&(e.substr(0,6)==="clamp("||e.indexOf("max")>-1);return i["_"+t+"Clamp"]=n,n?e.substr(6,e.length-7):e},Kv=function(e,t){return t&&(!kn(e)||e.substr(0,6)!=="clamp(")?"clamp("+e+")":e},FA=function r(){return bc&&requestAnimationFrame(r)},Zv=function(){return gd=1},Jv=function(){return gd=0},Es=function(e){return e},xc=function(e){return Math.round(e*1e5)/1e5||0},Jb=function(){return typeof window<"u"},Qb=function(){return Ke||Jb()&&(Ke=window.gsap)&&Ke.registerPlugin&&Ke},Jo=function(e){return!!~Xb.indexOf(e)},ex=function(e){return(e==="Height"?Rm:kt["inner"+e])||gs["client"+e]||Qt["client"+e]},tx=function(e){return Xr(e,"getBoundingClientRect")||(Jo(e)?function(){return Uh.width=kt.innerWidth,Uh.height=Rm,Uh}:function(){return rr(e)})},OA=function(e,t,i){var n=i.d,s=i.d2,a=i.a;return(a=Xr(e,"getBoundingClientRect"))?function(){return a()[n]}:function(){return(t?ex(s):e["client"+s])||0}},NA=function(e,t){return!t||~Is.indexOf(e)?tx(e):function(){return Uh}},Ls=function(e,t){var i=t.s,n=t.d2,s=t.d,a=t.a;return Math.max(0,(i="scroll"+n)&&(a=Xr(e,i))?a()-tx(e)()[s]:Jo(e)?(gs[i]||Qt[i])-ex(n):e[i]-e["offset"+n])},xh=function(e,t){for(var i=0;i<Wa.length;i+=3)(!t||~t.indexOf(Wa[i+1]))&&e(Wa[i],Wa[i+1],Wa[i+2])},kn=function(e){return typeof e=="string"},on=function(e){return typeof e=="function"},wc=function(e){return typeof e=="number"},Eo=function(e){return typeof e=="object"},dc=function(e,t,i){return e&&e.progress(t?0:1)&&i&&e.pause()},Jp=function(e,t){if(e.enabled){var i=e._ctx?e._ctx.add(function(){return t(e)}):t(e);i&&i.totalTime&&(e.callbackAnimation=i)}},Oa=Math.abs,ix="left",nx="top",km="right",Im="bottom",Uo="width",Go="height",Lc="Right",Rc="Left",kc="Top",Ic="Bottom",gi="padding",Jn="margin",dl="Width",Fm="Height",wi="px",Qn=function(e){return kt.getComputedStyle(e)},BA=function(e){var t=Qn(e).position;e.style.position=t==="absolute"||t==="fixed"?t:"relative"},Qv=function(e,t){for(var i in t)i in e||(e[i]=t[i]);return e},rr=function(e,t){var i=t&&Qn(e)[zf]!=="matrix(1, 0, 0, 1, 0, 0)"&&Ke.to(e,{x:0,y:0,xPercent:0,yPercent:0,rotation:0,rotationX:0,rotationY:0,scale:1,skewX:0,skewY:0}).progress(1),n=e.getBoundingClientRect();return i&&i.progress(0).kill(),n},Jh=function(e,t){var i=t.d2;return e["offset"+i]||e["client"+i]||0},sx=function(e){var t=[],i=e.labels,n=e.duration(),s;for(s in i)t.push(i[s]/n);return t},VA=function(e){return function(t){return Ke.utils.snap(sx(e),t)}},Om=function(e){var t=Ke.utils.snap(e),i=Array.isArray(e)&&e.slice(0).sort(function(n,s){return n-s});return i?function(n,s,a){a===void 0&&(a=.001);var o;if(!s)return t(n);if(s>0){for(n-=a,o=0;o<i.length;o++)if(i[o]>=n)return i[o];return i[o-1]}else for(o=i.length,n+=a;o--;)if(i[o]<=n)return i[o];return i[0]}:function(n,s,a){a===void 0&&(a=.001);var o=t(n);return!s||Math.abs(o-n)<a||o-n<0==s<0?o:t(s<0?n-e:n+e)}},zA=function(e){return function(t,i){return Om(sx(e))(t,i.direction)}},wh=function(e,t,i,n){return i.split(",").forEach(function(s){return e(t,s,n)})},Pi=function(e,t,i,n,s){return e.addEventListener(t,i,{passive:!n,capture:!!s})},Di=function(e,t,i,n){return e.removeEventListener(t,i,!!n)},yh=function(e,t,i){i=i&&i.wheelHandler,i&&(e(t,"wheel",i),e(t,"touchmove",i))},e0={startColor:"green",endColor:"red",indent:0,fontSize:"16px",fontWeight:"normal"},Sh={toggleActions:"play",anticipatePin:0},Qh={top:0,left:0,center:.5,bottom:1,right:1},Nh=function(e,t){if(kn(e)){var i=e.indexOf("="),n=~i?+(e.charAt(i-1)+1)*parseFloat(e.substr(i+1)):0;~i&&(e.indexOf("%")>i&&(n*=t/100),e=e.substr(0,i-1)),e=n+(e in Qh?Qh[e]*t:~e.indexOf("%")?parseFloat(e)*t/100:parseFloat(e)||0)}return e},Mh=function(e,t,i,n,s,a,o,u){var h=s.startColor,f=s.endColor,c=s.fontSize,d=s.indent,m=s.fontWeight,x=ni.createElement("div"),_=Jo(i)||Xr(i,"pinType")==="fixed",b=e.indexOf("scroller")!==-1,y=_?Qt:i,M=e.indexOf("start")!==-1,D=M?h:f,C="border-color:"+D+";font-size:"+c+";color:"+D+";font-weight:"+m+";pointer-events:none;white-space:nowrap;font-family:sans-serif,Arial;z-index:1000;padding:4px 8px;border-width:0;border-style:solid;";return C+="position:"+((b||u)&&_?"fixed;":"absolute;"),(b||u||!_)&&(C+=(n===yi?km:Im)+":"+(a+parseFloat(d))+"px;"),o&&(C+="box-sizing:border-box;text-align:left;width:"+o.offsetWidth+"px;"),x._isStart=M,x.setAttribute("class","gsap-marker-"+e+(t?" marker-"+t:"")),x.style.cssText=C,x.innerText=t||t===0?e+"-"+t:e,y.children[0]?y.insertBefore(x,y.children[0]):y.appendChild(x),x._offset=x["offset"+n.op.d2],Bh(x,0,n,M),x},Bh=function(e,t,i,n){var s={display:"block"},a=i[n?"os2":"p2"],o=i[n?"p2":"os2"];e._isFlipped=n,s[i.a+"Percent"]=n?-100:0,s[i.a]=n?"1px":0,s["border"+a+dl]=1,s["border"+o+dl]=0,s[i.p]=t+"px",Ke.set(e,s)},Dt=[],Wf={},Kc,t0=function(){return zi()-ss>34&&(Kc||(Kc=requestAnimationFrame(hr)))},Na=function(){(!tn||!tn.isPressed||tn.startX>Qt.clientWidth)&&(At.cache++,tn?Kc||(Kc=requestAnimationFrame(hr)):hr(),ss||ea("scrollStart"),ss=zi())},Qp=function(){Zb=kt.innerWidth,Kb=kt.innerHeight},yc=function(){At.cache++,!Vi&&!Yb&&!ni.fullscreenElement&&!ni.webkitFullscreenElement&&(!Uf||Zb!==kt.innerWidth||Math.abs(kt.innerHeight-Kb)>kt.innerHeight*.25)&&Kh.restart(!0)},Qo={},UA=[],rx=function r(){return Di(ft,"scrollEnd",r)||Ro(!0)},ea=function(e){return Qo[e]&&Qo[e].map(function(t){return t()})||UA},Rn=[],ox=function(e){for(var t=0;t<Rn.length;t+=5)(!e||Rn[t+4]&&Rn[t+4].query===e)&&(Rn[t].style.cssText=Rn[t+1],Rn[t].getBBox&&Rn[t].setAttribute("transform",Rn[t+2]||""),Rn[t+3].uncache=1)},Nm=function(e,t){var i;for(nn=0;nn<Dt.length;nn++)i=Dt[nn],i&&(!t||i._ctx===t)&&(e?i.kill(1):i.revert(!0,!0));Zh=!0,t&&ox(t),t||ea("revert")},ax=function(e,t){At.cache++,(t||!sn)&&At.forEach(function(i){return on(i)&&i.cacheID++&&(i.rec=0)}),kn(e)&&(kt.history.scrollRestoration=Lm=e)},sn,Ho=0,i0,GA=function(){if(i0!==Ho){var e=i0=Ho;requestAnimationFrame(function(){return e===Ho&&Ro(!0)})}},lx=function(){Qt.appendChild(tl),Rm=!tn&&tl.offsetHeight||kt.innerHeight,Qt.removeChild(tl)},n0=function(e){return Yc(".gsap-marker-start, .gsap-marker-end, .gsap-marker-scroller-start, .gsap-marker-scroller-end").forEach(function(t){return t.style.display=e?"none":"block"})},Ro=function(e,t){if(ss&&!e&&!Zh){Pi(ft,"scrollEnd",rx);return}lx(),sn=ft.isRefreshing=!0,At.forEach(function(n){return on(n)&&++n.cacheID&&(n.rec=n())});var i=ea("refreshInit");$b&&ft.sort(),t||Nm(),At.forEach(function(n){on(n)&&(n.smooth&&(n.target.style.scrollBehavior="auto"),n(0))}),Dt.slice(0).forEach(function(n){return n.refresh()}),Zh=!1,Dt.forEach(function(n){if(n._subPinOffset&&n.pin){var s=n.vars.horizontal?"offsetWidth":"offsetHeight",a=n.pin[s];n.revert(!0,1),n.adjustPinSpacing(n.pin[s]-a),n.refresh()}}),Hf=1,n0(!0),Dt.forEach(function(n){var s=Ls(n.scroller,n._dir),a=n.vars.end==="max"||n._endClamp&&n.end>s,o=n._startClamp&&n.start>=s;(a||o)&&n.setPositions(o?s-1:n.start,a?Math.max(o?s:n.start+1,s):n.end,!0)}),n0(!1),Hf=0,i.forEach(function(n){return n&&n.render&&n.render(-1)}),At.forEach(function(n){on(n)&&(n.smooth&&requestAnimationFrame(function(){return n.target.style.scrollBehavior="smooth"}),n.rec&&n(n.rec))}),ax(Lm,1),Kh.pause(),Ho++,sn=2,hr(2),Dt.forEach(function(n){return on(n.vars.onRefresh)&&n.vars.onRefresh(n)}),sn=ft.isRefreshing=!1,ea("refresh")},jf=0,Vh=1,Fc,hr=function(e){if(e===2||!sn&&!Zh){ft.isUpdating=!0,Fc&&Fc.update(0);var t=Dt.length,i=zi(),n=i-Zp>=50,s=t&&Dt[0].scroll();if(Vh=jf>s?-1:1,sn||(jf=s),n&&(ss&&!gd&&i-ss>200&&(ss=0,ea("scrollEnd")),vc=Zp,Zp=i),Vh<0){for(nn=t;nn-- >0;)Dt[nn]&&Dt[nn].update(0,n);Vh=1}else for(nn=0;nn<t;nn++)Dt[nn]&&Dt[nn].update(0,n);ft.isUpdating=!1}Kc=0},qf=[ix,nx,Im,km,Jn+Ic,Jn+Lc,Jn+kc,Jn+Rc,"display","flexShrink","float","zIndex","gridColumnStart","gridColumnEnd","gridRowStart","gridRowEnd","gridArea","justifySelf","alignSelf","placeSelf","order"],zh=qf.concat([Uo,Go,"boxSizing","max"+dl,"max"+Fm,"position",Jn,gi,gi+kc,gi+Lc,gi+Ic,gi+Rc]),HA=function(e,t,i){il(i);var n=e._gsap;if(n.spacerIsNative)il(n.spacerState);else if(e._gsap.swappedIn){var s=t.parentNode;s&&(s.insertBefore(e,t),s.removeChild(t))}e._gsap.swappedIn=!1},ef=function(e,t,i,n){if(!e._gsap.swappedIn){for(var s=qf.length,a=t.style,o=e.style,u;s--;)u=qf[s],a[u]=i[u];a.position=i.position==="absolute"?"absolute":"relative",i.display==="inline"&&(a.display="inline-block"),o[Im]=o[km]="auto",a.flexBasis=i.flexBasis||"auto",a.overflow="visible",a.boxSizing="border-box",a[Uo]=Jh(e,rn)+wi,a[Go]=Jh(e,yi)+wi,a[gi]=o[Jn]=o[nx]=o[ix]="0",il(n),o[Uo]=o["max"+dl]=i[Uo],o[Go]=o["max"+Fm]=i[Go],o[gi]=i[gi],e.parentNode!==t&&(e.parentNode.insertBefore(t,e),t.appendChild(e)),e._gsap.swappedIn=!0}},WA=/([A-Z])/g,il=function(e){if(e){var t=e.t.style,i=e.length,n=0,s,a;for((e.t._gsap||Ke.core.getCache(e.t)).uncache=1;n<i;n+=2)a=e[n+1],s=e[n],a?t[s]=a:t[s]&&t.removeProperty(s.replace(WA,"-$1").toLowerCase())}},Th=function(e){for(var t=zh.length,i=e.style,n=[],s=0;s<t;s++)n.push(zh[s],i[zh[s]]);return n.t=e,n},jA=function(e,t,i){for(var n=[],s=e.length,a=i?8:0,o;a<s;a+=2)o=e[a],n.push(o,o in t?t[o]:e[a+1]);return n.t=e.t,n},Uh={left:0,top:0},s0=function(e,t,i,n,s,a,o,u,h,f,c,d,m,x){on(e)&&(e=e(u)),kn(e)&&e.substr(0,3)==="max"&&(e=d+(e.charAt(4)==="="?Nh("0"+e.substr(3),i):0));var _=m?m.time():0,b,y,M;if(m&&m.seek(0),isNaN(e)||(e=+e),wc(e))m&&(e=Ke.utils.mapRange(m.scrollTrigger.start,m.scrollTrigger.end,0,d,e)),o&&Bh(o,i,n,!0);else{on(t)&&(t=t(u));var D=(e||"0").split(" "),C,P,I,F;M=_n(t,u)||Qt,C=rr(M)||{},(!C||!C.left&&!C.top)&&Qn(M).display==="none"&&(F=M.style.display,M.style.display="block",C=rr(M),F?M.style.display=F:M.style.removeProperty("display")),P=Nh(D[0],C[n.d]),I=Nh(D[1]||"0",i),e=C[n.p]-h[n.p]-f+P+s-I,o&&Bh(o,I,n,i-I<20||o._isStart&&I>20),i-=i-I}if(x&&(u[x]=e||-.001,e<0&&(e=0)),a){var A=e+i,k=a._isStart;b="scroll"+n.d2,Bh(a,A,n,k&&A>20||!k&&(c?Math.max(Qt[b],gs[b]):a.parentNode[b])<=A+1),c&&(h=rr(o),c&&(a.style[n.op.p]=h[n.op.p]-n.op.m-a._offset+wi))}return m&&M&&(b=rr(M),m.seek(d),y=rr(M),m._caScrollDist=b[n.p]-y[n.p],e=e/m._caScrollDist*d),m&&m.seek(_),m?e:Math.round(e)},qA=/(webkit|moz|length|cssText|inset)/i,r0=function(e,t,i,n){if(e.parentNode!==t){var s=e.style,a,o;if(t===Qt){e._stOrig=s.cssText,o=Qn(e);for(a in o)!+a&&!qA.test(a)&&o[a]&&typeof s[a]=="string"&&a!=="0"&&(s[a]=o[a]);s.top=i,s.left=n}else s.cssText=e._stOrig;Ke.core.getCache(e).uncache=1,t.appendChild(e)}},cx=function(e,t,i){var n=t,s=n;return function(a){var o=Math.round(e());return o!==n&&o!==s&&Math.abs(o-n)>3&&Math.abs(o-s)>3&&(a=o,i&&i()),s=n,n=a,a}},Eh=function(e,t,i){var n={};n[t.p]="+="+i,Ke.set(e,n)},o0=function(e,t){var i=Zr(e,t),n="_scroll"+t.p2,s=function a(o,u,h,f,c){var d=a.tween,m=u.onComplete,x={};h=h||i();var _=cx(i,h,function(){d.kill(),a.tween=0});return c=f&&c||0,f=f||o-h,d&&d.kill(),u[n]=o,u.inherit=!1,u.modifiers=x,x[n]=function(){return _(h+f*d.ratio+c*d.ratio*d.ratio)},u.onUpdate=function(){At.cache++,a.tween&&hr()},u.onComplete=function(){a.tween=0,m&&m.call(d)},d=a.tween=Ke.to(e,u),d};return e[n]=i,i.wheelHandler=function(){return s.tween&&s.tween.kill()&&(s.tween=0)},Pi(e,"wheel",i.wheelHandler),ft.isTouch&&Pi(e,"touchmove",i.wheelHandler),s},ft=function(){function r(t,i){Ha||r.register(Ke)||console.warn("Please gsap.registerPlugin(ScrollTrigger)"),Gf(this),this.init(t,i)}var e=r.prototype;return e.init=function(i,n){if(this.progress=this.start=0,this.vars&&this.kill(!0,!0),!bc){this.update=this.refresh=this.kill=Es;return}i=Qv(kn(i)||wc(i)||i.nodeType?{trigger:i}:i,Sh);var s=i,a=s.onUpdate,o=s.toggleClass,u=s.id,h=s.onToggle,f=s.onRefresh,c=s.scrub,d=s.trigger,m=s.pin,x=s.pinSpacing,_=s.invalidateOnRefresh,b=s.anticipatePin,y=s.onScrubComplete,M=s.onSnapComplete,D=s.once,C=s.snap,P=s.pinReparent,I=s.pinSpacer,F=s.containerAnimation,A=s.fastScrollEnd,k=s.preventOverlaps,O=i.horizontal||i.containerAnimation&&i.horizontal!==!1?rn:yi,J=!c&&c!==0,Q=_n(i.scroller||kt),X=Ke.core.getCache(Q),j=Jo(Q),K=("pinType"in i?i.pinType:Xr(Q,"pinType")||j&&"fixed")==="fixed",ie=[i.onEnter,i.onLeave,i.onEnterBack,i.onLeaveBack],ee=J&&i.toggleActions.split(" "),V="markers"in i?i.markers:Sh.markers,_e=j?0:parseFloat(Qn(Q)["border"+O.p2+dl])||0,U=this,oe=i.onRefreshInit&&function(){return i.onRefreshInit(U)},ce=OA(Q,j,O),me=NA(Q,j),le=0,be=0,ue=0,We=Zr(Q,O),ye,Ne,Ce,Ze,Qe,Pe,ct,xt,mt,he,Tt,_t,Ot,wt,G,N,fe,xe,Me,Se,je,H,ne,Fe,Te,Re,He,ze,ut,ht,Ct,$,ge,we,ke,Ge,St,Vt,Lt;if(U._startClamp=U._endClamp=!1,U._dir=O,b*=45,U.scroller=Q,U.scroll=F?F.time.bind(F):We,Ze=We(),U.vars=i,n=n||i.animation,"refreshPriority"in i&&($b=1,i.refreshPriority===-9999&&(Fc=U)),X.tweenScroll=X.tweenScroll||{top:o0(Q,yi),left:o0(Q,rn)},U.tweenTo=ye=X.tweenScroll[O.p],U.scrubDuration=function(Ie){ge=wc(Ie)&&Ie,ge?$?$.duration(Ie):$=Ke.to(n,{ease:"expo",totalProgress:"+=0",inherit:!1,duration:ge,paused:!0,onComplete:function(){return y&&y(U)}}):($&&$.progress(1).kill(),$=0)},n&&(n.vars.lazy=!1,n._initted&&!U.isReverted||n.vars.immediateRender!==!1&&i.immediateRender!==!1&&n.duration()&&n.render(0,!0,!0),U.animation=n.pause(),n.scrollTrigger=U,U.scrubDuration(c),ht=0,u||(u=n.vars.id)),C&&((!Eo(C)||C.push)&&(C={snapTo:C}),"scrollBehavior"in Qt.style&&Ke.set(j?[Qt,gs]:Q,{scrollBehavior:"auto"}),At.forEach(function(Ie){return on(Ie)&&Ie.target===(j?ni.scrollingElement||gs:Q)&&(Ie.smooth=!1)}),Ce=on(C.snapTo)?C.snapTo:C.snapTo==="labels"?VA(n):C.snapTo==="labelsDirectional"?zA(n):C.directional!==!1?function(Ie,at){return Om(C.snapTo)(Ie,zi()-be<500?0:at.direction)}:Ke.utils.snap(C.snapTo),we=C.duration||{min:.1,max:2},we=Eo(we)?Ac(we.min,we.max):Ac(we,we),ke=Ke.delayedCall(C.delay||ge/2||.1,function(){var Ie=We(),at=zi()-be<500,et=ye.tween;if((at||Math.abs(U.getVelocity())<10)&&!et&&!gd&&le!==Ie){var lt=(Ie-Pe)/wt,B=n&&!J?n.totalProgress():lt,te=at?0:(B-Ct)/(zi()-vc)*1e3||0,de=Ke.utils.clamp(-lt,1-lt,Oa(te/2)*te/.185),se=lt+(C.inertia===!1?0:de),pe,Oe,Be=C,rt=Be.onStart,Ye=Be.onInterrupt,ot=Be.onComplete;if(pe=Ce(se,U),wc(pe)||(pe=se),Oe=Math.round(Pe+pe*wt),Ie<=ct&&Ie>=Pe&&Oe!==Ie){if(et&&!et._initted&&et.data<=Oa(Oe-Ie))return;C.inertia===!1&&(de=pe-lt),ye(Oe,{duration:we(Oa(Math.max(Oa(se-B),Oa(pe-B))*.185/te/.05||0)),ease:C.ease||"power3",data:Oa(Oe-Ie),onInterrupt:function(){return ke.restart(!0)&&Ye&&Ye(U)},onComplete:function(){U.update(),le=We(),n&&($?$.resetTo("totalProgress",pe,n._tTime/n._tDur):n.progress(pe)),ht=Ct=n&&!J?n.totalProgress():U.progress,M&&M(U),ot&&ot(U)}},Ie,de*wt,Oe-Ie-de*wt),rt&&rt(U,ye.tween)}}else U.isActive&&le!==Ie&&ke.restart(!0)}).pause()),u&&(Wf[u]=U),d=U.trigger=_n(d||m!==!0&&m),Lt=d&&d._gsap&&d._gsap.stRevert,Lt&&(Lt=Lt(U)),m=m===!0?d:_n(m),kn(o)&&(o={targets:d,className:o}),m&&(x===!1||x===Jn||(x=!x&&m.parentNode&&m.parentNode.style&&Qn(m.parentNode).display==="flex"?!1:gi),U.pin=m,Ne=Ke.core.getCache(m),Ne.spacer?G=Ne.pinState:(I&&(I=_n(I),I&&!I.nodeType&&(I=I.current||I.nativeElement),Ne.spacerIsNative=!!I,I&&(Ne.spacerState=Th(I))),Ne.spacer=xe=I||ni.createElement("div"),xe.classList.add("pin-spacer"),u&&xe.classList.add("pin-spacer-"+u),Ne.pinState=G=Th(m)),i.force3D!==!1&&Ke.set(m,{force3D:!0}),U.spacer=xe=Ne.spacer,ut=Qn(m),Fe=ut[x+O.os2],Se=Ke.getProperty(m),je=Ke.quickSetter(m,O.a,wi),ef(m,xe,ut),fe=Th(m)),V){_t=Eo(V)?Qv(V,e0):e0,he=Mh("scroller-start",u,Q,O,_t,0),Tt=Mh("scroller-end",u,Q,O,_t,0,he),Me=he["offset"+O.op.d2];var bi=_n(Xr(Q,"content")||Q);xt=this.markerStart=Mh("start",u,bi,O,_t,Me,0,F),mt=this.markerEnd=Mh("end",u,bi,O,_t,Me,0,F),F&&(Vt=Ke.quickSetter([xt,mt],O.a,wi)),!K&&!(Is.length&&Xr(Q,"fixedMarkers")===!0)&&(BA(j?Qt:Q),Ke.set([he,Tt],{force3D:!0}),Re=Ke.quickSetter(he,O.a,wi),ze=Ke.quickSetter(Tt,O.a,wi))}if(F){var Le=F.vars.onUpdate,$e=F.vars.onUpdateParams;F.eventCallback("onUpdate",function(){U.update(0,0,1),Le&&Le.apply(F,$e||[])})}if(U.previous=function(){return Dt[Dt.indexOf(U)-1]},U.next=function(){return Dt[Dt.indexOf(U)+1]},U.revert=function(Ie,at){if(!at)return U.kill(!0);var et=Ie!==!1||!U.enabled,lt=Vi;et!==U.isReverted&&(et&&(Ge=Math.max(We(),U.scroll.rec||0),ue=U.progress,St=n&&n.progress()),xt&&[xt,mt,he,Tt].forEach(function(B){return B.style.display=et?"none":"block"}),et&&(Vi=U,U.update(et)),m&&(!P||!U.isActive)&&(et?HA(m,xe,G):ef(m,xe,Qn(m),Te)),et||U.update(et),Vi=lt,U.isReverted=et)},U.refresh=function(Ie,at,et,lt){if(!((Vi||!U.enabled)&&!at)){if(m&&Ie&&ss){Pi(r,"scrollEnd",rx);return}!sn&&oe&&oe(U),Vi=U,ye.tween&&!et&&(ye.tween.kill(),ye.tween=0),$&&$.pause(),_&&n&&n.revert({kill:!1}).invalidate(),U.isReverted||U.revert(!0,!0),U._subPinOffset=!1;var B=ce(),te=me(),de=F?F.duration():Ls(Q,O),se=wt<=.01,pe=0,Oe=lt||0,Be=Eo(et)?et.end:i.end,rt=i.endTrigger||d,Ye=Eo(et)?et.start:i.start||(i.start===0||!d?0:m?"0 0":"0 100%"),ot=U.pinnedContainer=i.pinnedContainer&&_n(i.pinnedContainer,U),gt=d&&Math.max(0,Dt.indexOf(U))||0,nt=gt,bt,Ft,Yt,Ii,yt,tt,ai,Kt,zt,Hn,ii,hn,Zt;for(V&&Eo(et)&&(hn=Ke.getProperty(he,O.p),Zt=Ke.getProperty(Tt,O.p));nt--;)tt=Dt[nt],tt.end||tt.refresh(0,1)||(Vi=U),ai=tt.pin,ai&&(ai===d||ai===m||ai===ot)&&!tt.isReverted&&(Hn||(Hn=[]),Hn.unshift(tt),tt.revert(!0,!0)),tt!==Dt[nt]&&(gt--,nt--);for(on(Ye)&&(Ye=Ye(U)),Ye=Yv(Ye,"start",U),Pe=s0(Ye,d,B,O,We(),xt,he,U,te,_e,K,de,F,U._startClamp&&"_startClamp")||(m?-.001:0),on(Be)&&(Be=Be(U)),kn(Be)&&!Be.indexOf("+=")&&(~Be.indexOf(" ")?Be=(kn(Ye)?Ye.split(" ")[0]:"")+Be:(pe=Nh(Be.substr(2),B),Be=kn(Ye)?Ye:(F?Ke.utils.mapRange(0,F.duration(),F.scrollTrigger.start,F.scrollTrigger.end,Pe):Pe)+pe,rt=d)),Be=Yv(Be,"end",U),ct=Math.max(Pe,s0(Be||(rt?"100% 0":de),rt,B,O,We()+pe,mt,Tt,U,te,_e,K,de,F,U._endClamp&&"_endClamp"))||-.001,pe=0,nt=gt;nt--;)tt=Dt[nt],ai=tt.pin,ai&&tt.start-tt._pinPush<=Pe&&!F&&tt.end>0&&(bt=tt.end-(U._startClamp?Math.max(0,tt.start):tt.start),(ai===d&&tt.start-tt._pinPush<Pe||ai===ot)&&isNaN(Ye)&&(pe+=bt*(1-tt.progress)),ai===m&&(Oe+=bt));if(Pe+=pe,ct+=pe,U._startClamp&&(U._startClamp+=pe),U._endClamp&&!sn&&(U._endClamp=ct||-.001,ct=Math.min(ct,Ls(Q,O))),wt=ct-Pe||(Pe-=.01)&&.001,se&&(ue=Ke.utils.clamp(0,1,Ke.utils.normalize(Pe,ct,Ge))),U._pinPush=Oe,xt&&pe&&(bt={},bt[O.a]="+="+pe,ot&&(bt[O.p]="-="+We()),Ke.set([xt,mt],bt)),m&&!(Hf&&U.end>=Ls(Q,O)))bt=Qn(m),Ii=O===yi,Yt=We(),H=parseFloat(Se(O.a))+Oe,!de&&ct>1&&(ii=(j?ni.scrollingElement||gs:Q).style,ii={style:ii,value:ii["overflow"+O.a.toUpperCase()]},j&&Qn(Qt)["overflow"+O.a.toUpperCase()]!=="scroll"&&(ii.style["overflow"+O.a.toUpperCase()]="scroll")),ef(m,xe,bt),fe=Th(m),Ft=rr(m,!0),Kt=K&&Zr(Q,Ii?rn:yi)(),x?(Te=[x+O.os2,wt+Oe+wi],Te.t=xe,nt=x===gi?Jh(m,O)+wt+Oe:0,nt&&(Te.push(O.d,nt+wi),xe.style.flexBasis!=="auto"&&(xe.style.flexBasis=nt+wi)),il(Te),ot&&Dt.forEach(function(Ti){Ti.pin===ot&&Ti.vars.pinSpacing!==!1&&(Ti._subPinOffset=!0)}),K&&We(Ge)):(nt=Jh(m,O),nt&&xe.style.flexBasis!=="auto"&&(xe.style.flexBasis=nt+wi)),K&&(yt={top:Ft.top+(Ii?Yt-Pe:Kt)+wi,left:Ft.left+(Ii?Kt:Yt-Pe)+wi,boxSizing:"border-box",position:"fixed"},yt[Uo]=yt["max"+dl]=Math.ceil(Ft.width)+wi,yt[Go]=yt["max"+Fm]=Math.ceil(Ft.height)+wi,yt[Jn]=yt[Jn+kc]=yt[Jn+Lc]=yt[Jn+Ic]=yt[Jn+Rc]="0",yt[gi]=bt[gi],yt[gi+kc]=bt[gi+kc],yt[gi+Lc]=bt[gi+Lc],yt[gi+Ic]=bt[gi+Ic],yt[gi+Rc]=bt[gi+Rc],N=jA(G,yt,P),sn&&We(0)),n?(zt=n._initted,Yp(1),n.render(n.duration(),!0,!0),ne=Se(O.a)-H+wt+Oe,He=Math.abs(wt-ne)>1,K&&He&&N.splice(N.length-2,2),n.render(0,!0,!0),zt||n.invalidate(!0),n.parent||n.totalTime(n.totalTime()),Yp(0)):ne=wt,ii&&(ii.value?ii.style["overflow"+O.a.toUpperCase()]=ii.value:ii.style.removeProperty("overflow-"+O.a));else if(d&&We()&&!F)for(Ft=d.parentNode;Ft&&Ft!==Qt;)Ft._pinOffset&&(Pe-=Ft._pinOffset,ct-=Ft._pinOffset),Ft=Ft.parentNode;Hn&&Hn.forEach(function(Ti){return Ti.revert(!1,!0)}),U.start=Pe,U.end=ct,Ze=Qe=sn?Ge:We(),!F&&!sn&&(Ze<Ge&&We(Ge),U.scroll.rec=0),U.revert(!1,!0),be=zi(),ke&&(le=-1,ke.restart(!0)),Vi=0,n&&J&&(n._initted||St)&&n.progress()!==St&&n.progress(St||0,!0).render(n.time(),!0,!0),(se||ue!==U.progress||F||_)&&(n&&!J&&n.totalProgress(F&&Pe<-.001&&!ue?Ke.utils.normalize(Pe,ct,0):ue,!0),U.progress=se||(Ze-Pe)/wt===ue?0:ue),m&&x&&(xe._pinOffset=Math.round(U.progress*ne)),$&&$.invalidate(),isNaN(hn)||(hn-=Ke.getProperty(he,O.p),Zt-=Ke.getProperty(Tt,O.p),Eh(he,O,hn),Eh(xt,O,hn-(lt||0)),Eh(Tt,O,Zt),Eh(mt,O,Zt-(lt||0))),se&&!sn&&U.update(),f&&!sn&&!Ot&&(Ot=!0,f(U),Ot=!1)}},U.getVelocity=function(){return(We()-Qe)/(zi()-vc)*1e3||0},U.endAnimation=function(){dc(U.callbackAnimation),n&&($?$.progress(1):n.paused()?J||dc(n,U.direction<0,1):dc(n,n.reversed()))},U.labelToScroll=function(Ie){return n&&n.labels&&(Pe||U.refresh()||Pe)+n.labels[Ie]/n.duration()*wt||0},U.getTrailing=function(Ie){var at=Dt.indexOf(U),et=U.direction>0?Dt.slice(0,at).reverse():Dt.slice(at+1);return(kn(Ie)?et.filter(function(lt){return lt.vars.preventOverlaps===Ie}):et).filter(function(lt){return U.direction>0?lt.end<=Pe:lt.start>=ct})},U.update=function(Ie,at,et){if(!(F&&!et&&!Ie)){var lt=sn===!0?Ge:U.scroll(),B=Ie?0:(lt-Pe)/wt,te=B<0?0:B>1?1:B||0,de=U.progress,se,pe,Oe,Be,rt,Ye,ot,gt;if(at&&(Qe=Ze,Ze=F?We():lt,C&&(Ct=ht,ht=n&&!J?n.totalProgress():te)),b&&m&&!Vi&&!bh&&ss&&(!te&&Pe<lt+(lt-Qe)/(zi()-vc)*b?te=1e-4:te===1&&ct>lt+(lt-Qe)/(zi()-vc)*b&&(te=.9999)),te!==de&&U.enabled){if(se=U.isActive=!!te&&te<1,pe=!!de&&de<1,Ye=se!==pe,rt=Ye||!!te!=!!de,U.direction=te>de?1:-1,U.progress=te,rt&&!Vi&&(Oe=te&&!de?0:te===1?1:de===1?2:3,J&&(Be=!Ye&&ee[Oe+1]!=="none"&&ee[Oe+1]||ee[Oe],gt=n&&(Be==="complete"||Be==="reset"||Be in n))),k&&(Ye||gt)&&(gt||c||!n)&&(on(k)?k(U):U.getTrailing(k).forEach(function(Yt){return Yt.endAnimation()})),J||($&&!Vi&&!bh?($._dp._time-$._start!==$._time&&$.render($._dp._time-$._start),$.resetTo?$.resetTo("totalProgress",te,n._tTime/n._tDur):($.vars.totalProgress=te,$.invalidate().restart())):n&&n.totalProgress(te,!!(Vi&&(be||Ie)))),m){if(Ie&&x&&(xe.style[x+O.os2]=Fe),!K)je(xc(H+ne*te));else if(rt){if(ot=!Ie&&te>de&&ct+1>lt&&lt+1>=Ls(Q,O),P)if(!Ie&&(se||ot)){var nt=rr(m,!0),bt=lt-Pe;r0(m,Qt,nt.top+(O===yi?bt:0)+wi,nt.left+(O===yi?0:bt)+wi)}else r0(m,xe);il(se||ot?N:fe),He&&te<1&&se||je(H+(te===1&&!ot?ne:0))}}C&&!ye.tween&&!Vi&&!bh&&ke.restart(!0),o&&(Ye||D&&te&&(te<1||!Kp))&&Yc(o.targets).forEach(function(Yt){return Yt.classList[se||D?"add":"remove"](o.className)}),a&&!J&&!Ie&&a(U),rt&&!Vi?(J&&(gt&&(Be==="complete"?n.pause().totalProgress(1):Be==="reset"?n.restart(!0).pause():Be==="restart"?n.restart(!0):n[Be]()),a&&a(U)),(Ye||!Kp)&&(h&&Ye&&Jp(U,h),ie[Oe]&&Jp(U,ie[Oe]),D&&(te===1?U.kill(!1,1):ie[Oe]=0),Ye||(Oe=te===1?1:3,ie[Oe]&&Jp(U,ie[Oe]))),A&&!se&&Math.abs(U.getVelocity())>(wc(A)?A:2500)&&(dc(U.callbackAnimation),$?$.progress(1):dc(n,Be==="reverse"?1:!te,1))):J&&a&&!Vi&&a(U)}if(ze){var Ft=F?lt/F.duration()*(F._caScrollDist||0):lt;Re(Ft+(he._isFlipped?1:0)),ze(Ft)}Vt&&Vt(-lt/F.duration()*(F._caScrollDist||0))}},U.enable=function(Ie,at){U.enabled||(U.enabled=!0,Pi(Q,"resize",yc),j||Pi(Q,"scroll",Na),oe&&Pi(r,"refreshInit",oe),Ie!==!1&&(U.progress=ue=0,Ze=Qe=le=We()),at!==!1&&U.refresh())},U.getTween=function(Ie){return Ie&&ye?ye.tween:$},U.setPositions=function(Ie,at,et,lt){if(F){var B=F.scrollTrigger,te=F.duration(),de=B.end-B.start;Ie=B.start+de*Ie/te,at=B.start+de*at/te}U.refresh(!1,!1,{start:Kv(Ie,et&&!!U._startClamp),end:Kv(at,et&&!!U._endClamp)},lt),U.update()},U.adjustPinSpacing=function(Ie){if(Te&&Ie){var at=Te.indexOf(O.d)+1;Te[at]=parseFloat(Te[at])+Ie+wi,Te[1]=parseFloat(Te[1])+Ie+wi,il(Te)}},U.disable=function(Ie,at){if(U.enabled&&(Ie!==!1&&U.revert(!0,!0),U.enabled=U.isActive=!1,at||$&&$.pause(),Ge=0,Ne&&(Ne.uncache=1),oe&&Di(r,"refreshInit",oe),ke&&(ke.pause(),ye.tween&&ye.tween.kill()&&(ye.tween=0)),!j)){for(var et=Dt.length;et--;)if(Dt[et].scroller===Q&&Dt[et]!==U)return;Di(Q,"resize",yc),j||Di(Q,"scroll",Na)}},U.kill=function(Ie,at){U.disable(Ie,at),$&&!at&&$.kill(),u&&delete Wf[u];var et=Dt.indexOf(U);et>=0&&Dt.splice(et,1),et===nn&&Vh>0&&nn--,et=0,Dt.forEach(function(lt){return lt.scroller===U.scroller&&(et=1)}),et||sn||(U.scroll.rec=0),n&&(n.scrollTrigger=null,Ie&&n.revert({kill:!1}),at||n.kill()),xt&&[xt,mt,he,Tt].forEach(function(lt){return lt.parentNode&&lt.parentNode.removeChild(lt)}),Fc===U&&(Fc=0),m&&(Ne&&(Ne.uncache=1),et=0,Dt.forEach(function(lt){return lt.pin===m&&et++}),et||(Ne.spacer=0)),i.onKill&&i.onKill(U)},Dt.push(U),U.enable(!1,!1),Lt&&Lt(U),n&&n.add&&!wt){var it=U.update;U.update=function(){U.update=it,Pe||ct||U.refresh()},Ke.delayedCall(.01,U.update),wt=.01,Pe=ct=0}else U.refresh();m&&GA()},r.register=function(i){return Ha||(Ke=i||Qb(),Jb()&&window.document&&r.enable(),Ha=bc),Ha},r.defaults=function(i){if(i)for(var n in i)Sh[n]=i[n];return Sh},r.disable=function(i,n){bc=0,Dt.forEach(function(a){return a[n?"kill":"disable"](i)}),Di(kt,"wheel",Na),Di(ni,"scroll",Na),clearInterval(vh),Di(ni,"touchcancel",Es),Di(Qt,"touchstart",Es),wh(Di,ni,"pointerdown,touchstart,mousedown",Zv),wh(Di,ni,"pointerup,touchend,mouseup",Jv),Kh.kill(),xh(Di);for(var s=0;s<At.length;s+=3)yh(Di,At[s],At[s+1]),yh(Di,At[s],At[s+2])},r.enable=function(){if(kt=window,ni=document,gs=ni.documentElement,Qt=ni.body,Ke&&(Yc=Ke.utils.toArray,Ac=Ke.utils.clamp,Gf=Ke.core.context||Es,Yp=Ke.core.suppressOverwrites||Es,Lm=kt.history.scrollRestoration||"auto",jf=kt.pageYOffset,Ke.core.globals("ScrollTrigger",r),Qt)){bc=1,tl=document.createElement("div"),tl.style.height="100vh",tl.style.position="absolute",lx(),FA(),oi.register(Ke),r.isTouch=oi.isTouch,Nr=oi.isTouch&&/(iPad|iPhone|iPod|Mac)/g.test(navigator.userAgent),Uf=oi.isTouch===1,Pi(kt,"wheel",Na),Xb=[kt,ni,gs,Qt],Ke.matchMedia?(r.matchMedia=function(u){var h=Ke.matchMedia(),f;for(f in u)h.add(f,u[f]);return h},Ke.addEventListener("matchMediaInit",function(){return Nm()}),Ke.addEventListener("matchMediaRevert",function(){return ox()}),Ke.addEventListener("matchMedia",function(){Ro(0,1),ea("matchMedia")}),Ke.matchMedia("(orientation: portrait)",function(){return Qp(),Qp})):console.warn("Requires GSAP 3.11.0 or later"),Qp(),Pi(ni,"scroll",Na);var i=Qt.style,n=i.borderTopStyle,s=Ke.core.Animation.prototype,a,o;for(s.revert||Object.defineProperty(s,"revert",{value:function(){return this.time(-.01,!0)}}),i.borderTopStyle="solid",a=rr(Qt),yi.m=Math.round(a.top+yi.sc())||0,rn.m=Math.round(a.left+rn.sc())||0,n?i.borderTopStyle=n:i.removeProperty("border-top-style"),vh=setInterval(t0,250),Ke.delayedCall(.5,function(){return bh=0}),Pi(ni,"touchcancel",Es),Pi(Qt,"touchstart",Es),wh(Pi,ni,"pointerdown,touchstart,mousedown",Zv),wh(Pi,ni,"pointerup,touchend,mouseup",Jv),zf=Ke.utils.checkPrefix("transform"),zh.push(zf),Ha=zi(),Kh=Ke.delayedCall(.2,Ro).pause(),Wa=[ni,"visibilitychange",function(){var u=kt.innerWidth,h=kt.innerHeight;ni.hidden?(Xv=u,$v=h):(Xv!==u||$v!==h)&&yc()},ni,"DOMContentLoaded",Ro,kt,"load",Ro,kt,"resize",yc],xh(Pi),Dt.forEach(function(u){return u.enable(0,1)}),o=0;o<At.length;o+=3)yh(Di,At[o],At[o+1]),yh(Di,At[o],At[o+2])}},r.config=function(i){"limitCallbacks"in i&&(Kp=!!i.limitCallbacks);var n=i.syncInterval;n&&clearInterval(vh)||(vh=n)&&setInterval(t0,n),"ignoreMobileResize"in i&&(Uf=r.isTouch===1&&i.ignoreMobileResize),"autoRefreshEvents"in i&&(xh(Di)||xh(Pi,i.autoRefreshEvents||"none"),Yb=(i.autoRefreshEvents+"").indexOf("resize")===-1)},r.scrollerProxy=function(i,n){var s=_n(i),a=At.indexOf(s),o=Jo(s);~a&&At.splice(a,o?6:2),n&&(o?Is.unshift(kt,n,Qt,n,gs,n):Is.unshift(s,n))},r.clearMatchMedia=function(i){Dt.forEach(function(n){return n._ctx&&n._ctx.query===i&&n._ctx.kill(!0,!0)})},r.isInViewport=function(i,n,s){var a=(kn(i)?_n(i):i).getBoundingClientRect(),o=a[s?Uo:Go]*n||0;return s?a.right-o>0&&a.left+o<kt.innerWidth:a.bottom-o>0&&a.top+o<kt.innerHeight},r.positionInViewport=function(i,n,s){kn(i)&&(i=_n(i));var a=i.getBoundingClientRect(),o=a[s?Uo:Go],u=n==null?o/2:n in Qh?Qh[n]*o:~n.indexOf("%")?parseFloat(n)*o/100:parseFloat(n)||0;return s?(a.left+u)/kt.innerWidth:(a.top+u)/kt.innerHeight},r.killAll=function(i){if(Dt.slice(0).forEach(function(s){return s.vars.id!=="ScrollSmoother"&&s.kill()}),i!==!0){var n=Qo.killAll||[];Qo={},n.forEach(function(s){return s()})}},r}();ft.version="3.12.5";ft.saveStyles=function(r){return r?Yc(r).forEach(function(e){if(e&&e.style){var t=Rn.indexOf(e);t>=0&&Rn.splice(t,5),Rn.push(e,e.style.cssText,e.getBBox&&e.getAttribute("transform"),Ke.core.getCache(e),Gf())}}):Rn};ft.revert=function(r,e){return Nm(!r,e)};ft.create=function(r,e){return new ft(r,e)};ft.refresh=function(r){return r?yc():(Ha||ft.register())&&Ro(!0)};ft.update=function(r){return++At.cache&&hr(r===!0?2:0)};ft.clearScrollMemory=ax;ft.maxScroll=function(r,e){return Ls(r,e?rn:yi)};ft.getScrollFunc=function(r,e){return Zr(_n(r),e?rn:yi)};ft.getById=function(r){return Wf[r]};ft.getAll=function(){return Dt.filter(function(r){return r.vars.id!=="ScrollSmoother"})};ft.isScrolling=function(){return!!ss};ft.snapDirectional=Om;ft.addEventListener=function(r,e){var t=Qo[r]||(Qo[r]=[]);~t.indexOf(e)||t.push(e)};ft.removeEventListener=function(r,e){var t=Qo[r],i=t&&t.indexOf(e);i>=0&&t.splice(i,1)};ft.batch=function(r,e){var t=[],i={},n=e.interval||.016,s=e.batchMax||1e9,a=function(h,f){var c=[],d=[],m=Ke.delayedCall(n,function(){f(c,d),c=[],d=[]}).pause();return function(x){c.length||m.restart(!0),c.push(x.trigger),d.push(x),s<=c.length&&m.progress(1)}},o;for(o in e)i[o]=o.substr(0,2)==="on"&&on(e[o])&&o!=="onRefreshInit"?a(o,e[o]):e[o];return on(s)&&(s=s(),Pi(ft,"refresh",function(){return s=e.batchMax()})),Yc(r).forEach(function(u){var h={};for(o in i)h[o]=i[o];h.trigger=u,t.push(ft.create(h))}),t};var a0=function(e,t,i,n){return t>n?e(n):t<0&&e(0),i>n?(n-t)/(i-t):i<0?t/(t-i):1},tf=function r(e,t){t===!0?e.style.removeProperty("touch-action"):e.style.touchAction=t===!0?"auto":t?"pan-"+t+(oi.isTouch?" pinch-zoom":""):"none",e===gs&&r(Qt,t)},Ch={auto:1,scroll:1},XA=function(e){var t=e.event,i=e.target,n=e.axis,s=(t.changedTouches?t.changedTouches[0]:t).target,a=s._gsap||Ke.core.getCache(s),o=zi(),u;if(!a._isScrollT||o-a._isScrollT>2e3){for(;s&&s!==Qt&&(s.scrollHeight<=s.clientHeight&&s.scrollWidth<=s.clientWidth||!(Ch[(u=Qn(s)).overflowY]||Ch[u.overflowX]));)s=s.parentNode;a._isScroll=s&&s!==i&&!Jo(s)&&(Ch[(u=Qn(s)).overflowY]||Ch[u.overflowX]),a._isScrollT=o}(a._isScroll||n==="x")&&(t.stopPropagation(),t._gsapAllow=!0)},ux=function(e,t,i,n){return oi.create({target:e,capture:!0,debounce:!1,lockAxis:!0,type:t,onWheel:n=n&&XA,onPress:n,onDrag:n,onScroll:n,onEnable:function(){return i&&Pi(ni,oi.eventTypes[0],c0,!1,!0)},onDisable:function(){return Di(ni,oi.eventTypes[0],c0,!0)}})},$A=/(input|label|select|textarea)/i,l0,c0=function(e){var t=$A.test(e.target.tagName);(t||l0)&&(e._gsapAllow=!0,l0=t)},YA=function(e){Eo(e)||(e={}),e.preventDefault=e.isNormalizer=e.allowClicks=!0,e.type||(e.type="wheel,touch"),e.debounce=!!e.debounce,e.id=e.id||"normalizer";var t=e,i=t.normalizeScrollX,n=t.momentum,s=t.allowNestedScroll,a=t.onRelease,o,u,h=_n(e.target)||gs,f=Ke.core.globals().ScrollSmoother,c=f&&f.get(),d=Nr&&(e.content&&_n(e.content)||c&&e.content!==!1&&!c.smooth()&&c.content()),m=Zr(h,yi),x=Zr(h,rn),_=1,b=(oi.isTouch&&kt.visualViewport?kt.visualViewport.scale*kt.visualViewport.width:kt.outerWidth)/kt.innerWidth,y=0,M=on(n)?function(){return n(o)}:function(){return n||2.8},D,C,P=ux(h,e.type,!0,s),I=function(){return C=!1},F=Es,A=Es,k=function(){u=Ls(h,yi),A=Ac(Nr?1:0,u),i&&(F=Ac(0,Ls(h,rn))),D=Ho},O=function(){d._gsap.y=xc(parseFloat(d._gsap.y)+m.offset)+"px",d.style.transform="matrix3d(1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, "+parseFloat(d._gsap.y)+", 0, 1)",m.offset=m.cacheID=0},J=function(){if(C){requestAnimationFrame(I);var V=xc(o.deltaY/2),_e=A(m.v-V);if(d&&_e!==m.v+m.offset){m.offset=_e-m.v;var U=xc((parseFloat(d&&d._gsap.y)||0)-m.offset);d.style.transform="matrix3d(1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, "+U+", 0, 1)",d._gsap.y=U+"px",m.cacheID=At.cache,hr()}return!0}m.offset&&O(),C=!0},Q,X,j,K,ie=function(){k(),Q.isActive()&&Q.vars.scrollY>u&&(m()>u?Q.progress(1)&&m(u):Q.resetTo("scrollY",u))};return d&&Ke.set(d,{y:"+=0"}),e.ignoreCheck=function(ee){return Nr&&ee.type==="touchmove"&&J()||_>1.05&&ee.type!=="touchstart"||o.isGesturing||ee.touches&&ee.touches.length>1},e.onPress=function(){C=!1;var ee=_;_=xc((kt.visualViewport&&kt.visualViewport.scale||1)/b),Q.pause(),ee!==_&&tf(h,_>1.01?!0:i?!1:"x"),X=x(),j=m(),k(),D=Ho},e.onRelease=e.onGestureStart=function(ee,V){if(m.offset&&O(),!V)K.restart(!0);else{At.cache++;var _e=M(),U,oe;i&&(U=x(),oe=U+_e*.05*-ee.velocityX/.227,_e*=a0(x,U,oe,Ls(h,rn)),Q.vars.scrollX=F(oe)),U=m(),oe=U+_e*.05*-ee.velocityY/.227,_e*=a0(m,U,oe,Ls(h,yi)),Q.vars.scrollY=A(oe),Q.invalidate().duration(_e).play(.01),(Nr&&Q.vars.scrollY>=u||U>=u-1)&&Ke.to({},{onUpdate:ie,duration:_e})}a&&a(ee)},e.onWheel=function(){Q._ts&&Q.pause(),zi()-y>1e3&&(D=0,y=zi())},e.onChange=function(ee,V,_e,U,oe){if(Ho!==D&&k(),V&&i&&x(F(U[2]===V?X+(ee.startX-ee.x):x()+V-U[1])),_e){m.offset&&O();var ce=oe[2]===_e,me=ce?j+ee.startY-ee.y:m()+_e-oe[1],le=A(me);ce&&me!==le&&(j+=le-me),m(le)}(_e||V)&&hr()},e.onEnable=function(){tf(h,i?!1:"x"),ft.addEventListener("refresh",ie),Pi(kt,"resize",ie),m.smooth&&(m.target.style.scrollBehavior="auto",m.smooth=x.smooth=!1),P.enable()},e.onDisable=function(){tf(h,!0),Di(kt,"resize",ie),ft.removeEventListener("refresh",ie),P.kill()},e.lockAxis=e.lockAxis!==!1,o=new oi(e),o.iOS=Nr,Nr&&!m()&&m(1),Nr&&Ke.ticker.add(Es),K=o._dc,Q=Ke.to(o,{ease:"power4",paused:!0,inherit:!1,scrollX:i?"+=0.1":"+=0",scrollY:"+=0.1",modifiers:{scrollY:cx(m,m(),function(){return Q.pause()})},onUpdate:hr,onComplete:K.vars.onComplete}),o};ft.sort=function(r){return Dt.sort(r||function(e,t){return(e.vars.refreshPriority||0)*-1e6+e.start-(t.start+(t.vars.refreshPriority||0)*-1e6)})};ft.observe=function(r){return new oi(r)};ft.normalizeScroll=function(r){if(typeof r>"u")return tn;if(r===!0&&tn)return tn.enable();if(r===!1){tn&&tn.kill(),tn=r;return}var e=r instanceof oi?r:YA(r);return tn&&tn.target===e.target&&tn.kill(),Jo(e.target)&&(tn=e),e};ft.core={_getVelocityProp:Vf,_inputObserver:ux,_scrollers:At,_proxies:Is,bridge:{ss:function(){ss||ea("scrollStart"),ss=zi()},ref:function(){return Vi}}};Qb()&&Ke.registerPlugin(ft);const Ka=class Ka{static init(e=!1,t={},i=!0){e?this.scrollBody(t):this.scrollContainer(t),De.on("scroll:lock",()=>this.lock()),De.on("scroll:unlock",()=>this.unlock()),E.SmoothScroll=this,i&&(this.scrollbar=new KA(this.Lenis)),this.lock()}static scrollTo(e,t={}){this.Lenis.scrollTo(e,t)}static lock(){E.body.classList.remove("smoothscroll-enabled"),this.Lenis.stop()}static unlock(){E.body.classList.add("smoothscroll-enabled"),this.Lenis.start()}static scrollBody(e={}){const t=Object.assign({},e);this.Lenis=new Wv(t),this.isBody=!0,this.configureScrollTrigger(),E.body.classList.add("smoothscroll-body"),E.RAFCollection.remove(this.onRAF),E.RAFCollection.add(this.onRAF,0)}static scrollContainer(e={}){const t=Object.assign({wrapper:st(".scroll-container"),content:st(".scroll-container > div")},e);this.Lenis=new Wv(t),this.isBody=!1,this.configureScrollTrigger(),E.body.classList.remove("smoothscroll-body"),E.RAFCollection.remove(this.onRAF),E.RAFCollection.add(this.onRAF,0)}static configureScrollTrigger(){const e=st(".scroll-container");this.isBody?ft.defaults({scroller:window}):ft.defaults({scroller:e}),this.Lenis.on("scroll",ft.update),ft.scrollerProxy(e,{scrollTop:t=>(arguments.length&&(this.isBody?E.html.scrollTop=t:e.scrollTop=t),this.isBody?E.html.scrollTop:this.Lenis.scroll),getBoundingClientRect(){return{top:0,left:0,width:E.window.w,height:E.window.h}}})}};q(Ka,"Lenis",null),q(Ka,"isBody",null),q(Ka,"onRAF",e=>{Ka.Lenis.raf(e*1e3)});let pl=Ka;class KA{constructor(e){q(this,"transform",()=>{this.mouseDown||(this.position=this.controller.scroll/this.controller.limit*(E.window.h-this.handleElHeight)),this.handleEl.style.transform=`translate(0px, ${this.position}px)`});q(this,"onScroll",()=>{this.transform(),Math.abs(this.controller.velocity)>0?this.show():this.hide()});q(this,"onResize",()=>{const e=this.controller.options.content.offsetHeight;if(this.scale=(e+E.window.h)/E.window.h,this.scale<=1){this.handleEl.style.height=0;return}this.trueSize=E.window.h/this.scale,this.handleElHeight=Math.max(this.trueSize,40),this.handleEl.style.height=`${this.handleElHeight}px`,this.maxY=E.window.h-this.handleElHeight});q(this,"onMouseMove",e=>{this.mouseDown&&(this.mousePos=e.clientY,this.position-=this.prevMousePos-this.mousePos,this.position=Math.min(Math.max(this.position,0),this.maxY),this.prevMousePos=this.mousePos,this.controller.scrollTo(this.position/this.maxY*this.controller.limit,{immediate:!0}))});q(this,"onMouseDown",e=>{this.mousePos=this.prevMousePos=e.clientY,this.mouseDown=!0,E.body.style.userSelect="none",this.wrapperEl.classList.add("active")});q(this,"onMouseUp",()=>{this.mouseDown=!1,E.body.style.removeProperty("user-select"),this.wrapperEl.classList.remove("active")});this.controller=e,this.options={wrapperClass:".unseen-scrollbar"},this.position=0,this.mousePos=0,this.prevMousePos=0,this.buildHTML(),this.addEvents(),this.onResize()}show(){this.wrapperEl.classList.add("show")}hide(){this.wrapperEl.classList.remove("show")}addEvents(){this.controller.on("scroll",this.onScroll),De.on("mousedown",this.handleEl,this.onMouseDown),De.on("mousemove",window,this.onMouseMove),De.on("mouseup",window,this.onMouseUp),De.on(Je.RESIZE,this.onResize),De.on("NAVIGATE_END",this.onResize)}buildHTML(){this.wrapperEl=document.createElement("div"),this.wrapperEl.classList.add(this.options.wrapperClass.substring(1)),this.handleEl=document.createElement("div"),this.handleEl.innerHTML="<div></div>",this.wrapperEl.appendChild(this.handleEl),document.body.appendChild(this.wrapperEl)}destroy(){this.controller.off("scroll",this.onScroll),De.off("mousedown",this.handleEl,this.onMouseDown),De.off("mousemove",window,this.onMouseMove),De.off("mouseup",window,this.onMouseUp),De.off(Je.RESIZE,this.onResize),De.off("NAVIGATE_END",this.onResize)}}function ir(r){if(r===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return r}function hx(r,e){r.prototype=Object.create(e.prototype),r.prototype.constructor=r,r.__proto__=e}/*!
 * GSAP 3.12.5
 * https://gsap.com
 *
 * @license Copyright 2008-2024, GreenSock. All rights reserved.
 * Subject to the terms at https://gsap.com/standard-license or for
 * Club GSAP members, the agreement issued with that membership.
 * @author: Jack Doyle, jack@greensock.com
*/var zn={autoSleep:120,force3D:"auto",nullTargetWarn:1,units:{lineHeight:""}},fl={duration:.5,overwrite:!1,delay:0},Bm,ji,ti,is=1e8,Jt=1/is,Xf=Math.PI*2,ZA=Xf/4,JA=0,dx=Math.sqrt,QA=Math.cos,eL=Math.sin,ki=function(e){return typeof e=="string"},hi=function(e){return typeof e=="function"},mr=function(e){return typeof e=="number"},Vm=function(e){return typeof e>"u"},Bs=function(e){return typeof e=="object"},wn=function(e){return e!==!1},zm=function(){return typeof window<"u"},Dh=function(e){return hi(e)||ki(e)},px=typeof ArrayBuffer=="function"&&ArrayBuffer.isView||function(){},qi=Array.isArray,$f=/(?:-?\.?\d|\.)+/gi,fx=/[-+=.]*\d+[.e\-+]*\d*[e\-+]*\d*/g,$a=/[-+=.]*\d+[.e-]*\d*[a-z%]*/g,nf=/[-+=.]*\d+\.?\d*(?:e-|e\+)?\d*/gi,mx=/[+-]=-?[.\d]+/,gx=/[^,'"\[\]\s]+/gi,tL=/^[+\-=e\s\d]*\d+[.\d]*([a-z]*|%)\s*$/i,si,Cs,Yf,Um,Un={},ed={},_x,vx=function(e){return(ed=ta(e,Un))&&Xi},Gm=function(e,t){return console.warn("Invalid property",e,"set to",t,"Missing plugin? gsap.registerPlugin()")},Zc=function(e,t){return!t&&console.warn(e)},bx=function(e,t){return e&&(Un[e]=t)&&ed&&(ed[e]=t)||Un},Jc=function(){return 0},iL={suppressEvents:!0,isStart:!0,kill:!1},Gh={suppressEvents:!0,kill:!1},nL={suppressEvents:!0},Hm={},$r=[],Kf={},xx,In={},sf={},u0=30,Hh=[],Wm="",jm=function(e){var t=e[0],i,n;if(Bs(t)||hi(t)||(e=[e]),!(i=(t._gsap||{}).harness)){for(n=Hh.length;n--&&!Hh[n].targetTest(t););i=Hh[n]}for(n=e.length;n--;)e[n]&&(e[n]._gsap||(e[n]._gsap=new Wx(e[n],i)))||e.splice(n,1);return e},Wo=function(e){return e._gsap||jm(ns(e))[0]._gsap},wx=function(e,t,i){return(i=e[t])&&hi(i)?e[t]():Vm(i)&&e.getAttribute&&e.getAttribute(t)||i},yn=function(e,t){return(e=e.split(",")).forEach(t)||e},pi=function(e){return Math.round(e*1e5)/1e5||0},Ri=function(e){return Math.round(e*1e7)/1e7||0},nl=function(e,t){var i=t.charAt(0),n=parseFloat(t.substr(2));return e=parseFloat(e),i==="+"?e+n:i==="-"?e-n:i==="*"?e*n:e/n},sL=function(e,t){for(var i=t.length,n=0;e.indexOf(t[n])<0&&++n<i;);return n<i},td=function(){var e=$r.length,t=$r.slice(0),i,n;for(Kf={},$r.length=0,i=0;i<e;i++)n=t[i],n&&n._lazy&&(n.render(n._lazy[0],n._lazy[1],!0)._lazy=0)},yx=function(e,t,i,n){$r.length&&!ji&&td(),e.render(t,i,n||ji&&t<0&&(e._initted||e._startAt)),$r.length&&!ji&&td()},Sx=function(e){var t=parseFloat(e);return(t||t===0)&&(e+"").match(gx).length<2?t:ki(e)?e.trim():e},Mx=function(e){return e},os=function(e,t){for(var i in t)i in e||(e[i]=t[i]);return e},rL=function(e){return function(t,i){for(var n in i)n in t||n==="duration"&&e||n==="ease"||(t[n]=i[n])}},ta=function(e,t){for(var i in t)e[i]=t[i];return e},h0=function r(e,t){for(var i in t)i!=="__proto__"&&i!=="constructor"&&i!=="prototype"&&(e[i]=Bs(t[i])?r(e[i]||(e[i]={}),t[i]):t[i]);return e},id=function(e,t){var i={},n;for(n in e)n in t||(i[n]=e[n]);return i},Oc=function(e){var t=e.parent||si,i=e.keyframes?rL(qi(e.keyframes)):os;if(wn(e.inherit))for(;t;)i(e,t.vars.defaults),t=t.parent||t._dp;return e},oL=function(e,t){for(var i=e.length,n=i===t.length;n&&i--&&e[i]===t[i];);return i<0},Tx=function(e,t,i,n,s){i===void 0&&(i="_first"),n===void 0&&(n="_last");var a=e[n],o;if(s)for(o=t[s];a&&a[s]>o;)a=a._prev;return a?(t._next=a._next,a._next=t):(t._next=e[i],e[i]=t),t._next?t._next._prev=t:e[n]=t,t._prev=a,t.parent=t._dp=e,t},_d=function(e,t,i,n){i===void 0&&(i="_first"),n===void 0&&(n="_last");var s=t._prev,a=t._next;s?s._next=a:e[i]===t&&(e[i]=a),a?a._prev=s:e[n]===t&&(e[n]=s),t._next=t._prev=t.parent=null},Jr=function(e,t){e.parent&&(!t||e.parent.autoRemoveChildren)&&e.parent.remove&&e.parent.remove(e),e._act=0},jo=function(e,t){if(e&&(!t||t._end>e._dur||t._start<0))for(var i=e;i;)i._dirty=1,i=i.parent;return e},aL=function(e){for(var t=e.parent;t&&t.parent;)t._dirty=1,t.totalDuration(),t=t.parent;return e},Zf=function(e,t,i,n){return e._startAt&&(ji?e._startAt.revert(Gh):e.vars.immediateRender&&!e.vars.autoRevert||e._startAt.render(t,!0,n))},lL=function r(e){return!e||e._ts&&r(e.parent)},d0=function(e){return e._repeat?ml(e._tTime,e=e.duration()+e._rDelay)*e:0},ml=function(e,t){var i=Math.floor(e/=t);return e&&i===e?i-1:i},nd=function(e,t){return(e-t._start)*t._ts+(t._ts>=0?0:t._dirty?t.totalDuration():t._tDur)},vd=function(e){return e._end=Ri(e._start+(e._tDur/Math.abs(e._ts||e._rts||Jt)||0))},bd=function(e,t){var i=e._dp;return i&&i.smoothChildTiming&&e._ts&&(e._start=Ri(i._time-(e._ts>0?t/e._ts:((e._dirty?e.totalDuration():e._tDur)-t)/-e._ts)),vd(e),i._dirty||jo(i,e)),e},Ex=function(e,t){var i;if((t._time||!t._dur&&t._initted||t._start<e._time&&(t._dur||!t.add))&&(i=nd(e.rawTime(),t),(!t._dur||mu(0,t.totalDuration(),i)-t._tTime>Jt)&&t.render(i,!0)),jo(e,t)._dp&&e._initted&&e._time>=e._dur&&e._ts){if(e._dur<e.duration())for(i=e;i._dp;)i.rawTime()>=0&&i.totalTime(i._tTime),i=i._dp;e._zTime=-Jt}},As=function(e,t,i,n){return t.parent&&Jr(t),t._start=Ri((mr(i)?i:i||e!==si?Kn(e,i,t):e._time)+t._delay),t._end=Ri(t._start+(t.totalDuration()/Math.abs(t.timeScale())||0)),Tx(e,t,"_first","_last",e._sort?"_start":0),Jf(t)||(e._recent=t),n||Ex(e,t),e._ts<0&&bd(e,e._tTime),e},Cx=function(e,t){return(Un.ScrollTrigger||Gm("scrollTrigger",t))&&Un.ScrollTrigger.create(t,e)},Dx=function(e,t,i,n,s){if(Xm(e,t,s),!e._initted)return 1;if(!i&&e._pt&&!ji&&(e._dur&&e.vars.lazy!==!1||!e._dur&&e.vars.lazy)&&xx!==On.frame)return $r.push(e),e._lazy=[s,n],1},cL=function r(e){var t=e.parent;return t&&t._ts&&t._initted&&!t._lock&&(t.rawTime()<0||r(t))},Jf=function(e){var t=e.data;return t==="isFromStart"||t==="isStart"},uL=function(e,t,i,n){var s=e.ratio,a=t<0||!t&&(!e._start&&cL(e)&&!(!e._initted&&Jf(e))||(e._ts<0||e._dp._ts<0)&&!Jf(e))?0:1,o=e._rDelay,u=0,h,f,c;if(o&&e._repeat&&(u=mu(0,e._tDur,t),f=ml(u,o),e._yoyo&&f&1&&(a=1-a),f!==ml(e._tTime,o)&&(s=1-a,e.vars.repeatRefresh&&e._initted&&e.invalidate())),a!==s||ji||n||e._zTime===Jt||!t&&e._zTime){if(!e._initted&&Dx(e,t,n,i,u))return;for(c=e._zTime,e._zTime=t||(i?Jt:0),i||(i=t&&!c),e.ratio=a,e._from&&(a=1-a),e._time=0,e._tTime=u,h=e._pt;h;)h.r(a,h.d),h=h._next;t<0&&Zf(e,t,i,!0),e._onUpdate&&!i&&Bn(e,"onUpdate"),u&&e._repeat&&!i&&e.parent&&Bn(e,"onRepeat"),(t>=e._tDur||t<0)&&e.ratio===a&&(a&&Jr(e,1),!i&&!ji&&(Bn(e,a?"onComplete":"onReverseComplete",!0),e._prom&&e._prom()))}else e._zTime||(e._zTime=t)},hL=function(e,t,i){var n;if(i>t)for(n=e._first;n&&n._start<=i;){if(n.data==="isPause"&&n._start>t)return n;n=n._next}else for(n=e._last;n&&n._start>=i;){if(n.data==="isPause"&&n._start<t)return n;n=n._prev}},gl=function(e,t,i,n){var s=e._repeat,a=Ri(t)||0,o=e._tTime/e._tDur;return o&&!n&&(e._time*=a/e._dur),e._dur=a,e._tDur=s?s<0?1e10:Ri(a*(s+1)+e._rDelay*s):a,o>0&&!n&&bd(e,e._tTime=e._tDur*o),e.parent&&vd(e),i||jo(e.parent,e),e},p0=function(e){return e instanceof an?jo(e):gl(e,e._dur)},dL={_start:0,endTime:Jc,totalDuration:Jc},Kn=function r(e,t,i){var n=e.labels,s=e._recent||dL,a=e.duration()>=is?s.endTime(!1):e._dur,o,u,h;return ki(t)&&(isNaN(t)||t in n)?(u=t.charAt(0),h=t.substr(-1)==="%",o=t.indexOf("="),u==="<"||u===">"?(o>=0&&(t=t.replace(/=/,"")),(u==="<"?s._start:s.endTime(s._repeat>=0))+(parseFloat(t.substr(1))||0)*(h?(o<0?s:i).totalDuration()/100:1)):o<0?(t in n||(n[t]=a),n[t]):(u=parseFloat(t.charAt(o-1)+t.substr(o+1)),h&&i&&(u=u/100*(qi(i)?i[0]:i).totalDuration()),o>1?r(e,t.substr(0,o-1),i)+u:a+u)):t==null?a:+t},Nc=function(e,t,i){var n=mr(t[1]),s=(n?2:1)+(e<2?0:1),a=t[s],o,u;if(n&&(a.duration=t[1]),a.parent=i,e){for(o=a,u=i;u&&!("immediateRender"in o);)o=u.vars.defaults||{},u=wn(u.vars.inherit)&&u.parent;a.immediateRender=wn(o.immediateRender),e<2?a.runBackwards=1:a.startAt=t[s-1]}return new _i(t[0],a,t[s+1])},eo=function(e,t){return e||e===0?t(e):t},mu=function(e,t,i){return i<e?e:i>t?t:i},Hi=function(e,t){return!ki(e)||!(t=tL.exec(e))?"":t[1]},pL=function(e,t,i){return eo(i,function(n){return mu(e,t,n)})},Qf=[].slice,Px=function(e,t){return e&&Bs(e)&&"length"in e&&(!t&&!e.length||e.length-1 in e&&Bs(e[0]))&&!e.nodeType&&e!==Cs},fL=function(e,t,i){return i===void 0&&(i=[]),e.forEach(function(n){var s;return ki(n)&&!t||Px(n,1)?(s=i).push.apply(s,ns(n)):i.push(n)})||i},ns=function(e,t,i){return ti&&!t&&ti.selector?ti.selector(e):ki(e)&&!i&&(Yf||!_l())?Qf.call((t||Um).querySelectorAll(e),0):qi(e)?fL(e,i):Px(e)?Qf.call(e,0):e?[e]:[]},em=function(e){return e=ns(e)[0]||Zc("Invalid scope")||{},function(t){var i=e.current||e.nativeElement||e;return ns(t,i.querySelectorAll?i:i===e?Zc("Invalid scope")||Um.createElement("div"):e)}},Ax=function(e){return e.sort(function(){return .5-Math.random()})},Lx=function(e){if(hi(e))return e;var t=Bs(e)?e:{each:e},i=qo(t.ease),n=t.from||0,s=parseFloat(t.base)||0,a={},o=n>0&&n<1,u=isNaN(n)||o,h=t.axis,f=n,c=n;return ki(n)?f=c={center:.5,edges:.5,end:1}[n]||0:!o&&u&&(f=n[0],c=n[1]),function(d,m,x){var _=(x||t).length,b=a[_],y,M,D,C,P,I,F,A,k;if(!b){if(k=t.grid==="auto"?0:(t.grid||[1,is])[1],!k){for(F=-is;F<(F=x[k++].getBoundingClientRect().left)&&k<_;);k<_&&k--}for(b=a[_]=[],y=u?Math.min(k,_)*f-.5:n%k,M=k===is?0:u?_*c/k-.5:n/k|0,F=0,A=is,I=0;I<_;I++)D=I%k-y,C=M-(I/k|0),b[I]=P=h?Math.abs(h==="y"?C:D):dx(D*D+C*C),P>F&&(F=P),P<A&&(A=P);n==="random"&&Ax(b),b.max=F-A,b.min=A,b.v=_=(parseFloat(t.amount)||parseFloat(t.each)*(k>_?_-1:h?h==="y"?_/k:k:Math.max(k,_/k))||0)*(n==="edges"?-1:1),b.b=_<0?s-_:s,b.u=Hi(t.amount||t.each)||0,i=i&&_<0?Ux(i):i}return _=(b[d]-b.min)/b.max||0,Ri(b.b+(i?i(_):_)*b.v)+b.u}},tm=function(e){var t=Math.pow(10,((e+"").split(".")[1]||"").length);return function(i){var n=Ri(Math.round(parseFloat(i)/e)*e*t);return(n-n%1)/t+(mr(i)?0:Hi(i))}},Rx=function(e,t){var i=qi(e),n,s;return!i&&Bs(e)&&(n=i=e.radius||is,e.values?(e=ns(e.values),(s=!mr(e[0]))&&(n*=n)):e=tm(e.increment)),eo(t,i?hi(e)?function(a){return s=e(a),Math.abs(s-a)<=n?s:a}:function(a){for(var o=parseFloat(s?a.x:a),u=parseFloat(s?a.y:0),h=is,f=0,c=e.length,d,m;c--;)s?(d=e[c].x-o,m=e[c].y-u,d=d*d+m*m):d=Math.abs(e[c]-o),d<h&&(h=d,f=c);return f=!n||h<=n?e[f]:a,s||f===a||mr(a)?f:f+Hi(a)}:tm(e))},kx=function(e,t,i,n){return eo(qi(e)?!t:i===!0?!!(i=0):!n,function(){return qi(e)?e[~~(Math.random()*e.length)]:(i=i||1e-5)&&(n=i<1?Math.pow(10,(i+"").length-2):1)&&Math.floor(Math.round((e-i/2+Math.random()*(t-e+i*.99))/i)*i*n)/n})},mL=function(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];return function(n){return t.reduce(function(s,a){return a(s)},n)}},gL=function(e,t){return function(i){return e(parseFloat(i))+(t||Hi(i))}},_L=function(e,t,i){return Fx(e,t,0,1,i)},Ix=function(e,t,i){return eo(i,function(n){return e[~~t(n)]})},vL=function r(e,t,i){var n=t-e;return qi(e)?Ix(e,r(0,e.length),t):eo(i,function(s){return(n+(s-e)%n)%n+e})},bL=function r(e,t,i){var n=t-e,s=n*2;return qi(e)?Ix(e,r(0,e.length-1),t):eo(i,function(a){return a=(s+(a-e)%s)%s||0,e+(a>n?s-a:a)})},Qc=function(e){for(var t=0,i="",n,s,a,o;~(n=e.indexOf("random(",t));)a=e.indexOf(")",n),o=e.charAt(n+7)==="[",s=e.substr(n+7,a-n-7).match(o?gx:$f),i+=e.substr(t,n-t)+kx(o?s:+s[0],o?0:+s[1],+s[2]||1e-5),t=a+1;return i+e.substr(t,e.length-t)},Fx=function(e,t,i,n,s){var a=t-e,o=n-i;return eo(s,function(u){return i+((u-e)/a*o||0)})},xL=function r(e,t,i,n){var s=isNaN(e+t)?0:function(m){return(1-m)*e+m*t};if(!s){var a=ki(e),o={},u,h,f,c,d;if(i===!0&&(n=1)&&(i=null),a)e={p:e},t={p:t};else if(qi(e)&&!qi(t)){for(f=[],c=e.length,d=c-2,h=1;h<c;h++)f.push(r(e[h-1],e[h]));c--,s=function(x){x*=c;var _=Math.min(d,~~x);return f[_](x-_)},i=t}else n||(e=ta(qi(e)?[]:{},e));if(!f){for(u in t)qm.call(o,e,u,"get",t[u]);s=function(x){return Km(x,o)||(a?e.p:e)}}}return eo(i,s)},f0=function(e,t,i){var n=e.labels,s=is,a,o,u;for(a in n)o=n[a]-t,o<0==!!i&&o&&s>(o=Math.abs(o))&&(u=a,s=o);return u},Bn=function(e,t,i){var n=e.vars,s=n[t],a=ti,o=e._ctx,u,h,f;if(s)return u=n[t+"Params"],h=n.callbackScope||e,i&&$r.length&&td(),o&&(ti=o),f=u?s.apply(h,u):s.call(h),ti=a,f},Sc=function(e){return Jr(e),e.scrollTrigger&&e.scrollTrigger.kill(!!ji),e.progress()<1&&Bn(e,"onInterrupt"),e},Ya,Ox=[],Nx=function(e){if(e)if(e=!e.name&&e.default||e,zm()||e.headless){var t=e.name,i=hi(e),n=t&&!i&&e.init?function(){this._props=[]}:e,s={init:Jc,render:Km,add:qm,kill:OL,modifier:FL,rawVars:0},a={targetTest:0,get:0,getSetter:Ym,aliases:{},register:0};if(_l(),e!==n){if(In[t])return;os(n,os(id(e,s),a)),ta(n.prototype,ta(s,id(e,a))),In[n.prop=t]=n,e.targetTest&&(Hh.push(n),Hm[t]=1),t=(t==="css"?"CSS":t.charAt(0).toUpperCase()+t.substr(1))+"Plugin"}bx(t,n),e.register&&e.register(Xi,n,Sn)}else Ox.push(e)},qt=255,Mc={aqua:[0,qt,qt],lime:[0,qt,0],silver:[192,192,192],black:[0,0,0],maroon:[128,0,0],teal:[0,128,128],blue:[0,0,qt],navy:[0,0,128],white:[qt,qt,qt],olive:[128,128,0],yellow:[qt,qt,0],orange:[qt,165,0],gray:[128,128,128],purple:[128,0,128],green:[0,128,0],red:[qt,0,0],pink:[qt,192,203],cyan:[0,qt,qt],transparent:[qt,qt,qt,0]},rf=function(e,t,i){return e+=e<0?1:e>1?-1:0,(e*6<1?t+(i-t)*e*6:e<.5?i:e*3<2?t+(i-t)*(2/3-e)*6:t)*qt+.5|0},Bx=function(e,t,i){var n=e?mr(e)?[e>>16,e>>8&qt,e&qt]:0:Mc.black,s,a,o,u,h,f,c,d,m,x;if(!n){if(e.substr(-1)===","&&(e=e.substr(0,e.length-1)),Mc[e])n=Mc[e];else if(e.charAt(0)==="#"){if(e.length<6&&(s=e.charAt(1),a=e.charAt(2),o=e.charAt(3),e="#"+s+s+a+a+o+o+(e.length===5?e.charAt(4)+e.charAt(4):"")),e.length===9)return n=parseInt(e.substr(1,6),16),[n>>16,n>>8&qt,n&qt,parseInt(e.substr(7),16)/255];e=parseInt(e.substr(1),16),n=[e>>16,e>>8&qt,e&qt]}else if(e.substr(0,3)==="hsl"){if(n=x=e.match($f),!t)u=+n[0]%360/360,h=+n[1]/100,f=+n[2]/100,a=f<=.5?f*(h+1):f+h-f*h,s=f*2-a,n.length>3&&(n[3]*=1),n[0]=rf(u+1/3,s,a),n[1]=rf(u,s,a),n[2]=rf(u-1/3,s,a);else if(~e.indexOf("="))return n=e.match(fx),i&&n.length<4&&(n[3]=1),n}else n=e.match($f)||Mc.transparent;n=n.map(Number)}return t&&!x&&(s=n[0]/qt,a=n[1]/qt,o=n[2]/qt,c=Math.max(s,a,o),d=Math.min(s,a,o),f=(c+d)/2,c===d?u=h=0:(m=c-d,h=f>.5?m/(2-c-d):m/(c+d),u=c===s?(a-o)/m+(a<o?6:0):c===a?(o-s)/m+2:(s-a)/m+4,u*=60),n[0]=~~(u+.5),n[1]=~~(h*100+.5),n[2]=~~(f*100+.5)),i&&n.length<4&&(n[3]=1),n},Vx=function(e){var t=[],i=[],n=-1;return e.split(Yr).forEach(function(s){var a=s.match($a)||[];t.push.apply(t,a),i.push(n+=a.length+1)}),t.c=i,t},m0=function(e,t,i){var n="",s=(e+n).match(Yr),a=t?"hsla(":"rgba(",o=0,u,h,f,c;if(!s)return e;if(s=s.map(function(d){return(d=Bx(d,t,1))&&a+(t?d[0]+","+d[1]+"%,"+d[2]+"%,"+d[3]:d.join(","))+")"}),i&&(f=Vx(e),u=i.c,u.join(n)!==f.c.join(n)))for(h=e.replace(Yr,"1").split($a),c=h.length-1;o<c;o++)n+=h[o]+(~u.indexOf(o)?s.shift()||a+"0,0,0,0)":(f.length?f:s.length?s:i).shift());if(!h)for(h=e.split(Yr),c=h.length-1;o<c;o++)n+=h[o]+s[o];return n+h[c]},Yr=function(){var r="(?:\\b(?:(?:rgb|rgba|hsl|hsla)\\(.+?\\))|\\B#(?:[0-9a-f]{3,4}){1,2}\\b",e;for(e in Mc)r+="|"+e+"\\b";return new RegExp(r+")","gi")}(),wL=/hsl[a]?\(/,zx=function(e){var t=e.join(" "),i;if(Yr.lastIndex=0,Yr.test(t))return i=wL.test(t),e[1]=m0(e[1],i),e[0]=m0(e[0],i,Vx(e[1])),!0},eu,On=function(){var r=Date.now,e=500,t=33,i=r(),n=i,s=1e3/240,a=s,o=[],u,h,f,c,d,m,x=function _(b){var y=r()-n,M=b===!0,D,C,P,I;if((y>e||y<0)&&(i+=y-t),n+=y,P=n-i,D=P-a,(D>0||M)&&(I=++c.frame,d=P-c.time*1e3,c.time=P=P/1e3,a+=D+(D>=s?4:s-D),C=1),M||(u=h(_)),C)for(m=0;m<o.length;m++)o[m](P,d,I,b)};return c={time:0,frame:0,tick:function(){x(!0)},deltaRatio:function(b){return d/(1e3/(b||60))},wake:function(){_x&&(!Yf&&zm()&&(Cs=Yf=window,Um=Cs.document||{},Un.gsap=Xi,(Cs.gsapVersions||(Cs.gsapVersions=[])).push(Xi.version),vx(ed||Cs.GreenSockGlobals||!Cs.gsap&&Cs||{}),Ox.forEach(Nx)),f=typeof requestAnimationFrame<"u"&&requestAnimationFrame,u&&c.sleep(),h=f||function(b){return setTimeout(b,a-c.time*1e3+1|0)},eu=1,x(2))},sleep:function(){(f?cancelAnimationFrame:clearTimeout)(u),eu=0,h=Jc},lagSmoothing:function(b,y){e=b||1/0,t=Math.min(y||33,e)},fps:function(b){s=1e3/(b||240),a=c.time*1e3+s},add:function(b,y,M){var D=y?function(C,P,I,F){b(C,P,I,F),c.remove(D)}:b;return c.remove(b),o[M?"unshift":"push"](D),_l(),D},remove:function(b,y){~(y=o.indexOf(b))&&o.splice(y,1)&&m>=y&&m--},_listeners:o},c}(),_l=function(){return!eu&&On.wake()},It={},yL=/^[\d.\-M][\d.\-,\s]/,SL=/["']/g,ML=function(e){for(var t={},i=e.substr(1,e.length-3).split(":"),n=i[0],s=1,a=i.length,o,u,h;s<a;s++)u=i[s],o=s!==a-1?u.lastIndexOf(","):u.length,h=u.substr(0,o),t[n]=isNaN(h)?h.replace(SL,"").trim():+h,n=u.substr(o+1).trim();return t},TL=function(e){var t=e.indexOf("(")+1,i=e.indexOf(")"),n=e.indexOf("(",t);return e.substring(t,~n&&n<i?e.indexOf(")",i+1):i)},EL=function(e){var t=(e+"").split("("),i=It[t[0]];return i&&t.length>1&&i.config?i.config.apply(null,~e.indexOf("{")?[ML(t[1])]:TL(e).split(",").map(Sx)):It._CE&&yL.test(e)?It._CE("",e):i},Ux=function(e){return function(t){return 1-e(1-t)}},Gx=function r(e,t){for(var i=e._first,n;i;)i instanceof an?r(i,t):i.vars.yoyoEase&&(!i._yoyo||!i._repeat)&&i._yoyo!==t&&(i.timeline?r(i.timeline,t):(n=i._ease,i._ease=i._yEase,i._yEase=n,i._yoyo=t)),i=i._next},qo=function(e,t){return e&&(hi(e)?e:It[e]||EL(e))||t},aa=function(e,t,i,n){i===void 0&&(i=function(u){return 1-t(1-u)}),n===void 0&&(n=function(u){return u<.5?t(u*2)/2:1-t((1-u)*2)/2});var s={easeIn:t,easeOut:i,easeInOut:n},a;return yn(e,function(o){It[o]=Un[o]=s,It[a=o.toLowerCase()]=i;for(var u in s)It[a+(u==="easeIn"?".in":u==="easeOut"?".out":".inOut")]=It[o+"."+u]=s[u]}),s},Hx=function(e){return function(t){return t<.5?(1-e(1-t*2))/2:.5+e((t-.5)*2)/2}},of=function r(e,t,i){var n=t>=1?t:1,s=(i||(e?.3:.45))/(t<1?t:1),a=s/Xf*(Math.asin(1/n)||0),o=function(f){return f===1?1:n*Math.pow(2,-10*f)*eL((f-a)*s)+1},u=e==="out"?o:e==="in"?function(h){return 1-o(1-h)}:Hx(o);return s=Xf/s,u.config=function(h,f){return r(e,h,f)},u},af=function r(e,t){t===void 0&&(t=1.70158);var i=function(a){return a?--a*a*((t+1)*a+t)+1:0},n=e==="out"?i:e==="in"?function(s){return 1-i(1-s)}:Hx(i);return n.config=function(s){return r(e,s)},n};yn("Linear,Quad,Cubic,Quart,Quint,Strong",function(r,e){var t=e<5?e+1:e;aa(r+",Power"+(t-1),e?function(i){return Math.pow(i,t)}:function(i){return i},function(i){return 1-Math.pow(1-i,t)},function(i){return i<.5?Math.pow(i*2,t)/2:1-Math.pow((1-i)*2,t)/2})});It.Linear.easeNone=It.none=It.Linear.easeIn;aa("Elastic",of("in"),of("out"),of());(function(r,e){var t=1/e,i=2*t,n=2.5*t,s=function(o){return o<t?r*o*o:o<i?r*Math.pow(o-1.5/e,2)+.75:o<n?r*(o-=2.25/e)*o+.9375:r*Math.pow(o-2.625/e,2)+.984375};aa("Bounce",function(a){return 1-s(1-a)},s)})(7.5625,2.75);aa("Expo",function(r){return r?Math.pow(2,10*(r-1)):0});aa("Circ",function(r){return-(dx(1-r*r)-1)});aa("Sine",function(r){return r===1?1:-QA(r*ZA)+1});aa("Back",af("in"),af("out"),af());It.SteppedEase=It.steps=Un.SteppedEase={config:function(e,t){e===void 0&&(e=1);var i=1/e,n=e+(t?0:1),s=t?1:0,a=1-Jt;return function(o){return((n*mu(0,a,o)|0)+s)*i}}};fl.ease=It["quad.out"];yn("onComplete,onUpdate,onStart,onRepeat,onReverseComplete,onInterrupt",function(r){return Wm+=r+","+r+"Params,"});var Wx=function(e,t){this.id=JA++,e._gsap=this,this.target=e,this.harness=t,this.get=t?t.get:wx,this.set=t?t.getSetter:Ym},tu=function(){function r(t){this.vars=t,this._delay=+t.delay||0,(this._repeat=t.repeat===1/0?-2:t.repeat||0)&&(this._rDelay=t.repeatDelay||0,this._yoyo=!!t.yoyo||!!t.yoyoEase),this._ts=1,gl(this,+t.duration,1,1),this.data=t.data,ti&&(this._ctx=ti,ti.data.push(this)),eu||On.wake()}var e=r.prototype;return e.delay=function(i){return i||i===0?(this.parent&&this.parent.smoothChildTiming&&this.startTime(this._start+i-this._delay),this._delay=i,this):this._delay},e.duration=function(i){return arguments.length?this.totalDuration(this._repeat>0?i+(i+this._rDelay)*this._repeat:i):this.totalDuration()&&this._dur},e.totalDuration=function(i){return arguments.length?(this._dirty=0,gl(this,this._repeat<0?i:(i-this._repeat*this._rDelay)/(this._repeat+1))):this._tDur},e.totalTime=function(i,n){if(_l(),!arguments.length)return this._tTime;var s=this._dp;if(s&&s.smoothChildTiming&&this._ts){for(bd(this,i),!s._dp||s.parent||Ex(s,this);s&&s.parent;)s.parent._time!==s._start+(s._ts>=0?s._tTime/s._ts:(s.totalDuration()-s._tTime)/-s._ts)&&s.totalTime(s._tTime,!0),s=s.parent;!this.parent&&this._dp.autoRemoveChildren&&(this._ts>0&&i<this._tDur||this._ts<0&&i>0||!this._tDur&&!i)&&As(this._dp,this,this._start-this._delay)}return(this._tTime!==i||!this._dur&&!n||this._initted&&Math.abs(this._zTime)===Jt||!i&&!this._initted&&(this.add||this._ptLookup))&&(this._ts||(this._pTime=i),yx(this,i,n)),this},e.time=function(i,n){return arguments.length?this.totalTime(Math.min(this.totalDuration(),i+d0(this))%(this._dur+this._rDelay)||(i?this._dur:0),n):this._time},e.totalProgress=function(i,n){return arguments.length?this.totalTime(this.totalDuration()*i,n):this.totalDuration()?Math.min(1,this._tTime/this._tDur):this.rawTime()>0?1:0},e.progress=function(i,n){return arguments.length?this.totalTime(this.duration()*(this._yoyo&&!(this.iteration()&1)?1-i:i)+d0(this),n):this.duration()?Math.min(1,this._time/this._dur):this.rawTime()>0?1:0},e.iteration=function(i,n){var s=this.duration()+this._rDelay;return arguments.length?this.totalTime(this._time+(i-1)*s,n):this._repeat?ml(this._tTime,s)+1:1},e.timeScale=function(i,n){if(!arguments.length)return this._rts===-Jt?0:this._rts;if(this._rts===i)return this;var s=this.parent&&this._ts?nd(this.parent._time,this):this._tTime;return this._rts=+i||0,this._ts=this._ps||i===-Jt?0:this._rts,this.totalTime(mu(-Math.abs(this._delay),this._tDur,s),n!==!1),vd(this),aL(this)},e.paused=function(i){return arguments.length?(this._ps!==i&&(this._ps=i,i?(this._pTime=this._tTime||Math.max(-this._delay,this.rawTime()),this._ts=this._act=0):(_l(),this._ts=this._rts,this.totalTime(this.parent&&!this.parent.smoothChildTiming?this.rawTime():this._tTime||this._pTime,this.progress()===1&&Math.abs(this._zTime)!==Jt&&(this._tTime-=Jt)))),this):this._ps},e.startTime=function(i){if(arguments.length){this._start=i;var n=this.parent||this._dp;return n&&(n._sort||!this.parent)&&As(n,this,i-this._delay),this}return this._start},e.endTime=function(i){return this._start+(wn(i)?this.totalDuration():this.duration())/Math.abs(this._ts||1)},e.rawTime=function(i){var n=this.parent||this._dp;return n?i&&(!this._ts||this._repeat&&this._time&&this.totalProgress()<1)?this._tTime%(this._dur+this._rDelay):this._ts?nd(n.rawTime(i),this):this._tTime:this._tTime},e.revert=function(i){i===void 0&&(i=nL);var n=ji;return ji=i,(this._initted||this._startAt)&&(this.timeline&&this.timeline.revert(i),this.totalTime(-.01,i.suppressEvents)),this.data!=="nested"&&i.kill!==!1&&this.kill(),ji=n,this},e.globalTime=function(i){for(var n=this,s=arguments.length?i:n.rawTime();n;)s=n._start+s/(Math.abs(n._ts)||1),n=n._dp;return!this.parent&&this._sat?this._sat.globalTime(i):s},e.repeat=function(i){return arguments.length?(this._repeat=i===1/0?-2:i,p0(this)):this._repeat===-2?1/0:this._repeat},e.repeatDelay=function(i){if(arguments.length){var n=this._time;return this._rDelay=i,p0(this),n?this.time(n):this}return this._rDelay},e.yoyo=function(i){return arguments.length?(this._yoyo=i,this):this._yoyo},e.seek=function(i,n){return this.totalTime(Kn(this,i),wn(n))},e.restart=function(i,n){return this.play().totalTime(i?-this._delay:0,wn(n))},e.play=function(i,n){return i!=null&&this.seek(i,n),this.reversed(!1).paused(!1)},e.reverse=function(i,n){return i!=null&&this.seek(i||this.totalDuration(),n),this.reversed(!0).paused(!1)},e.pause=function(i,n){return i!=null&&this.seek(i,n),this.paused(!0)},e.resume=function(){return this.paused(!1)},e.reversed=function(i){return arguments.length?(!!i!==this.reversed()&&this.timeScale(-this._rts||(i?-Jt:0)),this):this._rts<0},e.invalidate=function(){return this._initted=this._act=0,this._zTime=-Jt,this},e.isActive=function(){var i=this.parent||this._dp,n=this._start,s;return!!(!i||this._ts&&this._initted&&i.isActive()&&(s=i.rawTime(!0))>=n&&s<this.endTime(!0)-Jt)},e.eventCallback=function(i,n,s){var a=this.vars;return arguments.length>1?(n?(a[i]=n,s&&(a[i+"Params"]=s),i==="onUpdate"&&(this._onUpdate=n)):delete a[i],this):a[i]},e.then=function(i){var n=this;return new Promise(function(s){var a=hi(i)?i:Mx,o=function(){var h=n.then;n.then=null,hi(a)&&(a=a(n))&&(a.then||a===n)&&(n.then=h),s(a),n.then=h};n._initted&&n.totalProgress()===1&&n._ts>=0||!n._tTime&&n._ts<0?o():n._prom=o})},e.kill=function(){Sc(this)},r}();os(tu.prototype,{_time:0,_start:0,_end:0,_tTime:0,_tDur:0,_dirty:0,_repeat:0,_yoyo:!1,parent:null,_initted:!1,_rDelay:0,_ts:1,_dp:0,ratio:0,_zTime:-Jt,_prom:0,_ps:!1,_rts:1});var an=function(r){hx(e,r);function e(i,n){var s;return i===void 0&&(i={}),s=r.call(this,i)||this,s.labels={},s.smoothChildTiming=!!i.smoothChildTiming,s.autoRemoveChildren=!!i.autoRemoveChildren,s._sort=wn(i.sortChildren),si&&As(i.parent||si,ir(s),n),i.reversed&&s.reverse(),i.paused&&s.paused(!0),i.scrollTrigger&&Cx(ir(s),i.scrollTrigger),s}var t=e.prototype;return t.to=function(n,s,a){return Nc(0,arguments,this),this},t.from=function(n,s,a){return Nc(1,arguments,this),this},t.fromTo=function(n,s,a,o){return Nc(2,arguments,this),this},t.set=function(n,s,a){return s.duration=0,s.parent=this,Oc(s).repeatDelay||(s.repeat=0),s.immediateRender=!!s.immediateRender,new _i(n,s,Kn(this,a),1),this},t.call=function(n,s,a){return As(this,_i.delayedCall(0,n,s),a)},t.staggerTo=function(n,s,a,o,u,h,f){return a.duration=s,a.stagger=a.stagger||o,a.onComplete=h,a.onCompleteParams=f,a.parent=this,new _i(n,a,Kn(this,u)),this},t.staggerFrom=function(n,s,a,o,u,h,f){return a.runBackwards=1,Oc(a).immediateRender=wn(a.immediateRender),this.staggerTo(n,s,a,o,u,h,f)},t.staggerFromTo=function(n,s,a,o,u,h,f,c){return o.startAt=a,Oc(o).immediateRender=wn(o.immediateRender),this.staggerTo(n,s,o,u,h,f,c)},t.render=function(n,s,a){var o=this._time,u=this._dirty?this.totalDuration():this._tDur,h=this._dur,f=n<=0?0:Ri(n),c=this._zTime<0!=n<0&&(this._initted||!h),d,m,x,_,b,y,M,D,C,P,I,F;if(this!==si&&f>u&&n>=0&&(f=u),f!==this._tTime||a||c){if(o!==this._time&&h&&(f+=this._time-o,n+=this._time-o),d=f,C=this._start,D=this._ts,y=!D,c&&(h||(o=this._zTime),(n||!s)&&(this._zTime=n)),this._repeat){if(I=this._yoyo,b=h+this._rDelay,this._repeat<-1&&n<0)return this.totalTime(b*100+n,s,a);if(d=Ri(f%b),f===u?(_=this._repeat,d=h):(_=~~(f/b),_&&_===f/b&&(d=h,_--),d>h&&(d=h)),P=ml(this._tTime,b),!o&&this._tTime&&P!==_&&this._tTime-P*b-this._dur<=0&&(P=_),I&&_&1&&(d=h-d,F=1),_!==P&&!this._lock){var A=I&&P&1,k=A===(I&&_&1);if(_<P&&(A=!A),o=A?0:f%h?h:f,this._lock=1,this.render(o||(F?0:Ri(_*b)),s,!h)._lock=0,this._tTime=f,!s&&this.parent&&Bn(this,"onRepeat"),this.vars.repeatRefresh&&!F&&(this.invalidate()._lock=1),o&&o!==this._time||y!==!this._ts||this.vars.onRepeat&&!this.parent&&!this._act)return this;if(h=this._dur,u=this._tDur,k&&(this._lock=2,o=A?h:-1e-4,this.render(o,!0),this.vars.repeatRefresh&&!F&&this.invalidate()),this._lock=0,!this._ts&&!y)return this;Gx(this,F)}}if(this._hasPause&&!this._forcing&&this._lock<2&&(M=hL(this,Ri(o),Ri(d)),M&&(f-=d-(d=M._start))),this._tTime=f,this._time=d,this._act=!D,this._initted||(this._onUpdate=this.vars.onUpdate,this._initted=1,this._zTime=n,o=0),!o&&d&&!s&&!_&&(Bn(this,"onStart"),this._tTime!==f))return this;if(d>=o&&n>=0)for(m=this._first;m;){if(x=m._next,(m._act||d>=m._start)&&m._ts&&M!==m){if(m.parent!==this)return this.render(n,s,a);if(m.render(m._ts>0?(d-m._start)*m._ts:(m._dirty?m.totalDuration():m._tDur)+(d-m._start)*m._ts,s,a),d!==this._time||!this._ts&&!y){M=0,x&&(f+=this._zTime=-Jt);break}}m=x}else{m=this._last;for(var O=n<0?n:d;m;){if(x=m._prev,(m._act||O<=m._end)&&m._ts&&M!==m){if(m.parent!==this)return this.render(n,s,a);if(m.render(m._ts>0?(O-m._start)*m._ts:(m._dirty?m.totalDuration():m._tDur)+(O-m._start)*m._ts,s,a||ji&&(m._initted||m._startAt)),d!==this._time||!this._ts&&!y){M=0,x&&(f+=this._zTime=O?-Jt:Jt);break}}m=x}}if(M&&!s&&(this.pause(),M.render(d>=o?0:-Jt)._zTime=d>=o?1:-1,this._ts))return this._start=C,vd(this),this.render(n,s,a);this._onUpdate&&!s&&Bn(this,"onUpdate",!0),(f===u&&this._tTime>=this.totalDuration()||!f&&o)&&(C===this._start||Math.abs(D)!==Math.abs(this._ts))&&(this._lock||((n||!h)&&(f===u&&this._ts>0||!f&&this._ts<0)&&Jr(this,1),!s&&!(n<0&&!o)&&(f||o||!u)&&(Bn(this,f===u&&n>=0?"onComplete":"onReverseComplete",!0),this._prom&&!(f<u&&this.timeScale()>0)&&this._prom())))}return this},t.add=function(n,s){var a=this;if(mr(s)||(s=Kn(this,s,n)),!(n instanceof tu)){if(qi(n))return n.forEach(function(o){return a.add(o,s)}),this;if(ki(n))return this.addLabel(n,s);if(hi(n))n=_i.delayedCall(0,n);else return this}return this!==n?As(this,n,s):this},t.getChildren=function(n,s,a,o){n===void 0&&(n=!0),s===void 0&&(s=!0),a===void 0&&(a=!0),o===void 0&&(o=-is);for(var u=[],h=this._first;h;)h._start>=o&&(h instanceof _i?s&&u.push(h):(a&&u.push(h),n&&u.push.apply(u,h.getChildren(!0,s,a)))),h=h._next;return u},t.getById=function(n){for(var s=this.getChildren(1,1,1),a=s.length;a--;)if(s[a].vars.id===n)return s[a]},t.remove=function(n){return ki(n)?this.removeLabel(n):hi(n)?this.killTweensOf(n):(_d(this,n),n===this._recent&&(this._recent=this._last),jo(this))},t.totalTime=function(n,s){return arguments.length?(this._forcing=1,!this._dp&&this._ts&&(this._start=Ri(On.time-(this._ts>0?n/this._ts:(this.totalDuration()-n)/-this._ts))),r.prototype.totalTime.call(this,n,s),this._forcing=0,this):this._tTime},t.addLabel=function(n,s){return this.labels[n]=Kn(this,s),this},t.removeLabel=function(n){return delete this.labels[n],this},t.addPause=function(n,s,a){var o=_i.delayedCall(0,s||Jc,a);return o.data="isPause",this._hasPause=1,As(this,o,Kn(this,n))},t.removePause=function(n){var s=this._first;for(n=Kn(this,n);s;)s._start===n&&s.data==="isPause"&&Jr(s),s=s._next},t.killTweensOf=function(n,s,a){for(var o=this.getTweensOf(n,a),u=o.length;u--;)Wr!==o[u]&&o[u].kill(n,s);return this},t.getTweensOf=function(n,s){for(var a=[],o=ns(n),u=this._first,h=mr(s),f;u;)u instanceof _i?sL(u._targets,o)&&(h?(!Wr||u._initted&&u._ts)&&u.globalTime(0)<=s&&u.globalTime(u.totalDuration())>s:!s||u.isActive())&&a.push(u):(f=u.getTweensOf(o,s)).length&&a.push.apply(a,f),u=u._next;return a},t.tweenTo=function(n,s){s=s||{};var a=this,o=Kn(a,n),u=s,h=u.startAt,f=u.onStart,c=u.onStartParams,d=u.immediateRender,m,x=_i.to(a,os({ease:s.ease||"none",lazy:!1,immediateRender:!1,time:o,overwrite:"auto",duration:s.duration||Math.abs((o-(h&&"time"in h?h.time:a._time))/a.timeScale())||Jt,onStart:function(){if(a.pause(),!m){var b=s.duration||Math.abs((o-(h&&"time"in h?h.time:a._time))/a.timeScale());x._dur!==b&&gl(x,b,0,1).render(x._time,!0,!0),m=1}f&&f.apply(x,c||[])}},s));return d?x.render(0):x},t.tweenFromTo=function(n,s,a){return this.tweenTo(s,os({startAt:{time:Kn(this,n)}},a))},t.recent=function(){return this._recent},t.nextLabel=function(n){return n===void 0&&(n=this._time),f0(this,Kn(this,n))},t.previousLabel=function(n){return n===void 0&&(n=this._time),f0(this,Kn(this,n),1)},t.currentLabel=function(n){return arguments.length?this.seek(n,!0):this.previousLabel(this._time+Jt)},t.shiftChildren=function(n,s,a){a===void 0&&(a=0);for(var o=this._first,u=this.labels,h;o;)o._start>=a&&(o._start+=n,o._end+=n),o=o._next;if(s)for(h in u)u[h]>=a&&(u[h]+=n);return jo(this)},t.invalidate=function(n){var s=this._first;for(this._lock=0;s;)s.invalidate(n),s=s._next;return r.prototype.invalidate.call(this,n)},t.clear=function(n){n===void 0&&(n=!0);for(var s=this._first,a;s;)a=s._next,this.remove(s),s=a;return this._dp&&(this._time=this._tTime=this._pTime=0),n&&(this.labels={}),jo(this)},t.totalDuration=function(n){var s=0,a=this,o=a._last,u=is,h,f,c;if(arguments.length)return a.timeScale((a._repeat<0?a.duration():a.totalDuration())/(a.reversed()?-n:n));if(a._dirty){for(c=a.parent;o;)h=o._prev,o._dirty&&o.totalDuration(),f=o._start,f>u&&a._sort&&o._ts&&!a._lock?(a._lock=1,As(a,o,f-o._delay,1)._lock=0):u=f,f<0&&o._ts&&(s-=f,(!c&&!a._dp||c&&c.smoothChildTiming)&&(a._start+=f/a._ts,a._time-=f,a._tTime-=f),a.shiftChildren(-f,!1,-1/0),u=0),o._end>s&&o._ts&&(s=o._end),o=h;gl(a,a===si&&a._time>s?a._time:s,1,1),a._dirty=0}return a._tDur},e.updateRoot=function(n){if(si._ts&&(yx(si,nd(n,si)),xx=On.frame),On.frame>=u0){u0+=zn.autoSleep||120;var s=si._first;if((!s||!s._ts)&&zn.autoSleep&&On._listeners.length<2){for(;s&&!s._ts;)s=s._next;s||On.sleep()}}},e}(tu);os(an.prototype,{_lock:0,_hasPause:0,_forcing:0});var CL=function(e,t,i,n,s,a,o){var u=new Sn(this._pt,e,t,0,1,Kx,null,s),h=0,f=0,c,d,m,x,_,b,y,M;for(u.b=i,u.e=n,i+="",n+="",(y=~n.indexOf("random("))&&(n=Qc(n)),a&&(M=[i,n],a(M,e,t),i=M[0],n=M[1]),d=i.match(nf)||[];c=nf.exec(n);)x=c[0],_=n.substring(h,c.index),m?m=(m+1)%5:_.substr(-5)==="rgba("&&(m=1),x!==d[f++]&&(b=parseFloat(d[f-1])||0,u._pt={_next:u._pt,p:_||f===1?_:",",s:b,c:x.charAt(1)==="="?nl(b,x)-b:parseFloat(x)-b,m:m&&m<4?Math.round:0},h=nf.lastIndex);return u.c=h<n.length?n.substring(h,n.length):"",u.fp=o,(mx.test(n)||y)&&(u.e=0),this._pt=u,u},qm=function(e,t,i,n,s,a,o,u,h,f){hi(n)&&(n=n(s||0,e,a));var c=e[t],d=i!=="get"?i:hi(c)?h?e[t.indexOf("set")||!hi(e["get"+t.substr(3)])?t:"get"+t.substr(3)](h):e[t]():c,m=hi(c)?h?RL:$x:$m,x;if(ki(n)&&(~n.indexOf("random(")&&(n=Qc(n)),n.charAt(1)==="="&&(x=nl(d,n)+(Hi(d)||0),(x||x===0)&&(n=x))),!f||d!==n||im)return!isNaN(d*n)&&n!==""?(x=new Sn(this._pt,e,t,+d||0,n-(d||0),typeof c=="boolean"?IL:Yx,0,m),h&&(x.fp=h),o&&x.modifier(o,this,e),this._pt=x):(!c&&!(t in e)&&Gm(t,n),CL.call(this,e,t,d,n,m,u||zn.stringFilter,h))},DL=function(e,t,i,n,s){if(hi(e)&&(e=Bc(e,s,t,i,n)),!Bs(e)||e.style&&e.nodeType||qi(e)||px(e))return ki(e)?Bc(e,s,t,i,n):e;var a={},o;for(o in e)a[o]=Bc(e[o],s,t,i,n);return a},jx=function(e,t,i,n,s,a){var o,u,h,f;if(In[e]&&(o=new In[e]).init(s,o.rawVars?t[e]:DL(t[e],n,s,a,i),i,n,a)!==!1&&(i._pt=u=new Sn(i._pt,s,e,0,1,o.render,o,0,o.priority),i!==Ya))for(h=i._ptLookup[i._targets.indexOf(s)],f=o._props.length;f--;)h[o._props[f]]=u;return o},Wr,im,Xm=function r(e,t,i){var n=e.vars,s=n.ease,a=n.startAt,o=n.immediateRender,u=n.lazy,h=n.onUpdate,f=n.runBackwards,c=n.yoyoEase,d=n.keyframes,m=n.autoRevert,x=e._dur,_=e._startAt,b=e._targets,y=e.parent,M=y&&y.data==="nested"?y.vars.targets:b,D=e._overwrite==="auto"&&!Bm,C=e.timeline,P,I,F,A,k,O,J,Q,X,j,K,ie,ee;if(C&&(!d||!s)&&(s="none"),e._ease=qo(s,fl.ease),e._yEase=c?Ux(qo(c===!0?s:c,fl.ease)):0,c&&e._yoyo&&!e._repeat&&(c=e._yEase,e._yEase=e._ease,e._ease=c),e._from=!C&&!!n.runBackwards,!C||d&&!n.stagger){if(Q=b[0]?Wo(b[0]).harness:0,ie=Q&&n[Q.prop],P=id(n,Hm),_&&(_._zTime<0&&_.progress(1),t<0&&f&&o&&!m?_.render(-1,!0):_.revert(f&&x?Gh:iL),_._lazy=0),a){if(Jr(e._startAt=_i.set(b,os({data:"isStart",overwrite:!1,parent:y,immediateRender:!0,lazy:!_&&wn(u),startAt:null,delay:0,onUpdate:h&&function(){return Bn(e,"onUpdate")},stagger:0},a))),e._startAt._dp=0,e._startAt._sat=e,t<0&&(ji||!o&&!m)&&e._startAt.revert(Gh),o&&x&&t<=0&&i<=0){t&&(e._zTime=t);return}}else if(f&&x&&!_){if(t&&(o=!1),F=os({overwrite:!1,data:"isFromStart",lazy:o&&!_&&wn(u),immediateRender:o,stagger:0,parent:y},P),ie&&(F[Q.prop]=ie),Jr(e._startAt=_i.set(b,F)),e._startAt._dp=0,e._startAt._sat=e,t<0&&(ji?e._startAt.revert(Gh):e._startAt.render(-1,!0)),e._zTime=t,!o)r(e._startAt,Jt,Jt);else if(!t)return}for(e._pt=e._ptCache=0,u=x&&wn(u)||u&&!x,I=0;I<b.length;I++){if(k=b[I],J=k._gsap||jm(b)[I]._gsap,e._ptLookup[I]=j={},Kf[J.id]&&$r.length&&td(),K=M===b?I:M.indexOf(k),Q&&(X=new Q).init(k,ie||P,e,K,M)!==!1&&(e._pt=A=new Sn(e._pt,k,X.name,0,1,X.render,X,0,X.priority),X._props.forEach(function(V){j[V]=A}),X.priority&&(O=1)),!Q||ie)for(F in P)In[F]&&(X=jx(F,P,e,K,k,M))?X.priority&&(O=1):j[F]=A=qm.call(e,k,F,"get",P[F],K,M,0,n.stringFilter);e._op&&e._op[I]&&e.kill(k,e._op[I]),D&&e._pt&&(Wr=e,si.killTweensOf(k,j,e.globalTime(t)),ee=!e.parent,Wr=0),e._pt&&u&&(Kf[J.id]=1)}O&&Zx(e),e._onInit&&e._onInit(e)}e._onUpdate=h,e._initted=(!e._op||e._pt)&&!ee,d&&t<=0&&C.render(is,!0,!0)},PL=function(e,t,i,n,s,a,o,u){var h=(e._pt&&e._ptCache||(e._ptCache={}))[t],f,c,d,m;if(!h)for(h=e._ptCache[t]=[],d=e._ptLookup,m=e._targets.length;m--;){if(f=d[m][t],f&&f.d&&f.d._pt)for(f=f.d._pt;f&&f.p!==t&&f.fp!==t;)f=f._next;if(!f)return im=1,e.vars[t]="+=0",Xm(e,o),im=0,u?Zc(t+" not eligible for reset"):1;h.push(f)}for(m=h.length;m--;)c=h[m],f=c._pt||c,f.s=(n||n===0)&&!s?n:f.s+(n||0)+a*f.c,f.c=i-f.s,c.e&&(c.e=pi(i)+Hi(c.e)),c.b&&(c.b=f.s+Hi(c.b))},AL=function(e,t){var i=e[0]?Wo(e[0]).harness:0,n=i&&i.aliases,s,a,o,u;if(!n)return t;s=ta({},t);for(a in n)if(a in s)for(u=n[a].split(","),o=u.length;o--;)s[u[o]]=s[a];return s},LL=function(e,t,i,n){var s=t.ease||n||"power1.inOut",a,o;if(qi(t))o=i[e]||(i[e]=[]),t.forEach(function(u,h){return o.push({t:h/(t.length-1)*100,v:u,e:s})});else for(a in t)o=i[a]||(i[a]=[]),a==="ease"||o.push({t:parseFloat(e),v:t[a],e:s})},Bc=function(e,t,i,n,s){return hi(e)?e.call(t,i,n,s):ki(e)&&~e.indexOf("random(")?Qc(e):e},qx=Wm+"repeat,repeatDelay,yoyo,repeatRefresh,yoyoEase,autoRevert",Xx={};yn(qx+",id,stagger,delay,duration,paused,scrollTrigger",function(r){return Xx[r]=1});var _i=function(r){hx(e,r);function e(i,n,s,a){var o;typeof n=="number"&&(s.duration=n,n=s,s=null),o=r.call(this,a?n:Oc(n))||this;var u=o.vars,h=u.duration,f=u.delay,c=u.immediateRender,d=u.stagger,m=u.overwrite,x=u.keyframes,_=u.defaults,b=u.scrollTrigger,y=u.yoyoEase,M=n.parent||si,D=(qi(i)||px(i)?mr(i[0]):"length"in n)?[i]:ns(i),C,P,I,F,A,k,O,J;if(o._targets=D.length?jm(D):Zc("GSAP target "+i+" not found. https://gsap.com",!zn.nullTargetWarn)||[],o._ptLookup=[],o._overwrite=m,x||d||Dh(h)||Dh(f)){if(n=o.vars,C=o.timeline=new an({data:"nested",defaults:_||{},targets:M&&M.data==="nested"?M.vars.targets:D}),C.kill(),C.parent=C._dp=ir(o),C._start=0,d||Dh(h)||Dh(f)){if(F=D.length,O=d&&Lx(d),Bs(d))for(A in d)~qx.indexOf(A)&&(J||(J={}),J[A]=d[A]);for(P=0;P<F;P++)I=id(n,Xx),I.stagger=0,y&&(I.yoyoEase=y),J&&ta(I,J),k=D[P],I.duration=+Bc(h,ir(o),P,k,D),I.delay=(+Bc(f,ir(o),P,k,D)||0)-o._delay,!d&&F===1&&I.delay&&(o._delay=f=I.delay,o._start+=f,I.delay=0),C.to(k,I,O?O(P,k,D):0),C._ease=It.none;C.duration()?h=f=0:o.timeline=0}else if(x){Oc(os(C.vars.defaults,{ease:"none"})),C._ease=qo(x.ease||n.ease||"none");var Q=0,X,j,K;if(qi(x))x.forEach(function(ie){return C.to(D,ie,">")}),C.duration();else{I={};for(A in x)A==="ease"||A==="easeEach"||LL(A,x[A],I,x.easeEach);for(A in I)for(X=I[A].sort(function(ie,ee){return ie.t-ee.t}),Q=0,P=0;P<X.length;P++)j=X[P],K={ease:j.e,duration:(j.t-(P?X[P-1].t:0))/100*h},K[A]=j.v,C.to(D,K,Q),Q+=K.duration;C.duration()<h&&C.to({},{duration:h-C.duration()})}}h||o.duration(h=C.duration())}else o.timeline=0;return m===!0&&!Bm&&(Wr=ir(o),si.killTweensOf(D),Wr=0),As(M,ir(o),s),n.reversed&&o.reverse(),n.paused&&o.paused(!0),(c||!h&&!x&&o._start===Ri(M._time)&&wn(c)&&lL(ir(o))&&M.data!=="nested")&&(o._tTime=-Jt,o.render(Math.max(0,-f)||0)),b&&Cx(ir(o),b),o}var t=e.prototype;return t.render=function(n,s,a){var o=this._time,u=this._tDur,h=this._dur,f=n<0,c=n>u-Jt&&!f?u:n<Jt?0:n,d,m,x,_,b,y,M,D,C;if(!h)uL(this,n,s,a);else if(c!==this._tTime||!n||a||!this._initted&&this._tTime||this._startAt&&this._zTime<0!==f){if(d=c,D=this.timeline,this._repeat){if(_=h+this._rDelay,this._repeat<-1&&f)return this.totalTime(_*100+n,s,a);if(d=Ri(c%_),c===u?(x=this._repeat,d=h):(x=~~(c/_),x&&x===Ri(c/_)&&(d=h,x--),d>h&&(d=h)),y=this._yoyo&&x&1,y&&(C=this._yEase,d=h-d),b=ml(this._tTime,_),d===o&&!a&&this._initted&&x===b)return this._tTime=c,this;x!==b&&(D&&this._yEase&&Gx(D,y),this.vars.repeatRefresh&&!y&&!this._lock&&this._time!==_&&this._initted&&(this._lock=a=1,this.render(Ri(_*x),!0).invalidate()._lock=0))}if(!this._initted){if(Dx(this,f?n:d,a,s,c))return this._tTime=0,this;if(o!==this._time&&!(a&&this.vars.repeatRefresh&&x!==b))return this;if(h!==this._dur)return this.render(n,s,a)}if(this._tTime=c,this._time=d,!this._act&&this._ts&&(this._act=1,this._lazy=0),this.ratio=M=(C||this._ease)(d/h),this._from&&(this.ratio=M=1-M),d&&!o&&!s&&!x&&(Bn(this,"onStart"),this._tTime!==c))return this;for(m=this._pt;m;)m.r(M,m.d),m=m._next;D&&D.render(n<0?n:D._dur*D._ease(d/this._dur),s,a)||this._startAt&&(this._zTime=n),this._onUpdate&&!s&&(f&&Zf(this,n,s,a),Bn(this,"onUpdate")),this._repeat&&x!==b&&this.vars.onRepeat&&!s&&this.parent&&Bn(this,"onRepeat"),(c===this._tDur||!c)&&this._tTime===c&&(f&&!this._onUpdate&&Zf(this,n,!0,!0),(n||!h)&&(c===this._tDur&&this._ts>0||!c&&this._ts<0)&&Jr(this,1),!s&&!(f&&!o)&&(c||o||y)&&(Bn(this,c===u?"onComplete":"onReverseComplete",!0),this._prom&&!(c<u&&this.timeScale()>0)&&this._prom()))}return this},t.targets=function(){return this._targets},t.invalidate=function(n){return(!n||!this.vars.runBackwards)&&(this._startAt=0),this._pt=this._op=this._onUpdate=this._lazy=this.ratio=0,this._ptLookup=[],this.timeline&&this.timeline.invalidate(n),r.prototype.invalidate.call(this,n)},t.resetTo=function(n,s,a,o,u){eu||On.wake(),this._ts||this.play();var h=Math.min(this._dur,(this._dp._time-this._start)*this._ts),f;return this._initted||Xm(this,h),f=this._ease(h/this._dur),PL(this,n,s,a,o,f,h,u)?this.resetTo(n,s,a,o,1):(bd(this,0),this.parent||Tx(this._dp,this,"_first","_last",this._dp._sort?"_start":0),this.render(0))},t.kill=function(n,s){if(s===void 0&&(s="all"),!n&&(!s||s==="all"))return this._lazy=this._pt=0,this.parent?Sc(this):this;if(this.timeline){var a=this.timeline.totalDuration();return this.timeline.killTweensOf(n,s,Wr&&Wr.vars.overwrite!==!0)._first||Sc(this),this.parent&&a!==this.timeline.totalDuration()&&gl(this,this._dur*this.timeline._tDur/a,0,1),this}var o=this._targets,u=n?ns(n):o,h=this._ptLookup,f=this._pt,c,d,m,x,_,b,y;if((!s||s==="all")&&oL(o,u))return s==="all"&&(this._pt=0),Sc(this);for(c=this._op=this._op||[],s!=="all"&&(ki(s)&&(_={},yn(s,function(M){return _[M]=1}),s=_),s=AL(o,s)),y=o.length;y--;)if(~u.indexOf(o[y])){d=h[y],s==="all"?(c[y]=s,x=d,m={}):(m=c[y]=c[y]||{},x=s);for(_ in x)b=d&&d[_],b&&((!("kill"in b.d)||b.d.kill(_)===!0)&&_d(this,b,"_pt"),delete d[_]),m!=="all"&&(m[_]=1)}return this._initted&&!this._pt&&f&&Sc(this),this},e.to=function(n,s){return new e(n,s,arguments[2])},e.from=function(n,s){return Nc(1,arguments)},e.delayedCall=function(n,s,a,o){return new e(s,0,{immediateRender:!1,lazy:!1,overwrite:!1,delay:n,onComplete:s,onReverseComplete:s,onCompleteParams:a,onReverseCompleteParams:a,callbackScope:o})},e.fromTo=function(n,s,a){return Nc(2,arguments)},e.set=function(n,s){return s.duration=0,s.repeatDelay||(s.repeat=0),new e(n,s)},e.killTweensOf=function(n,s,a){return si.killTweensOf(n,s,a)},e}(tu);os(_i.prototype,{_targets:[],_lazy:0,_startAt:0,_op:0,_onInit:0});yn("staggerTo,staggerFrom,staggerFromTo",function(r){_i[r]=function(){var e=new an,t=Qf.call(arguments,0);return t.splice(r==="staggerFromTo"?5:4,0,0),e[r].apply(e,t)}});var $m=function(e,t,i){return e[t]=i},$x=function(e,t,i){return e[t](i)},RL=function(e,t,i,n){return e[t](n.fp,i)},kL=function(e,t,i){return e.setAttribute(t,i)},Ym=function(e,t){return hi(e[t])?$x:Vm(e[t])&&e.setAttribute?kL:$m},Yx=function(e,t){return t.set(t.t,t.p,Math.round((t.s+t.c*e)*1e6)/1e6,t)},IL=function(e,t){return t.set(t.t,t.p,!!(t.s+t.c*e),t)},Kx=function(e,t){var i=t._pt,n="";if(!e&&t.b)n=t.b;else if(e===1&&t.e)n=t.e;else{for(;i;)n=i.p+(i.m?i.m(i.s+i.c*e):Math.round((i.s+i.c*e)*1e4)/1e4)+n,i=i._next;n+=t.c}t.set(t.t,t.p,n,t)},Km=function(e,t){for(var i=t._pt;i;)i.r(e,i.d),i=i._next},FL=function(e,t,i,n){for(var s=this._pt,a;s;)a=s._next,s.p===n&&s.modifier(e,t,i),s=a},OL=function(e){for(var t=this._pt,i,n;t;)n=t._next,t.p===e&&!t.op||t.op===e?_d(this,t,"_pt"):t.dep||(i=1),t=n;return!i},NL=function(e,t,i,n){n.mSet(e,t,n.m.call(n.tween,i,n.mt),n)},Zx=function(e){for(var t=e._pt,i,n,s,a;t;){for(i=t._next,n=s;n&&n.pr>t.pr;)n=n._next;(t._prev=n?n._prev:a)?t._prev._next=t:s=t,(t._next=n)?n._prev=t:a=t,t=i}e._pt=s},Sn=function(){function r(t,i,n,s,a,o,u,h,f){this.t=i,this.s=s,this.c=a,this.p=n,this.r=o||Yx,this.d=u||this,this.set=h||$m,this.pr=f||0,this._next=t,t&&(t._prev=this)}var e=r.prototype;return e.modifier=function(i,n,s){this.mSet=this.mSet||this.set,this.set=NL,this.m=i,this.mt=s,this.tween=n},r}();yn(Wm+"parent,duration,ease,delay,overwrite,runBackwards,startAt,yoyo,immediateRender,repeat,repeatDelay,data,paused,reversed,lazy,callbackScope,stringFilter,id,yoyoEase,stagger,inherit,repeatRefresh,keyframes,autoRevert,scrollTrigger",function(r){return Hm[r]=1});Un.TweenMax=Un.TweenLite=_i;Un.TimelineLite=Un.TimelineMax=an;si=new an({sortChildren:!1,defaults:fl,autoRemoveChildren:!0,id:"root",smoothChildTiming:!0});zn.stringFilter=zx;var Xo=[],Wh={},BL=[],g0=0,VL=0,lf=function(e){return(Wh[e]||BL).map(function(t){return t()})},nm=function(){var e=Date.now(),t=[];e-g0>2&&(lf("matchMediaInit"),Xo.forEach(function(i){var n=i.queries,s=i.conditions,a,o,u,h;for(o in n)a=Cs.matchMedia(n[o]).matches,a&&(u=1),a!==s[o]&&(s[o]=a,h=1);h&&(i.revert(),u&&t.push(i))}),lf("matchMediaRevert"),t.forEach(function(i){return i.onMatch(i,function(n){return i.add(null,n)})}),g0=e,lf("matchMedia"))},Jx=function(){function r(t,i){this.selector=i&&em(i),this.data=[],this._r=[],this.isReverted=!1,this.id=VL++,t&&this.add(t)}var e=r.prototype;return e.add=function(i,n,s){hi(i)&&(s=n,n=i,i=hi);var a=this,o=function(){var h=ti,f=a.selector,c;return h&&h!==a&&h.data.push(a),s&&(a.selector=em(s)),ti=a,c=n.apply(a,arguments),hi(c)&&a._r.push(c),ti=h,a.selector=f,a.isReverted=!1,c};return a.last=o,i===hi?o(a,function(u){return a.add(null,u)}):i?a[i]=o:o},e.ignore=function(i){var n=ti;ti=null,i(this),ti=n},e.getTweens=function(){var i=[];return this.data.forEach(function(n){return n instanceof r?i.push.apply(i,n.getTweens()):n instanceof _i&&!(n.parent&&n.parent.data==="nested")&&i.push(n)}),i},e.clear=function(){this._r.length=this.data.length=0},e.kill=function(i,n){var s=this;if(i?function(){for(var o=s.getTweens(),u=s.data.length,h;u--;)h=s.data[u],h.data==="isFlip"&&(h.revert(),h.getChildren(!0,!0,!1).forEach(function(f){return o.splice(o.indexOf(f),1)}));for(o.map(function(f){return{g:f._dur||f._delay||f._sat&&!f._sat.vars.immediateRender?f.globalTime(0):-1/0,t:f}}).sort(function(f,c){return c.g-f.g||-1/0}).forEach(function(f){return f.t.revert(i)}),u=s.data.length;u--;)h=s.data[u],h instanceof an?h.data!=="nested"&&(h.scrollTrigger&&h.scrollTrigger.revert(),h.kill()):!(h instanceof _i)&&h.revert&&h.revert(i);s._r.forEach(function(f){return f(i,s)}),s.isReverted=!0}():this.data.forEach(function(o){return o.kill&&o.kill()}),this.clear(),n)for(var a=Xo.length;a--;)Xo[a].id===this.id&&Xo.splice(a,1)},e.revert=function(i){this.kill(i||{})},r}(),zL=function(){function r(t){this.contexts=[],this.scope=t,ti&&ti.data.push(this)}var e=r.prototype;return e.add=function(i,n,s){Bs(i)||(i={matches:i});var a=new Jx(0,s||this.scope),o=a.conditions={},u,h,f;ti&&!a.selector&&(a.selector=ti.selector),this.contexts.push(a),n=a.add("onMatch",n),a.queries=i;for(h in i)h==="all"?f=1:(u=Cs.matchMedia(i[h]),u&&(Xo.indexOf(a)<0&&Xo.push(a),(o[h]=u.matches)&&(f=1),u.addListener?u.addListener(nm):u.addEventListener("change",nm)));return f&&n(a,function(c){return a.add(null,c)}),this},e.revert=function(i){this.kill(i||{})},e.kill=function(i){this.contexts.forEach(function(n){return n.kill(i,!0)})},r}(),sd={registerPlugin:function(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];t.forEach(function(n){return Nx(n)})},timeline:function(e){return new an(e)},getTweensOf:function(e,t){return si.getTweensOf(e,t)},getProperty:function(e,t,i,n){ki(e)&&(e=ns(e)[0]);var s=Wo(e||{}).get,a=i?Mx:Sx;return i==="native"&&(i=""),e&&(t?a((In[t]&&In[t].get||s)(e,t,i,n)):function(o,u,h){return a((In[o]&&In[o].get||s)(e,o,u,h))})},quickSetter:function(e,t,i){if(e=ns(e),e.length>1){var n=e.map(function(f){return Xi.quickSetter(f,t,i)}),s=n.length;return function(f){for(var c=s;c--;)n[c](f)}}e=e[0]||{};var a=In[t],o=Wo(e),u=o.harness&&(o.harness.aliases||{})[t]||t,h=a?function(f){var c=new a;Ya._pt=0,c.init(e,i?f+i:f,Ya,0,[e]),c.render(1,c),Ya._pt&&Km(1,Ya)}:o.set(e,u);return a?h:function(f){return h(e,u,i?f+i:f,o,1)}},quickTo:function(e,t,i){var n,s=Xi.to(e,ta((n={},n[t]="+=0.1",n.paused=!0,n),i||{})),a=function(u,h,f){return s.resetTo(t,u,h,f)};return a.tween=s,a},isTweening:function(e){return si.getTweensOf(e,!0).length>0},defaults:function(e){return e&&e.ease&&(e.ease=qo(e.ease,fl.ease)),h0(fl,e||{})},config:function(e){return h0(zn,e||{})},registerEffect:function(e){var t=e.name,i=e.effect,n=e.plugins,s=e.defaults,a=e.extendTimeline;(n||"").split(",").forEach(function(o){return o&&!In[o]&&!Un[o]&&Zc(t+" effect requires "+o+" plugin.")}),sf[t]=function(o,u,h){return i(ns(o),os(u||{},s),h)},a&&(an.prototype[t]=function(o,u,h){return this.add(sf[t](o,Bs(u)?u:(h=u)&&{},this),h)})},registerEase:function(e,t){It[e]=qo(t)},parseEase:function(e,t){return arguments.length?qo(e,t):It},getById:function(e){return si.getById(e)},exportRoot:function(e,t){e===void 0&&(e={});var i=new an(e),n,s;for(i.smoothChildTiming=wn(e.smoothChildTiming),si.remove(i),i._dp=0,i._time=i._tTime=si._time,n=si._first;n;)s=n._next,(t||!(!n._dur&&n instanceof _i&&n.vars.onComplete===n._targets[0]))&&As(i,n,n._start-n._delay),n=s;return As(si,i,0),i},context:function(e,t){return e?new Jx(e,t):ti},matchMedia:function(e){return new zL(e)},matchMediaRefresh:function(){return Xo.forEach(function(e){var t=e.conditions,i,n;for(n in t)t[n]&&(t[n]=!1,i=1);i&&e.revert()})||nm()},addEventListener:function(e,t){var i=Wh[e]||(Wh[e]=[]);~i.indexOf(t)||i.push(t)},removeEventListener:function(e,t){var i=Wh[e],n=i&&i.indexOf(t);n>=0&&i.splice(n,1)},utils:{wrap:vL,wrapYoyo:bL,distribute:Lx,random:kx,snap:Rx,normalize:_L,getUnit:Hi,clamp:pL,splitColor:Bx,toArray:ns,selector:em,mapRange:Fx,pipe:mL,unitize:gL,interpolate:xL,shuffle:Ax},install:vx,effects:sf,ticker:On,updateRoot:an.updateRoot,plugins:In,globalTimeline:si,core:{PropTween:Sn,globals:bx,Tween:_i,Timeline:an,Animation:tu,getCache:Wo,_removeLinkedListItem:_d,reverting:function(){return ji},context:function(e){return e&&ti&&(ti.data.push(e),e._ctx=ti),ti},suppressOverwrites:function(e){return Bm=e}}};yn("to,from,fromTo,delayedCall,set,killTweensOf",function(r){return sd[r]=_i[r]});On.add(an.updateRoot);Ya=sd.to({},{duration:0});var UL=function(e,t){for(var i=e._pt;i&&i.p!==t&&i.op!==t&&i.fp!==t;)i=i._next;return i},GL=function(e,t){var i=e._targets,n,s,a;for(n in t)for(s=i.length;s--;)a=e._ptLookup[s][n],a&&(a=a.d)&&(a._pt&&(a=UL(a,n)),a&&a.modifier&&a.modifier(t[n],e,i[s],n))},cf=function(e,t){return{name:e,rawVars:1,init:function(n,s,a){a._onInit=function(o){var u,h;if(ki(s)&&(u={},yn(s,function(f){return u[f]=1}),s=u),t){u={};for(h in s)u[h]=t(s[h]);s=u}GL(o,s)}}}},Xi=sd.registerPlugin({name:"attr",init:function(e,t,i,n,s){var a,o,u;this.tween=i;for(a in t)u=e.getAttribute(a)||"",o=this.add(e,"setAttribute",(u||0)+"",t[a],n,s,0,0,a),o.op=a,o.b=u,this._props.push(a)},render:function(e,t){for(var i=t._pt;i;)ji?i.set(i.t,i.p,i.b,i):i.r(e,i.d),i=i._next}},{name:"endArray",init:function(e,t){for(var i=t.length;i--;)this.add(e,i,e[i]||0,t[i],0,0,0,0,0,1)}},cf("roundProps",tm),cf("modifiers"),cf("snap",Rx))||sd;_i.version=an.version=Xi.version="3.12.5";_x=1;zm()&&_l();It.Power0;It.Power1;It.Power2;It.Power3;It.Power4;It.Linear;It.Quad;It.Cubic;It.Quart;It.Quint;It.Strong;It.Elastic;It.Back;It.SteppedEase;It.Bounce;It.Sine;It.Expo;It.Circ;/*!
 * CSSPlugin 3.12.5
 * https://gsap.com
 *
 * Copyright 2008-2024, GreenSock. All rights reserved.
 * Subject to the terms at https://gsap.com/standard-license or for
 * Club GSAP members, the agreement issued with that membership.
 * @author: Jack Doyle, jack@greensock.com
*/var _0,jr,sl,Zm,ko,v0,Jm,HL=function(){return typeof window<"u"},gr={},Co=180/Math.PI,rl=Math.PI/180,Ba=Math.atan2,b0=1e8,Qm=/([A-Z])/g,WL=/(left|right|width|margin|padding|x)/i,jL=/[\s,\(]\S/,Rs={autoAlpha:"opacity,visibility",scale:"scaleX,scaleY",alpha:"opacity"},sm=function(e,t){return t.set(t.t,t.p,Math.round((t.s+t.c*e)*1e4)/1e4+t.u,t)},qL=function(e,t){return t.set(t.t,t.p,e===1?t.e:Math.round((t.s+t.c*e)*1e4)/1e4+t.u,t)},XL=function(e,t){return t.set(t.t,t.p,e?Math.round((t.s+t.c*e)*1e4)/1e4+t.u:t.b,t)},$L=function(e,t){var i=t.s+t.c*e;t.set(t.t,t.p,~~(i+(i<0?-.5:.5))+t.u,t)},Qx=function(e,t){return t.set(t.t,t.p,e?t.e:t.b,t)},ew=function(e,t){return t.set(t.t,t.p,e!==1?t.b:t.e,t)},YL=function(e,t,i){return e.style[t]=i},KL=function(e,t,i){return e.style.setProperty(t,i)},ZL=function(e,t,i){return e._gsap[t]=i},JL=function(e,t,i){return e._gsap.scaleX=e._gsap.scaleY=i},QL=function(e,t,i,n,s){var a=e._gsap;a.scaleX=a.scaleY=i,a.renderTransform(s,a)},e2=function(e,t,i,n,s){var a=e._gsap;a[t]=i,a.renderTransform(s,a)},ri="transform",Mn=ri+"Origin",t2=function r(e,t){var i=this,n=this.target,s=n.style,a=n._gsap;if(e in gr&&s){if(this.tfm=this.tfm||{},e!=="transform")e=Rs[e]||e,~e.indexOf(",")?e.split(",").forEach(function(o){return i.tfm[o]=nr(n,o)}):this.tfm[e]=a.x?a[e]:nr(n,e),e===Mn&&(this.tfm.zOrigin=a.zOrigin);else return Rs.transform.split(",").forEach(function(o){return r.call(i,o,t)});if(this.props.indexOf(ri)>=0)return;a.svg&&(this.svgo=n.getAttribute("data-svg-origin"),this.props.push(Mn,t,"")),e=ri}(s||t)&&this.props.push(e,t,s[e])},tw=function(e){e.translate&&(e.removeProperty("translate"),e.removeProperty("scale"),e.removeProperty("rotate"))},i2=function(){var e=this.props,t=this.target,i=t.style,n=t._gsap,s,a;for(s=0;s<e.length;s+=3)e[s+1]?t[e[s]]=e[s+2]:e[s+2]?i[e[s]]=e[s+2]:i.removeProperty(e[s].substr(0,2)==="--"?e[s]:e[s].replace(Qm,"-$1").toLowerCase());if(this.tfm){for(a in this.tfm)n[a]=this.tfm[a];n.svg&&(n.renderTransform(),t.setAttribute("data-svg-origin",this.svgo||"")),s=Jm(),(!s||!s.isStart)&&!i[ri]&&(tw(i),n.zOrigin&&i[Mn]&&(i[Mn]+=" "+n.zOrigin+"px",n.zOrigin=0,n.renderTransform()),n.uncache=1)}},iw=function(e,t){var i={target:e,props:[],revert:i2,save:t2};return e._gsap||Xi.core.getCache(e),t&&t.split(",").forEach(function(n){return i.save(n)}),i},nw,rm=function(e,t){var i=jr.createElementNS?jr.createElementNS((t||"http://www.w3.org/1999/xhtml").replace(/^https/,"http"),e):jr.createElement(e);return i&&i.style?i:jr.createElement(e)},Fs=function r(e,t,i){var n=getComputedStyle(e);return n[t]||n.getPropertyValue(t.replace(Qm,"-$1").toLowerCase())||n.getPropertyValue(t)||!i&&r(e,vl(t)||t,1)||""},x0="O,Moz,ms,Ms,Webkit".split(","),vl=function(e,t,i){var n=t||ko,s=n.style,a=5;if(e in s&&!i)return e;for(e=e.charAt(0).toUpperCase()+e.substr(1);a--&&!(x0[a]+e in s););return a<0?null:(a===3?"ms":a>=0?x0[a]:"")+e},om=function(){HL()&&window.document&&(_0=window,jr=_0.document,sl=jr.documentElement,ko=rm("div")||{style:{}},rm("div"),ri=vl(ri),Mn=ri+"Origin",ko.style.cssText="border-width:0;line-height:0;position:absolute;padding:0",nw=!!vl("perspective"),Jm=Xi.core.reverting,Zm=1)},uf=function r(e){var t=rm("svg",this.ownerSVGElement&&this.ownerSVGElement.getAttribute("xmlns")||"http://www.w3.org/2000/svg"),i=this.parentNode,n=this.nextSibling,s=this.style.cssText,a;if(sl.appendChild(t),t.appendChild(this),this.style.display="block",e)try{a=this.getBBox(),this._gsapBBox=this.getBBox,this.getBBox=r}catch{}else this._gsapBBox&&(a=this._gsapBBox());return i&&(n?i.insertBefore(this,n):i.appendChild(this)),sl.removeChild(t),this.style.cssText=s,a},w0=function(e,t){for(var i=t.length;i--;)if(e.hasAttribute(t[i]))return e.getAttribute(t[i])},sw=function(e){var t;try{t=e.getBBox()}catch{t=uf.call(e,!0)}return t&&(t.width||t.height)||e.getBBox===uf||(t=uf.call(e,!0)),t&&!t.width&&!t.x&&!t.y?{x:+w0(e,["x","cx","x1"])||0,y:+w0(e,["y","cy","y1"])||0,width:0,height:0}:t},rw=function(e){return!!(e.getCTM&&(!e.parentNode||e.ownerSVGElement)&&sw(e))},ia=function(e,t){if(t){var i=e.style,n;t in gr&&t!==Mn&&(t=ri),i.removeProperty?(n=t.substr(0,2),(n==="ms"||t.substr(0,6)==="webkit")&&(t="-"+t),i.removeProperty(n==="--"?t:t.replace(Qm,"-$1").toLowerCase())):i.removeAttribute(t)}},qr=function(e,t,i,n,s,a){var o=new Sn(e._pt,t,i,0,1,a?ew:Qx);return e._pt=o,o.b=n,o.e=s,e._props.push(i),o},y0={deg:1,rad:1,turn:1},n2={grid:1,flex:1},Qr=function r(e,t,i,n){var s=parseFloat(i)||0,a=(i+"").trim().substr((s+"").length)||"px",o=ko.style,u=WL.test(t),h=e.tagName.toLowerCase()==="svg",f=(h?"client":"offset")+(u?"Width":"Height"),c=100,d=n==="px",m=n==="%",x,_,b,y;if(n===a||!s||y0[n]||y0[a])return s;if(a!=="px"&&!d&&(s=r(e,t,i,"px")),y=e.getCTM&&rw(e),(m||a==="%")&&(gr[t]||~t.indexOf("adius")))return x=y?e.getBBox()[u?"width":"height"]:e[f],pi(m?s/x*c:s/100*x);if(o[u?"width":"height"]=c+(d?a:n),_=~t.indexOf("adius")||n==="em"&&e.appendChild&&!h?e:e.parentNode,y&&(_=(e.ownerSVGElement||{}).parentNode),(!_||_===jr||!_.appendChild)&&(_=jr.body),b=_._gsap,b&&m&&b.width&&u&&b.time===On.time&&!b.uncache)return pi(s/b.width*c);if(m&&(t==="height"||t==="width")){var M=e.style[t];e.style[t]=c+n,x=e[f],M?e.style[t]=M:ia(e,t)}else(m||a==="%")&&!n2[Fs(_,"display")]&&(o.position=Fs(e,"position")),_===e&&(o.position="static"),_.appendChild(ko),x=ko[f],_.removeChild(ko),o.position="absolute";return u&&m&&(b=Wo(_),b.time=On.time,b.width=_[f]),pi(d?x*s/c:x&&s?c/x*s:0)},nr=function(e,t,i,n){var s;return Zm||om(),t in Rs&&t!=="transform"&&(t=Rs[t],~t.indexOf(",")&&(t=t.split(",")[0])),gr[t]&&t!=="transform"?(s=nu(e,n),s=t!=="transformOrigin"?s[t]:s.svg?s.origin:od(Fs(e,Mn))+" "+s.zOrigin+"px"):(s=e.style[t],(!s||s==="auto"||n||~(s+"").indexOf("calc("))&&(s=rd[t]&&rd[t](e,t,i)||Fs(e,t)||wx(e,t)||(t==="opacity"?1:0))),i&&!~(s+"").trim().indexOf(" ")?Qr(e,t,s,i)+i:s},s2=function(e,t,i,n){if(!i||i==="none"){var s=vl(t,e,1),a=s&&Fs(e,s,1);a&&a!==i?(t=s,i=a):t==="borderColor"&&(i=Fs(e,"borderTopColor"))}var o=new Sn(this._pt,e.style,t,0,1,Kx),u=0,h=0,f,c,d,m,x,_,b,y,M,D,C,P;if(o.b=i,o.e=n,i+="",n+="",n==="auto"&&(_=e.style[t],e.style[t]=n,n=Fs(e,t)||n,_?e.style[t]=_:ia(e,t)),f=[i,n],zx(f),i=f[0],n=f[1],d=i.match($a)||[],P=n.match($a)||[],P.length){for(;c=$a.exec(n);)b=c[0],M=n.substring(u,c.index),x?x=(x+1)%5:(M.substr(-5)==="rgba("||M.substr(-5)==="hsla(")&&(x=1),b!==(_=d[h++]||"")&&(m=parseFloat(_)||0,C=_.substr((m+"").length),b.charAt(1)==="="&&(b=nl(m,b)+C),y=parseFloat(b),D=b.substr((y+"").length),u=$a.lastIndex-D.length,D||(D=D||zn.units[t]||C,u===n.length&&(n+=D,o.e+=D)),C!==D&&(m=Qr(e,t,_,D)||0),o._pt={_next:o._pt,p:M||h===1?M:",",s:m,c:y-m,m:x&&x<4||t==="zIndex"?Math.round:0});o.c=u<n.length?n.substring(u,n.length):""}else o.r=t==="display"&&n==="none"?ew:Qx;return mx.test(n)&&(o.e=0),this._pt=o,o},S0={top:"0%",bottom:"100%",left:"0%",right:"100%",center:"50%"},r2=function(e){var t=e.split(" "),i=t[0],n=t[1]||"50%";return(i==="top"||i==="bottom"||n==="left"||n==="right")&&(e=i,i=n,n=e),t[0]=S0[i]||i,t[1]=S0[n]||n,t.join(" ")},o2=function(e,t){if(t.tween&&t.tween._time===t.tween._dur){var i=t.t,n=i.style,s=t.u,a=i._gsap,o,u,h;if(s==="all"||s===!0)n.cssText="",u=1;else for(s=s.split(","),h=s.length;--h>-1;)o=s[h],gr[o]&&(u=1,o=o==="transformOrigin"?Mn:ri),ia(i,o);u&&(ia(i,ri),a&&(a.svg&&i.removeAttribute("transform"),nu(i,1),a.uncache=1,tw(n)))}},rd={clearProps:function(e,t,i,n,s){if(s.data!=="isFromStart"){var a=e._pt=new Sn(e._pt,t,i,0,0,o2);return a.u=n,a.pr=-10,a.tween=s,e._props.push(i),1}}},iu=[1,0,0,1,0,0],ow={},aw=function(e){return e==="matrix(1, 0, 0, 1, 0, 0)"||e==="none"||!e},M0=function(e){var t=Fs(e,ri);return aw(t)?iu:t.substr(7).match(fx).map(pi)},eg=function(e,t){var i=e._gsap||Wo(e),n=e.style,s=M0(e),a,o,u,h;return i.svg&&e.getAttribute("transform")?(u=e.transform.baseVal.consolidate().matrix,s=[u.a,u.b,u.c,u.d,u.e,u.f],s.join(",")==="1,0,0,1,0,0"?iu:s):(s===iu&&!e.offsetParent&&e!==sl&&!i.svg&&(u=n.display,n.display="block",a=e.parentNode,(!a||!e.offsetParent)&&(h=1,o=e.nextElementSibling,sl.appendChild(e)),s=M0(e),u?n.display=u:ia(e,"display"),h&&(o?a.insertBefore(e,o):a?a.appendChild(e):sl.removeChild(e))),t&&s.length>6?[s[0],s[1],s[4],s[5],s[12],s[13]]:s)},am=function(e,t,i,n,s,a){var o=e._gsap,u=s||eg(e,!0),h=o.xOrigin||0,f=o.yOrigin||0,c=o.xOffset||0,d=o.yOffset||0,m=u[0],x=u[1],_=u[2],b=u[3],y=u[4],M=u[5],D=t.split(" "),C=parseFloat(D[0])||0,P=parseFloat(D[1])||0,I,F,A,k;i?u!==iu&&(F=m*b-x*_)&&(A=C*(b/F)+P*(-_/F)+(_*M-b*y)/F,k=C*(-x/F)+P*(m/F)-(m*M-x*y)/F,C=A,P=k):(I=sw(e),C=I.x+(~D[0].indexOf("%")?C/100*I.width:C),P=I.y+(~(D[1]||D[0]).indexOf("%")?P/100*I.height:P)),n||n!==!1&&o.smooth?(y=C-h,M=P-f,o.xOffset=c+(y*m+M*_)-y,o.yOffset=d+(y*x+M*b)-M):o.xOffset=o.yOffset=0,o.xOrigin=C,o.yOrigin=P,o.smooth=!!n,o.origin=t,o.originIsAbsolute=!!i,e.style[Mn]="0px 0px",a&&(qr(a,o,"xOrigin",h,C),qr(a,o,"yOrigin",f,P),qr(a,o,"xOffset",c,o.xOffset),qr(a,o,"yOffset",d,o.yOffset)),e.setAttribute("data-svg-origin",C+" "+P)},nu=function(e,t){var i=e._gsap||new Wx(e);if("x"in i&&!t&&!i.uncache)return i;var n=e.style,s=i.scaleX<0,a="px",o="deg",u=getComputedStyle(e),h=Fs(e,Mn)||"0",f,c,d,m,x,_,b,y,M,D,C,P,I,F,A,k,O,J,Q,X,j,K,ie,ee,V,_e,U,oe,ce,me,le,be;return f=c=d=_=b=y=M=D=C=0,m=x=1,i.svg=!!(e.getCTM&&rw(e)),u.translate&&((u.translate!=="none"||u.scale!=="none"||u.rotate!=="none")&&(n[ri]=(u.translate!=="none"?"translate3d("+(u.translate+" 0 0").split(" ").slice(0,3).join(", ")+") ":"")+(u.rotate!=="none"?"rotate("+u.rotate+") ":"")+(u.scale!=="none"?"scale("+u.scale.split(" ").join(",")+") ":"")+(u[ri]!=="none"?u[ri]:"")),n.scale=n.rotate=n.translate="none"),F=eg(e,i.svg),i.svg&&(i.uncache?(V=e.getBBox(),h=i.xOrigin-V.x+"px "+(i.yOrigin-V.y)+"px",ee=""):ee=!t&&e.getAttribute("data-svg-origin"),am(e,ee||h,!!ee||i.originIsAbsolute,i.smooth!==!1,F)),P=i.xOrigin||0,I=i.yOrigin||0,F!==iu&&(J=F[0],Q=F[1],X=F[2],j=F[3],f=K=F[4],c=ie=F[5],F.length===6?(m=Math.sqrt(J*J+Q*Q),x=Math.sqrt(j*j+X*X),_=J||Q?Ba(Q,J)*Co:0,M=X||j?Ba(X,j)*Co+_:0,M&&(x*=Math.abs(Math.cos(M*rl))),i.svg&&(f-=P-(P*J+I*X),c-=I-(P*Q+I*j))):(be=F[6],me=F[7],U=F[8],oe=F[9],ce=F[10],le=F[11],f=F[12],c=F[13],d=F[14],A=Ba(be,ce),b=A*Co,A&&(k=Math.cos(-A),O=Math.sin(-A),ee=K*k+U*O,V=ie*k+oe*O,_e=be*k+ce*O,U=K*-O+U*k,oe=ie*-O+oe*k,ce=be*-O+ce*k,le=me*-O+le*k,K=ee,ie=V,be=_e),A=Ba(-X,ce),y=A*Co,A&&(k=Math.cos(-A),O=Math.sin(-A),ee=J*k-U*O,V=Q*k-oe*O,_e=X*k-ce*O,le=j*O+le*k,J=ee,Q=V,X=_e),A=Ba(Q,J),_=A*Co,A&&(k=Math.cos(A),O=Math.sin(A),ee=J*k+Q*O,V=K*k+ie*O,Q=Q*k-J*O,ie=ie*k-K*O,J=ee,K=V),b&&Math.abs(b)+Math.abs(_)>359.9&&(b=_=0,y=180-y),m=pi(Math.sqrt(J*J+Q*Q+X*X)),x=pi(Math.sqrt(ie*ie+be*be)),A=Ba(K,ie),M=Math.abs(A)>2e-4?A*Co:0,C=le?1/(le<0?-le:le):0),i.svg&&(ee=e.getAttribute("transform"),i.forceCSS=e.setAttribute("transform","")||!aw(Fs(e,ri)),ee&&e.setAttribute("transform",ee))),Math.abs(M)>90&&Math.abs(M)<270&&(s?(m*=-1,M+=_<=0?180:-180,_+=_<=0?180:-180):(x*=-1,M+=M<=0?180:-180)),t=t||i.uncache,i.x=f-((i.xPercent=f&&(!t&&i.xPercent||(Math.round(e.offsetWidth/2)===Math.round(-f)?-50:0)))?e.offsetWidth*i.xPercent/100:0)+a,i.y=c-((i.yPercent=c&&(!t&&i.yPercent||(Math.round(e.offsetHeight/2)===Math.round(-c)?-50:0)))?e.offsetHeight*i.yPercent/100:0)+a,i.z=d+a,i.scaleX=pi(m),i.scaleY=pi(x),i.rotation=pi(_)+o,i.rotationX=pi(b)+o,i.rotationY=pi(y)+o,i.skewX=M+o,i.skewY=D+o,i.transformPerspective=C+a,(i.zOrigin=parseFloat(h.split(" ")[2])||!t&&i.zOrigin||0)&&(n[Mn]=od(h)),i.xOffset=i.yOffset=0,i.force3D=zn.force3D,i.renderTransform=i.svg?l2:nw?lw:a2,i.uncache=0,i},od=function(e){return(e=e.split(" "))[0]+" "+e[1]},hf=function(e,t,i){var n=Hi(t);return pi(parseFloat(t)+parseFloat(Qr(e,"x",i+"px",n)))+n},a2=function(e,t){t.z="0px",t.rotationY=t.rotationX="0deg",t.force3D=0,lw(e,t)},xo="0deg",pc="0px",wo=") ",lw=function(e,t){var i=t||this,n=i.xPercent,s=i.yPercent,a=i.x,o=i.y,u=i.z,h=i.rotation,f=i.rotationY,c=i.rotationX,d=i.skewX,m=i.skewY,x=i.scaleX,_=i.scaleY,b=i.transformPerspective,y=i.force3D,M=i.target,D=i.zOrigin,C="",P=y==="auto"&&e&&e!==1||y===!0;if(D&&(c!==xo||f!==xo)){var I=parseFloat(f)*rl,F=Math.sin(I),A=Math.cos(I),k;I=parseFloat(c)*rl,k=Math.cos(I),a=hf(M,a,F*k*-D),o=hf(M,o,-Math.sin(I)*-D),u=hf(M,u,A*k*-D+D)}b!==pc&&(C+="perspective("+b+wo),(n||s)&&(C+="translate("+n+"%, "+s+"%) "),(P||a!==pc||o!==pc||u!==pc)&&(C+=u!==pc||P?"translate3d("+a+", "+o+", "+u+") ":"translate("+a+", "+o+wo),h!==xo&&(C+="rotate("+h+wo),f!==xo&&(C+="rotateY("+f+wo),c!==xo&&(C+="rotateX("+c+wo),(d!==xo||m!==xo)&&(C+="skew("+d+", "+m+wo),(x!==1||_!==1)&&(C+="scale("+x+", "+_+wo),M.style[ri]=C||"translate(0, 0)"},l2=function(e,t){var i=t||this,n=i.xPercent,s=i.yPercent,a=i.x,o=i.y,u=i.rotation,h=i.skewX,f=i.skewY,c=i.scaleX,d=i.scaleY,m=i.target,x=i.xOrigin,_=i.yOrigin,b=i.xOffset,y=i.yOffset,M=i.forceCSS,D=parseFloat(a),C=parseFloat(o),P,I,F,A,k;u=parseFloat(u),h=parseFloat(h),f=parseFloat(f),f&&(f=parseFloat(f),h+=f,u+=f),u||h?(u*=rl,h*=rl,P=Math.cos(u)*c,I=Math.sin(u)*c,F=Math.sin(u-h)*-d,A=Math.cos(u-h)*d,h&&(f*=rl,k=Math.tan(h-f),k=Math.sqrt(1+k*k),F*=k,A*=k,f&&(k=Math.tan(f),k=Math.sqrt(1+k*k),P*=k,I*=k)),P=pi(P),I=pi(I),F=pi(F),A=pi(A)):(P=c,A=d,I=F=0),(D&&!~(a+"").indexOf("px")||C&&!~(o+"").indexOf("px"))&&(D=Qr(m,"x",a,"px"),C=Qr(m,"y",o,"px")),(x||_||b||y)&&(D=pi(D+x-(x*P+_*F)+b),C=pi(C+_-(x*I+_*A)+y)),(n||s)&&(k=m.getBBox(),D=pi(D+n/100*k.width),C=pi(C+s/100*k.height)),k="matrix("+P+","+I+","+F+","+A+","+D+","+C+")",m.setAttribute("transform",k),M&&(m.style[ri]=k)},c2=function(e,t,i,n,s){var a=360,o=ki(s),u=parseFloat(s)*(o&&~s.indexOf("rad")?Co:1),h=u-n,f=n+h+"deg",c,d;return o&&(c=s.split("_")[1],c==="short"&&(h%=a,h!==h%(a/2)&&(h+=h<0?a:-a)),c==="cw"&&h<0?h=(h+a*b0)%a-~~(h/a)*a:c==="ccw"&&h>0&&(h=(h-a*b0)%a-~~(h/a)*a)),e._pt=d=new Sn(e._pt,t,i,n,h,qL),d.e=f,d.u="deg",e._props.push(i),d},T0=function(e,t){for(var i in t)e[i]=t[i];return e},u2=function(e,t,i){var n=T0({},i._gsap),s="perspective,force3D,transformOrigin,svgOrigin",a=i.style,o,u,h,f,c,d,m,x;n.svg?(h=i.getAttribute("transform"),i.setAttribute("transform",""),a[ri]=t,o=nu(i,1),ia(i,ri),i.setAttribute("transform",h)):(h=getComputedStyle(i)[ri],a[ri]=t,o=nu(i,1),a[ri]=h);for(u in gr)h=n[u],f=o[u],h!==f&&s.indexOf(u)<0&&(m=Hi(h),x=Hi(f),c=m!==x?Qr(i,u,h,x):parseFloat(h),d=parseFloat(f),e._pt=new Sn(e._pt,o,u,c,d-c,sm),e._pt.u=x||0,e._props.push(u));T0(o,n)};yn("padding,margin,Width,Radius",function(r,e){var t="Top",i="Right",n="Bottom",s="Left",a=(e<3?[t,i,n,s]:[t+s,t+i,n+i,n+s]).map(function(o){return e<2?r+o:"border"+o+r});rd[e>1?"border"+r:r]=function(o,u,h,f,c){var d,m;if(arguments.length<4)return d=a.map(function(x){return nr(o,x,h)}),m=d.join(" "),m.split(d[0]).length===5?d[0]:m;d=(f+"").split(" "),m={},a.forEach(function(x,_){return m[x]=d[_]=d[_]||d[(_-1)/2|0]}),o.init(u,m,c)}});var tg={name:"css",register:om,targetTest:function(e){return e.style&&e.nodeType},init:function(e,t,i,n,s){var a=this._props,o=e.style,u=i.vars.startAt,h,f,c,d,m,x,_,b,y,M,D,C,P,I,F,A;Zm||om(),this.styles=this.styles||iw(e),A=this.styles.props,this.tween=i;for(_ in t)if(_!=="autoRound"&&(f=t[_],!(In[_]&&jx(_,t,i,n,e,s)))){if(m=typeof f,x=rd[_],m==="function"&&(f=f.call(i,n,e,s),m=typeof f),m==="string"&&~f.indexOf("random(")&&(f=Qc(f)),x)x(this,e,_,f,i)&&(F=1);else if(_.substr(0,2)==="--")h=(getComputedStyle(e).getPropertyValue(_)+"").trim(),f+="",Yr.lastIndex=0,Yr.test(h)||(b=Hi(h),y=Hi(f)),y?b!==y&&(h=Qr(e,_,h,y)+y):b&&(f+=b),this.add(o,"setProperty",h,f,n,s,0,0,_),a.push(_),A.push(_,0,o[_]);else if(m!=="undefined"){if(u&&_ in u?(h=typeof u[_]=="function"?u[_].call(i,n,e,s):u[_],ki(h)&&~h.indexOf("random(")&&(h=Qc(h)),Hi(h+"")||h==="auto"||(h+=zn.units[_]||Hi(nr(e,_))||""),(h+"").charAt(1)==="="&&(h=nr(e,_))):h=nr(e,_),d=parseFloat(h),M=m==="string"&&f.charAt(1)==="="&&f.substr(0,2),M&&(f=f.substr(2)),c=parseFloat(f),_ in Rs&&(_==="autoAlpha"&&(d===1&&nr(e,"visibility")==="hidden"&&c&&(d=0),A.push("visibility",0,o.visibility),qr(this,o,"visibility",d?"inherit":"hidden",c?"inherit":"hidden",!c)),_!=="scale"&&_!=="transform"&&(_=Rs[_],~_.indexOf(",")&&(_=_.split(",")[0]))),D=_ in gr,D){if(this.styles.save(_),C||(P=e._gsap,P.renderTransform&&!t.parseTransform||nu(e,t.parseTransform),I=t.smoothOrigin!==!1&&P.smooth,C=this._pt=new Sn(this._pt,o,ri,0,1,P.renderTransform,P,0,-1),C.dep=1),_==="scale")this._pt=new Sn(this._pt,P,"scaleY",P.scaleY,(M?nl(P.scaleY,M+c):c)-P.scaleY||0,sm),this._pt.u=0,a.push("scaleY",_),_+="X";else if(_==="transformOrigin"){A.push(Mn,0,o[Mn]),f=r2(f),P.svg?am(e,f,0,I,0,this):(y=parseFloat(f.split(" ")[2])||0,y!==P.zOrigin&&qr(this,P,"zOrigin",P.zOrigin,y),qr(this,o,_,od(h),od(f)));continue}else if(_==="svgOrigin"){am(e,f,1,I,0,this);continue}else if(_ in ow){c2(this,P,_,d,M?nl(d,M+f):f);continue}else if(_==="smoothOrigin"){qr(this,P,"smooth",P.smooth,f);continue}else if(_==="force3D"){P[_]=f;continue}else if(_==="transform"){u2(this,f,e);continue}}else _ in o||(_=vl(_)||_);if(D||(c||c===0)&&(d||d===0)&&!jL.test(f)&&_ in o)b=(h+"").substr((d+"").length),c||(c=0),y=Hi(f)||(_ in zn.units?zn.units[_]:b),b!==y&&(d=Qr(e,_,h,y)),this._pt=new Sn(this._pt,D?P:o,_,d,(M?nl(d,M+c):c)-d,!D&&(y==="px"||_==="zIndex")&&t.autoRound!==!1?$L:sm),this._pt.u=y||0,b!==y&&y!=="%"&&(this._pt.b=h,this._pt.r=XL);else if(_ in o)s2.call(this,e,_,h,M?M+f:f);else if(_ in e)this.add(e,_,h||e[_],M?M+f:f,n,s);else if(_!=="parseTransform"){Gm(_,f);continue}D||(_ in o?A.push(_,0,o[_]):A.push(_,1,h||e[_])),a.push(_)}}F&&Zx(this)},render:function(e,t){if(t.tween._time||!Jm())for(var i=t._pt;i;)i.r(e,i.d),i=i._next;else t.styles.revert()},get:nr,aliases:Rs,getSetter:function(e,t,i){var n=Rs[t];return n&&n.indexOf(",")<0&&(t=n),t in gr&&t!==Mn&&(e._gsap.x||nr(e,"x"))?i&&v0===i?t==="scale"?JL:ZL:(v0=i||{})&&(t==="scale"?QL:e2):e.style&&!Vm(e.style[t])?YL:~t.indexOf("-")?KL:Ym(e,t)},core:{_removeProperty:ia,_getMatrix:eg}};Xi.utils.checkPrefix=vl;Xi.core.getStyleSaver=iw;(function(r,e,t,i){var n=yn(r+","+e+","+t,function(s){gr[s]=1});yn(e,function(s){zn.units[s]="deg",ow[s]=1}),Rs[n[13]]=r+","+e,yn(i,function(s){var a=s.split(":");Rs[a[1]]=n[a[0]]})})("x,y,z,scale,scaleX,scaleY,xPercent,yPercent","rotation,rotationX,rotationY,skewX,skewY","transform,transformOrigin,svgOrigin,force3D,smoothOrigin,transformPerspective","0:translateX,1:translateY,2:translateZ,8:rotate,8:rotationZ,8:rotateZ,9:rotateX,10:rotateY");yn("x,y,z,top,right,bottom,left,width,height,fontSize,padding,margin,perspective",function(r){zn.units[r]="px"});Xi.registerPlugin(tg);var Y=Xi.registerPlugin(tg)||Xi;Y.core.Tween;const h2={name:"fadeUp",extendTimeline:!0,effect:(r,e)=>Y.timeline(e).from(r[0],{y:30,opacity:0},0),defaults:{}};/*!
 * strings: 3.11.3
 * https://greensock.com
 *
 * Copyright 2008-2022, GreenSock. All rights reserved.
 * Subject to the terms at https://greensock.com/standard-license or for
 * Club GreenSock members, the agreement issued with that membership.
 * @author: Jack Doyle, jack@greensock.com
*/const d2=/([\uD800-\uDBFF][\uDC00-\uDFFF](?:[\u200D\uFE0F][\uD800-\uDBFF][\uDC00-\uDFFF]){2,}|\uD83D\uDC69(?:\u200D(?:(?:\uD83D\uDC69\u200D)?\uD83D\uDC67|(?:\uD83D\uDC69\u200D)?\uD83D\uDC66)|\uD83C[\uDFFB-\uDFFF])|\uD83D\uDC69\u200D(?:\uD83D\uDC69\u200D)?\uD83D\uDC66\u200D\uD83D\uDC66|\uD83D\uDC69\u200D(?:\uD83D\uDC69\u200D)?\uD83D\uDC67\u200D(?:\uD83D[\uDC66\uDC67])|\uD83C\uDFF3\uFE0F\u200D\uD83C\uDF08|(?:\uD83C[\uDFC3\uDFC4\uDFCA]|\uD83D[\uDC6E\uDC71\uDC73\uDC77\uDC81\uDC82\uDC86\uDC87\uDE45-\uDE47\uDE4B\uDE4D\uDE4E\uDEA3\uDEB4-\uDEB6]|\uD83E[\uDD26\uDD37-\uDD39\uDD3D\uDD3E\uDDD6-\uDDDD])(?:\uD83C[\uDFFB-\uDFFF])\u200D[\u2640\u2642]\uFE0F|\uD83D\uDC69(?:\uD83C[\uDFFB-\uDFFF])\u200D(?:\uD83C[\uDF3E\uDF73\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92])|(?:\uD83C[\uDFC3\uDFC4\uDFCA]|\uD83D[\uDC6E\uDC6F\uDC71\uDC73\uDC77\uDC81\uDC82\uDC86\uDC87\uDE45-\uDE47\uDE4B\uDE4D\uDE4E\uDEA3\uDEB4-\uDEB6]|\uD83E[\uDD26\uDD37-\uDD39\uDD3C-\uDD3E\uDDD6-\uDDDF])\u200D[\u2640\u2642]\uFE0F|\uD83C\uDDFD\uD83C\uDDF0|\uD83C\uDDF6\uD83C\uDDE6|\uD83C\uDDF4\uD83C\uDDF2|\uD83C\uDDE9(?:\uD83C[\uDDEA\uDDEC\uDDEF\uDDF0\uDDF2\uDDF4\uDDFF])|\uD83C\uDDF7(?:\uD83C[\uDDEA\uDDF4\uDDF8\uDDFA\uDDFC])|\uD83C\uDDE8(?:\uD83C[\uDDE6\uDDE8\uDDE9\uDDEB-\uDDEE\uDDF0-\uDDF5\uDDF7\uDDFA-\uDDFF])|(?:\u26F9|\uD83C[\uDFCB\uDFCC]|\uD83D\uDD75)(?:\uFE0F\u200D[\u2640\u2642]|(?:\uD83C[\uDFFB-\uDFFF])\u200D[\u2640\u2642])\uFE0F|(?:\uD83D\uDC41\uFE0F\u200D\uD83D\uDDE8|\uD83D\uDC69(?:\uD83C[\uDFFB-\uDFFF])\u200D[\u2695\u2696\u2708]|\uD83D\uDC69\u200D[\u2695\u2696\u2708]|\uD83D\uDC68(?:(?:\uD83C[\uDFFB-\uDFFF])\u200D[\u2695\u2696\u2708]|\u200D[\u2695\u2696\u2708]))\uFE0F|\uD83C\uDDF2(?:\uD83C[\uDDE6\uDDE8-\uDDED\uDDF0-\uDDFF])|\uD83D\uDC69\u200D(?:\uD83C[\uDF3E\uDF73\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]|\u2764\uFE0F\u200D(?:\uD83D\uDC8B\u200D(?:\uD83D[\uDC68\uDC69])|\uD83D[\uDC68\uDC69]))|\uD83C\uDDF1(?:\uD83C[\uDDE6-\uDDE8\uDDEE\uDDF0\uDDF7-\uDDFB\uDDFE])|\uD83C\uDDEF(?:\uD83C[\uDDEA\uDDF2\uDDF4\uDDF5])|\uD83C\uDDED(?:\uD83C[\uDDF0\uDDF2\uDDF3\uDDF7\uDDF9\uDDFA])|\uD83C\uDDEB(?:\uD83C[\uDDEE-\uDDF0\uDDF2\uDDF4\uDDF7])|[#\*0-9]\uFE0F\u20E3|\uD83C\uDDE7(?:\uD83C[\uDDE6\uDDE7\uDDE9-\uDDEF\uDDF1-\uDDF4\uDDF6-\uDDF9\uDDFB\uDDFC\uDDFE\uDDFF])|\uD83C\uDDE6(?:\uD83C[\uDDE8-\uDDEC\uDDEE\uDDF1\uDDF2\uDDF4\uDDF6-\uDDFA\uDDFC\uDDFD\uDDFF])|\uD83C\uDDFF(?:\uD83C[\uDDE6\uDDF2\uDDFC])|\uD83C\uDDF5(?:\uD83C[\uDDE6\uDDEA-\uDDED\uDDF0-\uDDF3\uDDF7-\uDDF9\uDDFC\uDDFE])|\uD83C\uDDFB(?:\uD83C[\uDDE6\uDDE8\uDDEA\uDDEC\uDDEE\uDDF3\uDDFA])|\uD83C\uDDF3(?:\uD83C[\uDDE6\uDDE8\uDDEA-\uDDEC\uDDEE\uDDF1\uDDF4\uDDF5\uDDF7\uDDFA\uDDFF])|\uD83C\uDFF4\uDB40\uDC67\uDB40\uDC62(?:\uDB40\uDC77\uDB40\uDC6C\uDB40\uDC73|\uDB40\uDC73\uDB40\uDC63\uDB40\uDC74|\uDB40\uDC65\uDB40\uDC6E\uDB40\uDC67)\uDB40\uDC7F|\uD83D\uDC68(?:\u200D(?:\u2764\uFE0F\u200D(?:\uD83D\uDC8B\u200D)?\uD83D\uDC68|(?:(?:\uD83D[\uDC68\uDC69])\u200D)?\uD83D\uDC66\u200D\uD83D\uDC66|(?:(?:\uD83D[\uDC68\uDC69])\u200D)?\uD83D\uDC67\u200D(?:\uD83D[\uDC66\uDC67])|\uD83C[\uDF3E\uDF73\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92])|(?:\uD83C[\uDFFB-\uDFFF])\u200D(?:\uD83C[\uDF3E\uDF73\uDF93\uDFA4\uDFA8\uDFEB\uDFED]|\uD83D[\uDCBB\uDCBC\uDD27\uDD2C\uDE80\uDE92]))|\uD83C\uDDF8(?:\uD83C[\uDDE6-\uDDEA\uDDEC-\uDDF4\uDDF7-\uDDF9\uDDFB\uDDFD-\uDDFF])|\uD83C\uDDF0(?:\uD83C[\uDDEA\uDDEC-\uDDEE\uDDF2\uDDF3\uDDF5\uDDF7\uDDFC\uDDFE\uDDFF])|\uD83C\uDDFE(?:\uD83C[\uDDEA\uDDF9])|\uD83C\uDDEE(?:\uD83C[\uDDE8-\uDDEA\uDDF1-\uDDF4\uDDF6-\uDDF9])|\uD83C\uDDF9(?:\uD83C[\uDDE6\uDDE8\uDDE9\uDDEB-\uDDED\uDDEF-\uDDF4\uDDF7\uDDF9\uDDFB\uDDFC\uDDFF])|\uD83C\uDDEC(?:\uD83C[\uDDE6\uDDE7\uDDE9-\uDDEE\uDDF1-\uDDF3\uDDF5-\uDDFA\uDDFC\uDDFE])|\uD83C\uDDFA(?:\uD83C[\uDDE6\uDDEC\uDDF2\uDDF3\uDDF8\uDDFE\uDDFF])|\uD83C\uDDEA(?:\uD83C[\uDDE6\uDDE8\uDDEA\uDDEC\uDDED\uDDF7-\uDDFA])|\uD83C\uDDFC(?:\uD83C[\uDDEB\uDDF8])|(?:\u26F9|\uD83C[\uDFCB\uDFCC]|\uD83D\uDD75)(?:\uD83C[\uDFFB-\uDFFF])|(?:\uD83C[\uDFC3\uDFC4\uDFCA]|\uD83D[\uDC6E\uDC71\uDC73\uDC77\uDC81\uDC82\uDC86\uDC87\uDE45-\uDE47\uDE4B\uDE4D\uDE4E\uDEA3\uDEB4-\uDEB6]|\uD83E[\uDD26\uDD37-\uDD39\uDD3D\uDD3E\uDDD6-\uDDDD])(?:\uD83C[\uDFFB-\uDFFF])|(?:[\u261D\u270A-\u270D]|\uD83C[\uDF85\uDFC2\uDFC7]|\uD83D[\uDC42\uDC43\uDC46-\uDC50\uDC66\uDC67\uDC70\uDC72\uDC74-\uDC76\uDC78\uDC7C\uDC83\uDC85\uDCAA\uDD74\uDD7A\uDD90\uDD95\uDD96\uDE4C\uDE4F\uDEC0\uDECC]|\uD83E[\uDD18-\uDD1C\uDD1E\uDD1F\uDD30-\uDD36\uDDD1-\uDDD5])(?:\uD83C[\uDFFB-\uDFFF])|\uD83D\uDC68(?:\u200D(?:(?:(?:\uD83D[\uDC68\uDC69])\u200D)?\uD83D\uDC67|(?:(?:\uD83D[\uDC68\uDC69])\u200D)?\uD83D\uDC66)|\uD83C[\uDFFB-\uDFFF])|(?:[\u261D\u26F9\u270A-\u270D]|\uD83C[\uDF85\uDFC2-\uDFC4\uDFC7\uDFCA-\uDFCC]|\uD83D[\uDC42\uDC43\uDC46-\uDC50\uDC66-\uDC69\uDC6E\uDC70-\uDC78\uDC7C\uDC81-\uDC83\uDC85-\uDC87\uDCAA\uDD74\uDD75\uDD7A\uDD90\uDD95\uDD96\uDE45-\uDE47\uDE4B-\uDE4F\uDEA3\uDEB4-\uDEB6\uDEC0\uDECC]|\uD83E[\uDD18-\uDD1C\uDD1E\uDD1F\uDD26\uDD30-\uDD39\uDD3D\uDD3E\uDDD1-\uDDDD])(?:\uD83C[\uDFFB-\uDFFF])?|(?:[\u231A\u231B\u23E9-\u23EC\u23F0\u23F3\u25FD\u25FE\u2614\u2615\u2648-\u2653\u267F\u2693\u26A1\u26AA\u26AB\u26BD\u26BE\u26C4\u26C5\u26CE\u26D4\u26EA\u26F2\u26F3\u26F5\u26FA\u26FD\u2705\u270A\u270B\u2728\u274C\u274E\u2753-\u2755\u2757\u2795-\u2797\u27B0\u27BF\u2B1B\u2B1C\u2B50\u2B55]|\uD83C[\uDC04\uDCCF\uDD8E\uDD91-\uDD9A\uDDE6-\uDDFF\uDE01\uDE1A\uDE2F\uDE32-\uDE36\uDE38-\uDE3A\uDE50\uDE51\uDF00-\uDF20\uDF2D-\uDF35\uDF37-\uDF7C\uDF7E-\uDF93\uDFA0-\uDFCA\uDFCF-\uDFD3\uDFE0-\uDFF0\uDFF4\uDFF8-\uDFFF]|\uD83D[\uDC00-\uDC3E\uDC40\uDC42-\uDCFC\uDCFF-\uDD3D\uDD4B-\uDD4E\uDD50-\uDD67\uDD7A\uDD95\uDD96\uDDA4\uDDFB-\uDE4F\uDE80-\uDEC5\uDECC\uDED0-\uDED2\uDEEB\uDEEC\uDEF4-\uDEF8]|\uD83E[\uDD10-\uDD3A\uDD3C-\uDD3E\uDD40-\uDD45\uDD47-\uDD4C\uDD50-\uDD6B\uDD80-\uDD97\uDDC0\uDDD0-\uDDE6])|(?:[#\*0-9\xA9\xAE\u203C\u2049\u2122\u2139\u2194-\u2199\u21A9\u21AA\u231A\u231B\u2328\u23CF\u23E9-\u23F3\u23F8-\u23FA\u24C2\u25AA\u25AB\u25B6\u25C0\u25FB-\u25FE\u2600-\u2604\u260E\u2611\u2614\u2615\u2618\u261D\u2620\u2622\u2623\u2626\u262A\u262E\u262F\u2638-\u263A\u2640\u2642\u2648-\u2653\u2660\u2663\u2665\u2666\u2668\u267B\u267F\u2692-\u2697\u2699\u269B\u269C\u26A0\u26A1\u26AA\u26AB\u26B0\u26B1\u26BD\u26BE\u26C4\u26C5\u26C8\u26CE\u26CF\u26D1\u26D3\u26D4\u26E9\u26EA\u26F0-\u26F5\u26F7-\u26FA\u26FD\u2702\u2705\u2708-\u270D\u270F\u2712\u2714\u2716\u271D\u2721\u2728\u2733\u2734\u2744\u2747\u274C\u274E\u2753-\u2755\u2757\u2763\u2764\u2795-\u2797\u27A1\u27B0\u27BF\u2934\u2935\u2B05-\u2B07\u2B1B\u2B1C\u2B50\u2B55\u3030\u303D\u3297\u3299]|\uD83C[\uDC04\uDCCF\uDD70\uDD71\uDD7E\uDD7F\uDD8E\uDD91-\uDD9A\uDDE6-\uDDFF\uDE01\uDE02\uDE1A\uDE2F\uDE32-\uDE3A\uDE50\uDE51\uDF00-\uDF21\uDF24-\uDF93\uDF96\uDF97\uDF99-\uDF9B\uDF9E-\uDFF0\uDFF3-\uDFF5\uDFF7-\uDFFF]|\uD83D[\uDC00-\uDCFD\uDCFF-\uDD3D\uDD49-\uDD4E\uDD50-\uDD67\uDD6F\uDD70\uDD73-\uDD7A\uDD87\uDD8A-\uDD8D\uDD90\uDD95\uDD96\uDDA4\uDDA5\uDDA8\uDDB1\uDDB2\uDDBC\uDDC2-\uDDC4\uDDD1-\uDDD3\uDDDC-\uDDDE\uDDE1\uDDE3\uDDE8\uDDEF\uDDF3\uDDFA-\uDE4F\uDE80-\uDEC5\uDECB-\uDED2\uDEE0-\uDEE5\uDEE9\uDEEB\uDEEC\uDEF0\uDEF3-\uDEF8]|\uD83E[\uDD10-\uDD3A\uDD3C-\uDD3E\uDD40-\uDD45\uDD47-\uDD4C\uDD50-\uDD6B\uDD80-\uDD97\uDDC0\uDDD0-\uDDE6])\uFE0F)/;function cw(r){let e=r.nodeType,t="";if(e===1||e===9||e===11){if(typeof r.textContent=="string")return r.textContent;for(r=r.firstChild;r;r=r.nextSibling)t+=cw(r)}else if(e===3||e===4)return r.nodeValue;return t}/*!
 * SplitText: 3.11.3
 * https://greensock.com
 *
 * @license Copyright 2008-2022, GreenSock. All rights reserved.
 * Subject to the terms at https://greensock.com/standard-license or for
 * Club GreenSock members, the agreement issued with that membership.
 * @author: Jack Doyle, jack@greensock.com
*/let Io,uw,hw,p2=/(?:\r|\n|\t\t)/g,f2=/(?:\s\s+)/g,m2=()=>{Io=document,uw=window,hw=1},dw=r=>uw.getComputedStyle(r),g2=Array.isArray,E0=[].slice,ig=(r,e)=>{let t;return g2(r)?r:(t=typeof r)=="string"&&!e&&r?E0.call(Io.querySelectorAll(r),0):r&&t==="object"&&"length"in r?E0.call(r,0):r?[r]:[]},ng=r=>r.position==="absolute"||r.absolute===!0,_2=(r,e)=>{let t=e.length,i;for(;--t>-1;)if(i=e[t],r.substr(0,i.length)===i)return i.length},v2=" style='position:relative;display:inline-block;'",C0=(r="",e)=>{let t=~r.indexOf("++"),i=1;return t&&(r=r.split("++").join("")),()=>"<"+e+v2+(r?" class='"+r+(t?i++:"")+"'>":">")},sg=(r,e,t)=>{let i=r.nodeType;if(i===1||i===9||i===11)for(r=r.firstChild;r;r=r.nextSibling)sg(r,e,t);else(i===3||i===4)&&(r.nodeValue=r.nodeValue.split(e).join(t))},df=(r,e)=>{let t=e.length;for(;--t>-1;)r.push(e[t])},D0=(r,e,t)=>{let i;for(;r&&r!==e;){if(i=r._next||r.nextSibling,i)return i.textContent.charAt(0)===t;r=r.parentNode||r._parent}},pw=r=>{let e=ig(r.childNodes),t=e.length,i,n;for(i=0;i<t;i++)n=e[i],n._isSplit?pw(n):i&&n.previousSibling&&n.previousSibling.nodeType===3?(n.previousSibling.nodeValue+=n.nodeType===3?n.nodeValue:n.firstChild.nodeValue,r.removeChild(n)):n.nodeType!==3&&(r.insertBefore(n.firstChild,n),r.removeChild(n))},Ms=(r,e)=>parseFloat(e[r])||0,b2=(r,e,t,i,n,s,a)=>{let o=dw(r),u=Ms("paddingLeft",o),h=-999,f=Ms("borderBottomWidth",o)+Ms("borderTopWidth",o),c=Ms("borderLeftWidth",o)+Ms("borderRightWidth",o),d=Ms("paddingTop",o)+Ms("paddingBottom",o),m=Ms("paddingLeft",o)+Ms("paddingRight",o),x=Ms("fontSize",o)*(e.lineThreshold||.2),_=o.textAlign,b=[],y=[],M=[],D=e.wordDelimiter||" ",C=e.tag?e.tag:e.span?"span":"div",P=e.type||e.split||"chars,words,lines",I=n&&~P.indexOf("lines")?[]:null,F=~P.indexOf("words"),A=~P.indexOf("chars"),k=ng(e),O=e.linesClass,J=~(O||"").indexOf("++"),Q=[],X=o.display==="flex",j=r.style.display,K,ie,ee,V,_e,U,oe,ce,me,le,be,ue;for(J&&(O=O.split("++").join("")),X&&(r.style.display="block"),ie=r.getElementsByTagName("*"),ee=ie.length,_e=[],K=0;K<ee;K++)_e[K]=ie[K];if(I||k)for(K=0;K<ee;K++)V=_e[K],U=V.parentNode===r,(U||k||A&&!F)&&(ue=V.offsetTop,I&&U&&Math.abs(ue-h)>x&&(V.nodeName!=="BR"||K===0)&&(oe=[],I.push(oe),h=ue),k&&(V._x=V.offsetLeft,V._y=ue,V._w=V.offsetWidth,V._h=V.offsetHeight),I&&((V._isSplit&&U||!A&&U||F&&U||!F&&V.parentNode.parentNode===r&&!V.parentNode._isSplit)&&(oe.push(V),V._x-=u,D0(V,r,D)&&(V._wordEnd=!0)),V.nodeName==="BR"&&(V.nextSibling&&V.nextSibling.nodeName==="BR"||K===0)&&I.push([])));for(K=0;K<ee;K++){if(V=_e[K],U=V.parentNode===r,V.nodeName==="BR"){I||k?(V.parentNode&&V.parentNode.removeChild(V),_e.splice(K--,1),ee--):F||r.appendChild(V);continue}if(k&&(me=V.style,!F&&!U&&(V._x+=V.parentNode._x,V._y+=V.parentNode._y),me.left=V._x+"px",me.top=V._y+"px",me.position="absolute",me.display="block",me.width=V._w+1+"px",me.height=V._h+"px"),!F&&A)if(V._isSplit)for(V._next=ie=V.nextSibling,V.parentNode.appendChild(V);ie&&ie.nodeType===3&&ie.textContent===" ";)V._next=ie.nextSibling,V.parentNode.appendChild(ie),ie=ie.nextSibling;else V.parentNode._isSplit?(V._parent=V.parentNode,!V.previousSibling&&V.firstChild&&(V.firstChild._isFirst=!0),V.nextSibling&&V.nextSibling.textContent===" "&&!V.nextSibling.nextSibling&&Q.push(V.nextSibling),V._next=V.nextSibling&&V.nextSibling._isFirst?null:V.nextSibling,V.parentNode.removeChild(V),_e.splice(K--,1),ee--):U||(ue=!V.nextSibling&&D0(V.parentNode,r,D),V.parentNode._parent&&V.parentNode._parent.appendChild(V),ue&&V.parentNode.appendChild(Io.createTextNode(" ")),C==="span"&&(V.style.display="inline"),b.push(V));else V.parentNode._isSplit&&!V._isSplit&&V.innerHTML!==""?y.push(V):A&&!V._isSplit&&(C==="span"&&(V.style.display="inline"),b.push(V))}for(K=Q.length;--K>-1;)Q[K].parentNode.removeChild(Q[K]);if(I){for(k&&(le=Io.createElement(C),r.appendChild(le),be=le.offsetWidth+"px",ue=le.offsetParent===r?0:r.offsetLeft,r.removeChild(le)),me=r.style.cssText,r.style.cssText="display:none;";r.firstChild;)r.removeChild(r.firstChild);for(ce=D===" "&&(!k||!F&&!A),K=0;K<I.length;K++){for(oe=I[K],le=Io.createElement(C),le.style.cssText="display:block;text-align:"+_+";position:"+(k?"absolute;":"relative;"),O&&(le.className=O+(J?K+1:"")),M.push(le),ee=oe.length,ie=0;ie<ee;ie++)oe[ie].nodeName!=="BR"&&(V=oe[ie],le.appendChild(V),ce&&V._wordEnd&&le.appendChild(Io.createTextNode(" ")),k&&(ie===0&&(le.style.top=V._y+"px",le.style.left=u+ue+"px"),V.style.top="0px",ue&&(V.style.left=V._x-ue+"px")));ee===0?le.innerHTML="&nbsp;":!F&&!A&&(pw(le),sg(le,String.fromCharCode(160)," ")),k&&(le.style.width=be,le.style.height=V._h+"px"),r.appendChild(le)}r.style.cssText=me}k&&(a>r.clientHeight&&(r.style.height=a-d+"px",r.clientHeight<a&&(r.style.height=a+f+"px")),s>r.clientWidth&&(r.style.width=s-m+"px",r.clientWidth<s&&(r.style.width=s+c+"px"))),X&&(j?r.style.display=j:r.style.removeProperty("display")),df(t,b),F&&df(i,y),df(n,M)},x2=(r,e,t,i)=>{let n=e.tag?e.tag:e.span?"span":"div",s=e.type||e.split||"chars,words,lines",a=~s.indexOf("chars"),o=ng(e),u=e.wordDelimiter||" ",h=u!==" "?"":o?"&#173; ":" ",f="</"+n+">",c=1,d=e.specialChars?typeof e.specialChars=="function"?e.specialChars:_2:null,m,x,_,b,y,M,D,C,P=Io.createElement("div"),I=r.parentNode;for(I.insertBefore(P,r),P.textContent=r.nodeValue,I.removeChild(r),r=P,m=cw(r),D=m.indexOf("<")!==-1,e.reduceWhiteSpace!==!1&&(m=m.replace(f2," ").replace(p2,"")),D&&(m=m.split("<").join("{{LT}}")),y=m.length,x=(m.charAt(0)===" "?h:"")+t(),_=0;_<y;_++)if(M=m.charAt(_),d&&(C=d(m.substr(_),e.specialChars)))M=m.substr(_,C||1),x+=a&&M!==" "?i()+M+"</"+n+">":M,_+=C-1;else if(M===u&&m.charAt(_-1)!==u&&_){for(x+=c?f:"",c=0;m.charAt(_+1)===u;)x+=h,_++;_===y-1?x+=h:m.charAt(_+1)!==")"&&(x+=h+t(),c=1)}else M==="{"&&m.substr(_,6)==="{{LT}}"?(x+=a?i()+"{{LT}}</"+n+">":"{{LT}}",_+=5):M.charCodeAt(0)>=55296&&M.charCodeAt(0)<=56319||m.charCodeAt(_+1)>=65024&&m.charCodeAt(_+1)<=65039?(b=((m.substr(_,12).split(d2)||[])[1]||"").length||2,x+=a&&M!==" "?i()+m.substr(_,b)+"</"+n+">":m.substr(_,b),_+=b-1):x+=a&&M!==" "?i()+M+"</"+n+">":M;r.outerHTML=x+(c?f:""),D&&sg(I,"{{LT}}","<")},fw=(r,e,t,i)=>{let n=ig(r.childNodes),s=n.length,a=ng(e),o,u;if(r.nodeType!==3||s>1){for(e.absolute=!1,o=0;o<s;o++)u=n[o],u._next=u._isFirst=u._parent=u._wordEnd=null,(u.nodeType!==3||/\S+/.test(u.nodeValue))&&(a&&u.nodeType!==3&&dw(u).display==="inline"&&(u.style.display="inline-block",u.style.position="relative"),u._isSplit=!0,fw(u,e,t,i));e.absolute=a,r._isSplit=!0;return}x2(r,e,t,i)};class _r{constructor(e,t){hw||m2(),this.elements=ig(e),this.chars=[],this.words=[],this.lines=[],this._originals=[],this.vars=t||{},this.split(t)}split(e){this.isSplit&&this.revert(),this.vars=e=e||this.vars,this._originals.length=this.chars.length=this.words.length=this.lines.length=0;let t=this.elements.length,i=e.tag?e.tag:e.span?"span":"div",n=C0(e.wordsClass,i),s=C0(e.charsClass,i),a,o,u;for(;--t>-1;)u=this.elements[t],this._originals[t]=u.innerHTML,a=u.clientHeight,o=u.clientWidth,fw(u,e,n,s),b2(u,e,this.chars,this.words,this.lines,o,a);return this.chars.reverse(),this.words.reverse(),this.lines.reverse(),this.isSplit=!0,this}revert(){let e=this._originals;if(!e)throw"revert() call wasn't scoped properly.";return this.elements.forEach((t,i)=>t.innerHTML=e[i]),this.chars=[],this.words=[],this.lines=[],this.isSplit=!1,this}static create(e,t){return new _r(e,t)}}_r.version="3.11.3";const P0=[],w2={name:"titleIn",extendTimeline:!0,onResize:()=>{P0.forEach(r=>{r.revert()})},effect:(r,e)=>{const t=new _r(r,{type:"words",wordsClass:"split-word"}),i=t.words;return P0.push(t),Y.timeline(e).fromTo(i,{y:"10rem"},{y:0,stagger:.02,duration:1,ease:"power2.inOut"},0).fromTo(i,{opacity:0},{opacity:1,stagger:.02,duration:.8,ease:"power2.inOut"},.2)}},A0=[],y2={name:"paragraphIn",extendTimeline:!0,onResize:()=>{A0.forEach(r=>{r.revert()})},effect:(r,e)=>{const t=new _r(r,{type:"lines",linesClass:"split-word"}),i=t.lines;return A0.push(t),Y.timeline(e).fromTo(i,{y:"10rem"},{y:0,stagger:.02,duration:1,ease:"power2.inOut"},0).fromTo(i,{opacity:0},{opacity:1,stagger:.02,duration:.8,ease:"power2.inOut"},.2)}},S2={name:"transformUp",extendTimeline:!0,effect:(r,e)=>Y.timeline(e).fromTo(r[0],{y:"31.25rem",opacity:0},{y:0,opacity:1,ease:"expo.out",duration:1,overwrite:"true"},0),defaults:{}},fs={fadeUp:h2,titleIn:w2,transformUp:S2,paragraphIn:y2};function L0(r){return Function('"use strict";return ('+r+")")()}class M2{constructor(){q(this,"onResize",()=>{var e,t,i;for(let n=0;n<this.resizeTweens.length;n++){const s=(e=this.resizeTweens[n].tween)==null?void 0:e.progress();(t=this.resizeTweens[n].tween)!=null&&t.scrollTrigger&&this.resizeTweens[n].tween.scrollTrigger.kill(),(i=this.resizeTweens[n].tween)==null||i.kill(),this.resizeTweens[n].onResize(this.resizeTweens[n].tweenEl,this.resizeTweens[n].from,this.resizeTweens[n].tween),s===0&&(this.resizeTweens[n].tween=Y.effects[this.resizeTweens[n].preset](this.resizeTweens[n].tweenEl,{...this.resizeTweens[n].from}))}});this.fromAttr="animate-from",this.toAttr="animate-to",this.mqAttr="animate-mq",this.els=[],this.resizeTweens=[],this.mirrorGlProps={x:"position.x",y:"position.y",z:"position.z",rotationX:"rotation.x",rotationY:"rotation.y",rotationZ:"rotation.z"},De.on(Je.RESIZE,this.onResize),this.registerGsapPlugins(),this.registerGsapEffects()}build(e){const i=(e||document).querySelectorAll(`[${this.fromAttr}], [${this.toAttr}]`),n=i.length;for(let s=0;s<n;s++){if(i[s].attributes[this.mqAttr]&&i[s].attributes[this.mqAttr].value!==""&&!E.mq[i[s].attributes[this.mqAttr].value].matches||i[s].attributes[this.fromAttr]&&i[s].attributes[this.fromAttr].value===""&&i[s].attributes[this.toAttr]&&i[s].attributes[this.toAttr].value==="")continue;let a={uniforms:{}};const o={ease:"none",duration:1.5,scrollTrigger:{trigger:i[s],start:"top 80%",once:!0}},u=i[s].hasAttribute("dom2webgl");let h=null,f=i[s],c=!1,d=!1;if(u&&(h=i[s].getBoundingClientRect()),i[s].attributes[this.fromAttr]&&(c=L0(`{${i[s].attributes[this.fromAttr].value}}`),u)){const x=this.parseGlPropsFrom(c,a,h);c=x.from,a=x.glProps}i[s].attributes[this.toAttr]&&(d={...o,...L0(`{${i[s].attributes[this.toAttr].value}}`)},u&&(d=this.parseGlPropsTo(d,h))),(d.stagger||c.stagger)&&i[s].children.length&&(f=i[s].children),o.scrollTrigger=Object.assign(o.scrollTrigger,c.scrollTrigger),delete c.scrollTrigger,!f.length&&f.hasAttribute("dom2webgl")&&(f._glProps||(f._glProps=a),o.scrollTrigger.pin&&(this.updateGlPropsPinPos(o,f),o.scrollTrigger.onUpdate=()=>{this.updateGlPropsPinPos(o,f)}));let m;if(c&&c.preset){const x=c.preset;delete c.preset,fs[x].defaults.scrollTrigger&&(o.scrollTrigger=Object.assign(o.scrollTrigger,fs[x].defaults.scrollTrigger)),c.scrollTrigger=o.scrollTrigger;const _={...c};m=Y.effects[x](f,c),fs[x].onResize&&this.resizeTweens.push({tween:m,preset:x,tweenEl:f,from:_,onResize:fs[x].onResize.bind(fs[x])})}else c&&d?(d=Object.assign(o,d),m=Y.fromTo(f,c,d)):!d&&c?(c=Object.assign(o,c),m=Y.from(f,c)):(d=Object.assign(o,d),m=Y.to(f,d));m.scrollTrigger&&m.scrollTrigger.disable(),m.pause(),this.els.push({el:i[s],tween:m})}}enable(){for(let e=0;e<this.els.length;e++)this.els[e].tween.scrollTrigger&&(this.els[e].tween.scrollTrigger.enable(),this.els[e].tween.scrollTrigger&&this.els[e].tween.scrollTrigger.isActive&&!this.els[e].tween.scrollTrigger.vars.scrub&&this.els[e].tween.restart(!0))}registerGsapEffects(){for(const e in fs)fs[e].extendTimeline&&Y.registerEffect(fs[e]),fs[e].onResize&&this.resizeTweens.push({tween:null,preset:null,tweenEl:null,from:null,onResize:fs[e].onResize.bind(fs[e])})}registerGsapPlugins(){Y.registerPlugin({name:"glProps",init(e,t){for(const i in t){if(typeof t[i]=="object"){for(const n in t[i])this.add(e._glProps[i],n,e._glProps[i][n],t[i][n]),this._props.push(n);continue}this.add(e._glProps,i,e._glProps[i],t[i])}}})}destroy(){for(let e=0;e<this.els.length;e++)this.els[e].tween.scrollTrigger&&this.els[e].tween.scrollTrigger.kill(!1),this.els[e].tween&&this.els[e].tween.kill();this.els=[],this.resizeTweens=[]}}class T2{static init(){if(window.localStorage.getItem("isDarkMode")==="true"){this.set(!0);return}this.set(E.isDarkMode)}static set(e){window.localStorage.setItem("isDarkMode",e?"true":"false"),E.isDarkMode=e,e?E.html.classList.add("is-dark-mode"):E.html.classList.remove("is-dark-mode")}}function st(r,e=document){return e.querySelector(r)}function ad(r,e=document){return Array.prototype.slice.call(e.querySelectorAll(r))}function Po(r,e,t){const i=(n,s)=>{if(n==="style"){Object.assign(r.style,s);return}if(n==="classList"){mw(r,s);return}r.setAttribute(n,s===!0?n:s)};if(typeof e=="object")for(const n in e){if(e[n]===!1){r.removeAttribute(n);continue}i(n,e[n])}else{if(t===void 0)return r.getAttribute(e);if(t===!1){r.removeAttribute(e);return}i(e,t)}}function mw(r,e){if(Array.isArray(e)){r.classList.add(...e);return}if(typeof e=="string"){r.classList.add(...e.split(" "));return}e.add&&mw(r,e.add),e.remove&&E2(r,e.remove)}function E2(r,e){if(Array.isArray(e)){r.classList.remove(...e);return}typeof e=="string"&&r.classList.remove(...e.split(" "))}function C2(r,e){let t=null;return function(){clearTimeout(t);const i=arguments,n=this;t=setTimeout(function(){r.apply(n,i)},e)}}function D2(r,e){let t,i;return function(){const n=this,s=arguments;i?(clearTimeout(t),t=setTimeout(function(){Date.now()-i>=e&&(r.apply(n,s),i=Date.now())},e-(Date.now()-i))):(r.apply(n,s),i=Date.now())}}function rg(...r){const e=t=>t&&typeof t=="object";return r.reduce((t,i)=>(Object.keys(i).forEach(n=>{const s=t[n],a=i[n];Array.isArray(s)&&Array.isArray(a)?t[n]=s.concat(...a):e(s)&&e(a)?t[n]=rg(s,a):t[n]=a}),t),{})}function pf(r){return r.replace(/#define\sGLSLIFY\s./,"")}function P2(){Array.from(document.styleSheets).filter(r=>r.href===null||r.href.startsWith(window.location.origin)||r.href.startsWith("http://127.0.0.1")||r.href.startsWith("https://www.cosmos.so")||r.href.startsWith("https://cosmos.so")||r.href.startsWith("https://landing.cosmos.so")||r.href.startsWith("https://cosmos.unseen")||r.href.startsWith("http://192.168")).reduce((r,e)=>r=[...r,...Array.from(e.cssRules).reduce((t,i)=>t=i.selectorText===":root"?[...t,...Array.from(i.style).filter(n=>n.startsWith("--bp-"))]:t,[])],[]).forEach(r=>{E.mq[r.replace("--bp-","")]=window.matchMedia(getComputedStyle(document.documentElement).getPropertyValue(r))}),E.staticComponents=new Ov,E.components=new Ov,E.urlParams=new URLSearchParams(window.location.search),Object.assign(E,{...window.globalData})}const A2=new DOMParser;function L2(r){return typeof r=="string"?A2.parseFromString(r,"text/html"):r}function Fr(r){const e=new URL(r,window.location.origin),t=e.hash.length?r.replace(e.hash,""):null;return{hasHash:e.hash.length>0,pathname:e.pathname,host:e.host,raw:r,href:t||e.href}}function R0(r,e){r.parentNode.replaceChild(gw(r,e),r)}function k0(r,e){(r.parentNode.tagName==="HEAD"?document.head:document.body).appendChild(gw(r,e))}function gw(r,e){const t=document.createElement(e);for(let i=0;i<r.attributes.length;i++){const n=r.attributes[i];t.setAttribute(n.nodeName,n.nodeValue)}return r.innerHTML&&(t.innerHTML=r.innerHTML),t}class lm{constructor({wrapper:e}){this.wrapper=e}leave(e){return new Promise(t=>{this.onLeave({...e,done:t})})}enter(e){return new Promise(t=>{this.onEnter({...e,done:t})})}onLeave({from:e,trigger:t,done:i}){i()}onEnter({to:e,trigger:t,done:i}){i()}}class cm{constructor({content:e,page:t,title:i,wrapper:n}){this._contentString=e.outerHTML,this._DOM=null,this.page=t,this.title=i,this.wrapper=n,this.content=this.wrapper.lastElementChild}onEnter(){}onEnterCompleted(){}onLeave(){}onLeaveCompleted(){}initialLoad(){this.onEnter(),this.onEnterCompleted()}update(){document.title=this.title,this.wrapper.appendChild(this._DOM.firstElementChild),this.content=this.wrapper.lastElementChild,this._DOM=null}createDom(){this._DOM||(this._DOM=document.createElement("div"),this._DOM.innerHTML=this._contentString)}remove(){this.wrapper.firstElementChild.remove()}enter(e,t){return new Promise(i=>{this.onEnter(),e.enter({trigger:t,to:this.content}).then(()=>{this.onEnterCompleted(),i()})})}leave(e,t,i){return new Promise(n=>{this.onLeave(),e.leave({trigger:t,from:this.content}).then(()=>{i&&this.remove(),this.onLeaveCompleted(),n()})})}}class R2{constructor(){q(this,"data",new Map);q(this,"regexCache",new Map)}add(e,t,i){this.data.has(e)||(this.data.set(e,new Map),this.regexCache.set(e,new RegExp(`^${e}$`))),this.data.get(e).set(t,i),this.regexCache.set(t,new RegExp(`^${t}$`))}findMatch(e,t){for(const[i,n]of this.data)if(e.pathname.match(this.regexCache.get(i))){for(const[s,a]of n)if(t.pathname.match(this.regexCache.get(s)))return a;break}return null}}const I0="A transition is currently in progress";class k2{constructor(e={}){q(this,"isTransitioning",!1);q(this,"currentCacheEntry",null);q(this,"cache",new Map);q(this,"activePromises",new Map);q(this,"onClick",e=>{if(!(e.metaKey||e.ctrlKey)){const t=Fr(e.currentTarget.href);if(this.currentLocation=Fr(window.location.href),this.currentLocation.host!==t.host)return;if(this.currentLocation.href!==t.href||this.currentLocation.hasHash&&!t.hasHash){e.preventDefault(),this.navigateTo(t.raw,e.currentTarget.dataset.transition||!1,e.currentTarget).catch(i=>console.warn(i));return}!this.currentLocation.hasHash&&!t.hasHash&&e.preventDefault()}});q(this,"onPopstate",()=>{if(window.location.pathname===this.currentLocation.pathname&&!this.isPopping)return!1;if(!this.allowInterruption&&(this.isTransitioning||this.isPopping))return window.history.pushState({},"",this.popTarget),console.warn(I0),!1;this.isPopping||(this.popTarget=window.location.href),this.isPopping=!0,this.navigateTo(window.location.href,!1,"popstate")});q(this,"onPrefetch",e=>{const t=Fr(e.currentTarget.href);this.currentLocation.host===t.host&&this.preload(e.currentTarget.href,!1)});const{links:t="a:not([target]):not([href^=\\#]):not([data-taxi-ignore])",removeOldContent:i=!0,allowInterruption:n=!1,bypassCache:s=!1,enablePrefetch:a=!0,renderers:o={default:cm},transitions:u={default:lm},reloadJsFilter:h=c=>c.dataset.taxiReload!==void 0,reloadCssFilter:f=c=>!0}=e;this.renderers=o,this.transitions=u,this.defaultRenderer=this.renderers.default||cm,this.defaultTransition=this.transitions.default||lm,this.wrapper=document.querySelector("[data-taxi]"),this.reloadJsFilter=h,this.reloadCssFilter=f,this.removeOldContent=i,this.allowInterruption=n,this.bypassCache=s,this.enablePrefetch=a,this.cache=new Map,this.isPopping=!1,this.attachEvents(t),this.currentLocation=Fr(window.location.href),this.cache.set(this.currentLocation.href,this.createCacheEntry(document.cloneNode(!0),window.location.href)),this.currentCacheEntry=this.cache.get(this.currentLocation.href),this.currentCacheEntry.renderer.initialLoad()}setDefaultRenderer(e){this.defaultRenderer=this.renderers[e]}setDefaultTransition(e){this.defaultTransition=this.transitions[e]}addRoute(e,t,i){this.router||(this.router=new R2),this.router.add(e,t,i)}preload(e,t=!1){return e=Fr(e).href,this.cache.has(e)?Promise.resolve():this.fetch(e,!1).then(async i=>{this.cache.set(e,this.createCacheEntry(i.html,i.url)),t&&this.cache.get(e).renderer.createDom()}).catch(i=>console.warn(i))}updateCache(e){const t=Fr(e||window.location.href).href;this.cache.has(t)&&this.cache.delete(t),this.cache.set(t,this.createCacheEntry(document.cloneNode(!0),t))}clearCache(e){const t=Fr(e||window.location.href).href;this.cache.has(t)&&this.cache.delete(t)}navigateTo(e,t=!1,i=!1){return new Promise((n,s)=>{if(!this.allowInterruption&&this.isTransitioning){s(new Error(I0));return}this.isTransitioning=!0,this.isPopping=!0,this.targetLocation=Fr(e),this.popTarget=window.location.href;const a=new(this.chooseTransition(t))({wrapper:this.wrapper});let o;if(this.bypassCache||!this.cache.has(this.targetLocation.href)||this.cache.get(this.targetLocation.href).skipCache){const u=this.fetch(this.targetLocation.href).then(h=>{this.cache.set(this.targetLocation.href,this.createCacheEntry(h.html,h.url)),this.cache.get(this.targetLocation.href).renderer.createDom()}).catch(h=>{window.location.href=e});o=this.beforeFetch(this.targetLocation,a,i).then(async()=>u.then(async()=>await this.afterFetch(this.targetLocation,a,this.cache.get(this.targetLocation.href),i)))}else this.cache.get(this.targetLocation.href).renderer.createDom(),o=this.beforeFetch(this.targetLocation,a,i).then(async()=>await this.afterFetch(this.targetLocation,a,this.cache.get(this.targetLocation.href),i));o.then(()=>{n()})})}on(e,t){De.on(e,t)}off(e,t){De.off(e,t)}beforeFetch(e,t,i){return De.emit("NAVIGATE_OUT",{from:this.currentCacheEntry,trigger:i}),new Promise(n=>{this.currentCacheEntry.renderer.leave(t,i,this.removeOldContent).then(()=>{i!=="popstate"&&window.history.pushState({},"",e.raw),n()})})}afterFetch(e,t,i,n){return this.currentLocation=e,this.popTarget=this.currentLocation.href,new Promise(s=>{i.renderer.update(),De.emit("NAVIGATE_IN",{from:this.currentCacheEntry,to:i,trigger:n}),this.reloadJsFilter&&this.loadScripts(i.scripts),this.reloadCssFilter&&this.loadStyles(i.styles),n!=="popstate"&&e.href!==i.finalUrl&&window.history.replaceState({},"",i.finalUrl),i.renderer.enter(t,n).then(()=>{De.emit("NAVIGATE_END",{from:this.currentCacheEntry,to:i,trigger:n}),this.currentCacheEntry=i,this.isTransitioning=!1,this.isPopping=!1,s()})})}loadScripts(e){const t=[...e],i=Array.from(document.querySelectorAll("script")).filter(this.reloadJsFilter);for(let n=0;n<i.length;n++)for(let s=0;s<t.length;s++)if(i[n].outerHTML===t[s].outerHTML){R0(i[n],"SCRIPT"),t.splice(s,1);break}for(const n of t)k0(n,"SCRIPT")}loadStyles(e){const t=Array.from(document.querySelectorAll('link[rel="stylesheet"]')).filter(this.reloadCssFilter),i=Array.from(document.querySelectorAll("style")).filter(this.reloadCssFilter),n=e.filter(s=>{if(s.href){if(!t.find(a=>a.href===s.href))return document.body.append(s),!1}else return!0});for(let s=0;s<i.length;s++)for(let a=0;a<n.length;a++)if(i[s].outerHTML===n[a].outerHTML){R0(i[s],"STYLE"),n.splice(a,1);break}for(const s of n)k0(s,"STYLE")}attachEvents(e){De.delegate("click",e,this.onClick),De.on("popstate",window,this.onPopstate),this.enablePrefetch&&De.delegate("mouseenter focus",e,this.onPrefetch)}fetch(e,t=!0){if(this.activePromises.has(e))return this.activePromises.get(e);const i=new Promise((n,s)=>{let a;fetch(e,{mode:"same-origin",method:"GET",headers:{"X-Requested-With":"Taxi"},credentials:"same-origin"}).then(o=>(o.ok||(s("Taxi encountered a non 2xx HTTP status code"),t&&(window.location.href=e)),a=o.url,o.text())).then(o=>{n({html:L2(o),url:a})}).catch(o=>{s(o),t&&(window.location.href=e)}).finally(()=>{this.activePromises.delete(e)})});return this.activePromises.set(e,i),i}chooseTransition(e){var i;if(e)return this.transitions[e];const t=(i=this.router)==null?void 0:i.findMatch(this.currentLocation,this.targetLocation);return t?this.transitions[t]:this.defaultTransition}createCacheEntry(e,t){const i=e.querySelector("[data-taxi-view]"),n=i.dataset.taxiView.length?this.renderers[i.dataset.taxiView]:this.defaultRenderer;return n||console.warn(`The Renderer "${i.dataset.taxiView}" was set in the data-taxi-view of the requested page, but not registered in Taxi.`),{page:e,content:i,finalUrl:t,skipCache:i.hasAttribute("data-taxi-nocache"),scripts:this.reloadJsFilter?Array.from(e.querySelectorAll("script")).filter(this.reloadJsFilter):[],styles:this.reloadCssFilter?Array.from(e.querySelectorAll('link[rel="stylesheet"], style')).filter(this.reloadCssFilter):[],title:e.title,renderer:new n({wrapper:this.wrapper,title:e.title,content:i,page:e})}}}const I2="modulepreload",F2=function(r){return"/"+r},F0={},O2=function(e,t,i){if(!t||t.length===0)return e();const n=document.getElementsByTagName("link");return Promise.all(t.map(s=>{if(s=F2(s),s in F0)return;F0[s]=!0;const a=s.endsWith(".css"),o=a?'[rel="stylesheet"]':"";if(!!i)for(let f=n.length-1;f>=0;f--){const c=n[f];if(c.href===s&&(!a||c.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${s}"]${o}`))return;const h=document.createElement("link");if(h.rel=a?"stylesheet":I2,a||(h.as="script",h.crossOrigin=""),h.href=s,document.head.appendChild(h),a)return new Promise((f,c)=>{h.addEventListener("load",f),h.addEventListener("error",()=>c(new Error(`Unable to preload CSS for ${s}`)))})})).then(()=>e()).catch(s=>{const a=new Event("vite:preloadError",{cancelable:!0});if(a.payload=s,window.dispatchEvent(a),!a.defaultPrevented)throw s})};var Ao=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function N2(r){return r&&r.__esModule&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r}var um={exports:{}};/*! Tweakpane 3.1.10 (c) 2016 cocopon, licensed under the MIT license. */(function(r,e){(function(t,i){i(e)})(Ao,function(t){class i{constructor(l){const[p,w]=l.split("-"),R=p.split(".");this.major=parseInt(R[0],10),this.minor=parseInt(R[1],10),this.patch=parseInt(R[2],10),this.prerelease=w??null}toString(){const l=[this.major,this.minor,this.patch].join(".");return this.prerelease!==null?[l,this.prerelease].join("-"):l}}class n{constructor(l){this.controller_=l}get element(){return this.controller_.view.element}get disabled(){return this.controller_.viewProps.get("disabled")}set disabled(l){this.controller_.viewProps.set("disabled",l)}get hidden(){return this.controller_.viewProps.get("hidden")}set hidden(l){this.controller_.viewProps.set("hidden",l)}dispose(){this.controller_.viewProps.set("disposed",!0)}}class s{constructor(l){this.target=l}}class a extends s{constructor(l,p,w,R){super(l),this.value=p,this.presetKey=w,this.last=R??!0}}class o extends s{constructor(l,p,w){super(l),this.value=p,this.presetKey=w}}class u extends s{constructor(l,p){super(l),this.expanded=p}}class h extends s{constructor(l,p){super(l),this.index=p}}function f(g){return g}function c(g){return g==null}function d(g,l){if(g.length!==l.length)return!1;for(let p=0;p<g.length;p++)if(g[p]!==l[p])return!1;return!0}function m(g,l){let p=g;do{const w=Object.getOwnPropertyDescriptor(p,l);if(w&&(w.set!==void 0||w.writable===!0))return!0;p=Object.getPrototypeOf(p)}while(p!==null);return!1}const x={alreadydisposed:()=>"View has been already disposed",invalidparams:g=>`Invalid parameters for '${g.name}'`,nomatchingcontroller:g=>`No matching controller for '${g.key}'`,nomatchingview:g=>`No matching view for '${JSON.stringify(g.params)}'`,notbindable:()=>"Value is not bindable",propertynotfound:g=>`Property '${g.name}' not found`,shouldneverhappen:()=>"This error should never happen"};class _{static alreadyDisposed(){return new _({type:"alreadydisposed"})}static notBindable(){return new _({type:"notbindable"})}static propertyNotFound(l){return new _({type:"propertynotfound",context:{name:l}})}static shouldNeverHappen(){return new _({type:"shouldneverhappen"})}constructor(l){var p;this.message=(p=x[l.type](l.context))!==null&&p!==void 0?p:"Unexpected error",this.name=this.constructor.name,this.stack=new Error(this.message).stack,this.type=l.type}}class b{constructor(l,p,w){this.obj_=l,this.key_=p,this.presetKey_=w??p}static isBindable(l){return!(l===null||typeof l!="object"&&typeof l!="function")}get key(){return this.key_}get presetKey(){return this.presetKey_}read(){return this.obj_[this.key_]}write(l){this.obj_[this.key_]=l}writeProperty(l,p){const w=this.read();if(!b.isBindable(w))throw _.notBindable();if(!(l in w))throw _.propertyNotFound(l);w[l]=p}}class y extends n{get label(){return this.controller_.props.get("label")}set label(l){this.controller_.props.set("label",l)}get title(){var l;return(l=this.controller_.valueController.props.get("title"))!==null&&l!==void 0?l:""}set title(l){this.controller_.valueController.props.set("title",l)}on(l,p){const w=p.bind(this);return this.controller_.valueController.emitter.on(l,()=>{w(new s(this))}),this}}class M{constructor(){this.observers_={}}on(l,p){let w=this.observers_[l];return w||(w=this.observers_[l]=[]),w.push({handler:p}),this}off(l,p){const w=this.observers_[l];return w&&(this.observers_[l]=w.filter(R=>R.handler!==p)),this}emit(l,p){const w=this.observers_[l];w&&w.forEach(R=>{R.handler(p)})}}const D="tp";function C(g){return(p,w)=>[D,"-",g,"v",p?`_${p}`:"",w?`-${w}`:""].join("")}function P(g,l){return p=>l(g(p))}function I(g){return g.rawValue}function F(g,l){g.emitter.on("change",P(I,l)),l(g.rawValue)}function A(g,l,p){F(g.value(l),p)}function k(g,l,p){p?g.classList.add(l):g.classList.remove(l)}function O(g,l){return p=>{k(g,l,p)}}function J(g,l){F(g,p=>{l.textContent=p??""})}const Q=C("btn");class X{constructor(l,p){this.element=l.createElement("div"),this.element.classList.add(Q()),p.viewProps.bindClassModifiers(this.element);const w=l.createElement("button");w.classList.add(Q("b")),p.viewProps.bindDisabled(w),this.element.appendChild(w),this.buttonElement=w;const R=l.createElement("div");R.classList.add(Q("t")),J(p.props.value("title"),R),this.buttonElement.appendChild(R)}}class j{constructor(l,p){this.emitter=new M,this.onClick_=this.onClick_.bind(this),this.props=p.props,this.viewProps=p.viewProps,this.view=new X(l,{props:this.props,viewProps:this.viewProps}),this.view.buttonElement.addEventListener("click",this.onClick_)}onClick_(){this.emitter.emit("click",{sender:this})}}class K{constructor(l,p){var w;this.constraint_=p==null?void 0:p.constraint,this.equals_=(w=p==null?void 0:p.equals)!==null&&w!==void 0?w:(R,W)=>R===W,this.emitter=new M,this.rawValue_=l}get constraint(){return this.constraint_}get rawValue(){return this.rawValue_}set rawValue(l){this.setRawValue(l,{forceEmit:!1,last:!0})}setRawValue(l,p){const w=p??{forceEmit:!1,last:!0},R=this.constraint_?this.constraint_.constrain(l):l,W=this.rawValue_;this.equals_(W,R)&&!w.forceEmit||(this.emitter.emit("beforechange",{sender:this}),this.rawValue_=R,this.emitter.emit("change",{options:w,previousRawValue:W,rawValue:R,sender:this}))}}class ie{constructor(l){this.emitter=new M,this.value_=l}get rawValue(){return this.value_}set rawValue(l){this.setRawValue(l,{forceEmit:!1,last:!0})}setRawValue(l,p){const w=p??{forceEmit:!1,last:!0},R=this.value_;R===l&&!w.forceEmit||(this.emitter.emit("beforechange",{sender:this}),this.value_=l,this.emitter.emit("change",{options:w,previousRawValue:R,rawValue:this.value_,sender:this}))}}function ee(g,l){const p=l==null?void 0:l.constraint,w=l==null?void 0:l.equals;return!p&&!w?new ie(g):new K(g,l)}class V{constructor(l){this.emitter=new M,this.valMap_=l;for(const p in this.valMap_)this.valMap_[p].emitter.on("change",()=>{this.emitter.emit("change",{key:p,sender:this})})}static createCore(l){return Object.keys(l).reduce((w,R)=>Object.assign(w,{[R]:ee(l[R])}),{})}static fromObject(l){const p=this.createCore(l);return new V(p)}get(l){return this.valMap_[l].rawValue}set(l,p){this.valMap_[l].rawValue=p}value(l){return this.valMap_[l]}}function _e(g,l){const w=Object.keys(l).reduce((R,W)=>{if(R===void 0)return;const ae=l[W],Ee=ae(g[W]);return Ee.succeeded?Object.assign(Object.assign({},R),{[W]:Ee.value}):void 0},{});return w}function U(g,l){return g.reduce((p,w)=>{if(p===void 0)return;const R=l(w);if(!(!R.succeeded||R.value===void 0))return[...p,R.value]},[])}function oe(g){return g===null?!1:typeof g=="object"}function ce(g){return l=>p=>{if(!l&&p===void 0)return{succeeded:!1,value:void 0};if(l&&p===void 0)return{succeeded:!0,value:void 0};const w=g(p);return w!==void 0?{succeeded:!0,value:w}:{succeeded:!1,value:void 0}}}function me(g){return{custom:l=>ce(l)(g),boolean:ce(l=>typeof l=="boolean"?l:void 0)(g),number:ce(l=>typeof l=="number"?l:void 0)(g),string:ce(l=>typeof l=="string"?l:void 0)(g),function:ce(l=>typeof l=="function"?l:void 0)(g),constant:l=>ce(p=>p===l?l:void 0)(g),raw:ce(l=>l)(g),object:l=>ce(p=>{if(oe(p))return _e(p,l)})(g),array:l=>ce(p=>{if(Array.isArray(p))return U(p,l)})(g)}}const le={optional:me(!0),required:me(!1)};function be(g,l){const p=le.required.object(l)(g);return p.succeeded?p.value:void 0}function ue(g){console.warn([`Missing '${g.key}' of ${g.target} in ${g.place}.`,"Please rebuild plugins with the latest core package."].join(" "))}function We(g){return g&&g.parentElement&&g.parentElement.removeChild(g),null}class ye{constructor(l){this.value_=l}static create(l){return[new ye(l),(p,w)=>{l.setRawValue(p,w)}]}get emitter(){return this.value_.emitter}get rawValue(){return this.value_.rawValue}}const Ne=C("");function Ce(g,l){return O(g,Ne(void 0,l))}class Ze extends V{constructor(l){var p;super(l),this.onDisabledChange_=this.onDisabledChange_.bind(this),this.onParentChange_=this.onParentChange_.bind(this),this.onParentGlobalDisabledChange_=this.onParentGlobalDisabledChange_.bind(this),[this.globalDisabled_,this.setGlobalDisabled_]=ye.create(ee(this.getGlobalDisabled_())),this.value("disabled").emitter.on("change",this.onDisabledChange_),this.value("parent").emitter.on("change",this.onParentChange_),(p=this.get("parent"))===null||p===void 0||p.globalDisabled.emitter.on("change",this.onParentGlobalDisabledChange_)}static create(l){var p,w,R;const W=l??{};return new Ze(V.createCore({disabled:(p=W.disabled)!==null&&p!==void 0?p:!1,disposed:!1,hidden:(w=W.hidden)!==null&&w!==void 0?w:!1,parent:(R=W.parent)!==null&&R!==void 0?R:null}))}get globalDisabled(){return this.globalDisabled_}bindClassModifiers(l){F(this.globalDisabled_,Ce(l,"disabled")),A(this,"hidden",Ce(l,"hidden"))}bindDisabled(l){F(this.globalDisabled_,p=>{l.disabled=p})}bindTabIndex(l){F(this.globalDisabled_,p=>{l.tabIndex=p?-1:0})}handleDispose(l){this.value("disposed").emitter.on("change",p=>{p&&l()})}getGlobalDisabled_(){const l=this.get("parent");return(l?l.globalDisabled.rawValue:!1)||this.get("disabled")}updateGlobalDisabled_(){this.setGlobalDisabled_(this.getGlobalDisabled_())}onDisabledChange_(){this.updateGlobalDisabled_()}onParentGlobalDisabledChange_(){this.updateGlobalDisabled_()}onParentChange_(l){var p;const w=l.previousRawValue;w==null||w.globalDisabled.emitter.off("change",this.onParentGlobalDisabledChange_),(p=this.get("parent"))===null||p===void 0||p.globalDisabled.emitter.on("change",this.onParentGlobalDisabledChange_),this.updateGlobalDisabled_()}}function Qe(){return["veryfirst","first","last","verylast"]}const Pe=C(""),ct={veryfirst:"vfst",first:"fst",last:"lst",verylast:"vlst"};class xt{constructor(l){this.parent_=null,this.blade=l.blade,this.view=l.view,this.viewProps=l.viewProps;const p=this.view.element;this.blade.value("positions").emitter.on("change",()=>{Qe().forEach(w=>{p.classList.remove(Pe(void 0,ct[w]))}),this.blade.get("positions").forEach(w=>{p.classList.add(Pe(void 0,ct[w]))})}),this.viewProps.handleDispose(()=>{We(p)})}get parent(){return this.parent_}set parent(l){if(this.parent_=l,!("parent"in this.viewProps.valMap_)){ue({key:"parent",target:Ze.name,place:"BladeController.parent"});return}this.viewProps.set("parent",this.parent_?this.parent_.viewProps:null)}}const mt="http://www.w3.org/2000/svg";function he(g){g.offsetHeight}function Tt(g,l){const p=g.style.transition;g.style.transition="none",l(),g.style.transition=p}function _t(g){return g.ontouchstart!==void 0}function Ot(){return globalThis}function wt(){return Ot().document}function G(g){const l=g.ownerDocument.defaultView;return l&&"document"in l?g.getContext("2d",{willReadFrequently:!0}):null}const N={check:'<path d="M2 8l4 4l8 -8"/>',dropdown:'<path d="M5 7h6l-3 3 z"/>',p2dpad:'<path d="M8 4v8"/><path d="M4 8h8"/><circle cx="12" cy="12" r="1.2"/>'};function fe(g,l){const p=g.createElementNS(mt,"svg");return p.innerHTML=N[l],p}function xe(g,l,p){g.insertBefore(l,g.children[p])}function Me(g){g.parentElement&&g.parentElement.removeChild(g)}function Se(g){for(;g.children.length>0;)g.removeChild(g.children[0])}function je(g){for(;g.childNodes.length>0;)g.removeChild(g.childNodes[0])}function H(g){return g.relatedTarget?g.relatedTarget:"explicitOriginalTarget"in g?g.explicitOriginalTarget:null}const ne=C("lbl");function Fe(g,l){const p=g.createDocumentFragment();return l.split(`
`).map(R=>g.createTextNode(R)).forEach((R,W)=>{W>0&&p.appendChild(g.createElement("br")),p.appendChild(R)}),p}class Te{constructor(l,p){this.element=l.createElement("div"),this.element.classList.add(ne()),p.viewProps.bindClassModifiers(this.element);const w=l.createElement("div");w.classList.add(ne("l")),A(p.props,"label",W=>{c(W)?this.element.classList.add(ne(void 0,"nol")):(this.element.classList.remove(ne(void 0,"nol")),je(w),w.appendChild(Fe(l,W)))}),this.element.appendChild(w),this.labelElement=w;const R=l.createElement("div");R.classList.add(ne("v")),this.element.appendChild(R),this.valueElement=R}}class Re extends xt{constructor(l,p){const w=p.valueController.viewProps;super(Object.assign(Object.assign({},p),{view:new Te(l,{props:p.props,viewProps:w}),viewProps:w})),this.props=p.props,this.valueController=p.valueController,this.view.valueElement.appendChild(this.valueController.view.element)}}const He={id:"button",type:"blade",accept(g){const l=le,p=be(g,{title:l.required.string,view:l.required.constant("button"),label:l.optional.string});return p?{params:p}:null},controller(g){return new Re(g.document,{blade:g.blade,props:V.fromObject({label:g.params.label}),valueController:new j(g.document,{props:V.fromObject({title:g.params.title}),viewProps:g.viewProps})})},api(g){return!(g.controller instanceof Re)||!(g.controller.valueController instanceof j)?null:new y(g.controller)}};class ze extends xt{constructor(l){super(l),this.value=l.value}}function ut(){return new V({positions:ee([],{equals:d})})}class ht extends V{constructor(l){super(l)}static create(l){const p={completed:!0,expanded:l,expandedHeight:null,shouldFixHeight:!1,temporaryExpanded:null},w=V.createCore(p);return new ht(w)}get styleExpanded(){var l;return(l=this.get("temporaryExpanded"))!==null&&l!==void 0?l:this.get("expanded")}get styleHeight(){if(!this.styleExpanded)return"0";const l=this.get("expandedHeight");return this.get("shouldFixHeight")&&!c(l)?`${l}px`:"auto"}bindExpandedClass(l,p){const w=()=>{this.styleExpanded?l.classList.add(p):l.classList.remove(p)};A(this,"expanded",w),A(this,"temporaryExpanded",w)}cleanUpTransition(){this.set("shouldFixHeight",!1),this.set("expandedHeight",null),this.set("completed",!0)}}function Ct(g,l){let p=0;return Tt(l,()=>{g.set("expandedHeight",null),g.set("temporaryExpanded",!0),he(l),p=l.clientHeight,g.set("temporaryExpanded",null),he(l)}),p}function $(g,l){l.style.height=g.styleHeight}function ge(g,l){g.value("expanded").emitter.on("beforechange",()=>{if(g.set("completed",!1),c(g.get("expandedHeight"))){const p=Ct(g,l);p>0&&g.set("expandedHeight",p)}g.set("shouldFixHeight",!0),he(l)}),g.emitter.on("change",()=>{$(g,l)}),$(g,l),l.addEventListener("transitionend",p=>{p.propertyName==="height"&&g.cleanUpTransition()})}class we extends n{constructor(l,p){super(l),this.rackApi_=p}}function ke(g,l){return g.addBlade(Object.assign(Object.assign({},l),{view:"button"}))}function Ge(g,l){return g.addBlade(Object.assign(Object.assign({},l),{view:"folder"}))}function St(g,l){const p=l??{};return g.addBlade(Object.assign(Object.assign({},p),{view:"separator"}))}function Vt(g,l){return g.addBlade(Object.assign(Object.assign({},l),{view:"tab"}))}class Lt{constructor(l){this.emitter=new M,this.items_=[],this.cache_=new Set,this.onSubListAdd_=this.onSubListAdd_.bind(this),this.onSubListRemove_=this.onSubListRemove_.bind(this),this.extract_=l}get items(){return this.items_}allItems(){return Array.from(this.cache_)}find(l){for(const p of this.allItems())if(l(p))return p;return null}includes(l){return this.cache_.has(l)}add(l,p){if(this.includes(l))throw _.shouldNeverHappen();const w=p!==void 0?p:this.items_.length;this.items_.splice(w,0,l),this.cache_.add(l);const R=this.extract_(l);R&&(R.emitter.on("add",this.onSubListAdd_),R.emitter.on("remove",this.onSubListRemove_),R.allItems().forEach(W=>{this.cache_.add(W)})),this.emitter.emit("add",{index:w,item:l,root:this,target:this})}remove(l){const p=this.items_.indexOf(l);if(p<0)return;this.items_.splice(p,1),this.cache_.delete(l);const w=this.extract_(l);w&&(w.emitter.off("add",this.onSubListAdd_),w.emitter.off("remove",this.onSubListRemove_)),this.emitter.emit("remove",{index:p,item:l,root:this,target:this})}onSubListAdd_(l){this.cache_.add(l.item),this.emitter.emit("add",{index:l.index,item:l.item,root:this,target:l.target})}onSubListRemove_(l){this.cache_.delete(l.item),this.emitter.emit("remove",{index:l.index,item:l.item,root:this,target:l.target})}}class bi extends n{constructor(l){super(l),this.onBindingChange_=this.onBindingChange_.bind(this),this.emitter_=new M,this.controller_.binding.emitter.on("change",this.onBindingChange_)}get label(){return this.controller_.props.get("label")}set label(l){this.controller_.props.set("label",l)}on(l,p){const w=p.bind(this);return this.emitter_.on(l,R=>{w(R.event)}),this}refresh(){this.controller_.binding.read()}onBindingChange_(l){const p=l.sender.target.read();this.emitter_.emit("change",{event:new a(this,p,this.controller_.binding.target.presetKey,l.options.last)})}}class Le extends Re{constructor(l,p){super(l,p),this.binding=p.binding}}class $e extends n{constructor(l){super(l),this.onBindingUpdate_=this.onBindingUpdate_.bind(this),this.emitter_=new M,this.controller_.binding.emitter.on("update",this.onBindingUpdate_)}get label(){return this.controller_.props.get("label")}set label(l){this.controller_.props.set("label",l)}on(l,p){const w=p.bind(this);return this.emitter_.on(l,R=>{w(R.event)}),this}refresh(){this.controller_.binding.read()}onBindingUpdate_(l){const p=l.sender.target.read();this.emitter_.emit("update",{event:new o(this,p,this.controller_.binding.target.presetKey)})}}class it extends Re{constructor(l,p){super(l,p),this.binding=p.binding,this.viewProps.bindDisabled(this.binding.ticker),this.viewProps.handleDispose(()=>{this.binding.dispose()})}}function Ie(g){return g instanceof lt?g.apiSet_:g instanceof we?g.rackApi_.apiSet_:null}function at(g,l){const p=g.find(w=>w.controller_===l);if(!p)throw _.shouldNeverHappen();return p}function et(g,l,p){if(!b.isBindable(g))throw _.notBindable();return new b(g,l,p)}class lt extends n{constructor(l,p){super(l),this.onRackAdd_=this.onRackAdd_.bind(this),this.onRackRemove_=this.onRackRemove_.bind(this),this.onRackInputChange_=this.onRackInputChange_.bind(this),this.onRackMonitorUpdate_=this.onRackMonitorUpdate_.bind(this),this.emitter_=new M,this.apiSet_=new Lt(Ie),this.pool_=p;const w=this.controller_.rack;w.emitter.on("add",this.onRackAdd_),w.emitter.on("remove",this.onRackRemove_),w.emitter.on("inputchange",this.onRackInputChange_),w.emitter.on("monitorupdate",this.onRackMonitorUpdate_),w.children.forEach(R=>{this.setUpApi_(R)})}get children(){return this.controller_.rack.children.map(l=>at(this.apiSet_,l))}addInput(l,p,w){const R=w??{},W=this.controller_.view.element.ownerDocument,ae=this.pool_.createInput(W,et(l,p,R.presetKey),R),Ee=new bi(ae);return this.add(Ee,R.index)}addMonitor(l,p,w){const R=w??{},W=this.controller_.view.element.ownerDocument,ae=this.pool_.createMonitor(W,et(l,p),R),Ee=new $e(ae);return this.add(Ee,R.index)}addFolder(l){return Ge(this,l)}addButton(l){return ke(this,l)}addSeparator(l){return St(this,l)}addTab(l){return Vt(this,l)}add(l,p){this.controller_.rack.add(l.controller_,p);const w=this.apiSet_.find(R=>R.controller_===l.controller_);return w&&this.apiSet_.remove(w),this.apiSet_.add(l),l}remove(l){this.controller_.rack.remove(l.controller_)}addBlade(l){const p=this.controller_.view.element.ownerDocument,w=this.pool_.createBlade(p,l),R=this.pool_.createBladeApi(w);return this.add(R,l.index)}on(l,p){const w=p.bind(this);return this.emitter_.on(l,R=>{w(R.event)}),this}setUpApi_(l){this.apiSet_.find(w=>w.controller_===l)||this.apiSet_.add(this.pool_.createBladeApi(l))}onRackAdd_(l){this.setUpApi_(l.bladeController)}onRackRemove_(l){if(l.isRoot){const p=at(this.apiSet_,l.bladeController);this.apiSet_.remove(p)}}onRackInputChange_(l){const p=l.bladeController;if(p instanceof Le){const w=at(this.apiSet_,p),R=p.binding;this.emitter_.emit("change",{event:new a(w,R.target.read(),R.target.presetKey,l.options.last)})}else if(p instanceof ze){const w=at(this.apiSet_,p);this.emitter_.emit("change",{event:new a(w,p.value.rawValue,void 0,l.options.last)})}}onRackMonitorUpdate_(l){if(!(l.bladeController instanceof it))throw _.shouldNeverHappen();const p=at(this.apiSet_,l.bladeController),w=l.bladeController.binding;this.emitter_.emit("update",{event:new o(p,w.target.read(),w.target.presetKey)})}}class B extends we{constructor(l,p){super(l,new lt(l.rackController,p)),this.emitter_=new M,this.controller_.foldable.value("expanded").emitter.on("change",w=>{this.emitter_.emit("fold",{event:new u(this,w.sender.rawValue)})}),this.rackApi_.on("change",w=>{this.emitter_.emit("change",{event:w})}),this.rackApi_.on("update",w=>{this.emitter_.emit("update",{event:w})})}get expanded(){return this.controller_.foldable.get("expanded")}set expanded(l){this.controller_.foldable.set("expanded",l)}get title(){return this.controller_.props.get("title")}set title(l){this.controller_.props.set("title",l)}get children(){return this.rackApi_.children}addInput(l,p,w){return this.rackApi_.addInput(l,p,w)}addMonitor(l,p,w){return this.rackApi_.addMonitor(l,p,w)}addFolder(l){return this.rackApi_.addFolder(l)}addButton(l){return this.rackApi_.addButton(l)}addSeparator(l){return this.rackApi_.addSeparator(l)}addTab(l){return this.rackApi_.addTab(l)}add(l,p){return this.rackApi_.add(l,p)}remove(l){this.rackApi_.remove(l)}addBlade(l){return this.rackApi_.addBlade(l)}on(l,p){const w=p.bind(this);return this.emitter_.on(l,R=>{w(R.event)}),this}}class te extends xt{constructor(l){super({blade:l.blade,view:l.view,viewProps:l.rackController.viewProps}),this.rackController=l.rackController}}class de{constructor(l,p){const w=C(p.viewName);this.element=l.createElement("div"),this.element.classList.add(w()),p.viewProps.bindClassModifiers(this.element)}}function se(g,l){for(let p=0;p<g.length;p++){const w=g[p];if(w instanceof Le&&w.binding===l)return w}return null}function pe(g,l){for(let p=0;p<g.length;p++){const w=g[p];if(w instanceof it&&w.binding===l)return w}return null}function Oe(g,l){for(let p=0;p<g.length;p++){const w=g[p];if(w instanceof ze&&w.value===l)return w}return null}function Be(g){return g instanceof ot?g.rack:g instanceof te?g.rackController.rack:null}function rt(g){const l=Be(g);return l?l.bcSet_:null}class Ye{constructor(l){var p,w;this.onBladePositionsChange_=this.onBladePositionsChange_.bind(this),this.onSetAdd_=this.onSetAdd_.bind(this),this.onSetRemove_=this.onSetRemove_.bind(this),this.onChildDispose_=this.onChildDispose_.bind(this),this.onChildPositionsChange_=this.onChildPositionsChange_.bind(this),this.onChildInputChange_=this.onChildInputChange_.bind(this),this.onChildMonitorUpdate_=this.onChildMonitorUpdate_.bind(this),this.onChildValueChange_=this.onChildValueChange_.bind(this),this.onChildViewPropsChange_=this.onChildViewPropsChange_.bind(this),this.onDescendantLayout_=this.onDescendantLayout_.bind(this),this.onDescendantInputChange_=this.onDescendantInputChange_.bind(this),this.onDescendantMonitorUpdate_=this.onDescendantMonitorUpdate_.bind(this),this.emitter=new M,this.blade_=(p=l.blade)!==null&&p!==void 0?p:null,(w=this.blade_)===null||w===void 0||w.value("positions").emitter.on("change",this.onBladePositionsChange_),this.viewProps=l.viewProps,this.bcSet_=new Lt(rt),this.bcSet_.emitter.on("add",this.onSetAdd_),this.bcSet_.emitter.on("remove",this.onSetRemove_)}get children(){return this.bcSet_.items}add(l,p){var w;(w=l.parent)===null||w===void 0||w.remove(l),m(l,"parent")?l.parent=this:(l.parent_=this,ue({key:"parent",target:"BladeController",place:"BladeRack.add"})),this.bcSet_.add(l,p)}remove(l){m(l,"parent")?l.parent=null:(l.parent_=null,ue({key:"parent",target:"BladeController",place:"BladeRack.remove"})),this.bcSet_.remove(l)}find(l){return this.bcSet_.allItems().filter(p=>p instanceof l)}onSetAdd_(l){this.updatePositions_();const p=l.target===l.root;if(this.emitter.emit("add",{bladeController:l.item,index:l.index,isRoot:p,sender:this}),!p)return;const w=l.item;if(w.viewProps.emitter.on("change",this.onChildViewPropsChange_),w.blade.value("positions").emitter.on("change",this.onChildPositionsChange_),w.viewProps.handleDispose(this.onChildDispose_),w instanceof Le)w.binding.emitter.on("change",this.onChildInputChange_);else if(w instanceof it)w.binding.emitter.on("update",this.onChildMonitorUpdate_);else if(w instanceof ze)w.value.emitter.on("change",this.onChildValueChange_);else{const R=Be(w);if(R){const W=R.emitter;W.on("layout",this.onDescendantLayout_),W.on("inputchange",this.onDescendantInputChange_),W.on("monitorupdate",this.onDescendantMonitorUpdate_)}}}onSetRemove_(l){this.updatePositions_();const p=l.target===l.root;if(this.emitter.emit("remove",{bladeController:l.item,isRoot:p,sender:this}),!p)return;const w=l.item;if(w instanceof Le)w.binding.emitter.off("change",this.onChildInputChange_);else if(w instanceof it)w.binding.emitter.off("update",this.onChildMonitorUpdate_);else if(w instanceof ze)w.value.emitter.off("change",this.onChildValueChange_);else{const R=Be(w);if(R){const W=R.emitter;W.off("layout",this.onDescendantLayout_),W.off("inputchange",this.onDescendantInputChange_),W.off("monitorupdate",this.onDescendantMonitorUpdate_)}}}updatePositions_(){const l=this.bcSet_.items.filter(R=>!R.viewProps.get("hidden")),p=l[0],w=l[l.length-1];this.bcSet_.items.forEach(R=>{const W=[];R===p&&(W.push("first"),(!this.blade_||this.blade_.get("positions").includes("veryfirst"))&&W.push("veryfirst")),R===w&&(W.push("last"),(!this.blade_||this.blade_.get("positions").includes("verylast"))&&W.push("verylast")),R.blade.set("positions",W)})}onChildPositionsChange_(){this.updatePositions_(),this.emitter.emit("layout",{sender:this})}onChildViewPropsChange_(l){this.updatePositions_(),this.emitter.emit("layout",{sender:this})}onChildDispose_(){this.bcSet_.items.filter(p=>p.viewProps.get("disposed")).forEach(p=>{this.bcSet_.remove(p)})}onChildInputChange_(l){const p=se(this.find(Le),l.sender);if(!p)throw _.alreadyDisposed();this.emitter.emit("inputchange",{bladeController:p,options:l.options,sender:this})}onChildMonitorUpdate_(l){const p=pe(this.find(it),l.sender);if(!p)throw _.alreadyDisposed();this.emitter.emit("monitorupdate",{bladeController:p,sender:this})}onChildValueChange_(l){const p=Oe(this.find(ze),l.sender);if(!p)throw _.alreadyDisposed();this.emitter.emit("inputchange",{bladeController:p,options:l.options,sender:this})}onDescendantLayout_(l){this.updatePositions_(),this.emitter.emit("layout",{sender:this})}onDescendantInputChange_(l){this.emitter.emit("inputchange",{bladeController:l.bladeController,options:l.options,sender:this})}onDescendantMonitorUpdate_(l){this.emitter.emit("monitorupdate",{bladeController:l.bladeController,sender:this})}onBladePositionsChange_(){this.updatePositions_()}}class ot extends xt{constructor(l,p){super(Object.assign(Object.assign({},p),{view:new de(l,{viewName:"brk",viewProps:p.viewProps})})),this.onRackAdd_=this.onRackAdd_.bind(this),this.onRackRemove_=this.onRackRemove_.bind(this);const w=new Ye({blade:p.root?void 0:p.blade,viewProps:p.viewProps});w.emitter.on("add",this.onRackAdd_),w.emitter.on("remove",this.onRackRemove_),this.rack=w,this.viewProps.handleDispose(()=>{for(let R=this.rack.children.length-1;R>=0;R--)this.rack.children[R].viewProps.set("disposed",!0)})}onRackAdd_(l){l.isRoot&&xe(this.view.element,l.bladeController.view.element,l.index)}onRackRemove_(l){l.isRoot&&Me(l.bladeController.view.element)}}const gt=C("cnt");class nt{constructor(l,p){var w;this.className_=C((w=p.viewName)!==null&&w!==void 0?w:"fld"),this.element=l.createElement("div"),this.element.classList.add(this.className_(),gt()),p.viewProps.bindClassModifiers(this.element),this.foldable_=p.foldable,this.foldable_.bindExpandedClass(this.element,this.className_(void 0,"expanded")),A(this.foldable_,"completed",O(this.element,this.className_(void 0,"cpl")));const R=l.createElement("button");R.classList.add(this.className_("b")),A(p.props,"title",vt=>{c(vt)?this.element.classList.add(this.className_(void 0,"not")):this.element.classList.remove(this.className_(void 0,"not"))}),p.viewProps.bindDisabled(R),this.element.appendChild(R),this.buttonElement=R;const W=l.createElement("div");W.classList.add(this.className_("i")),this.element.appendChild(W);const ae=l.createElement("div");ae.classList.add(this.className_("t")),J(p.props.value("title"),ae),this.buttonElement.appendChild(ae),this.titleElement=ae;const Ee=l.createElement("div");Ee.classList.add(this.className_("m")),this.buttonElement.appendChild(Ee);const dt=p.containerElement;dt.classList.add(this.className_("c")),this.element.appendChild(dt),this.containerElement=dt}}class bt extends te{constructor(l,p){var w;const R=ht.create((w=p.expanded)!==null&&w!==void 0?w:!0),W=new ot(l,{blade:p.blade,root:p.root,viewProps:p.viewProps});super(Object.assign(Object.assign({},p),{rackController:W,view:new nt(l,{containerElement:W.view.element,foldable:R,props:p.props,viewName:p.root?"rot":void 0,viewProps:p.viewProps})})),this.onTitleClick_=this.onTitleClick_.bind(this),this.props=p.props,this.foldable=R,ge(this.foldable,this.view.containerElement),this.rackController.rack.emitter.on("add",()=>{this.foldable.cleanUpTransition()}),this.rackController.rack.emitter.on("remove",()=>{this.foldable.cleanUpTransition()}),this.view.buttonElement.addEventListener("click",this.onTitleClick_)}get document(){return this.view.element.ownerDocument}onTitleClick_(){this.foldable.set("expanded",!this.foldable.get("expanded"))}}const Ft={id:"folder",type:"blade",accept(g){const l=le,p=be(g,{title:l.required.string,view:l.required.constant("folder"),expanded:l.optional.boolean});return p?{params:p}:null},controller(g){return new bt(g.document,{blade:g.blade,expanded:g.params.expanded,props:V.fromObject({title:g.params.title}),viewProps:g.viewProps})},api(g){return g.controller instanceof bt?new B(g.controller,g.pool):null}};class Yt extends ze{constructor(l,p){const w=p.valueController.viewProps;super(Object.assign(Object.assign({},p),{value:p.valueController.value,view:new Te(l,{props:p.props,viewProps:w}),viewProps:w})),this.props=p.props,this.valueController=p.valueController,this.view.valueElement.appendChild(this.valueController.view.element)}}class Ii extends n{}const yt=C("spr");class tt{constructor(l,p){this.element=l.createElement("div"),this.element.classList.add(yt()),p.viewProps.bindClassModifiers(this.element);const w=l.createElement("hr");w.classList.add(yt("r")),this.element.appendChild(w)}}class ai extends xt{constructor(l,p){super(Object.assign(Object.assign({},p),{view:new tt(l,{viewProps:p.viewProps})}))}}const Kt={id:"separator",type:"blade",accept(g){const p=be(g,{view:le.required.constant("separator")});return p?{params:p}:null},controller(g){return new ai(g.document,{blade:g.blade,viewProps:g.viewProps})},api(g){return g.controller instanceof ai?new Ii(g.controller):null}},zt=C("tbi");class Hn{constructor(l,p){this.element=l.createElement("div"),this.element.classList.add(zt()),p.viewProps.bindClassModifiers(this.element),A(p.props,"selected",W=>{W?this.element.classList.add(zt(void 0,"sel")):this.element.classList.remove(zt(void 0,"sel"))});const w=l.createElement("button");w.classList.add(zt("b")),p.viewProps.bindDisabled(w),this.element.appendChild(w),this.buttonElement=w;const R=l.createElement("div");R.classList.add(zt("t")),J(p.props.value("title"),R),this.buttonElement.appendChild(R),this.titleElement=R}}class ii{constructor(l,p){this.emitter=new M,this.onClick_=this.onClick_.bind(this),this.props=p.props,this.viewProps=p.viewProps,this.view=new Hn(l,{props:p.props,viewProps:p.viewProps}),this.view.buttonElement.addEventListener("click",this.onClick_)}onClick_(){this.emitter.emit("click",{sender:this})}}class hn{constructor(l,p){this.onItemClick_=this.onItemClick_.bind(this),this.ic_=new ii(l,{props:p.itemProps,viewProps:Ze.create()}),this.ic_.emitter.on("click",this.onItemClick_),this.cc_=new ot(l,{blade:ut(),viewProps:Ze.create()}),this.props=p.props,A(this.props,"selected",w=>{this.itemController.props.set("selected",w),this.contentController.viewProps.set("hidden",!w)})}get itemController(){return this.ic_}get contentController(){return this.cc_}onItemClick_(){this.props.set("selected",!0)}}class Zt{constructor(l,p){this.controller_=l,this.rackApi_=p}get title(){var l;return(l=this.controller_.itemController.props.get("title"))!==null&&l!==void 0?l:""}set title(l){this.controller_.itemController.props.set("title",l)}get selected(){return this.controller_.props.get("selected")}set selected(l){this.controller_.props.set("selected",l)}get children(){return this.rackApi_.children}addButton(l){return this.rackApi_.addButton(l)}addFolder(l){return this.rackApi_.addFolder(l)}addSeparator(l){return this.rackApi_.addSeparator(l)}addTab(l){return this.rackApi_.addTab(l)}add(l,p){this.rackApi_.add(l,p)}remove(l){this.rackApi_.remove(l)}addInput(l,p,w){return this.rackApi_.addInput(l,p,w)}addMonitor(l,p,w){return this.rackApi_.addMonitor(l,p,w)}addBlade(l){return this.rackApi_.addBlade(l)}}class Ti extends we{constructor(l,p){super(l,new lt(l.rackController,p)),this.onPageAdd_=this.onPageAdd_.bind(this),this.onPageRemove_=this.onPageRemove_.bind(this),this.onSelect_=this.onSelect_.bind(this),this.emitter_=new M,this.pageApiMap_=new Map,this.rackApi_.on("change",w=>{this.emitter_.emit("change",{event:w})}),this.rackApi_.on("update",w=>{this.emitter_.emit("update",{event:w})}),this.controller_.tab.selectedIndex.emitter.on("change",this.onSelect_),this.controller_.pageSet.emitter.on("add",this.onPageAdd_),this.controller_.pageSet.emitter.on("remove",this.onPageRemove_),this.controller_.pageSet.items.forEach(w=>{this.setUpPageApi_(w)})}get pages(){return this.controller_.pageSet.items.map(l=>{const p=this.pageApiMap_.get(l);if(!p)throw _.shouldNeverHappen();return p})}addPage(l){const p=this.controller_.view.element.ownerDocument,w=new hn(p,{itemProps:V.fromObject({selected:!1,title:l.title}),props:V.fromObject({selected:!1})});this.controller_.add(w,l.index);const R=this.pageApiMap_.get(w);if(!R)throw _.shouldNeverHappen();return R}removePage(l){this.controller_.remove(l)}on(l,p){const w=p.bind(this);return this.emitter_.on(l,R=>{w(R.event)}),this}setUpPageApi_(l){const p=this.rackApi_.apiSet_.find(R=>R.controller_===l.contentController);if(!p)throw _.shouldNeverHappen();const w=new Zt(l,p);this.pageApiMap_.set(l,w)}onPageAdd_(l){this.setUpPageApi_(l.item)}onPageRemove_(l){if(!this.pageApiMap_.get(l.item))throw _.shouldNeverHappen();this.pageApiMap_.delete(l.item)}onSelect_(l){this.emitter_.emit("select",{event:new h(this,l.rawValue)})}}const br=-1;class Fi{constructor(){this.onItemSelectedChange_=this.onItemSelectedChange_.bind(this),this.empty=ee(!0),this.selectedIndex=ee(br),this.items_=[]}add(l,p){const w=p??this.items_.length;this.items_.splice(w,0,l),l.emitter.on("change",this.onItemSelectedChange_),this.keepSelection_()}remove(l){const p=this.items_.indexOf(l);p<0||(this.items_.splice(p,1),l.emitter.off("change",this.onItemSelectedChange_),this.keepSelection_())}keepSelection_(){if(this.items_.length===0){this.selectedIndex.rawValue=br,this.empty.rawValue=!0;return}const l=this.items_.findIndex(p=>p.rawValue);l<0?(this.items_.forEach((p,w)=>{p.rawValue=w===0}),this.selectedIndex.rawValue=0):(this.items_.forEach((p,w)=>{p.rawValue=w===l}),this.selectedIndex.rawValue=l),this.empty.rawValue=!1}onItemSelectedChange_(l){if(l.rawValue){const p=this.items_.findIndex(w=>w===l.sender);this.items_.forEach((w,R)=>{w.rawValue=R===p}),this.selectedIndex.rawValue=p}else this.keepSelection_()}}const Wn=C("tab");class bs{constructor(l,p){this.element=l.createElement("div"),this.element.classList.add(Wn(),gt()),p.viewProps.bindClassModifiers(this.element),F(p.empty,O(this.element,Wn(void 0,"nop")));const w=l.createElement("div");w.classList.add(Wn("t")),this.element.appendChild(w),this.itemsElement=w;const R=l.createElement("div");R.classList.add(Wn("i")),this.element.appendChild(R);const W=p.contentsElement;W.classList.add(Wn("c")),this.element.appendChild(W),this.contentsElement=W}}class xs extends te{constructor(l,p){const w=new ot(l,{blade:p.blade,viewProps:p.viewProps}),R=new Fi;super({blade:p.blade,rackController:w,view:new bs(l,{contentsElement:w.view.element,empty:R.empty,viewProps:p.viewProps})}),this.onPageAdd_=this.onPageAdd_.bind(this),this.onPageRemove_=this.onPageRemove_.bind(this),this.pageSet_=new Lt(()=>null),this.pageSet_.emitter.on("add",this.onPageAdd_),this.pageSet_.emitter.on("remove",this.onPageRemove_),this.tab=R}get pageSet(){return this.pageSet_}add(l,p){this.pageSet_.add(l,p)}remove(l){this.pageSet_.remove(this.pageSet_.items[l])}onPageAdd_(l){const p=l.item;xe(this.view.itemsElement,p.itemController.view.element,l.index),p.itemController.viewProps.set("parent",this.viewProps),this.rackController.rack.add(p.contentController,l.index),this.tab.add(p.props.value("selected"))}onPageRemove_(l){const p=l.item;Me(p.itemController.view.element),p.itemController.viewProps.set("parent",null),this.rackController.rack.remove(p.contentController),this.tab.remove(p.props.value("selected"))}}const Ll={id:"tab",type:"blade",accept(g){const l=le,p=be(g,{pages:l.required.array(l.required.object({title:l.required.string})),view:l.required.constant("tab")});return!p||p.pages.length===0?null:{params:p}},controller(g){const l=new xs(g.document,{blade:g.blade,viewProps:g.viewProps});return g.params.pages.forEach(p=>{const w=new hn(g.document,{itemProps:V.fromObject({selected:!1,title:p.title}),props:V.fromObject({selected:!1})});l.add(w)}),l},api(g){return g.controller instanceof xs?new Ti(g.controller,g.pool):null}};function Md(g,l){const p=g.accept(l.params);if(!p)return null;const w=le.optional.boolean(l.params.disabled).value,R=le.optional.boolean(l.params.hidden).value;return g.controller({blade:ut(),document:l.document,params:Object.assign(Object.assign({},p.params),{disabled:w,hidden:R}),viewProps:Ze.create({disabled:w,hidden:R})})}class xu{constructor(){this.disabled=!1,this.emitter=new M}dispose(){}tick(){this.disabled||this.emitter.emit("tick",{sender:this})}}class Rl{constructor(l,p){this.disabled_=!1,this.timerId_=null,this.onTick_=this.onTick_.bind(this),this.doc_=l,this.emitter=new M,this.interval_=p,this.setTimer_()}get disabled(){return this.disabled_}set disabled(l){this.disabled_=l,this.disabled_?this.clearTimer_():this.setTimer_()}dispose(){this.clearTimer_()}clearTimer_(){if(this.timerId_===null)return;const l=this.doc_.defaultView;l&&l.clearInterval(this.timerId_),this.timerId_=null}setTimer_(){if(this.clearTimer_(),this.interval_<=0)return;const l=this.doc_.defaultView;l&&(this.timerId_=l.setInterval(this.onTick_,this.interval_))}onTick_(){this.disabled_||this.emitter.emit("tick",{sender:this})}}class la{constructor(l){this.onValueChange_=this.onValueChange_.bind(this),this.reader=l.reader,this.writer=l.writer,this.emitter=new M,this.value=l.value,this.value.emitter.on("change",this.onValueChange_),this.target=l.target,this.read()}read(){const l=this.target.read();l!==void 0&&(this.value.rawValue=this.reader(l))}write_(l){this.writer(this.target,l)}onValueChange_(l){this.write_(l.rawValue),this.emitter.emit("change",{options:l.options,rawValue:l.rawValue,sender:this})}}function li(g,l){for(;g.length<l;)g.push(void 0)}function wu(g){const l=[];return li(l,g),ee(l)}function xr(g){const l=g.indexOf(void 0);return l<0?g:g.slice(0,l)}function dn(g,l){const p=[...xr(g),l];return p.length>g.length?p.splice(0,p.length-g.length):li(p,g.length),p}class Td{constructor(l){this.onTick_=this.onTick_.bind(this),this.reader_=l.reader,this.target=l.target,this.emitter=new M,this.value=l.value,this.ticker=l.ticker,this.ticker.emitter.on("tick",this.onTick_),this.read()}dispose(){this.ticker.dispose()}read(){const l=this.target.read();if(l===void 0)return;const p=this.value.rawValue,w=this.reader_(l);this.value.rawValue=dn(p,w),this.emitter.emit("update",{rawValue:w,sender:this})}onTick_(l){this.read()}}class io{constructor(l){this.constraints=l}constrain(l){return this.constraints.reduce((p,w)=>w.constrain(p),l)}}function Cn(g,l){if(g instanceof l)return g;if(g instanceof io){const p=g.constraints.reduce((w,R)=>w||(R instanceof l?R:null),null);if(p)return p}return null}class wr{constructor(l){this.values=V.fromObject({max:l.max,min:l.min})}constrain(l){const p=this.values.get("max"),w=this.values.get("min");return Math.min(Math.max(l,w),p)}}class no{constructor(l){this.values=V.fromObject({options:l})}get options(){return this.values.get("options")}constrain(l){const p=this.values.get("options");return p.length===0||p.filter(R=>R.value===l).length>0?l:p[0].value}}class kl{constructor(l){this.values=V.fromObject({max:l.max,min:l.min})}get maxValue(){return this.values.get("max")}get minValue(){return this.values.get("min")}constrain(l){const p=this.values.get("max"),w=this.values.get("min");let R=l;return c(w)||(R=Math.max(R,w)),c(p)||(R=Math.min(R,p)),R}}class ca{constructor(l,p=0){this.step=l,this.origin=p}constrain(l){const p=this.origin%this.step,w=Math.round((l-p)/this.step);return p+w*this.step}}const yr=C("lst");class yu{constructor(l,p){this.onValueChange_=this.onValueChange_.bind(this),this.props_=p.props,this.element=l.createElement("div"),this.element.classList.add(yr()),p.viewProps.bindClassModifiers(this.element);const w=l.createElement("select");w.classList.add(yr("s")),p.viewProps.bindDisabled(w),this.element.appendChild(w),this.selectElement=w;const R=l.createElement("div");R.classList.add(yr("m")),R.appendChild(fe(l,"dropdown")),this.element.appendChild(R),p.value.emitter.on("change",this.onValueChange_),this.value_=p.value,A(this.props_,"options",W=>{Se(this.selectElement),W.forEach(ae=>{const Ee=l.createElement("option");Ee.textContent=ae.text,this.selectElement.appendChild(Ee)}),this.update_()})}update_(){const l=this.props_.get("options").map(p=>p.value);this.selectElement.selectedIndex=l.indexOf(this.value_.rawValue)}onValueChange_(){this.update_()}}class so{constructor(l,p){this.onSelectChange_=this.onSelectChange_.bind(this),this.props=p.props,this.value=p.value,this.viewProps=p.viewProps,this.view=new yu(l,{props:this.props,value:this.value,viewProps:this.viewProps}),this.view.selectElement.addEventListener("change",this.onSelectChange_)}onSelectChange_(l){const p=l.currentTarget;this.value.rawValue=this.props.get("options")[p.selectedIndex].value}}const Su=C("pop");class Ed{constructor(l,p){this.element=l.createElement("div"),this.element.classList.add(Su()),p.viewProps.bindClassModifiers(this.element),F(p.shows,O(this.element,Su(void 0,"v")))}}class Mu{constructor(l,p){this.shows=ee(!1),this.viewProps=p.viewProps,this.view=new Ed(l,{shows:this.shows,viewProps:this.viewProps})}}const Tu=C("txt");class Cd{constructor(l,p){this.onChange_=this.onChange_.bind(this),this.element=l.createElement("div"),this.element.classList.add(Tu()),p.viewProps.bindClassModifiers(this.element),this.props_=p.props,this.props_.emitter.on("change",this.onChange_);const w=l.createElement("input");w.classList.add(Tu("i")),w.type="text",p.viewProps.bindDisabled(w),this.element.appendChild(w),this.inputElement=w,p.value.emitter.on("change",this.onChange_),this.value_=p.value,this.refresh()}refresh(){const l=this.props_.get("formatter");this.inputElement.value=l(this.value_.rawValue)}onChange_(){this.refresh()}}class ua{constructor(l,p){this.onInputChange_=this.onInputChange_.bind(this),this.parser_=p.parser,this.props=p.props,this.value=p.value,this.viewProps=p.viewProps,this.view=new Cd(l,{props:p.props,value:this.value,viewProps:this.viewProps}),this.view.inputElement.addEventListener("change",this.onInputChange_)}onInputChange_(l){const w=l.currentTarget.value,R=this.parser_(w);c(R)||(this.value.rawValue=R),this.view.refresh()}}function Dd(g){return String(g)}function Eu(g){return g==="false"?!1:!!g}function Cu(g){return Dd(g)}class Pd{constructor(l){this.text=l}evaluate(){return Number(this.text)}toString(){return this.text}}const Ad={"**":(g,l)=>Math.pow(g,l),"*":(g,l)=>g*l,"/":(g,l)=>g/l,"%":(g,l)=>g%l,"+":(g,l)=>g+l,"-":(g,l)=>g-l,"<<":(g,l)=>g<<l,">>":(g,l)=>g>>l,">>>":(g,l)=>g>>>l,"&":(g,l)=>g&l,"^":(g,l)=>g^l,"|":(g,l)=>g|l};class Ld{constructor(l,p,w){this.left=p,this.operator=l,this.right=w}evaluate(){const l=Ad[this.operator];if(!l)throw new Error(`unexpected binary operator: '${this.operator}`);return l(this.left.evaluate(),this.right.evaluate())}toString(){return["b(",this.left.toString(),this.operator,this.right.toString(),")"].join(" ")}}const Du={"+":g=>g,"-":g=>-g,"~":g=>~g};class Rd{constructor(l,p){this.operator=l,this.expression=p}evaluate(){const l=Du[this.operator];if(!l)throw new Error(`unexpected unary operator: '${this.operator}`);return l(this.expression.evaluate())}toString(){return["u(",this.operator,this.expression.toString(),")"].join(" ")}}function Il(g){return(l,p)=>{for(let w=0;w<g.length;w++){const R=g[w](l,p);if(R!=="")return R}return""}}function Us(g,l){var p;const w=g.substr(l).match(/^\s+/);return(p=w&&w[0])!==null&&p!==void 0?p:""}function kd(g,l){const p=g.substr(l,1);return p.match(/^[1-9]$/)?p:""}function ro(g,l){var p;const w=g.substr(l).match(/^[0-9]+/);return(p=w&&w[0])!==null&&p!==void 0?p:""}function Id(g,l){const p=ro(g,l);if(p!=="")return p;const w=g.substr(l,1);if(l+=1,w!=="-"&&w!=="+")return"";const R=ro(g,l);return R===""?"":w+R}function jn(g,l){const p=g.substr(l,1);if(l+=1,p.toLowerCase()!=="e")return"";const w=Id(g,l);return w===""?"":p+w}function Pu(g,l){const p=g.substr(l,1);if(p==="0")return p;const w=kd(g,l);return l+=w.length,w===""?"":w+ro(g,l)}function Fd(g,l){const p=Pu(g,l);if(l+=p.length,p==="")return"";const w=g.substr(l,1);if(l+=w.length,w!==".")return"";const R=ro(g,l);return l+=R.length,p+w+R+jn(g,l)}function Au(g,l){const p=g.substr(l,1);if(l+=p.length,p!==".")return"";const w=ro(g,l);return l+=w.length,w===""?"":p+w+jn(g,l)}function Od(g,l){const p=Pu(g,l);return l+=p.length,p===""?"":p+jn(g,l)}const Lu=Il([Fd,Au,Od]);function Fl(g,l){var p;const w=g.substr(l).match(/^[01]+/);return(p=w&&w[0])!==null&&p!==void 0?p:""}function Nd(g,l){const p=g.substr(l,2);if(l+=p.length,p.toLowerCase()!=="0b")return"";const w=Fl(g,l);return w===""?"":p+w}function Ru(g,l){var p;const w=g.substr(l).match(/^[0-7]+/);return(p=w&&w[0])!==null&&p!==void 0?p:""}function pn(g,l){const p=g.substr(l,2);if(l+=p.length,p.toLowerCase()!=="0o")return"";const w=Ru(g,l);return w===""?"":p+w}function Bd(g,l){var p;const w=g.substr(l).match(/^[0-9a-f]+/i);return(p=w&&w[0])!==null&&p!==void 0?p:""}function Vd(g,l){const p=g.substr(l,2);if(l+=p.length,p.toLowerCase()!=="0x")return"";const w=Bd(g,l);return w===""?"":p+w}const Ol=Il([Nd,pn,Vd]),zd=Il([Ol,Lu]);function ws(g,l){const p=zd(g,l);return l+=p.length,p===""?null:{evaluable:new Pd(p),cursor:l}}function Nl(g,l){const p=g.substr(l,1);if(l+=p.length,p!=="(")return null;const w=ha(g,l);if(!w)return null;l=w.cursor,l+=Us(g,l).length;const R=g.substr(l,1);return l+=R.length,R!==")"?null:{evaluable:w.evaluable,cursor:l}}function Ud(g,l){var p;return(p=ws(g,l))!==null&&p!==void 0?p:Nl(g,l)}function Bl(g,l){const p=Ud(g,l);if(p)return p;const w=g.substr(l,1);if(l+=w.length,w!=="+"&&w!=="-"&&w!=="~")return null;const R=Bl(g,l);return R?(l=R.cursor,{cursor:l,evaluable:new Rd(w,R.evaluable)}):null}function Gd(g,l,p){p+=Us(l,p).length;const w=g.filter(R=>l.startsWith(R,p))[0];return w?(p+=w.length,p+=Us(l,p).length,{cursor:p,operator:w}):null}function Gs(g,l){return(p,w)=>{const R=g(p,w);if(!R)return null;w=R.cursor;let W=R.evaluable;for(;;){const ae=Gd(l,p,w);if(!ae)break;w=ae.cursor;const Ee=g(p,w);if(!Ee)return null;w=Ee.cursor,W=new Ld(ae.operator,W,Ee.evaluable)}return W?{cursor:w,evaluable:W}:null}}const ku=[["**"],["*","/","%"],["+","-"],["<<",">>>",">>"],["&"],["^"],["|"]].reduce((g,l)=>Gs(g,l),Bl);function ha(g,l){return l+=Us(g,l).length,ku(g,l)}function Iu(g){const l=ha(g,0);return!l||l.cursor+Us(g,l.cursor).length!==g.length?null:l.evaluable}function qn(g){var l;const p=Iu(g);return(l=p==null?void 0:p.evaluate())!==null&&l!==void 0?l:null}function cs(g){if(typeof g=="number")return g;if(typeof g=="string"){const l=qn(g);if(!c(l))return l}return 0}function Hd(g){return String(g)}function fi(g){return l=>l.toFixed(Math.max(Math.min(g,20),0))}const Fu=fi(0);function oo(g){return Fu(g)+"%"}function Vl(g){return String(g)}function ys(g){return g}function Sr({primary:g,secondary:l,forward:p,backward:w}){let R=!1;function W(ae){R||(R=!0,ae(),R=!1)}g.emitter.on("change",ae=>{W(()=>{l.setRawValue(p(g,l),ae.options)})}),l.emitter.on("change",ae=>{W(()=>{g.setRawValue(w(g,l),ae.options)}),W(()=>{l.setRawValue(p(g,l),ae.options)})}),W(()=>{l.setRawValue(p(g,l),{forceEmit:!1,last:!0})})}function Ei(g,l){const p=g*(l.altKey?.1:1)*(l.shiftKey?10:1);return l.upKey?+p:l.downKey?-p:0}function ao(g){return{altKey:g.altKey,downKey:g.key==="ArrowDown",shiftKey:g.shiftKey,upKey:g.key==="ArrowUp"}}function Xn(g){return{altKey:g.altKey,downKey:g.key==="ArrowLeft",shiftKey:g.shiftKey,upKey:g.key==="ArrowRight"}}function Ou(g){return g==="ArrowUp"||g==="ArrowDown"}function da(g){return Ou(g)||g==="ArrowLeft"||g==="ArrowRight"}function zl(g,l){var p,w;const R=l.ownerDocument.defaultView,W=l.getBoundingClientRect();return{x:g.pageX-(((p=R&&R.scrollX)!==null&&p!==void 0?p:0)+W.left),y:g.pageY-(((w=R&&R.scrollY)!==null&&w!==void 0?w:0)+W.top)}}class Hs{constructor(l){this.lastTouch_=null,this.onDocumentMouseMove_=this.onDocumentMouseMove_.bind(this),this.onDocumentMouseUp_=this.onDocumentMouseUp_.bind(this),this.onMouseDown_=this.onMouseDown_.bind(this),this.onTouchEnd_=this.onTouchEnd_.bind(this),this.onTouchMove_=this.onTouchMove_.bind(this),this.onTouchStart_=this.onTouchStart_.bind(this),this.elem_=l,this.emitter=new M,l.addEventListener("touchstart",this.onTouchStart_,{passive:!1}),l.addEventListener("touchmove",this.onTouchMove_,{passive:!0}),l.addEventListener("touchend",this.onTouchEnd_),l.addEventListener("mousedown",this.onMouseDown_)}computePosition_(l){const p=this.elem_.getBoundingClientRect();return{bounds:{width:p.width,height:p.height},point:l?{x:l.x,y:l.y}:null}}onMouseDown_(l){var p;l.preventDefault(),(p=l.currentTarget)===null||p===void 0||p.focus();const w=this.elem_.ownerDocument;w.addEventListener("mousemove",this.onDocumentMouseMove_),w.addEventListener("mouseup",this.onDocumentMouseUp_),this.emitter.emit("down",{altKey:l.altKey,data:this.computePosition_(zl(l,this.elem_)),sender:this,shiftKey:l.shiftKey})}onDocumentMouseMove_(l){this.emitter.emit("move",{altKey:l.altKey,data:this.computePosition_(zl(l,this.elem_)),sender:this,shiftKey:l.shiftKey})}onDocumentMouseUp_(l){const p=this.elem_.ownerDocument;p.removeEventListener("mousemove",this.onDocumentMouseMove_),p.removeEventListener("mouseup",this.onDocumentMouseUp_),this.emitter.emit("up",{altKey:l.altKey,data:this.computePosition_(zl(l,this.elem_)),sender:this,shiftKey:l.shiftKey})}onTouchStart_(l){l.preventDefault();const p=l.targetTouches.item(0),w=this.elem_.getBoundingClientRect();this.emitter.emit("down",{altKey:l.altKey,data:this.computePosition_(p?{x:p.clientX-w.left,y:p.clientY-w.top}:void 0),sender:this,shiftKey:l.shiftKey}),this.lastTouch_=p}onTouchMove_(l){const p=l.targetTouches.item(0),w=this.elem_.getBoundingClientRect();this.emitter.emit("move",{altKey:l.altKey,data:this.computePosition_(p?{x:p.clientX-w.left,y:p.clientY-w.top}:void 0),sender:this,shiftKey:l.shiftKey}),this.lastTouch_=p}onTouchEnd_(l){var p;const w=(p=l.targetTouches.item(0))!==null&&p!==void 0?p:this.lastTouch_,R=this.elem_.getBoundingClientRect();this.emitter.emit("up",{altKey:l.altKey,data:this.computePosition_(w?{x:w.clientX-R.left,y:w.clientY-R.top}:void 0),sender:this,shiftKey:l.shiftKey})}}function jt(g,l,p,w,R){const W=(g-l)/(p-l);return w+W*(R-w)}function Ul(g){return String(g.toFixed(10)).split(".")[1].replace(/0+$/,"").length}function ci(g,l,p){return Math.min(Math.max(g,l),p)}function Mr(g,l){return(g%l+l)%l}const $i=C("txt");class Gl{constructor(l,p){this.onChange_=this.onChange_.bind(this),this.props_=p.props,this.props_.emitter.on("change",this.onChange_),this.element=l.createElement("div"),this.element.classList.add($i(),$i(void 0,"num")),p.arrayPosition&&this.element.classList.add($i(void 0,p.arrayPosition)),p.viewProps.bindClassModifiers(this.element);const w=l.createElement("input");w.classList.add($i("i")),w.type="text",p.viewProps.bindDisabled(w),this.element.appendChild(w),this.inputElement=w,this.onDraggingChange_=this.onDraggingChange_.bind(this),this.dragging_=p.dragging,this.dragging_.emitter.on("change",this.onDraggingChange_),this.element.classList.add($i()),this.inputElement.classList.add($i("i"));const R=l.createElement("div");R.classList.add($i("k")),this.element.appendChild(R),this.knobElement=R;const W=l.createElementNS(mt,"svg");W.classList.add($i("g")),this.knobElement.appendChild(W);const ae=l.createElementNS(mt,"path");ae.classList.add($i("gb")),W.appendChild(ae),this.guideBodyElem_=ae;const Ee=l.createElementNS(mt,"path");Ee.classList.add($i("gh")),W.appendChild(Ee),this.guideHeadElem_=Ee;const dt=l.createElement("div");dt.classList.add(C("tt")()),this.knobElement.appendChild(dt),this.tooltipElem_=dt,p.value.emitter.on("change",this.onChange_),this.value=p.value,this.refresh()}onDraggingChange_(l){if(l.rawValue===null){this.element.classList.remove($i(void 0,"drg"));return}this.element.classList.add($i(void 0,"drg"));const p=l.rawValue/this.props_.get("draggingScale"),w=p+(p>0?-1:p<0?1:0),R=ci(-w,-4,4);this.guideHeadElem_.setAttributeNS(null,"d",[`M ${w+R},0 L${w},4 L${w+R},8`,`M ${p},-1 L${p},9`].join(" ")),this.guideBodyElem_.setAttributeNS(null,"d",`M 0,4 L${p},4`);const W=this.props_.get("formatter");this.tooltipElem_.textContent=W(this.value.rawValue),this.tooltipElem_.style.left=`${p}px`}refresh(){const l=this.props_.get("formatter");this.inputElement.value=l(this.value.rawValue)}onChange_(){this.refresh()}}class lo{constructor(l,p){var w;this.originRawValue_=0,this.onInputChange_=this.onInputChange_.bind(this),this.onInputKeyDown_=this.onInputKeyDown_.bind(this),this.onInputKeyUp_=this.onInputKeyUp_.bind(this),this.onPointerDown_=this.onPointerDown_.bind(this),this.onPointerMove_=this.onPointerMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.baseStep_=p.baseStep,this.parser_=p.parser,this.props=p.props,this.sliderProps_=(w=p.sliderProps)!==null&&w!==void 0?w:null,this.value=p.value,this.viewProps=p.viewProps,this.dragging_=ee(null),this.view=new Gl(l,{arrayPosition:p.arrayPosition,dragging:this.dragging_,props:this.props,value:this.value,viewProps:this.viewProps}),this.view.inputElement.addEventListener("change",this.onInputChange_),this.view.inputElement.addEventListener("keydown",this.onInputKeyDown_),this.view.inputElement.addEventListener("keyup",this.onInputKeyUp_);const R=new Hs(this.view.knobElement);R.emitter.on("down",this.onPointerDown_),R.emitter.on("move",this.onPointerMove_),R.emitter.on("up",this.onPointerUp_)}constrainValue_(l){var p,w;const R=(p=this.sliderProps_)===null||p===void 0?void 0:p.get("minValue"),W=(w=this.sliderProps_)===null||w===void 0?void 0:w.get("maxValue");let ae=l;return R!==void 0&&(ae=Math.max(ae,R)),W!==void 0&&(ae=Math.min(ae,W)),ae}onInputChange_(l){const w=l.currentTarget.value,R=this.parser_(w);c(R)||(this.value.rawValue=this.constrainValue_(R)),this.view.refresh()}onInputKeyDown_(l){const p=Ei(this.baseStep_,ao(l));p!==0&&this.value.setRawValue(this.constrainValue_(this.value.rawValue+p),{forceEmit:!1,last:!1})}onInputKeyUp_(l){Ei(this.baseStep_,ao(l))!==0&&this.value.setRawValue(this.value.rawValue,{forceEmit:!0,last:!0})}onPointerDown_(){this.originRawValue_=this.value.rawValue,this.dragging_.rawValue=0}computeDraggingValue_(l){if(!l.point)return null;const p=l.point.x-l.bounds.width/2;return this.constrainValue_(this.originRawValue_+p*this.props.get("draggingScale"))}onPointerMove_(l){const p=this.computeDraggingValue_(l.data);p!==null&&(this.value.setRawValue(p,{forceEmit:!1,last:!1}),this.dragging_.rawValue=this.value.rawValue-this.originRawValue_)}onPointerUp_(l){const p=this.computeDraggingValue_(l.data);p!==null&&(this.value.setRawValue(p,{forceEmit:!0,last:!0}),this.dragging_.rawValue=null)}}const Hl=C("sld");class Yi{constructor(l,p){this.onChange_=this.onChange_.bind(this),this.props_=p.props,this.props_.emitter.on("change",this.onChange_),this.element=l.createElement("div"),this.element.classList.add(Hl()),p.viewProps.bindClassModifiers(this.element);const w=l.createElement("div");w.classList.add(Hl("t")),p.viewProps.bindTabIndex(w),this.element.appendChild(w),this.trackElement=w;const R=l.createElement("div");R.classList.add(Hl("k")),this.trackElement.appendChild(R),this.knobElement=R,p.value.emitter.on("change",this.onChange_),this.value=p.value,this.update_()}update_(){const l=ci(jt(this.value.rawValue,this.props_.get("minValue"),this.props_.get("maxValue"),0,100),0,100);this.knobElement.style.width=`${l}%`}onChange_(){this.update_()}}class Wl{constructor(l,p){this.onKeyDown_=this.onKeyDown_.bind(this),this.onKeyUp_=this.onKeyUp_.bind(this),this.onPointerDownOrMove_=this.onPointerDownOrMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.baseStep_=p.baseStep,this.value=p.value,this.viewProps=p.viewProps,this.props=p.props,this.view=new Yi(l,{props:this.props,value:this.value,viewProps:this.viewProps}),this.ptHandler_=new Hs(this.view.trackElement),this.ptHandler_.emitter.on("down",this.onPointerDownOrMove_),this.ptHandler_.emitter.on("move",this.onPointerDownOrMove_),this.ptHandler_.emitter.on("up",this.onPointerUp_),this.view.trackElement.addEventListener("keydown",this.onKeyDown_),this.view.trackElement.addEventListener("keyup",this.onKeyUp_)}handlePointerEvent_(l,p){l.point&&this.value.setRawValue(jt(ci(l.point.x,0,l.bounds.width),0,l.bounds.width,this.props.get("minValue"),this.props.get("maxValue")),p)}onPointerDownOrMove_(l){this.handlePointerEvent_(l.data,{forceEmit:!1,last:!1})}onPointerUp_(l){this.handlePointerEvent_(l.data,{forceEmit:!0,last:!0})}onKeyDown_(l){const p=Ei(this.baseStep_,Xn(l));p!==0&&this.value.setRawValue(this.value.rawValue+p,{forceEmit:!1,last:!1})}onKeyUp_(l){Ei(this.baseStep_,Xn(l))!==0&&this.value.setRawValue(this.value.rawValue,{forceEmit:!0,last:!0})}}const co=C("sldtxt");class jl{constructor(l,p){this.element=l.createElement("div"),this.element.classList.add(co());const w=l.createElement("div");w.classList.add(co("s")),this.sliderView_=p.sliderView,w.appendChild(this.sliderView_.element),this.element.appendChild(w);const R=l.createElement("div");R.classList.add(co("t")),this.textView_=p.textView,R.appendChild(this.textView_.element),this.element.appendChild(R)}}class pa{constructor(l,p){this.value=p.value,this.viewProps=p.viewProps,this.sliderC_=new Wl(l,{baseStep:p.baseStep,props:p.sliderProps,value:p.value,viewProps:this.viewProps}),this.textC_=new lo(l,{baseStep:p.baseStep,parser:p.parser,props:p.textProps,sliderProps:p.sliderProps,value:p.value,viewProps:p.viewProps}),this.view=new jl(l,{sliderView:this.sliderC_.view,textView:this.textC_.view})}get sliderController(){return this.sliderC_}get textController(){return this.textC_}}function Dn(g,l){g.write(l)}function uo(g){const l=le;if(Array.isArray(g))return l.required.array(l.required.object({text:l.required.string,value:l.required.raw}))(g).value;if(typeof g=="object")return l.required.raw(g).value}function ql(g){if(g==="inline"||g==="popup")return g}function us(g){const l=le;return l.required.object({max:l.optional.number,min:l.optional.number,step:l.optional.number})(g).value}function Nu(g){if(Array.isArray(g))return g;const l=[];return Object.keys(g).forEach(p=>{l.push({text:p,value:g[p]})}),l}function Xl(g){return c(g)?null:new no(Nu(g))}function Wd(g){const l=g?Cn(g,ca):null;return l?l.step:null}function fa(g,l){const p=g&&Cn(g,ca);return p?Ul(p.step):Math.max(Ul(l),2)}function Ws(g){const l=Wd(g);return l??1}function js(g,l){var p;const w=g&&Cn(g,ca),R=Math.abs((p=w==null?void 0:w.step)!==null&&p!==void 0?p:l);return R===0?.1:Math.pow(10,Math.floor(Math.log10(R))-1)}const ho=C("ckb");class po{constructor(l,p){this.onValueChange_=this.onValueChange_.bind(this),this.element=l.createElement("div"),this.element.classList.add(ho()),p.viewProps.bindClassModifiers(this.element);const w=l.createElement("label");w.classList.add(ho("l")),this.element.appendChild(w);const R=l.createElement("input");R.classList.add(ho("i")),R.type="checkbox",w.appendChild(R),this.inputElement=R,p.viewProps.bindDisabled(this.inputElement);const W=l.createElement("div");W.classList.add(ho("w")),w.appendChild(W);const ae=fe(l,"check");W.appendChild(ae),p.value.emitter.on("change",this.onValueChange_),this.value=p.value,this.update_()}update_(){this.inputElement.checked=this.value.rawValue}onValueChange_(){this.update_()}}class Bu{constructor(l,p){this.onInputChange_=this.onInputChange_.bind(this),this.value=p.value,this.viewProps=p.viewProps,this.view=new po(l,{value:this.value,viewProps:this.viewProps}),this.view.inputElement.addEventListener("change",this.onInputChange_)}onInputChange_(l){const p=l.currentTarget;this.value.rawValue=p.checked}}function Vu(g){const l=[],p=Xl(g.options);return p&&l.push(p),new io(l)}const ma={id:"input-bool",type:"input",accept:(g,l)=>{if(typeof g!="boolean")return null;const w=be(l,{options:le.optional.custom(uo)});return w?{initialValue:g,params:w}:null},binding:{reader:g=>Eu,constraint:g=>Vu(g.params),writer:g=>Dn},controller:g=>{const l=g.document,p=g.value,w=g.constraint,R=w&&Cn(w,no);return R?new so(l,{props:new V({options:R.values.value("options")}),value:p,viewProps:g.viewProps}):new Bu(l,{value:p,viewProps:g.viewProps})}},qs=C("col");class $l{constructor(l,p){this.element=l.createElement("div"),this.element.classList.add(qs()),p.foldable.bindExpandedClass(this.element,qs(void 0,"expanded")),A(p.foldable,"completed",O(this.element,qs(void 0,"cpl")));const w=l.createElement("div");w.classList.add(qs("h")),this.element.appendChild(w);const R=l.createElement("div");R.classList.add(qs("s")),w.appendChild(R),this.swatchElement=R;const W=l.createElement("div");if(W.classList.add(qs("t")),w.appendChild(W),this.textElement=W,p.pickerLayout==="inline"){const ae=l.createElement("div");ae.classList.add(qs("p")),this.element.appendChild(ae),this.pickerElement=ae}else this.pickerElement=null}}function jd(g,l,p){const w=ci(g/255,0,1),R=ci(l/255,0,1),W=ci(p/255,0,1),ae=Math.max(w,R,W),Ee=Math.min(w,R,W),dt=ae-Ee;let vt=0,Bt=0;const Ut=(Ee+ae)/2;return dt!==0&&(Bt=dt/(1-Math.abs(ae+Ee-1)),w===ae?vt=(R-W)/dt:R===ae?vt=2+(W-w)/dt:vt=4+(w-R)/dt,vt=vt/6+(vt<0?1:0)),[vt*360,Bt*100,Ut*100]}function qd(g,l,p){const w=(g%360+360)%360,R=ci(l/100,0,1),W=ci(p/100,0,1),ae=(1-Math.abs(2*W-1))*R,Ee=ae*(1-Math.abs(w/60%2-1)),dt=W-ae/2;let vt,Bt,Ut;return w>=0&&w<60?[vt,Bt,Ut]=[ae,Ee,0]:w>=60&&w<120?[vt,Bt,Ut]=[Ee,ae,0]:w>=120&&w<180?[vt,Bt,Ut]=[0,ae,Ee]:w>=180&&w<240?[vt,Bt,Ut]=[0,Ee,ae]:w>=240&&w<300?[vt,Bt,Ut]=[Ee,0,ae]:[vt,Bt,Ut]=[ae,0,Ee],[(vt+dt)*255,(Bt+dt)*255,(Ut+dt)*255]}function Xd(g,l,p){const w=ci(g/255,0,1),R=ci(l/255,0,1),W=ci(p/255,0,1),ae=Math.max(w,R,W),Ee=Math.min(w,R,W),dt=ae-Ee;let vt;dt===0?vt=0:ae===w?vt=60*(((R-W)/dt%6+6)%6):ae===R?vt=60*((W-w)/dt+2):vt=60*((w-R)/dt+4);const Bt=ae===0?0:dt/ae,Ut=ae;return[vt,Bt*100,Ut*100]}function zu(g,l,p){const w=Mr(g,360),R=ci(l/100,0,1),W=ci(p/100,0,1),ae=W*R,Ee=ae*(1-Math.abs(w/60%2-1)),dt=W-ae;let vt,Bt,Ut;return w>=0&&w<60?[vt,Bt,Ut]=[ae,Ee,0]:w>=60&&w<120?[vt,Bt,Ut]=[Ee,ae,0]:w>=120&&w<180?[vt,Bt,Ut]=[0,ae,Ee]:w>=180&&w<240?[vt,Bt,Ut]=[0,Ee,ae]:w>=240&&w<300?[vt,Bt,Ut]=[Ee,0,ae]:[vt,Bt,Ut]=[ae,0,Ee],[(vt+dt)*255,(Bt+dt)*255,(Ut+dt)*255]}function T(g,l,p){const w=p+l*(100-Math.abs(2*p-100))/200;return[g,w!==0?l*(100-Math.abs(2*p-100))/w:0,p+l*(100-Math.abs(2*p-100))/(2*100)]}function v(g,l,p){const w=100-Math.abs(p*(200-l)/100-100);return[g,w!==0?l*p/w:0,p*(200-l)/(2*100)]}function S(g){return[g[0],g[1],g[2]]}function L(g,l){return[g[0],g[1],g[2],l]}const z={hsl:{hsl:(g,l,p)=>[g,l,p],hsv:T,rgb:qd},hsv:{hsl:v,hsv:(g,l,p)=>[g,l,p],rgb:zu},rgb:{hsl:jd,hsv:Xd,rgb:(g,l,p)=>[g,l,p]}};function re(g,l){return[l==="float"?1:g==="rgb"?255:360,l==="float"?1:g==="rgb"?255:100,l==="float"?1:g==="rgb"?255:100]}function ve(g,l){return g===l?l:Mr(g,l)}function Ae(g,l,p){var w;const R=re(l,p);return[l==="rgb"?ci(g[0],0,R[0]):ve(g[0],R[0]),ci(g[1],0,R[1]),ci(g[2],0,R[2]),ci((w=g[3])!==null&&w!==void 0?w:1,0,1)]}function Rt(g,l,p,w){const R=re(l,p),W=re(l,w);return g.map((ae,Ee)=>ae/R[Ee]*W[Ee])}function fn(g,l,p){const w=Rt(g,l.mode,l.type,"int"),R=z[l.mode][p.mode](...w);return Rt(R,p.mode,"int",p.type)}function mn(g,l){return typeof g!="object"||c(g)?!1:l in g&&typeof g[l]=="number"}class Et{static black(l="int"){return new Et([0,0,0],"rgb",l)}static fromObject(l,p="int"){const w="a"in l?[l.r,l.g,l.b,l.a]:[l.r,l.g,l.b];return new Et(w,"rgb",p)}static toRgbaObject(l,p="int"){return l.toRgbaObject(p)}static isRgbColorObject(l){return mn(l,"r")&&mn(l,"g")&&mn(l,"b")}static isRgbaColorObject(l){return this.isRgbColorObject(l)&&mn(l,"a")}static isColorObject(l){return this.isRgbColorObject(l)}static equals(l,p){if(l.mode!==p.mode)return!1;const w=l.comps_,R=p.comps_;for(let W=0;W<w.length;W++)if(w[W]!==R[W])return!1;return!0}constructor(l,p,w="int"){this.mode=p,this.type=w,this.comps_=Ae(l,p,w)}getComponents(l,p="int"){return L(fn(S(this.comps_),{mode:this.mode,type:this.type},{mode:l??this.mode,type:p}),this.comps_[3])}toRgbaObject(l="int"){const p=this.getComponents("rgb",l);return{r:p[0],g:p[1],b:p[2],a:p[3]}}}const Ss=C("colp");class $d{constructor(l,p){this.alphaViews_=null,this.element=l.createElement("div"),this.element.classList.add(Ss()),p.viewProps.bindClassModifiers(this.element);const w=l.createElement("div");w.classList.add(Ss("hsv"));const R=l.createElement("div");R.classList.add(Ss("sv")),this.svPaletteView_=p.svPaletteView,R.appendChild(this.svPaletteView_.element),w.appendChild(R);const W=l.createElement("div");W.classList.add(Ss("h")),this.hPaletteView_=p.hPaletteView,W.appendChild(this.hPaletteView_.element),w.appendChild(W),this.element.appendChild(w);const ae=l.createElement("div");if(ae.classList.add(Ss("rgb")),this.textView_=p.textView,ae.appendChild(this.textView_.element),this.element.appendChild(ae),p.alphaViews){this.alphaViews_={palette:p.alphaViews.palette,text:p.alphaViews.text};const Ee=l.createElement("div");Ee.classList.add(Ss("a"));const dt=l.createElement("div");dt.classList.add(Ss("ap")),dt.appendChild(this.alphaViews_.palette.element),Ee.appendChild(dt);const vt=l.createElement("div");vt.classList.add(Ss("at")),vt.appendChild(this.alphaViews_.text.element),Ee.appendChild(vt),this.element.appendChild(Ee)}}get allFocusableElements(){const l=[this.svPaletteView_.element,this.hPaletteView_.element,this.textView_.modeSelectElement,...this.textView_.textViews.map(p=>p.inputElement)];return this.alphaViews_&&l.push(this.alphaViews_.palette.element,this.alphaViews_.text.inputElement),l}}function Xw(g){return g==="int"?"int":g==="float"?"float":void 0}function Yd(g){const l=le;return be(g,{alpha:l.optional.boolean,color:l.optional.object({alpha:l.optional.boolean,type:l.optional.custom(Xw)}),expanded:l.optional.boolean,picker:l.optional.custom(ql)})}function fo(g){return g?.1:1}function mo(g){var l;return(l=g.color)===null||l===void 0?void 0:l.type}function $w(g,l){return g.alpha===l.alpha&&g.mode===l.mode&&g.notation===l.notation&&g.type===l.type}function $n(g,l){const p=g.match(/^(.+)%$/);return Math.min(p?parseFloat(p[1])*.01*l:parseFloat(g),l)}const Yw={deg:g=>g,grad:g=>g*360/400,rad:g=>g*360/(2*Math.PI),turn:g=>g*360};function vg(g){const l=g.match(/^([0-9.]+?)(deg|grad|rad|turn)$/);if(!l)return parseFloat(g);const p=parseFloat(l[1]),w=l[2];return Yw[w](p)}function bg(g){const l=g.match(/^rgb\(\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*\)$/);if(!l)return null;const p=[$n(l[1],255),$n(l[2],255),$n(l[3],255)];return isNaN(p[0])||isNaN(p[1])||isNaN(p[2])?null:p}function xg(g){return l=>{const p=bg(l);return p?new Et(p,"rgb",g):null}}function wg(g){const l=g.match(/^rgba\(\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*\)$/);if(!l)return null;const p=[$n(l[1],255),$n(l[2],255),$n(l[3],255),$n(l[4],1)];return isNaN(p[0])||isNaN(p[1])||isNaN(p[2])||isNaN(p[3])?null:p}function yg(g){return l=>{const p=wg(l);return p?new Et(p,"rgb",g):null}}function Sg(g){const l=g.match(/^hsl\(\s*([0-9A-Fa-f.]+(?:deg|grad|rad|turn)?)\s*,\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*\)$/);if(!l)return null;const p=[vg(l[1]),$n(l[2],100),$n(l[3],100)];return isNaN(p[0])||isNaN(p[1])||isNaN(p[2])?null:p}function Mg(g){return l=>{const p=Sg(l);return p?new Et(p,"hsl",g):null}}function Tg(g){const l=g.match(/^hsla\(\s*([0-9A-Fa-f.]+(?:deg|grad|rad|turn)?)\s*,\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*\)$/);if(!l)return null;const p=[vg(l[1]),$n(l[2],100),$n(l[3],100),$n(l[4],1)];return isNaN(p[0])||isNaN(p[1])||isNaN(p[2])||isNaN(p[3])?null:p}function Eg(g){return l=>{const p=Tg(l);return p?new Et(p,"hsl",g):null}}function Cg(g){const l=g.match(/^#([0-9A-Fa-f])([0-9A-Fa-f])([0-9A-Fa-f])$/);if(l)return[parseInt(l[1]+l[1],16),parseInt(l[2]+l[2],16),parseInt(l[3]+l[3],16)];const p=g.match(/^(?:#|0x)([0-9A-Fa-f]{2})([0-9A-Fa-f]{2})([0-9A-Fa-f]{2})$/);return p?[parseInt(p[1],16),parseInt(p[2],16),parseInt(p[3],16)]:null}function Kw(g){const l=Cg(g);return l?new Et(l,"rgb","int"):null}function Dg(g){const l=g.match(/^#?([0-9A-Fa-f])([0-9A-Fa-f])([0-9A-Fa-f])([0-9A-Fa-f])$/);if(l)return[parseInt(l[1]+l[1],16),parseInt(l[2]+l[2],16),parseInt(l[3]+l[3],16),jt(parseInt(l[4]+l[4],16),0,255,0,1)];const p=g.match(/^(?:#|0x)?([0-9A-Fa-f]{2})([0-9A-Fa-f]{2})([0-9A-Fa-f]{2})([0-9A-Fa-f]{2})$/);return p?[parseInt(p[1],16),parseInt(p[2],16),parseInt(p[3],16),jt(parseInt(p[4],16),0,255,0,1)]:null}function Zw(g){const l=Dg(g);return l?new Et(l,"rgb","int"):null}function Pg(g){const l=g.match(/^\{\s*r\s*:\s*([0-9A-Fa-f.]+%?)\s*,\s*g\s*:\s*([0-9A-Fa-f.]+%?)\s*,\s*b\s*:\s*([0-9A-Fa-f.]+%?)\s*\}$/);if(!l)return null;const p=[parseFloat(l[1]),parseFloat(l[2]),parseFloat(l[3])];return isNaN(p[0])||isNaN(p[1])||isNaN(p[2])?null:p}function Ag(g){return l=>{const p=Pg(l);return p?new Et(p,"rgb",g):null}}function Lg(g){const l=g.match(/^\{\s*r\s*:\s*([0-9A-Fa-f.]+%?)\s*,\s*g\s*:\s*([0-9A-Fa-f.]+%?)\s*,\s*b\s*:\s*([0-9A-Fa-f.]+%?)\s*,\s*a\s*:\s*([0-9A-Fa-f.]+%?)\s*\}$/);if(!l)return null;const p=[parseFloat(l[1]),parseFloat(l[2]),parseFloat(l[3]),parseFloat(l[4])];return isNaN(p[0])||isNaN(p[1])||isNaN(p[2])||isNaN(p[3])?null:p}function Rg(g){return l=>{const p=Lg(l);return p?new Et(p,"rgb",g):null}}const Jw=[{parser:Cg,result:{alpha:!1,mode:"rgb",notation:"hex"}},{parser:Dg,result:{alpha:!0,mode:"rgb",notation:"hex"}},{parser:bg,result:{alpha:!1,mode:"rgb",notation:"func"}},{parser:wg,result:{alpha:!0,mode:"rgb",notation:"func"}},{parser:Sg,result:{alpha:!1,mode:"hsl",notation:"func"}},{parser:Tg,result:{alpha:!0,mode:"hsl",notation:"func"}},{parser:Pg,result:{alpha:!1,mode:"rgb",notation:"object"}},{parser:Lg,result:{alpha:!0,mode:"rgb",notation:"object"}}];function Qw(g){return Jw.reduce((l,{parser:p,result:w})=>l||(p(g)?w:null),null)}function Kd(g,l="int"){const p=Qw(g);return p?p.notation==="hex"&&l!=="float"?Object.assign(Object.assign({},p),{type:"int"}):p.notation==="func"?Object.assign(Object.assign({},p),{type:l}):null:null}const kg={int:[Kw,Zw,xg("int"),yg("int"),Mg("int"),Eg("int"),Ag("int"),Rg("int")],float:[xg("float"),yg("float"),Mg("float"),Eg("float"),Ag("float"),Rg("float")]};function ey(g){const l=kg[g];return p=>{if(typeof p!="string")return Et.black(g);const w=l.reduce((R,W)=>R||W(p),null);return w??Et.black(g)}}function Zd(g){const l=kg[g];return p=>l.reduce((w,R)=>w||R(p),null)}function Ig(g){const l=ci(Math.floor(g),0,255).toString(16);return l.length===1?`0${l}`:l}function Fg(g,l="#"){const p=S(g.getComponents("rgb")).map(Ig).join("");return`${l}${p}`}function Jd(g,l="#"){const p=g.getComponents("rgb"),w=[p[0],p[1],p[2],p[3]*255].map(Ig).join("");return`${l}${w}`}function Og(g,l){const p=fi(l==="float"?2:0);return`rgb(${S(g.getComponents("rgb",l)).map(R=>p(R)).join(", ")})`}function ty(g){return l=>Og(l,g)}function Uu(g,l){const p=fi(2),w=fi(l==="float"?2:0);return`rgba(${g.getComponents("rgb",l).map((W,ae)=>(ae===3?p:w)(W)).join(", ")})`}function iy(g){return l=>Uu(l,g)}function ny(g){const l=[fi(0),oo,oo];return`hsl(${S(g.getComponents("hsl")).map((w,R)=>l[R](w)).join(", ")})`}function sy(g){const l=[fi(0),oo,oo,fi(2)];return`hsla(${g.getComponents("hsl").map((w,R)=>l[R](w)).join(", ")})`}function Ng(g,l){const p=fi(l==="float"?2:0),w=["r","g","b"];return`{${S(g.getComponents("rgb",l)).map((W,ae)=>`${w[ae]}: ${p(W)}`).join(", ")}}`}function ry(g){return l=>Ng(l,g)}function Bg(g,l){const p=fi(2),w=fi(l==="float"?2:0),R=["r","g","b","a"];return`{${g.getComponents("rgb",l).map((ae,Ee)=>{const dt=Ee===3?p:w;return`${R[Ee]}: ${dt(ae)}`}).join(", ")}}`}function oy(g){return l=>Bg(l,g)}const ay=[{format:{alpha:!1,mode:"rgb",notation:"hex",type:"int"},stringifier:Fg},{format:{alpha:!0,mode:"rgb",notation:"hex",type:"int"},stringifier:Jd},{format:{alpha:!1,mode:"hsl",notation:"func",type:"int"},stringifier:ny},{format:{alpha:!0,mode:"hsl",notation:"func",type:"int"},stringifier:sy},...["int","float"].reduce((g,l)=>[...g,{format:{alpha:!1,mode:"rgb",notation:"func",type:l},stringifier:ty(l)},{format:{alpha:!0,mode:"rgb",notation:"func",type:l},stringifier:iy(l)},{format:{alpha:!1,mode:"rgb",notation:"object",type:l},stringifier:ry(l)},{format:{alpha:!0,mode:"rgb",notation:"object",type:l},stringifier:oy(l)}],[])];function Qd(g){return ay.reduce((l,p)=>l||($w(p.format,g)?p.stringifier:null),null)}const Yl=C("apl");class ly{constructor(l,p){this.onValueChange_=this.onValueChange_.bind(this),this.value=p.value,this.value.emitter.on("change",this.onValueChange_),this.element=l.createElement("div"),this.element.classList.add(Yl()),p.viewProps.bindClassModifiers(this.element),p.viewProps.bindTabIndex(this.element);const w=l.createElement("div");w.classList.add(Yl("b")),this.element.appendChild(w);const R=l.createElement("div");R.classList.add(Yl("c")),w.appendChild(R),this.colorElem_=R;const W=l.createElement("div");W.classList.add(Yl("m")),this.element.appendChild(W),this.markerElem_=W;const ae=l.createElement("div");ae.classList.add(Yl("p")),this.markerElem_.appendChild(ae),this.previewElem_=ae,this.update_()}update_(){const l=this.value.rawValue,p=l.getComponents("rgb"),w=new Et([p[0],p[1],p[2],0],"rgb"),R=new Et([p[0],p[1],p[2],255],"rgb"),W=["to right",Uu(w),Uu(R)];this.colorElem_.style.background=`linear-gradient(${W.join(",")})`,this.previewElem_.style.backgroundColor=Uu(l);const ae=jt(p[3],0,1,0,100);this.markerElem_.style.left=`${ae}%`}onValueChange_(){this.update_()}}class cy{constructor(l,p){this.onKeyDown_=this.onKeyDown_.bind(this),this.onKeyUp_=this.onKeyUp_.bind(this),this.onPointerDown_=this.onPointerDown_.bind(this),this.onPointerMove_=this.onPointerMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.value=p.value,this.viewProps=p.viewProps,this.view=new ly(l,{value:this.value,viewProps:this.viewProps}),this.ptHandler_=new Hs(this.view.element),this.ptHandler_.emitter.on("down",this.onPointerDown_),this.ptHandler_.emitter.on("move",this.onPointerMove_),this.ptHandler_.emitter.on("up",this.onPointerUp_),this.view.element.addEventListener("keydown",this.onKeyDown_),this.view.element.addEventListener("keyup",this.onKeyUp_)}handlePointerEvent_(l,p){if(!l.point)return;const w=l.point.x/l.bounds.width,R=this.value.rawValue,[W,ae,Ee]=R.getComponents("hsv");this.value.setRawValue(new Et([W,ae,Ee,w],"hsv"),p)}onPointerDown_(l){this.handlePointerEvent_(l.data,{forceEmit:!1,last:!1})}onPointerMove_(l){this.handlePointerEvent_(l.data,{forceEmit:!1,last:!1})}onPointerUp_(l){this.handlePointerEvent_(l.data,{forceEmit:!0,last:!0})}onKeyDown_(l){const p=Ei(fo(!0),Xn(l));if(p===0)return;const w=this.value.rawValue,[R,W,ae,Ee]=w.getComponents("hsv");this.value.setRawValue(new Et([R,W,ae,Ee+p],"hsv"),{forceEmit:!1,last:!1})}onKeyUp_(l){Ei(fo(!0),Xn(l))!==0&&this.value.setRawValue(this.value.rawValue,{forceEmit:!0,last:!0})}}const ga=C("coltxt");function uy(g){const l=g.createElement("select"),p=[{text:"RGB",value:"rgb"},{text:"HSL",value:"hsl"},{text:"HSV",value:"hsv"}];return l.appendChild(p.reduce((w,R)=>{const W=g.createElement("option");return W.textContent=R.text,W.value=R.value,w.appendChild(W),w},g.createDocumentFragment())),l}class hy{constructor(l,p){this.element=l.createElement("div"),this.element.classList.add(ga()),p.viewProps.bindClassModifiers(this.element);const w=l.createElement("div");w.classList.add(ga("m")),this.modeElem_=uy(l),this.modeElem_.classList.add(ga("ms")),w.appendChild(this.modeSelectElement),p.viewProps.bindDisabled(this.modeElem_);const R=l.createElement("div");R.classList.add(ga("mm")),R.appendChild(fe(l,"dropdown")),w.appendChild(R),this.element.appendChild(w);const W=l.createElement("div");W.classList.add(ga("w")),this.element.appendChild(W),this.textsElem_=W,this.textViews_=p.textViews,this.applyTextViews_(),F(p.colorMode,ae=>{this.modeElem_.value=ae})}get modeSelectElement(){return this.modeElem_}get textViews(){return this.textViews_}set textViews(l){this.textViews_=l,this.applyTextViews_()}applyTextViews_(){Se(this.textsElem_);const l=this.element.ownerDocument;this.textViews_.forEach(p=>{const w=l.createElement("div");w.classList.add(ga("c")),w.appendChild(p.element),this.textsElem_.appendChild(w)})}}function dy(g){return fi(g==="float"?2:0)}function py(g,l,p){const w=re(g,l)[p];return new wr({min:0,max:w})}function ep(g,l,p){return new lo(g,{arrayPosition:p===0?"fst":p===3-1?"lst":"mid",baseStep:fo(!1),parser:l.parser,props:V.fromObject({draggingScale:l.colorType==="float"?.01:1,formatter:dy(l.colorType)}),value:ee(0,{constraint:py(l.colorMode,l.colorType,p)}),viewProps:l.viewProps})}class fy{constructor(l,p){this.onModeSelectChange_=this.onModeSelectChange_.bind(this),this.colorType_=p.colorType,this.parser_=p.parser,this.value=p.value,this.viewProps=p.viewProps,this.colorMode=ee(this.value.rawValue.mode),this.ccs_=this.createComponentControllers_(l),this.view=new hy(l,{colorMode:this.colorMode,textViews:[this.ccs_[0].view,this.ccs_[1].view,this.ccs_[2].view],viewProps:this.viewProps}),this.view.modeSelectElement.addEventListener("change",this.onModeSelectChange_)}createComponentControllers_(l){const p={colorMode:this.colorMode.rawValue,colorType:this.colorType_,parser:this.parser_,viewProps:this.viewProps},w=[ep(l,p,0),ep(l,p,1),ep(l,p,2)];return w.forEach((R,W)=>{Sr({primary:this.value,secondary:R.value,forward:ae=>ae.rawValue.getComponents(this.colorMode.rawValue,this.colorType_)[W],backward:(ae,Ee)=>{const dt=this.colorMode.rawValue,vt=ae.rawValue.getComponents(dt,this.colorType_);return vt[W]=Ee.rawValue,new Et(L(S(vt),vt[3]),dt,this.colorType_)}})}),w}onModeSelectChange_(l){const p=l.currentTarget;this.colorMode.rawValue=p.value,this.ccs_=this.createComponentControllers_(this.view.element.ownerDocument),this.view.textViews=[this.ccs_[0].view,this.ccs_[1].view,this.ccs_[2].view]}}const tp=C("hpl");class my{constructor(l,p){this.onValueChange_=this.onValueChange_.bind(this),this.value=p.value,this.value.emitter.on("change",this.onValueChange_),this.element=l.createElement("div"),this.element.classList.add(tp()),p.viewProps.bindClassModifiers(this.element),p.viewProps.bindTabIndex(this.element);const w=l.createElement("div");w.classList.add(tp("c")),this.element.appendChild(w);const R=l.createElement("div");R.classList.add(tp("m")),this.element.appendChild(R),this.markerElem_=R,this.update_()}update_(){const l=this.value.rawValue,[p]=l.getComponents("hsv");this.markerElem_.style.backgroundColor=Og(new Et([p,100,100],"hsv"));const w=jt(p,0,360,0,100);this.markerElem_.style.left=`${w}%`}onValueChange_(){this.update_()}}class gy{constructor(l,p){this.onKeyDown_=this.onKeyDown_.bind(this),this.onKeyUp_=this.onKeyUp_.bind(this),this.onPointerDown_=this.onPointerDown_.bind(this),this.onPointerMove_=this.onPointerMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.value=p.value,this.viewProps=p.viewProps,this.view=new my(l,{value:this.value,viewProps:this.viewProps}),this.ptHandler_=new Hs(this.view.element),this.ptHandler_.emitter.on("down",this.onPointerDown_),this.ptHandler_.emitter.on("move",this.onPointerMove_),this.ptHandler_.emitter.on("up",this.onPointerUp_),this.view.element.addEventListener("keydown",this.onKeyDown_),this.view.element.addEventListener("keyup",this.onKeyUp_)}handlePointerEvent_(l,p){if(!l.point)return;const w=jt(ci(l.point.x,0,l.bounds.width),0,l.bounds.width,0,360),R=this.value.rawValue,[,W,ae,Ee]=R.getComponents("hsv");this.value.setRawValue(new Et([w,W,ae,Ee],"hsv"),p)}onPointerDown_(l){this.handlePointerEvent_(l.data,{forceEmit:!1,last:!1})}onPointerMove_(l){this.handlePointerEvent_(l.data,{forceEmit:!1,last:!1})}onPointerUp_(l){this.handlePointerEvent_(l.data,{forceEmit:!0,last:!0})}onKeyDown_(l){const p=Ei(fo(!1),Xn(l));if(p===0)return;const w=this.value.rawValue,[R,W,ae,Ee]=w.getComponents("hsv");this.value.setRawValue(new Et([R+p,W,ae,Ee],"hsv"),{forceEmit:!1,last:!1})}onKeyUp_(l){Ei(fo(!1),Xn(l))!==0&&this.value.setRawValue(this.value.rawValue,{forceEmit:!0,last:!0})}}const ip=C("svp"),Vg=64;class _y{constructor(l,p){this.onValueChange_=this.onValueChange_.bind(this),this.value=p.value,this.value.emitter.on("change",this.onValueChange_),this.element=l.createElement("div"),this.element.classList.add(ip()),p.viewProps.bindClassModifiers(this.element),p.viewProps.bindTabIndex(this.element);const w=l.createElement("canvas");w.height=Vg,w.width=Vg,w.classList.add(ip("c")),this.element.appendChild(w),this.canvasElement=w;const R=l.createElement("div");R.classList.add(ip("m")),this.element.appendChild(R),this.markerElem_=R,this.update_()}update_(){const l=G(this.canvasElement);if(!l)return;const w=this.value.rawValue.getComponents("hsv"),R=this.canvasElement.width,W=this.canvasElement.height,ae=l.getImageData(0,0,R,W),Ee=ae.data;for(let Bt=0;Bt<W;Bt++)for(let Ut=0;Ut<R;Ut++){const go=jt(Ut,0,R,0,100),Zl=jt(Bt,0,W,100,0),Jl=zu(w[0],go,Zl),Gu=(Bt*R+Ut)*4;Ee[Gu]=Jl[0],Ee[Gu+1]=Jl[1],Ee[Gu+2]=Jl[2],Ee[Gu+3]=255}l.putImageData(ae,0,0);const dt=jt(w[1],0,100,0,100);this.markerElem_.style.left=`${dt}%`;const vt=jt(w[2],0,100,100,0);this.markerElem_.style.top=`${vt}%`}onValueChange_(){this.update_()}}class vy{constructor(l,p){this.onKeyDown_=this.onKeyDown_.bind(this),this.onKeyUp_=this.onKeyUp_.bind(this),this.onPointerDown_=this.onPointerDown_.bind(this),this.onPointerMove_=this.onPointerMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.value=p.value,this.viewProps=p.viewProps,this.view=new _y(l,{value:this.value,viewProps:this.viewProps}),this.ptHandler_=new Hs(this.view.element),this.ptHandler_.emitter.on("down",this.onPointerDown_),this.ptHandler_.emitter.on("move",this.onPointerMove_),this.ptHandler_.emitter.on("up",this.onPointerUp_),this.view.element.addEventListener("keydown",this.onKeyDown_),this.view.element.addEventListener("keyup",this.onKeyUp_)}handlePointerEvent_(l,p){if(!l.point)return;const w=jt(l.point.x,0,l.bounds.width,0,100),R=jt(l.point.y,0,l.bounds.height,100,0),[W,,,ae]=this.value.rawValue.getComponents("hsv");this.value.setRawValue(new Et([W,w,R,ae],"hsv"),p)}onPointerDown_(l){this.handlePointerEvent_(l.data,{forceEmit:!1,last:!1})}onPointerMove_(l){this.handlePointerEvent_(l.data,{forceEmit:!1,last:!1})}onPointerUp_(l){this.handlePointerEvent_(l.data,{forceEmit:!0,last:!0})}onKeyDown_(l){da(l.key)&&l.preventDefault();const[p,w,R,W]=this.value.rawValue.getComponents("hsv"),ae=fo(!1),Ee=Ei(ae,Xn(l)),dt=Ei(ae,ao(l));Ee===0&&dt===0||this.value.setRawValue(new Et([p,w+Ee,R+dt,W],"hsv"),{forceEmit:!1,last:!1})}onKeyUp_(l){const p=fo(!1),w=Ei(p,Xn(l)),R=Ei(p,ao(l));w===0&&R===0||this.value.setRawValue(this.value.rawValue,{forceEmit:!0,last:!0})}}class by{constructor(l,p){this.value=p.value,this.viewProps=p.viewProps,this.hPaletteC_=new gy(l,{value:this.value,viewProps:this.viewProps}),this.svPaletteC_=new vy(l,{value:this.value,viewProps:this.viewProps}),this.alphaIcs_=p.supportsAlpha?{palette:new cy(l,{value:this.value,viewProps:this.viewProps}),text:new lo(l,{parser:qn,baseStep:.1,props:V.fromObject({draggingScale:.01,formatter:fi(2)}),value:ee(0,{constraint:new wr({min:0,max:1})}),viewProps:this.viewProps})}:null,this.alphaIcs_&&Sr({primary:this.value,secondary:this.alphaIcs_.text.value,forward:w=>w.rawValue.getComponents()[3],backward:(w,R)=>{const W=w.rawValue.getComponents();return W[3]=R.rawValue,new Et(W,w.rawValue.mode)}}),this.textC_=new fy(l,{colorType:p.colorType,parser:qn,value:this.value,viewProps:this.viewProps}),this.view=new $d(l,{alphaViews:this.alphaIcs_?{palette:this.alphaIcs_.palette.view,text:this.alphaIcs_.text.view}:null,hPaletteView:this.hPaletteC_.view,supportsAlpha:p.supportsAlpha,svPaletteView:this.svPaletteC_.view,textView:this.textC_.view,viewProps:this.viewProps})}get textController(){return this.textC_}}const np=C("colsw");class xy{constructor(l,p){this.onValueChange_=this.onValueChange_.bind(this),p.value.emitter.on("change",this.onValueChange_),this.value=p.value,this.element=l.createElement("div"),this.element.classList.add(np()),p.viewProps.bindClassModifiers(this.element);const w=l.createElement("div");w.classList.add(np("sw")),this.element.appendChild(w),this.swatchElem_=w;const R=l.createElement("button");R.classList.add(np("b")),p.viewProps.bindDisabled(R),this.element.appendChild(R),this.buttonElement=R,this.update_()}update_(){const l=this.value.rawValue;this.swatchElem_.style.backgroundColor=Jd(l)}onValueChange_(){this.update_()}}class wy{constructor(l,p){this.value=p.value,this.viewProps=p.viewProps,this.view=new xy(l,{value:this.value,viewProps:this.viewProps})}}class sp{constructor(l,p){this.onButtonBlur_=this.onButtonBlur_.bind(this),this.onButtonClick_=this.onButtonClick_.bind(this),this.onPopupChildBlur_=this.onPopupChildBlur_.bind(this),this.onPopupChildKeydown_=this.onPopupChildKeydown_.bind(this),this.value=p.value,this.viewProps=p.viewProps,this.foldable_=ht.create(p.expanded),this.swatchC_=new wy(l,{value:this.value,viewProps:this.viewProps});const w=this.swatchC_.view.buttonElement;w.addEventListener("blur",this.onButtonBlur_),w.addEventListener("click",this.onButtonClick_),this.textC_=new ua(l,{parser:p.parser,props:V.fromObject({formatter:p.formatter}),value:this.value,viewProps:this.viewProps}),this.view=new $l(l,{foldable:this.foldable_,pickerLayout:p.pickerLayout}),this.view.swatchElement.appendChild(this.swatchC_.view.element),this.view.textElement.appendChild(this.textC_.view.element),this.popC_=p.pickerLayout==="popup"?new Mu(l,{viewProps:this.viewProps}):null;const R=new by(l,{colorType:p.colorType,supportsAlpha:p.supportsAlpha,value:this.value,viewProps:this.viewProps});R.view.allFocusableElements.forEach(W=>{W.addEventListener("blur",this.onPopupChildBlur_),W.addEventListener("keydown",this.onPopupChildKeydown_)}),this.pickerC_=R,this.popC_?(this.view.element.appendChild(this.popC_.view.element),this.popC_.view.element.appendChild(R.view.element),Sr({primary:this.foldable_.value("expanded"),secondary:this.popC_.shows,forward:W=>W.rawValue,backward:(W,ae)=>ae.rawValue})):this.view.pickerElement&&(this.view.pickerElement.appendChild(this.pickerC_.view.element),ge(this.foldable_,this.view.pickerElement))}get textController(){return this.textC_}onButtonBlur_(l){if(!this.popC_)return;const p=this.view.element,w=l.relatedTarget;(!w||!p.contains(w))&&(this.popC_.shows.rawValue=!1)}onButtonClick_(){this.foldable_.set("expanded",!this.foldable_.get("expanded")),this.foldable_.get("expanded")&&this.pickerC_.view.allFocusableElements[0].focus()}onPopupChildBlur_(l){if(!this.popC_)return;const p=this.popC_.view.element,w=H(l);w&&p.contains(w)||w&&w===this.swatchC_.view.buttonElement&&!_t(p.ownerDocument)||(this.popC_.shows.rawValue=!1)}onPopupChildKeydown_(l){this.popC_?l.key==="Escape"&&(this.popC_.shows.rawValue=!1):this.view.pickerElement&&l.key==="Escape"&&this.swatchC_.view.buttonElement.focus()}}function yy(g,l){return Et.isColorObject(g)?Et.fromObject(g,l):Et.black(l)}function Sy(g){return S(g.getComponents("rgb")).reduce((l,p)=>l<<8|Math.floor(p)&255,0)}function My(g){return g.getComponents("rgb").reduce((l,p,w)=>{const R=Math.floor(w===3?p*255:p)&255;return l<<8|R},0)>>>0}function Ty(g){return new Et([g>>16&255,g>>8&255,g&255],"rgb")}function Ey(g){return new Et([g>>24&255,g>>16&255,g>>8&255,jt(g&255,0,255,0,1)],"rgb")}function Cy(g){return typeof g!="number"?Et.black():Ty(g)}function Dy(g){return typeof g!="number"?Et.black():Ey(g)}function Py(g){const l=Qd(g);return l?(p,w)=>{Dn(p,l(w))}:null}function Ay(g){const l=g?My:Sy;return(p,w)=>{Dn(p,l(w))}}function Ly(g,l,p){const w=l.toRgbaObject(p);g.writeProperty("r",w.r),g.writeProperty("g",w.g),g.writeProperty("b",w.b),g.writeProperty("a",w.a)}function Ry(g,l,p){const w=l.toRgbaObject(p);g.writeProperty("r",w.r),g.writeProperty("g",w.g),g.writeProperty("b",w.b)}function ky(g,l){return(p,w)=>{g?Ly(p,w,l):Ry(p,w,l)}}function rp(g){var l;return!!(g!=null&&g.alpha||!((l=g==null?void 0:g.color)===null||l===void 0)&&l.alpha)}function Iy(g){return g?l=>Jd(l,"0x"):l=>Fg(l,"0x")}function Fy(g){return"color"in g||"view"in g&&g.view==="color"}const Oy={id:"input-color-number",type:"input",accept:(g,l)=>{if(typeof g!="number"||!Fy(l))return null;const p=Yd(l);return p?{initialValue:g,params:p}:null},binding:{reader:g=>rp(g.params)?Dy:Cy,equals:Et.equals,writer:g=>Ay(rp(g.params))},controller:g=>{const l=rp(g.params),p="expanded"in g.params?g.params.expanded:void 0,w="picker"in g.params?g.params.picker:void 0;return new sp(g.document,{colorType:"int",expanded:p??!1,formatter:Iy(l),parser:Zd("int"),pickerLayout:w??"popup",supportsAlpha:l,value:g.value,viewProps:g.viewProps})}};function Ny(g){return Et.isRgbaColorObject(g)}function By(g){return l=>yy(l,g)}function Vy(g,l){return p=>g?Bg(p,l):Ng(p,l)}const zy={id:"input-color-object",type:"input",accept:(g,l)=>{if(!Et.isColorObject(g))return null;const p=Yd(l);return p?{initialValue:g,params:p}:null},binding:{reader:g=>By(mo(g.params)),equals:Et.equals,writer:g=>ky(Ny(g.initialValue),mo(g.params))},controller:g=>{var l;const p=Et.isRgbaColorObject(g.initialValue),w="expanded"in g.params?g.params.expanded:void 0,R="picker"in g.params?g.params.picker:void 0,W=(l=mo(g.params))!==null&&l!==void 0?l:"int";return new sp(g.document,{colorType:W,expanded:w??!1,formatter:Vy(p,W),parser:Zd(W),pickerLayout:R??"popup",supportsAlpha:p,value:g.value,viewProps:g.viewProps})}},Uy={id:"input-color-string",type:"input",accept:(g,l)=>{if(typeof g!="string"||"view"in l&&l.view==="text")return null;const p=Kd(g,mo(l));if(!p||!Qd(p))return null;const R=Yd(l);return R?{initialValue:g,params:R}:null},binding:{reader:g=>{var l;return ey((l=mo(g.params))!==null&&l!==void 0?l:"int")},equals:Et.equals,writer:g=>{const l=Kd(g.initialValue,mo(g.params));if(!l)throw _.shouldNeverHappen();const p=Py(l);if(!p)throw _.notBindable();return p}},controller:g=>{const l=Kd(g.initialValue,mo(g.params));if(!l)throw _.shouldNeverHappen();const p=Qd(l);if(!p)throw _.shouldNeverHappen();const w="expanded"in g.params?g.params.expanded:void 0,R="picker"in g.params?g.params.picker:void 0;return new sp(g.document,{colorType:l.type,expanded:w??!1,formatter:p,parser:Zd(l.type),pickerLayout:R??"popup",supportsAlpha:l.alpha,value:g.value,viewProps:g.viewProps})}};class Tr{constructor(l){this.components=l.components,this.asm_=l.assembly}constrain(l){const p=this.asm_.toComponents(l).map((w,R)=>{var W,ae;return(ae=(W=this.components[R])===null||W===void 0?void 0:W.constrain(w))!==null&&ae!==void 0?ae:w});return this.asm_.fromComponents(p)}}const zg=C("pndtxt");class Gy{constructor(l,p){this.textViews=p.textViews,this.element=l.createElement("div"),this.element.classList.add(zg()),this.textViews.forEach(w=>{const R=l.createElement("div");R.classList.add(zg("a")),R.appendChild(w.element),this.element.appendChild(R)})}}function Hy(g,l,p){return new lo(g,{arrayPosition:p===0?"fst":p===l.axes.length-1?"lst":"mid",baseStep:l.axes[p].baseStep,parser:l.parser,props:l.axes[p].textProps,value:ee(0,{constraint:l.axes[p].constraint}),viewProps:l.viewProps})}class op{constructor(l,p){this.value=p.value,this.viewProps=p.viewProps,this.acs_=p.axes.map((w,R)=>Hy(l,p,R)),this.acs_.forEach((w,R)=>{Sr({primary:this.value,secondary:w.value,forward:W=>p.assembly.toComponents(W.rawValue)[R],backward:(W,ae)=>{const Ee=p.assembly.toComponents(W.rawValue);return Ee[R]=ae.rawValue,p.assembly.fromComponents(Ee)}})}),this.view=new Gy(l,{textViews:this.acs_.map(w=>w.view)})}}function Ug(g,l){return"step"in g&&!c(g.step)?new ca(g.step,l):null}function Gg(g){return!c(g.max)&&!c(g.min)?new wr({max:g.max,min:g.min}):!c(g.max)||!c(g.min)?new kl({max:g.max,min:g.min}):null}function Wy(g){const l=Cn(g,wr);if(l)return[l.values.get("min"),l.values.get("max")];const p=Cn(g,kl);return p?[p.minValue,p.maxValue]:[void 0,void 0]}function jy(g,l){const p=[],w=Ug(g,l);w&&p.push(w);const R=Gg(g);R&&p.push(R);const W=Xl(g.options);return W&&p.push(W),new io(p)}const qy={id:"input-number",type:"input",accept:(g,l)=>{if(typeof g!="number")return null;const p=le,w=be(l,{format:p.optional.function,max:p.optional.number,min:p.optional.number,options:p.optional.custom(uo),step:p.optional.number});return w?{initialValue:g,params:w}:null},binding:{reader:g=>cs,constraint:g=>jy(g.params,g.initialValue),writer:g=>Dn},controller:g=>{var l;const p=g.value,w=g.constraint,R=w&&Cn(w,no);if(R)return new so(g.document,{props:new V({options:R.values.value("options")}),value:p,viewProps:g.viewProps});const W=(l="format"in g.params?g.params.format:void 0)!==null&&l!==void 0?l:fi(fa(w,p.rawValue)),ae=w&&Cn(w,wr);return ae?new pa(g.document,{baseStep:Ws(w),parser:qn,sliderProps:new V({maxValue:ae.values.value("max"),minValue:ae.values.value("min")}),textProps:V.fromObject({draggingScale:js(w,p.rawValue),formatter:W}),value:p,viewProps:g.viewProps}):new lo(g.document,{baseStep:Ws(w),parser:qn,props:V.fromObject({draggingScale:js(w,p.rawValue),formatter:W}),value:p,viewProps:g.viewProps})}};class Er{constructor(l=0,p=0){this.x=l,this.y=p}getComponents(){return[this.x,this.y]}static isObject(l){if(c(l))return!1;const p=l.x,w=l.y;return!(typeof p!="number"||typeof w!="number")}static equals(l,p){return l.x===p.x&&l.y===p.y}toObject(){return{x:this.x,y:this.y}}}const Hg={toComponents:g=>g.getComponents(),fromComponents:g=>new Er(...g)},_a=C("p2d");class Xy{constructor(l,p){this.element=l.createElement("div"),this.element.classList.add(_a()),p.viewProps.bindClassModifiers(this.element),F(p.expanded,O(this.element,_a(void 0,"expanded")));const w=l.createElement("div");w.classList.add(_a("h")),this.element.appendChild(w);const R=l.createElement("button");R.classList.add(_a("b")),R.appendChild(fe(l,"p2dpad")),p.viewProps.bindDisabled(R),w.appendChild(R),this.buttonElement=R;const W=l.createElement("div");if(W.classList.add(_a("t")),w.appendChild(W),this.textElement=W,p.pickerLayout==="inline"){const ae=l.createElement("div");ae.classList.add(_a("p")),this.element.appendChild(ae),this.pickerElement=ae}else this.pickerElement=null}}const Cr=C("p2dp");class $y{constructor(l,p){this.onFoldableChange_=this.onFoldableChange_.bind(this),this.onValueChange_=this.onValueChange_.bind(this),this.invertsY_=p.invertsY,this.maxValue_=p.maxValue,this.element=l.createElement("div"),this.element.classList.add(Cr()),p.layout==="popup"&&this.element.classList.add(Cr(void 0,"p")),p.viewProps.bindClassModifiers(this.element);const w=l.createElement("div");w.classList.add(Cr("p")),p.viewProps.bindTabIndex(w),this.element.appendChild(w),this.padElement=w;const R=l.createElementNS(mt,"svg");R.classList.add(Cr("g")),this.padElement.appendChild(R),this.svgElem_=R;const W=l.createElementNS(mt,"line");W.classList.add(Cr("ax")),W.setAttributeNS(null,"x1","0"),W.setAttributeNS(null,"y1","50%"),W.setAttributeNS(null,"x2","100%"),W.setAttributeNS(null,"y2","50%"),this.svgElem_.appendChild(W);const ae=l.createElementNS(mt,"line");ae.classList.add(Cr("ax")),ae.setAttributeNS(null,"x1","50%"),ae.setAttributeNS(null,"y1","0"),ae.setAttributeNS(null,"x2","50%"),ae.setAttributeNS(null,"y2","100%"),this.svgElem_.appendChild(ae);const Ee=l.createElementNS(mt,"line");Ee.classList.add(Cr("l")),Ee.setAttributeNS(null,"x1","50%"),Ee.setAttributeNS(null,"y1","50%"),this.svgElem_.appendChild(Ee),this.lineElem_=Ee;const dt=l.createElement("div");dt.classList.add(Cr("m")),this.padElement.appendChild(dt),this.markerElem_=dt,p.value.emitter.on("change",this.onValueChange_),this.value=p.value,this.update_()}get allFocusableElements(){return[this.padElement]}update_(){const[l,p]=this.value.rawValue.getComponents(),w=this.maxValue_,R=jt(l,-w,+w,0,100),W=jt(p,-w,+w,0,100),ae=this.invertsY_?100-W:W;this.lineElem_.setAttributeNS(null,"x2",`${R}%`),this.lineElem_.setAttributeNS(null,"y2",`${ae}%`),this.markerElem_.style.left=`${R}%`,this.markerElem_.style.top=`${ae}%`}onValueChange_(){this.update_()}onFoldableChange_(){this.update_()}}function Wg(g,l,p){return[Ei(l[0],Xn(g)),Ei(l[1],ao(g))*(p?1:-1)]}class Yy{constructor(l,p){this.onPadKeyDown_=this.onPadKeyDown_.bind(this),this.onPadKeyUp_=this.onPadKeyUp_.bind(this),this.onPointerDown_=this.onPointerDown_.bind(this),this.onPointerMove_=this.onPointerMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.value=p.value,this.viewProps=p.viewProps,this.baseSteps_=p.baseSteps,this.maxValue_=p.maxValue,this.invertsY_=p.invertsY,this.view=new $y(l,{invertsY:this.invertsY_,layout:p.layout,maxValue:this.maxValue_,value:this.value,viewProps:this.viewProps}),this.ptHandler_=new Hs(this.view.padElement),this.ptHandler_.emitter.on("down",this.onPointerDown_),this.ptHandler_.emitter.on("move",this.onPointerMove_),this.ptHandler_.emitter.on("up",this.onPointerUp_),this.view.padElement.addEventListener("keydown",this.onPadKeyDown_),this.view.padElement.addEventListener("keyup",this.onPadKeyUp_)}handlePointerEvent_(l,p){if(!l.point)return;const w=this.maxValue_,R=jt(l.point.x,0,l.bounds.width,-w,+w),W=jt(this.invertsY_?l.bounds.height-l.point.y:l.point.y,0,l.bounds.height,-w,+w);this.value.setRawValue(new Er(R,W),p)}onPointerDown_(l){this.handlePointerEvent_(l.data,{forceEmit:!1,last:!1})}onPointerMove_(l){this.handlePointerEvent_(l.data,{forceEmit:!1,last:!1})}onPointerUp_(l){this.handlePointerEvent_(l.data,{forceEmit:!0,last:!0})}onPadKeyDown_(l){da(l.key)&&l.preventDefault();const[p,w]=Wg(l,this.baseSteps_,this.invertsY_);p===0&&w===0||this.value.setRawValue(new Er(this.value.rawValue.x+p,this.value.rawValue.y+w),{forceEmit:!1,last:!1})}onPadKeyUp_(l){const[p,w]=Wg(l,this.baseSteps_,this.invertsY_);p===0&&w===0||this.value.setRawValue(this.value.rawValue,{forceEmit:!0,last:!0})}}class Ky{constructor(l,p){var w,R;this.onPopupChildBlur_=this.onPopupChildBlur_.bind(this),this.onPopupChildKeydown_=this.onPopupChildKeydown_.bind(this),this.onPadButtonBlur_=this.onPadButtonBlur_.bind(this),this.onPadButtonClick_=this.onPadButtonClick_.bind(this),this.value=p.value,this.viewProps=p.viewProps,this.foldable_=ht.create(p.expanded),this.popC_=p.pickerLayout==="popup"?new Mu(l,{viewProps:this.viewProps}):null;const W=new Yy(l,{baseSteps:[p.axes[0].baseStep,p.axes[1].baseStep],invertsY:p.invertsY,layout:p.pickerLayout,maxValue:p.maxValue,value:this.value,viewProps:this.viewProps});W.view.allFocusableElements.forEach(ae=>{ae.addEventListener("blur",this.onPopupChildBlur_),ae.addEventListener("keydown",this.onPopupChildKeydown_)}),this.pickerC_=W,this.textC_=new op(l,{assembly:Hg,axes:p.axes,parser:p.parser,value:this.value,viewProps:this.viewProps}),this.view=new Xy(l,{expanded:this.foldable_.value("expanded"),pickerLayout:p.pickerLayout,viewProps:this.viewProps}),this.view.textElement.appendChild(this.textC_.view.element),(w=this.view.buttonElement)===null||w===void 0||w.addEventListener("blur",this.onPadButtonBlur_),(R=this.view.buttonElement)===null||R===void 0||R.addEventListener("click",this.onPadButtonClick_),this.popC_?(this.view.element.appendChild(this.popC_.view.element),this.popC_.view.element.appendChild(this.pickerC_.view.element),Sr({primary:this.foldable_.value("expanded"),secondary:this.popC_.shows,forward:ae=>ae.rawValue,backward:(ae,Ee)=>Ee.rawValue})):this.view.pickerElement&&(this.view.pickerElement.appendChild(this.pickerC_.view.element),ge(this.foldable_,this.view.pickerElement))}onPadButtonBlur_(l){if(!this.popC_)return;const p=this.view.element,w=l.relatedTarget;(!w||!p.contains(w))&&(this.popC_.shows.rawValue=!1)}onPadButtonClick_(){this.foldable_.set("expanded",!this.foldable_.get("expanded")),this.foldable_.get("expanded")&&this.pickerC_.view.allFocusableElements[0].focus()}onPopupChildBlur_(l){if(!this.popC_)return;const p=this.popC_.view.element,w=H(l);w&&p.contains(w)||w&&w===this.view.buttonElement&&!_t(p.ownerDocument)||(this.popC_.shows.rawValue=!1)}onPopupChildKeydown_(l){this.popC_?l.key==="Escape"&&(this.popC_.shows.rawValue=!1):this.view.pickerElement&&l.key==="Escape"&&this.view.buttonElement.focus()}}class va{constructor(l=0,p=0,w=0){this.x=l,this.y=p,this.z=w}getComponents(){return[this.x,this.y,this.z]}static isObject(l){if(c(l))return!1;const p=l.x,w=l.y,R=l.z;return!(typeof p!="number"||typeof w!="number"||typeof R!="number")}static equals(l,p){return l.x===p.x&&l.y===p.y&&l.z===p.z}toObject(){return{x:this.x,y:this.y,z:this.z}}}const jg={toComponents:g=>g.getComponents(),fromComponents:g=>new va(...g)};function Zy(g){return va.isObject(g)?new va(g.x,g.y,g.z):new va}function Jy(g,l){g.writeProperty("x",l.x),g.writeProperty("y",l.y),g.writeProperty("z",l.z)}function Qy(g,l){return new Tr({assembly:jg,components:[Xs("x"in g?g.x:void 0,l.x),Xs("y"in g?g.y:void 0,l.y),Xs("z"in g?g.z:void 0,l.z)]})}function ap(g,l){return{baseStep:Ws(l),constraint:l,textProps:V.fromObject({draggingScale:js(l,g),formatter:fi(fa(l,g))})}}const e1={id:"input-point3d",type:"input",accept:(g,l)=>{if(!va.isObject(g))return null;const p=le,w=be(l,{x:p.optional.custom(us),y:p.optional.custom(us),z:p.optional.custom(us)});return w?{initialValue:g,params:w}:null},binding:{reader:g=>Zy,constraint:g=>Qy(g.params,g.initialValue),equals:va.equals,writer:g=>Jy},controller:g=>{const l=g.value,p=g.constraint;if(!(p instanceof Tr))throw _.shouldNeverHappen();return new op(g.document,{assembly:jg,axes:[ap(l.rawValue.x,p.components[0]),ap(l.rawValue.y,p.components[1]),ap(l.rawValue.z,p.components[2])],parser:qn,value:l,viewProps:g.viewProps})}};class ba{constructor(l=0,p=0,w=0,R=0){this.x=l,this.y=p,this.z=w,this.w=R}getComponents(){return[this.x,this.y,this.z,this.w]}static isObject(l){if(c(l))return!1;const p=l.x,w=l.y,R=l.z,W=l.w;return!(typeof p!="number"||typeof w!="number"||typeof R!="number"||typeof W!="number")}static equals(l,p){return l.x===p.x&&l.y===p.y&&l.z===p.z&&l.w===p.w}toObject(){return{x:this.x,y:this.y,z:this.z,w:this.w}}}const qg={toComponents:g=>g.getComponents(),fromComponents:g=>new ba(...g)};function t1(g){return ba.isObject(g)?new ba(g.x,g.y,g.z,g.w):new ba}function i1(g,l){g.writeProperty("x",l.x),g.writeProperty("y",l.y),g.writeProperty("z",l.z),g.writeProperty("w",l.w)}function n1(g,l){return new Tr({assembly:qg,components:[Xs("x"in g?g.x:void 0,l.x),Xs("y"in g?g.y:void 0,l.y),Xs("z"in g?g.z:void 0,l.z),Xs("w"in g?g.w:void 0,l.w)]})}function s1(g,l){return{baseStep:Ws(l),constraint:l,textProps:V.fromObject({draggingScale:js(l,g),formatter:fi(fa(l,g))})}}const r1={id:"input-point4d",type:"input",accept:(g,l)=>{if(!ba.isObject(g))return null;const p=le,w=be(l,{x:p.optional.custom(us),y:p.optional.custom(us),z:p.optional.custom(us),w:p.optional.custom(us)});return w?{initialValue:g,params:w}:null},binding:{reader:g=>t1,constraint:g=>n1(g.params,g.initialValue),equals:ba.equals,writer:g=>i1},controller:g=>{const l=g.value,p=g.constraint;if(!(p instanceof Tr))throw _.shouldNeverHappen();return new op(g.document,{assembly:qg,axes:l.rawValue.getComponents().map((w,R)=>s1(w,p.components[R])),parser:qn,value:l,viewProps:g.viewProps})}};function o1(g){const l=[],p=Xl(g.options);return p&&l.push(p),new io(l)}const a1={id:"input-string",type:"input",accept:(g,l)=>{if(typeof g!="string")return null;const w=be(l,{options:le.optional.custom(uo)});return w?{initialValue:g,params:w}:null},binding:{reader:g=>Vl,constraint:g=>o1(g.params),writer:g=>Dn},controller:g=>{const l=g.document,p=g.value,w=g.constraint,R=w&&Cn(w,no);return R?new so(l,{props:new V({options:R.values.value("options")}),value:p,viewProps:g.viewProps}):new ua(l,{parser:W=>W,props:V.fromObject({formatter:ys}),value:p,viewProps:g.viewProps})}},Kl={monitor:{defaultInterval:200,defaultLineCount:3}},Xg=C("mll");class l1{constructor(l,p){this.onValueUpdate_=this.onValueUpdate_.bind(this),this.formatter_=p.formatter,this.element=l.createElement("div"),this.element.classList.add(Xg()),p.viewProps.bindClassModifiers(this.element);const w=l.createElement("textarea");w.classList.add(Xg("i")),w.style.height=`calc(var(--bld-us) * ${p.lineCount})`,w.readOnly=!0,p.viewProps.bindDisabled(w),this.element.appendChild(w),this.textareaElem_=w,p.value.emitter.on("change",this.onValueUpdate_),this.value=p.value,this.update_()}update_(){const l=this.textareaElem_,p=l.scrollTop===l.scrollHeight-l.clientHeight,w=[];this.value.rawValue.forEach(R=>{R!==void 0&&w.push(this.formatter_(R))}),l.textContent=w.join(`
`),p&&(l.scrollTop=l.scrollHeight)}onValueUpdate_(){this.update_()}}class lp{constructor(l,p){this.value=p.value,this.viewProps=p.viewProps,this.view=new l1(l,{formatter:p.formatter,lineCount:p.lineCount,value:this.value,viewProps:this.viewProps})}}const $g=C("sgl");class c1{constructor(l,p){this.onValueUpdate_=this.onValueUpdate_.bind(this),this.formatter_=p.formatter,this.element=l.createElement("div"),this.element.classList.add($g()),p.viewProps.bindClassModifiers(this.element);const w=l.createElement("input");w.classList.add($g("i")),w.readOnly=!0,w.type="text",p.viewProps.bindDisabled(w),this.element.appendChild(w),this.inputElement=w,p.value.emitter.on("change",this.onValueUpdate_),this.value=p.value,this.update_()}update_(){const l=this.value.rawValue,p=l[l.length-1];this.inputElement.value=p!==void 0?this.formatter_(p):""}onValueUpdate_(){this.update_()}}class cp{constructor(l,p){this.value=p.value,this.viewProps=p.viewProps,this.view=new c1(l,{formatter:p.formatter,value:this.value,viewProps:this.viewProps})}}const u1={id:"monitor-bool",type:"monitor",accept:(g,l)=>{if(typeof g!="boolean")return null;const w=be(l,{lineCount:le.optional.number});return w?{initialValue:g,params:w}:null},binding:{reader:g=>Eu},controller:g=>{var l;return g.value.rawValue.length===1?new cp(g.document,{formatter:Cu,value:g.value,viewProps:g.viewProps}):new lp(g.document,{formatter:Cu,lineCount:(l=g.params.lineCount)!==null&&l!==void 0?l:Kl.monitor.defaultLineCount,value:g.value,viewProps:g.viewProps})}},Dr=C("grl");class h1{constructor(l,p){this.onCursorChange_=this.onCursorChange_.bind(this),this.onValueUpdate_=this.onValueUpdate_.bind(this),this.element=l.createElement("div"),this.element.classList.add(Dr()),p.viewProps.bindClassModifiers(this.element),this.formatter_=p.formatter,this.props_=p.props,this.cursor_=p.cursor,this.cursor_.emitter.on("change",this.onCursorChange_);const w=l.createElementNS(mt,"svg");w.classList.add(Dr("g")),w.style.height=`calc(var(--bld-us) * ${p.lineCount})`,this.element.appendChild(w),this.svgElem_=w;const R=l.createElementNS(mt,"polyline");this.svgElem_.appendChild(R),this.lineElem_=R;const W=l.createElement("div");W.classList.add(Dr("t"),C("tt")()),this.element.appendChild(W),this.tooltipElem_=W,p.value.emitter.on("change",this.onValueUpdate_),this.value=p.value,this.update_()}get graphElement(){return this.svgElem_}update_(){const l=this.svgElem_.getBoundingClientRect(),p=this.value.rawValue.length-1,w=this.props_.get("minValue"),R=this.props_.get("maxValue"),W=[];this.value.rawValue.forEach((Bt,Ut)=>{if(Bt===void 0)return;const go=jt(Ut,0,p,0,l.width),Zl=jt(Bt,w,R,l.height,0);W.push([go,Zl].join(","))}),this.lineElem_.setAttributeNS(null,"points",W.join(" "));const ae=this.tooltipElem_,Ee=this.value.rawValue[this.cursor_.rawValue];if(Ee===void 0){ae.classList.remove(Dr("t","a"));return}const dt=jt(this.cursor_.rawValue,0,p,0,l.width),vt=jt(Ee,w,R,l.height,0);ae.style.left=`${dt}px`,ae.style.top=`${vt}px`,ae.textContent=`${this.formatter_(Ee)}`,ae.classList.contains(Dr("t","a"))||(ae.classList.add(Dr("t","a"),Dr("t","in")),he(ae),ae.classList.remove(Dr("t","in")))}onValueUpdate_(){this.update_()}onCursorChange_(){this.update_()}}class d1{constructor(l,p){if(this.onGraphMouseMove_=this.onGraphMouseMove_.bind(this),this.onGraphMouseLeave_=this.onGraphMouseLeave_.bind(this),this.onGraphPointerDown_=this.onGraphPointerDown_.bind(this),this.onGraphPointerMove_=this.onGraphPointerMove_.bind(this),this.onGraphPointerUp_=this.onGraphPointerUp_.bind(this),this.props_=p.props,this.value=p.value,this.viewProps=p.viewProps,this.cursor_=ee(-1),this.view=new h1(l,{cursor:this.cursor_,formatter:p.formatter,lineCount:p.lineCount,props:this.props_,value:this.value,viewProps:this.viewProps}),!_t(l))this.view.element.addEventListener("mousemove",this.onGraphMouseMove_),this.view.element.addEventListener("mouseleave",this.onGraphMouseLeave_);else{const w=new Hs(this.view.element);w.emitter.on("down",this.onGraphPointerDown_),w.emitter.on("move",this.onGraphPointerMove_),w.emitter.on("up",this.onGraphPointerUp_)}}onGraphMouseLeave_(){this.cursor_.rawValue=-1}onGraphMouseMove_(l){const p=this.view.element.getBoundingClientRect();this.cursor_.rawValue=Math.floor(jt(l.offsetX,0,p.width,0,this.value.rawValue.length))}onGraphPointerDown_(l){this.onGraphPointerMove_(l)}onGraphPointerMove_(l){if(!l.data.point){this.cursor_.rawValue=-1;return}this.cursor_.rawValue=Math.floor(jt(l.data.point.x,0,l.data.bounds.width,0,this.value.rawValue.length))}onGraphPointerUp_(){this.cursor_.rawValue=-1}}function up(g){return"format"in g&&!c(g.format)?g.format:fi(2)}function p1(g){var l;return g.value.rawValue.length===1?new cp(g.document,{formatter:up(g.params),value:g.value,viewProps:g.viewProps}):new lp(g.document,{formatter:up(g.params),lineCount:(l=g.params.lineCount)!==null&&l!==void 0?l:Kl.monitor.defaultLineCount,value:g.value,viewProps:g.viewProps})}function f1(g){var l,p,w;return new d1(g.document,{formatter:up(g.params),lineCount:(l=g.params.lineCount)!==null&&l!==void 0?l:Kl.monitor.defaultLineCount,props:V.fromObject({maxValue:(p="max"in g.params?g.params.max:null)!==null&&p!==void 0?p:100,minValue:(w="min"in g.params?g.params.min:null)!==null&&w!==void 0?w:0}),value:g.value,viewProps:g.viewProps})}function Yg(g){return"view"in g&&g.view==="graph"}const m1={id:"monitor-number",type:"monitor",accept:(g,l)=>{if(typeof g!="number")return null;const p=le,w=be(l,{format:p.optional.function,lineCount:p.optional.number,max:p.optional.number,min:p.optional.number,view:p.optional.string});return w?{initialValue:g,params:w}:null},binding:{defaultBufferSize:g=>Yg(g)?64:1,reader:g=>cs},controller:g=>Yg(g.params)?f1(g):p1(g)},g1={id:"monitor-string",type:"monitor",accept:(g,l)=>{if(typeof g!="string")return null;const p=le,w=be(l,{lineCount:p.optional.number,multiline:p.optional.boolean});return w?{initialValue:g,params:w}:null},binding:{reader:g=>Vl},controller:g=>{var l;const p=g.value;return p.rawValue.length>1||"multiline"in g.params&&g.params.multiline?new lp(g.document,{formatter:ys,lineCount:(l=g.params.lineCount)!==null&&l!==void 0?l:Kl.monitor.defaultLineCount,value:p,viewProps:g.viewProps}):new cp(g.document,{formatter:ys,value:p,viewProps:g.viewProps})}};function _1(g,l){var p;const w=g.accept(l.target.read(),l.params);if(c(w))return null;const R=le,W={target:l.target,initialValue:w.initialValue,params:w.params},ae=g.binding.reader(W),Ee=g.binding.constraint?g.binding.constraint(W):void 0,dt=ee(ae(w.initialValue),{constraint:Ee,equals:g.binding.equals}),vt=new la({reader:ae,target:l.target,value:dt,writer:g.binding.writer(W)}),Bt=R.optional.boolean(l.params.disabled).value,Ut=R.optional.boolean(l.params.hidden).value,go=g.controller({constraint:Ee,document:l.document,initialValue:w.initialValue,params:w.params,value:vt.value,viewProps:Ze.create({disabled:Bt,hidden:Ut})});return new Le(l.document,{binding:vt,blade:ut(),props:V.fromObject({label:"label"in l.params?(p=R.optional.string(l.params.label).value)!==null&&p!==void 0?p:null:l.target.key}),valueController:go})}function v1(g,l){return l===0?new xu:new Rl(g,l??Kl.monitor.defaultInterval)}function b1(g,l){var p,w,R;const W=le,ae=g.accept(l.target.read(),l.params);if(c(ae))return null;const Ee={target:l.target,initialValue:ae.initialValue,params:ae.params},dt=g.binding.reader(Ee),vt=(w=(p=W.optional.number(l.params.bufferSize).value)!==null&&p!==void 0?p:g.binding.defaultBufferSize&&g.binding.defaultBufferSize(ae.params))!==null&&w!==void 0?w:1,Bt=W.optional.number(l.params.interval).value,Ut=new Td({reader:dt,target:l.target,ticker:v1(l.document,Bt),value:wu(vt)}),go=W.optional.boolean(l.params.disabled).value,Zl=W.optional.boolean(l.params.hidden).value,Jl=g.controller({document:l.document,params:ae.params,value:Ut.value,viewProps:Ze.create({disabled:go,hidden:Zl})});return new it(l.document,{binding:Ut,blade:ut(),props:V.fromObject({label:"label"in l.params?(R=W.optional.string(l.params.label).value)!==null&&R!==void 0?R:null:l.target.key}),valueController:Jl})}class x1{constructor(){this.pluginsMap_={blades:[],inputs:[],monitors:[]}}getAll(){return[...this.pluginsMap_.blades,...this.pluginsMap_.inputs,...this.pluginsMap_.monitors]}register(l){l.type==="blade"?this.pluginsMap_.blades.unshift(l):l.type==="input"?this.pluginsMap_.inputs.unshift(l):l.type==="monitor"&&this.pluginsMap_.monitors.unshift(l)}createInput(l,p,w){const R=p.read();if(c(R))throw new _({context:{key:p.key},type:"nomatchingcontroller"});const W=this.pluginsMap_.inputs.reduce((ae,Ee)=>ae??_1(Ee,{document:l,target:p,params:w}),null);if(W)return W;throw new _({context:{key:p.key},type:"nomatchingcontroller"})}createMonitor(l,p,w){const R=this.pluginsMap_.monitors.reduce((W,ae)=>W??b1(ae,{document:l,params:w,target:p}),null);if(R)return R;throw new _({context:{key:p.key},type:"nomatchingcontroller"})}createBlade(l,p){const w=this.pluginsMap_.blades.reduce((R,W)=>R??Md(W,{document:l,params:p}),null);if(!w)throw new _({type:"nomatchingview",context:{params:p}});return w}createBladeApi(l){if(l instanceof Le)return new bi(l);if(l instanceof it)return new $e(l);if(l instanceof ot)return new lt(l,this);const p=this.pluginsMap_.blades.reduce((w,R)=>w??R.api({controller:l,pool:this}),null);if(!p)throw _.shouldNeverHappen();return p}}function w1(){const g=new x1;return[C1,e1,r1,a1,qy,Uy,zy,Oy,ma,u1,g1,m1,He,Ft,Kt,Ll].forEach(l=>{g.register(l)}),g}function y1(g){return Er.isObject(g)?new Er(g.x,g.y):new Er}function S1(g,l){g.writeProperty("x",l.x),g.writeProperty("y",l.y)}function Xs(g,l){if(!g)return;const p=[],w=Ug(g,l);w&&p.push(w);const R=Gg(g);return R&&p.push(R),new io(p)}function M1(g,l){return new Tr({assembly:Hg,components:[Xs("x"in g?g.x:void 0,l.x),Xs("y"in g?g.y:void 0,l.y)]})}function Kg(g,l){const[p,w]=g?Wy(g):[];if(!c(p)||!c(w))return Math.max(Math.abs(p??0),Math.abs(w??0));const R=Ws(g);return Math.max(Math.abs(R)*10,Math.abs(l)*10)}function T1(g,l){const p=l instanceof Tr?l.components[0]:void 0,w=l instanceof Tr?l.components[1]:void 0,R=Kg(p,g.x),W=Kg(w,g.y);return Math.max(R,W)}function Zg(g,l){return{baseStep:Ws(l),constraint:l,textProps:V.fromObject({draggingScale:js(l,g),formatter:fi(fa(l,g))})}}function E1(g){if(!("y"in g))return!1;const l=g.y;return l&&"inverted"in l?!!l.inverted:!1}const C1={id:"input-point2d",type:"input",accept:(g,l)=>{if(!Er.isObject(g))return null;const p=le,w=be(l,{expanded:p.optional.boolean,picker:p.optional.custom(ql),x:p.optional.custom(us),y:p.optional.object({inverted:p.optional.boolean,max:p.optional.number,min:p.optional.number,step:p.optional.number})});return w?{initialValue:g,params:w}:null},binding:{reader:g=>y1,constraint:g=>M1(g.params,g.initialValue),equals:Er.equals,writer:g=>S1},controller:g=>{const l=g.document,p=g.value,w=g.constraint;if(!(w instanceof Tr))throw _.shouldNeverHappen();const R="expanded"in g.params?g.params.expanded:void 0,W="picker"in g.params?g.params.picker:void 0;return new Ky(l,{axes:[Zg(p.rawValue.x,w.components[0]),Zg(p.rawValue.y,w.components[1])],expanded:R??!1,invertsY:E1(g.params),maxValue:T1(p.rawValue,w),parser:qn,pickerLayout:W??"popup",value:p,viewProps:g.viewProps})}};class Jg extends n{constructor(l){super(l),this.emitter_=new M,this.controller_.valueController.value.emitter.on("change",p=>{this.emitter_.emit("change",{event:new a(this,p.rawValue)})})}get label(){return this.controller_.props.get("label")}set label(l){this.controller_.props.set("label",l)}get options(){return this.controller_.valueController.props.get("options")}set options(l){this.controller_.valueController.props.set("options",l)}get value(){return this.controller_.valueController.value.rawValue}set value(l){this.controller_.valueController.value.rawValue=l}on(l,p){const w=p.bind(this);return this.emitter_.on(l,R=>{w(R.event)}),this}}class Qg extends n{constructor(l){super(l),this.emitter_=new M,this.controller_.valueController.value.emitter.on("change",p=>{this.emitter_.emit("change",{event:new a(this,p.rawValue)})})}get label(){return this.controller_.props.get("label")}set label(l){this.controller_.props.set("label",l)}get maxValue(){return this.controller_.valueController.sliderController.props.get("maxValue")}set maxValue(l){this.controller_.valueController.sliderController.props.set("maxValue",l)}get minValue(){return this.controller_.valueController.sliderController.props.get("minValue")}set minValue(l){this.controller_.valueController.sliderController.props.set("minValue",l)}get value(){return this.controller_.valueController.value.rawValue}set value(l){this.controller_.valueController.value.rawValue=l}on(l,p){const w=p.bind(this);return this.emitter_.on(l,R=>{w(R.event)}),this}}class e_ extends n{constructor(l){super(l),this.emitter_=new M,this.controller_.valueController.value.emitter.on("change",p=>{this.emitter_.emit("change",{event:new a(this,p.rawValue)})})}get label(){return this.controller_.props.get("label")}set label(l){this.controller_.props.set("label",l)}get formatter(){return this.controller_.valueController.props.get("formatter")}set formatter(l){this.controller_.valueController.props.set("formatter",l)}get value(){return this.controller_.valueController.value.rawValue}set value(l){this.controller_.valueController.value.rawValue=l}on(l,p){const w=p.bind(this);return this.emitter_.on(l,R=>{w(R.event)}),this}}const D1=function(){return{id:"list",type:"blade",accept(g){const l=le,p=be(g,{options:l.required.custom(uo),value:l.required.raw,view:l.required.constant("list"),label:l.optional.string});return p?{params:p}:null},controller(g){const l=new no(Nu(g.params.options)),p=ee(g.params.value,{constraint:l}),w=new so(g.document,{props:new V({options:l.values.value("options")}),value:p,viewProps:g.viewProps});return new Yt(g.document,{blade:g.blade,props:V.fromObject({label:g.params.label}),valueController:w})},api(g){return!(g.controller instanceof Yt)||!(g.controller.valueController instanceof so)?null:new Jg(g.controller)}}}();function P1(g){return g.reduce((l,p)=>Object.assign(l,{[p.presetKey]:p.read()}),{})}function A1(g,l){g.forEach(p=>{const w=l[p.target.presetKey];w!==void 0&&p.writer(p.target,p.reader(w))})}class L1 extends B{constructor(l,p){super(l,p)}get element(){return this.controller_.view.element}importPreset(l){const p=this.controller_.rackController.rack.find(Le).map(w=>w.binding);A1(p,l),this.refresh()}exportPreset(){const l=this.controller_.rackController.rack.find(Le).map(p=>p.binding.target);return P1(l)}refresh(){this.controller_.rackController.rack.find(Le).forEach(l=>{l.binding.read()}),this.controller_.rackController.rack.find(it).forEach(l=>{l.binding.read()})}}class R1 extends bt{constructor(l,p){super(l,{expanded:p.expanded,blade:p.blade,props:p.props,root:!0,viewProps:p.viewProps})}}const k1={id:"slider",type:"blade",accept(g){const l=le,p=be(g,{max:l.required.number,min:l.required.number,view:l.required.constant("slider"),format:l.optional.function,label:l.optional.string,value:l.optional.number});return p?{params:p}:null},controller(g){var l,p;const w=(l=g.params.value)!==null&&l!==void 0?l:0,R=new wr({max:g.params.max,min:g.params.min}),W=new pa(g.document,{baseStep:1,parser:qn,sliderProps:new V({maxValue:R.values.value("max"),minValue:R.values.value("min")}),textProps:V.fromObject({draggingScale:js(void 0,w),formatter:(p=g.params.format)!==null&&p!==void 0?p:Hd}),value:ee(w,{constraint:R}),viewProps:g.viewProps});return new Yt(g.document,{blade:g.blade,props:V.fromObject({label:g.params.label}),valueController:W})},api(g){return!(g.controller instanceof Yt)||!(g.controller.valueController instanceof pa)?null:new Qg(g.controller)}},I1=function(){return{id:"text",type:"blade",accept(g){const l=le,p=be(g,{parse:l.required.function,value:l.required.raw,view:l.required.constant("text"),format:l.optional.function,label:l.optional.string});return p?{params:p}:null},controller(g){var l;const p=new ua(g.document,{parser:g.params.parse,props:V.fromObject({formatter:(l=g.params.format)!==null&&l!==void 0?l:w=>String(w)}),value:ee(g.params.value),viewProps:g.viewProps});return new Yt(g.document,{blade:g.blade,props:V.fromObject({label:g.params.label}),valueController:p})},api(g){return!(g.controller instanceof Yt)||!(g.controller.valueController instanceof ua)?null:new e_(g.controller)}}}();function F1(g){const l=g.createElement("div");return l.classList.add(C("dfw")()),g.body&&g.body.appendChild(l),l}function t_(g,l,p){if(g.querySelector(`style[data-tp-style=${l}]`))return;const w=g.createElement("style");w.dataset.tpStyle=l,w.textContent=p,g.head.appendChild(w)}class O1 extends L1{constructor(l){var p,w;const R=l??{},W=(p=R.document)!==null&&p!==void 0?p:wt(),ae=w1(),Ee=new R1(W,{expanded:R.expanded,blade:ut(),props:V.fromObject({title:R.title}),viewProps:Ze.create()});super(Ee,ae),this.pool_=ae,this.containerElem_=(w=R.container)!==null&&w!==void 0?w:F1(W),this.containerElem_.appendChild(this.element),this.doc_=W,this.usesDefaultWrapper_=!R.container,this.setUpDefaultPlugins_()}get document(){if(!this.doc_)throw _.alreadyDisposed();return this.doc_}dispose(){const l=this.containerElem_;if(!l)throw _.alreadyDisposed();if(this.usesDefaultWrapper_){const p=l.parentElement;p&&p.removeChild(l)}this.containerElem_=null,this.doc_=null,super.dispose()}registerPlugin(l){("plugin"in l?[l.plugin]:"plugins"in l?l.plugins:[]).forEach(w=>{this.pool_.register(w),this.embedPluginStyle_(w)})}embedPluginStyle_(l){l.css&&t_(this.document,`plugin-${l.id}`,l.css)}setUpDefaultPlugins_(){t_(this.document,"default",'.tp-tbiv_b,.tp-coltxtv_ms,.tp-ckbv_i,.tp-rotv_b,.tp-fldv_b,.tp-mllv_i,.tp-sglv_i,.tp-grlv_g,.tp-txtv_i,.tp-p2dpv_p,.tp-colswv_sw,.tp-p2dv_b,.tp-btnv_b,.tp-lstv_s{-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:rgba(0,0,0,0);border-width:0;font-family:inherit;font-size:inherit;font-weight:inherit;margin:0;outline:none;padding:0}.tp-p2dv_b,.tp-btnv_b,.tp-lstv_s{background-color:var(--btn-bg);border-radius:var(--elm-br);color:var(--btn-fg);cursor:pointer;display:block;font-weight:bold;height:var(--bld-us);line-height:var(--bld-us);overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.tp-p2dv_b:hover,.tp-btnv_b:hover,.tp-lstv_s:hover{background-color:var(--btn-bg-h)}.tp-p2dv_b:focus,.tp-btnv_b:focus,.tp-lstv_s:focus{background-color:var(--btn-bg-f)}.tp-p2dv_b:active,.tp-btnv_b:active,.tp-lstv_s:active{background-color:var(--btn-bg-a)}.tp-p2dv_b:disabled,.tp-btnv_b:disabled,.tp-lstv_s:disabled{opacity:.5}.tp-txtv_i,.tp-p2dpv_p,.tp-colswv_sw{background-color:var(--in-bg);border-radius:var(--elm-br);box-sizing:border-box;color:var(--in-fg);font-family:inherit;height:var(--bld-us);line-height:var(--bld-us);min-width:0;width:100%}.tp-txtv_i:hover,.tp-p2dpv_p:hover,.tp-colswv_sw:hover{background-color:var(--in-bg-h)}.tp-txtv_i:focus,.tp-p2dpv_p:focus,.tp-colswv_sw:focus{background-color:var(--in-bg-f)}.tp-txtv_i:active,.tp-p2dpv_p:active,.tp-colswv_sw:active{background-color:var(--in-bg-a)}.tp-txtv_i:disabled,.tp-p2dpv_p:disabled,.tp-colswv_sw:disabled{opacity:.5}.tp-mllv_i,.tp-sglv_i,.tp-grlv_g{background-color:var(--mo-bg);border-radius:var(--elm-br);box-sizing:border-box;color:var(--mo-fg);height:var(--bld-us);scrollbar-color:currentColor rgba(0,0,0,0);scrollbar-width:thin;width:100%}.tp-mllv_i::-webkit-scrollbar,.tp-sglv_i::-webkit-scrollbar,.tp-grlv_g::-webkit-scrollbar{height:8px;width:8px}.tp-mllv_i::-webkit-scrollbar-corner,.tp-sglv_i::-webkit-scrollbar-corner,.tp-grlv_g::-webkit-scrollbar-corner{background-color:rgba(0,0,0,0)}.tp-mllv_i::-webkit-scrollbar-thumb,.tp-sglv_i::-webkit-scrollbar-thumb,.tp-grlv_g::-webkit-scrollbar-thumb{background-clip:padding-box;background-color:currentColor;border:rgba(0,0,0,0) solid 2px;border-radius:4px}.tp-rotv{--font-family: var(--tp-font-family, Roboto Mono, Source Code Pro, Menlo, Courier, monospace);--bs-br: var(--tp-base-border-radius, 6px);--cnt-h-p: var(--tp-container-horizontal-padding, 4px);--cnt-v-p: var(--tp-container-vertical-padding, 4px);--elm-br: var(--tp-element-border-radius, 2px);--bld-s: var(--tp-blade-spacing, 4px);--bld-us: var(--tp-blade-unit-size, 20px);--bs-bg: var(--tp-base-background-color, hsl(230, 7%, 17%));--bs-sh: var(--tp-base-shadow-color, rgba(0, 0, 0, 0.2));--btn-bg: var(--tp-button-background-color, hsl(230, 7%, 70%));--btn-bg-a: var(--tp-button-background-color-active, #d6d7db);--btn-bg-f: var(--tp-button-background-color-focus, #c8cad0);--btn-bg-h: var(--tp-button-background-color-hover, #bbbcc4);--btn-fg: var(--tp-button-foreground-color, hsl(230, 7%, 17%));--cnt-bg: var(--tp-container-background-color, rgba(187, 188, 196, 0.1));--cnt-bg-a: var(--tp-container-background-color-active, rgba(187, 188, 196, 0.25));--cnt-bg-f: var(--tp-container-background-color-focus, rgba(187, 188, 196, 0.2));--cnt-bg-h: var(--tp-container-background-color-hover, rgba(187, 188, 196, 0.15));--cnt-fg: var(--tp-container-foreground-color, hsl(230, 7%, 75%));--in-bg: var(--tp-input-background-color, rgba(187, 188, 196, 0.1));--in-bg-a: var(--tp-input-background-color-active, rgba(187, 188, 196, 0.25));--in-bg-f: var(--tp-input-background-color-focus, rgba(187, 188, 196, 0.2));--in-bg-h: var(--tp-input-background-color-hover, rgba(187, 188, 196, 0.15));--in-fg: var(--tp-input-foreground-color, hsl(230, 7%, 75%));--lbl-fg: var(--tp-label-foreground-color, rgba(187, 188, 196, 0.7));--mo-bg: var(--tp-monitor-background-color, rgba(0, 0, 0, 0.2));--mo-fg: var(--tp-monitor-foreground-color, rgba(187, 188, 196, 0.7));--grv-fg: var(--tp-groove-foreground-color, rgba(187, 188, 196, 0.1))}.tp-rotv_c>.tp-cntv.tp-v-lst,.tp-tabv_c .tp-brkv>.tp-cntv.tp-v-lst,.tp-fldv_c>.tp-cntv.tp-v-lst{margin-bottom:calc(-1*var(--cnt-v-p))}.tp-rotv_c>.tp-fldv.tp-v-lst .tp-fldv_c,.tp-tabv_c .tp-brkv>.tp-fldv.tp-v-lst .tp-fldv_c,.tp-fldv_c>.tp-fldv.tp-v-lst .tp-fldv_c{border-bottom-left-radius:0}.tp-rotv_c>.tp-fldv.tp-v-lst .tp-fldv_b,.tp-tabv_c .tp-brkv>.tp-fldv.tp-v-lst .tp-fldv_b,.tp-fldv_c>.tp-fldv.tp-v-lst .tp-fldv_b{border-bottom-left-radius:0}.tp-rotv_c>*:not(.tp-v-fst),.tp-tabv_c .tp-brkv>*:not(.tp-v-fst),.tp-fldv_c>*:not(.tp-v-fst){margin-top:var(--bld-s)}.tp-rotv_c>.tp-sprv:not(.tp-v-fst),.tp-tabv_c .tp-brkv>.tp-sprv:not(.tp-v-fst),.tp-fldv_c>.tp-sprv:not(.tp-v-fst),.tp-rotv_c>.tp-cntv:not(.tp-v-fst),.tp-tabv_c .tp-brkv>.tp-cntv:not(.tp-v-fst),.tp-fldv_c>.tp-cntv:not(.tp-v-fst){margin-top:var(--cnt-v-p)}.tp-rotv_c>.tp-sprv+*:not(.tp-v-hidden),.tp-tabv_c .tp-brkv>.tp-sprv+*:not(.tp-v-hidden),.tp-fldv_c>.tp-sprv+*:not(.tp-v-hidden),.tp-rotv_c>.tp-cntv+*:not(.tp-v-hidden),.tp-tabv_c .tp-brkv>.tp-cntv+*:not(.tp-v-hidden),.tp-fldv_c>.tp-cntv+*:not(.tp-v-hidden){margin-top:var(--cnt-v-p)}.tp-rotv_c>.tp-sprv:not(.tp-v-hidden)+.tp-sprv,.tp-tabv_c .tp-brkv>.tp-sprv:not(.tp-v-hidden)+.tp-sprv,.tp-fldv_c>.tp-sprv:not(.tp-v-hidden)+.tp-sprv,.tp-rotv_c>.tp-cntv:not(.tp-v-hidden)+.tp-cntv,.tp-tabv_c .tp-brkv>.tp-cntv:not(.tp-v-hidden)+.tp-cntv,.tp-fldv_c>.tp-cntv:not(.tp-v-hidden)+.tp-cntv{margin-top:0}.tp-tabv_c .tp-brkv>.tp-cntv,.tp-fldv_c>.tp-cntv{margin-left:4px}.tp-tabv_c .tp-brkv>.tp-fldv>.tp-fldv_b,.tp-fldv_c>.tp-fldv>.tp-fldv_b{border-top-left-radius:var(--elm-br);border-bottom-left-radius:var(--elm-br)}.tp-tabv_c .tp-brkv>.tp-fldv.tp-fldv-expanded>.tp-fldv_b,.tp-fldv_c>.tp-fldv.tp-fldv-expanded>.tp-fldv_b{border-bottom-left-radius:0}.tp-tabv_c .tp-brkv .tp-fldv>.tp-fldv_c,.tp-fldv_c .tp-fldv>.tp-fldv_c{border-bottom-left-radius:var(--elm-br)}.tp-tabv_c .tp-brkv>.tp-cntv+.tp-fldv>.tp-fldv_b,.tp-fldv_c>.tp-cntv+.tp-fldv>.tp-fldv_b{border-top-left-radius:0}.tp-tabv_c .tp-brkv>.tp-cntv+.tp-tabv>.tp-tabv_t,.tp-fldv_c>.tp-cntv+.tp-tabv>.tp-tabv_t{border-top-left-radius:0}.tp-tabv_c .tp-brkv>.tp-tabv>.tp-tabv_t,.tp-fldv_c>.tp-tabv>.tp-tabv_t{border-top-left-radius:var(--elm-br)}.tp-tabv_c .tp-brkv .tp-tabv>.tp-tabv_c,.tp-fldv_c .tp-tabv>.tp-tabv_c{border-bottom-left-radius:var(--elm-br)}.tp-rotv_b,.tp-fldv_b{background-color:var(--cnt-bg);color:var(--cnt-fg);cursor:pointer;display:block;height:calc(var(--bld-us) + 4px);line-height:calc(var(--bld-us) + 4px);overflow:hidden;padding-left:var(--cnt-h-p);padding-right:calc(4px + var(--bld-us) + var(--cnt-h-p));position:relative;text-align:left;text-overflow:ellipsis;white-space:nowrap;width:100%;transition:border-radius .2s ease-in-out .2s}.tp-rotv_b:hover,.tp-fldv_b:hover{background-color:var(--cnt-bg-h)}.tp-rotv_b:focus,.tp-fldv_b:focus{background-color:var(--cnt-bg-f)}.tp-rotv_b:active,.tp-fldv_b:active{background-color:var(--cnt-bg-a)}.tp-rotv_b:disabled,.tp-fldv_b:disabled{opacity:.5}.tp-rotv_m,.tp-fldv_m{background:linear-gradient(to left, var(--cnt-fg), var(--cnt-fg) 2px, transparent 2px, transparent 4px, var(--cnt-fg) 4px);border-radius:2px;bottom:0;content:"";display:block;height:6px;right:calc(var(--cnt-h-p) + (var(--bld-us) + 4px - 6px)/2 - 2px);margin:auto;opacity:.5;position:absolute;top:0;transform:rotate(90deg);transition:transform .2s ease-in-out;width:6px}.tp-rotv.tp-rotv-expanded .tp-rotv_m,.tp-fldv.tp-fldv-expanded>.tp-fldv_b>.tp-fldv_m{transform:none}.tp-rotv_c,.tp-fldv_c{box-sizing:border-box;height:0;opacity:0;overflow:hidden;padding-bottom:0;padding-top:0;position:relative;transition:height .2s ease-in-out,opacity .2s linear,padding .2s ease-in-out}.tp-rotv.tp-rotv-cpl:not(.tp-rotv-expanded) .tp-rotv_c,.tp-fldv.tp-fldv-cpl:not(.tp-fldv-expanded)>.tp-fldv_c{display:none}.tp-rotv.tp-rotv-expanded .tp-rotv_c,.tp-fldv.tp-fldv-expanded>.tp-fldv_c{opacity:1;padding-bottom:var(--cnt-v-p);padding-top:var(--cnt-v-p);transform:none;overflow:visible;transition:height .2s ease-in-out,opacity .2s linear .2s,padding .2s ease-in-out}.tp-lstv,.tp-coltxtv_m{position:relative}.tp-lstv_s{padding:0 20px 0 4px;width:100%}.tp-lstv_m,.tp-coltxtv_mm{bottom:0;margin:auto;pointer-events:none;position:absolute;right:2px;top:0}.tp-lstv_m svg,.tp-coltxtv_mm svg{bottom:0;height:16px;margin:auto;position:absolute;right:0;top:0;width:16px}.tp-lstv_m svg path,.tp-coltxtv_mm svg path{fill:currentColor}.tp-pndtxtv,.tp-coltxtv_w{display:flex}.tp-pndtxtv_a,.tp-coltxtv_c{width:100%}.tp-pndtxtv_a+.tp-pndtxtv_a,.tp-coltxtv_c+.tp-pndtxtv_a,.tp-pndtxtv_a+.tp-coltxtv_c,.tp-coltxtv_c+.tp-coltxtv_c{margin-left:2px}.tp-btnv_b{width:100%}.tp-btnv_t{text-align:center}.tp-ckbv_l{display:block;position:relative}.tp-ckbv_i{left:0;opacity:0;position:absolute;top:0}.tp-ckbv_w{background-color:var(--in-bg);border-radius:var(--elm-br);cursor:pointer;display:block;height:var(--bld-us);position:relative;width:var(--bld-us)}.tp-ckbv_w svg{bottom:0;display:block;height:16px;left:0;margin:auto;opacity:0;position:absolute;right:0;top:0;width:16px}.tp-ckbv_w svg path{fill:none;stroke:var(--in-fg);stroke-width:2}.tp-ckbv_i:hover+.tp-ckbv_w{background-color:var(--in-bg-h)}.tp-ckbv_i:focus+.tp-ckbv_w{background-color:var(--in-bg-f)}.tp-ckbv_i:active+.tp-ckbv_w{background-color:var(--in-bg-a)}.tp-ckbv_i:checked+.tp-ckbv_w svg{opacity:1}.tp-ckbv.tp-v-disabled .tp-ckbv_w{opacity:.5}.tp-colv{position:relative}.tp-colv_h{display:flex}.tp-colv_s{flex-grow:0;flex-shrink:0;width:var(--bld-us)}.tp-colv_t{flex:1;margin-left:4px}.tp-colv_p{height:0;margin-top:0;opacity:0;overflow:hidden;transition:height .2s ease-in-out,opacity .2s linear,margin .2s ease-in-out}.tp-colv.tp-colv-expanded.tp-colv-cpl .tp-colv_p{overflow:visible}.tp-colv.tp-colv-expanded .tp-colv_p{margin-top:var(--bld-s);opacity:1}.tp-colv .tp-popv{left:calc(-1*var(--cnt-h-p));right:calc(-1*var(--cnt-h-p));top:var(--bld-us)}.tp-colpv_h,.tp-colpv_ap{margin-left:6px;margin-right:6px}.tp-colpv_h{margin-top:var(--bld-s)}.tp-colpv_rgb{display:flex;margin-top:var(--bld-s);width:100%}.tp-colpv_a{display:flex;margin-top:var(--cnt-v-p);padding-top:calc(var(--cnt-v-p) + 2px);position:relative}.tp-colpv_a::before{background-color:var(--grv-fg);content:"";height:2px;left:calc(-1*var(--cnt-h-p));position:absolute;right:calc(-1*var(--cnt-h-p));top:0}.tp-colpv.tp-v-disabled .tp-colpv_a::before{opacity:.5}.tp-colpv_ap{align-items:center;display:flex;flex:3}.tp-colpv_at{flex:1;margin-left:4px}.tp-svpv{border-radius:var(--elm-br);outline:none;overflow:hidden;position:relative}.tp-svpv.tp-v-disabled{opacity:.5}.tp-svpv_c{cursor:crosshair;display:block;height:calc(var(--bld-us)*4);width:100%}.tp-svpv_m{border-radius:100%;border:rgba(255,255,255,.75) solid 2px;box-sizing:border-box;filter:drop-shadow(0 0 1px rgba(0, 0, 0, 0.3));height:12px;margin-left:-6px;margin-top:-6px;pointer-events:none;position:absolute;width:12px}.tp-svpv:focus .tp-svpv_m{border-color:#fff}.tp-hplv{cursor:pointer;height:var(--bld-us);outline:none;position:relative}.tp-hplv.tp-v-disabled{opacity:.5}.tp-hplv_c{background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAAABCAYAAABubagXAAAAQ0lEQVQoU2P8z8Dwn0GCgQEDi2OK/RBgYHjBgIpfovFh8j8YBIgzFGQxuqEgPhaDOT5gOhPkdCxOZeBg+IDFZZiGAgCaSSMYtcRHLgAAAABJRU5ErkJggg==);background-position:left top;background-repeat:no-repeat;background-size:100% 100%;border-radius:2px;display:block;height:4px;left:0;margin-top:-2px;position:absolute;top:50%;width:100%}.tp-hplv_m{border-radius:var(--elm-br);border:rgba(255,255,255,.75) solid 2px;box-shadow:0 0 2px rgba(0,0,0,.1);box-sizing:border-box;height:12px;left:50%;margin-left:-6px;margin-top:-6px;pointer-events:none;position:absolute;top:50%;width:12px}.tp-hplv:focus .tp-hplv_m{border-color:#fff}.tp-aplv{cursor:pointer;height:var(--bld-us);outline:none;position:relative;width:100%}.tp-aplv.tp-v-disabled{opacity:.5}.tp-aplv_b{background-color:#fff;background-image:linear-gradient(to top right, #ddd 25%, transparent 25%, transparent 75%, #ddd 75%),linear-gradient(to top right, #ddd 25%, transparent 25%, transparent 75%, #ddd 75%);background-size:4px 4px;background-position:0 0,2px 2px;border-radius:2px;display:block;height:4px;left:0;margin-top:-2px;overflow:hidden;position:absolute;top:50%;width:100%}.tp-aplv_c{bottom:0;left:0;position:absolute;right:0;top:0}.tp-aplv_m{background-color:#fff;background-image:linear-gradient(to top right, #ddd 25%, transparent 25%, transparent 75%, #ddd 75%),linear-gradient(to top right, #ddd 25%, transparent 25%, transparent 75%, #ddd 75%);background-size:12px 12px;background-position:0 0,6px 6px;border-radius:var(--elm-br);box-shadow:0 0 2px rgba(0,0,0,.1);height:12px;left:50%;margin-left:-6px;margin-top:-6px;overflow:hidden;pointer-events:none;position:absolute;top:50%;width:12px}.tp-aplv_p{border-radius:var(--elm-br);border:rgba(255,255,255,.75) solid 2px;box-sizing:border-box;bottom:0;left:0;position:absolute;right:0;top:0}.tp-aplv:focus .tp-aplv_p{border-color:#fff}.tp-colswv{background-color:#fff;background-image:linear-gradient(to top right, #ddd 25%, transparent 25%, transparent 75%, #ddd 75%),linear-gradient(to top right, #ddd 25%, transparent 25%, transparent 75%, #ddd 75%);background-size:10px 10px;background-position:0 0,5px 5px;border-radius:var(--elm-br);overflow:hidden}.tp-colswv.tp-v-disabled{opacity:.5}.tp-colswv_sw{border-radius:0}.tp-colswv_b{-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:rgba(0,0,0,0);border-width:0;cursor:pointer;display:block;height:var(--bld-us);left:0;margin:0;outline:none;padding:0;position:absolute;top:0;width:var(--bld-us)}.tp-colswv_b:focus::after{border:rgba(255,255,255,.75) solid 2px;border-radius:var(--elm-br);bottom:0;content:"";display:block;left:0;position:absolute;right:0;top:0}.tp-coltxtv{display:flex;width:100%}.tp-coltxtv_m{margin-right:4px}.tp-coltxtv_ms{border-radius:var(--elm-br);color:var(--lbl-fg);cursor:pointer;height:var(--bld-us);line-height:var(--bld-us);padding:0 18px 0 4px}.tp-coltxtv_ms:hover{background-color:var(--in-bg-h)}.tp-coltxtv_ms:focus{background-color:var(--in-bg-f)}.tp-coltxtv_ms:active{background-color:var(--in-bg-a)}.tp-coltxtv_mm{color:var(--lbl-fg)}.tp-coltxtv.tp-v-disabled .tp-coltxtv_mm{opacity:.5}.tp-coltxtv_w{flex:1}.tp-dfwv{position:absolute;top:8px;right:8px;width:256px}.tp-fldv{position:relative}.tp-fldv.tp-fldv-not .tp-fldv_b{display:none}.tp-fldv_t{padding-left:4px}.tp-fldv_b:disabled .tp-fldv_m{display:none}.tp-fldv_c{padding-left:4px}.tp-fldv_i{bottom:0;color:var(--cnt-bg);left:0;overflow:hidden;position:absolute;top:calc(var(--bld-us) + 4px);width:var(--bs-br)}.tp-fldv_i::before{background-color:currentColor;bottom:0;content:"";left:0;position:absolute;top:0;width:4px}.tp-fldv_b:hover+.tp-fldv_i{color:var(--cnt-bg-h)}.tp-fldv_b:focus+.tp-fldv_i{color:var(--cnt-bg-f)}.tp-fldv_b:active+.tp-fldv_i{color:var(--cnt-bg-a)}.tp-fldv.tp-v-disabled>.tp-fldv_i{opacity:.5}.tp-grlv{position:relative}.tp-grlv_g{display:block;height:calc(var(--bld-us)*3)}.tp-grlv_g polyline{fill:none;stroke:var(--mo-fg);stroke-linejoin:round}.tp-grlv_t{margin-top:-4px;transition:left .05s,top .05s;visibility:hidden}.tp-grlv_t.tp-grlv_t-a{visibility:visible}.tp-grlv_t.tp-grlv_t-in{transition:none}.tp-grlv.tp-v-disabled .tp-grlv_g{opacity:.5}.tp-grlv .tp-ttv{background-color:var(--mo-fg)}.tp-grlv .tp-ttv::before{border-top-color:var(--mo-fg)}.tp-lblv{align-items:center;display:flex;line-height:1.3;padding-left:var(--cnt-h-p);padding-right:var(--cnt-h-p)}.tp-lblv.tp-lblv-nol{display:block}.tp-lblv_l{color:var(--lbl-fg);flex:1;-webkit-hyphens:auto;hyphens:auto;overflow:hidden;padding-left:4px;padding-right:16px}.tp-lblv.tp-v-disabled .tp-lblv_l{opacity:.5}.tp-lblv.tp-lblv-nol .tp-lblv_l{display:none}.tp-lblv_v{align-self:flex-start;flex-grow:0;flex-shrink:0;width:160px}.tp-lblv.tp-lblv-nol .tp-lblv_v{width:100%}.tp-lstv_s{padding:0 20px 0 4px;width:100%}.tp-lstv_m{color:var(--btn-fg)}.tp-sglv_i{padding:0 4px}.tp-sglv.tp-v-disabled .tp-sglv_i{opacity:.5}.tp-mllv_i{display:block;height:calc(var(--bld-us)*3);line-height:var(--bld-us);padding:0 4px;resize:none;white-space:pre}.tp-mllv.tp-v-disabled .tp-mllv_i{opacity:.5}.tp-p2dv{position:relative}.tp-p2dv_h{display:flex}.tp-p2dv_b{height:var(--bld-us);margin-right:4px;position:relative;width:var(--bld-us)}.tp-p2dv_b svg{display:block;height:16px;left:50%;margin-left:-8px;margin-top:-8px;position:absolute;top:50%;width:16px}.tp-p2dv_b svg path{stroke:currentColor;stroke-width:2}.tp-p2dv_b svg circle{fill:currentColor}.tp-p2dv_t{flex:1}.tp-p2dv_p{height:0;margin-top:0;opacity:0;overflow:hidden;transition:height .2s ease-in-out,opacity .2s linear,margin .2s ease-in-out}.tp-p2dv.tp-p2dv-expanded .tp-p2dv_p{margin-top:var(--bld-s);opacity:1}.tp-p2dv .tp-popv{left:calc(-1*var(--cnt-h-p));right:calc(-1*var(--cnt-h-p));top:var(--bld-us)}.tp-p2dpv{padding-left:calc(var(--bld-us) + 4px)}.tp-p2dpv_p{cursor:crosshair;height:0;overflow:hidden;padding-bottom:100%;position:relative}.tp-p2dpv.tp-v-disabled .tp-p2dpv_p{opacity:.5}.tp-p2dpv_g{display:block;height:100%;left:0;pointer-events:none;position:absolute;top:0;width:100%}.tp-p2dpv_ax{opacity:.1;stroke:var(--in-fg);stroke-dasharray:1}.tp-p2dpv_l{opacity:.5;stroke:var(--in-fg);stroke-dasharray:1}.tp-p2dpv_m{border:var(--in-fg) solid 1px;border-radius:50%;box-sizing:border-box;height:4px;margin-left:-2px;margin-top:-2px;position:absolute;width:4px}.tp-p2dpv_p:focus .tp-p2dpv_m{background-color:var(--in-fg);border-width:0}.tp-popv{background-color:var(--bs-bg);border-radius:6px;box-shadow:0 2px 4px var(--bs-sh);display:none;max-width:168px;padding:var(--cnt-v-p) var(--cnt-h-p);position:absolute;visibility:hidden;z-index:1000}.tp-popv.tp-popv-v{display:block;visibility:visible}.tp-sprv_r{background-color:var(--grv-fg);border-width:0;display:block;height:2px;margin:0;width:100%}.tp-sprv.tp-v-disabled .tp-sprv_r{opacity:.5}.tp-sldv.tp-v-disabled{opacity:.5}.tp-sldv_t{box-sizing:border-box;cursor:pointer;height:var(--bld-us);margin:0 6px;outline:none;position:relative}.tp-sldv_t::before{background-color:var(--in-bg);border-radius:1px;bottom:0;content:"";display:block;height:2px;left:0;margin:auto;position:absolute;right:0;top:0}.tp-sldv_k{height:100%;left:0;position:absolute;top:0}.tp-sldv_k::before{background-color:var(--in-fg);border-radius:1px;bottom:0;content:"";display:block;height:2px;left:0;margin-bottom:auto;margin-top:auto;position:absolute;right:0;top:0}.tp-sldv_k::after{background-color:var(--btn-bg);border-radius:var(--elm-br);bottom:0;content:"";display:block;height:12px;margin-bottom:auto;margin-top:auto;position:absolute;right:-6px;top:0;width:12px}.tp-sldv_t:hover .tp-sldv_k::after{background-color:var(--btn-bg-h)}.tp-sldv_t:focus .tp-sldv_k::after{background-color:var(--btn-bg-f)}.tp-sldv_t:active .tp-sldv_k::after{background-color:var(--btn-bg-a)}.tp-sldtxtv{display:flex}.tp-sldtxtv_s{flex:2}.tp-sldtxtv_t{flex:1;margin-left:4px}.tp-tabv{position:relative}.tp-tabv_t{align-items:flex-end;color:var(--cnt-bg);display:flex;overflow:hidden;position:relative}.tp-tabv_t:hover{color:var(--cnt-bg-h)}.tp-tabv_t:has(*:focus){color:var(--cnt-bg-f)}.tp-tabv_t:has(*:active){color:var(--cnt-bg-a)}.tp-tabv_t::before{background-color:currentColor;bottom:0;content:"";height:2px;left:0;pointer-events:none;position:absolute;right:0}.tp-tabv.tp-v-disabled .tp-tabv_t::before{opacity:.5}.tp-tabv.tp-tabv-nop .tp-tabv_t{height:calc(var(--bld-us) + 4px);position:relative}.tp-tabv.tp-tabv-nop .tp-tabv_t::before{background-color:var(--cnt-bg);bottom:0;content:"";height:2px;left:0;position:absolute;right:0}.tp-tabv_c{padding-bottom:var(--cnt-v-p);padding-left:4px;padding-top:var(--cnt-v-p)}.tp-tabv_i{bottom:0;color:var(--cnt-bg);left:0;overflow:hidden;position:absolute;top:calc(var(--bld-us) + 4px);width:var(--bs-br)}.tp-tabv_i::before{background-color:currentColor;bottom:0;content:"";left:0;position:absolute;top:0;width:4px}.tp-tabv_t:hover+.tp-tabv_i{color:var(--cnt-bg-h)}.tp-tabv_t:has(*:focus)+.tp-tabv_i{color:var(--cnt-bg-f)}.tp-tabv_t:has(*:active)+.tp-tabv_i{color:var(--cnt-bg-a)}.tp-tabv.tp-v-disabled>.tp-tabv_i{opacity:.5}.tp-tbiv{flex:1;min-width:0;position:relative}.tp-tbiv+.tp-tbiv{margin-left:2px}.tp-tbiv+.tp-tbiv.tp-v-disabled::before{opacity:.5}.tp-tbiv_b{display:block;padding-left:calc(var(--cnt-h-p) + 4px);padding-right:calc(var(--cnt-h-p) + 4px);position:relative;width:100%}.tp-tbiv_b:disabled{opacity:.5}.tp-tbiv_b::before{background-color:var(--cnt-bg);bottom:2px;content:"";left:0;pointer-events:none;position:absolute;right:0;top:0}.tp-tbiv_b:hover::before{background-color:var(--cnt-bg-h)}.tp-tbiv_b:focus::before{background-color:var(--cnt-bg-f)}.tp-tbiv_b:active::before{background-color:var(--cnt-bg-a)}.tp-tbiv_t{color:var(--cnt-fg);height:calc(var(--bld-us) + 4px);line-height:calc(var(--bld-us) + 4px);opacity:.5;overflow:hidden;text-overflow:ellipsis}.tp-tbiv.tp-tbiv-sel .tp-tbiv_t{opacity:1}.tp-txtv{position:relative}.tp-txtv_i{padding:0 4px}.tp-txtv.tp-txtv-fst .tp-txtv_i{border-bottom-right-radius:0;border-top-right-radius:0}.tp-txtv.tp-txtv-mid .tp-txtv_i{border-radius:0}.tp-txtv.tp-txtv-lst .tp-txtv_i{border-bottom-left-radius:0;border-top-left-radius:0}.tp-txtv.tp-txtv-num .tp-txtv_i{text-align:right}.tp-txtv.tp-txtv-drg .tp-txtv_i{opacity:.3}.tp-txtv_k{cursor:pointer;height:100%;left:-3px;position:absolute;top:0;width:12px}.tp-txtv_k::before{background-color:var(--in-fg);border-radius:1px;bottom:0;content:"";height:calc(var(--bld-us) - 4px);left:50%;margin-bottom:auto;margin-left:-1px;margin-top:auto;opacity:.1;position:absolute;top:0;transition:border-radius .1s,height .1s,transform .1s,width .1s;width:2px}.tp-txtv_k:hover::before,.tp-txtv.tp-txtv-drg .tp-txtv_k::before{opacity:1}.tp-txtv.tp-txtv-drg .tp-txtv_k::before{border-radius:50%;height:4px;transform:translateX(-1px);width:4px}.tp-txtv_g{bottom:0;display:block;height:8px;left:50%;margin:auto;overflow:visible;pointer-events:none;position:absolute;top:0;visibility:hidden;width:100%}.tp-txtv.tp-txtv-drg .tp-txtv_g{visibility:visible}.tp-txtv_gb{fill:none;stroke:var(--in-fg);stroke-dasharray:1}.tp-txtv_gh{fill:none;stroke:var(--in-fg)}.tp-txtv .tp-ttv{margin-left:6px;visibility:hidden}.tp-txtv.tp-txtv-drg .tp-ttv{visibility:visible}.tp-ttv{background-color:var(--in-fg);border-radius:var(--elm-br);color:var(--bs-bg);padding:2px 4px;pointer-events:none;position:absolute;transform:translate(-50%, -100%)}.tp-ttv::before{border-color:var(--in-fg) rgba(0,0,0,0) rgba(0,0,0,0) rgba(0,0,0,0);border-style:solid;border-width:2px;box-sizing:border-box;content:"";font-size:.9em;height:4px;left:50%;margin-left:-2px;position:absolute;top:100%;width:4px}.tp-rotv{background-color:var(--bs-bg);border-radius:var(--bs-br);box-shadow:0 2px 4px var(--bs-sh);font-family:var(--font-family);font-size:11px;font-weight:500;line-height:1;text-align:left}.tp-rotv_b{border-bottom-left-radius:var(--bs-br);border-bottom-right-radius:var(--bs-br);border-top-left-radius:var(--bs-br);border-top-right-radius:var(--bs-br);padding-left:calc(4px + var(--bld-us) + var(--cnt-h-p));text-align:center}.tp-rotv.tp-rotv-expanded .tp-rotv_b{border-bottom-left-radius:0;border-bottom-right-radius:0}.tp-rotv.tp-rotv-not .tp-rotv_b{display:none}.tp-rotv_b:disabled .tp-rotv_m{display:none}.tp-rotv_c>.tp-fldv.tp-v-lst>.tp-fldv_c{border-bottom-left-radius:var(--bs-br);border-bottom-right-radius:var(--bs-br)}.tp-rotv_c>.tp-fldv.tp-v-lst>.tp-fldv_i{border-bottom-left-radius:var(--bs-br)}.tp-rotv_c>.tp-fldv.tp-v-lst:not(.tp-fldv-expanded)>.tp-fldv_b{border-bottom-left-radius:var(--bs-br);border-bottom-right-radius:var(--bs-br)}.tp-rotv_c .tp-fldv.tp-v-vlst:not(.tp-fldv-expanded)>.tp-fldv_b{border-bottom-right-radius:var(--bs-br)}.tp-rotv.tp-rotv-not .tp-rotv_c>.tp-fldv.tp-v-fst{margin-top:calc(-1*var(--cnt-v-p))}.tp-rotv.tp-rotv-not .tp-rotv_c>.tp-fldv.tp-v-fst>.tp-fldv_b{border-top-left-radius:var(--bs-br);border-top-right-radius:var(--bs-br)}.tp-rotv_c>.tp-tabv.tp-v-lst>.tp-tabv_c{border-bottom-left-radius:var(--bs-br);border-bottom-right-radius:var(--bs-br)}.tp-rotv_c>.tp-tabv.tp-v-lst>.tp-tabv_i{border-bottom-left-radius:var(--bs-br)}.tp-rotv.tp-rotv-not .tp-rotv_c>.tp-tabv.tp-v-fst{margin-top:calc(-1*var(--cnt-v-p))}.tp-rotv.tp-rotv-not .tp-rotv_c>.tp-tabv.tp-v-fst>.tp-tabv_t{border-top-left-radius:var(--bs-br);border-top-right-radius:var(--bs-br)}.tp-rotv.tp-v-disabled,.tp-rotv .tp-v-disabled{pointer-events:none}.tp-rotv.tp-v-hidden,.tp-rotv .tp-v-hidden{display:none}'),this.pool_.getAll().forEach(l=>{this.embedPluginStyle_(l)}),this.registerPlugin({plugins:[k1,D1,Ll,I1]})}}const N1=new i("3.1.10");t.BladeApi=n,t.ButtonApi=y,t.FolderApi=B,t.InputBindingApi=bi,t.ListApi=Jg,t.MonitorBindingApi=$e,t.Pane=O1,t.SeparatorApi=Ii,t.SliderApi=Qg,t.TabApi=Ti,t.TabPageApi=Zt,t.TextApi=e_,t.TpChangeEvent=a,t.VERSION=N1,Object.defineProperty(t,"__esModule",{value:!0})})})(um,um.exports);var B2=um.exports,hm={exports:{}};(function(r,e){(function(t,i){i(e)})(Ao,function(t){class i{constructor(v){this.controller_=v}get element(){return this.controller_.view.element}get disabled(){return this.controller_.viewProps.get("disabled")}set disabled(v){this.controller_.viewProps.set("disabled",v)}get hidden(){return this.controller_.viewProps.get("hidden")}set hidden(v){this.controller_.viewProps.set("hidden",v)}dispose(){this.controller_.viewProps.set("disposed",!0)}}class n{constructor(v){this.target=v}}class s extends n{constructor(v,S,L,z){super(v),this.value=S,this.presetKey=L,this.last=z??!0}}function a(T){return T}function o(T){return T==null}const u={alreadydisposed:()=>"View has been already disposed",invalidparams:T=>`Invalid parameters for '${T.name}'`,nomatchingcontroller:T=>`No matching controller for '${T.key}'`,nomatchingview:T=>`No matching view for '${JSON.stringify(T.params)}'`,notbindable:()=>"Value is not bindable",propertynotfound:T=>`Property '${T.name}' not found`,shouldneverhappen:()=>"This error should never happen"};class h{constructor(v){var S;this.message=(S=u[v.type](v.context))!==null&&S!==void 0?S:"Unexpected error",this.name=this.constructor.name,this.stack=new Error(this.message).stack,this.type=v.type}static alreadyDisposed(){return new h({type:"alreadydisposed"})}static notBindable(){return new h({type:"notbindable"})}static propertyNotFound(v){return new h({type:"propertynotfound",context:{name:v}})}static shouldNeverHappen(){return new h({type:"shouldneverhappen"})}}class f{constructor(){this.observers_={}}on(v,S){let L=this.observers_[v];return L||(L=this.observers_[v]=[]),L.push({handler:S}),this}off(v,S){const L=this.observers_[v];return L&&(this.observers_[v]=L.filter(z=>z.handler!==S)),this}emit(v,S){const L=this.observers_[v];L&&L.forEach(z=>{z.handler(S)})}}const c="tp";function d(T){return(S,L)=>[c,"-",T,"v",S?`_${S}`:"",L?`-${L}`:""].join("")}function m(T,v){return S=>v(T(S))}function x(T){return T.rawValue}function _(T,v){T.emitter.on("change",m(x,v)),v(T.rawValue)}function b(T,v,S){_(T.value(v),S)}function y(T,v,S){S?T.classList.add(v):T.classList.remove(v)}function M(T,v){return S=>{y(T,v,S)}}function D(T,v){_(T,S=>{v.textContent=S??""})}const C=d("btn");class P{constructor(v,S){this.element=v.createElement("div"),this.element.classList.add(C()),S.viewProps.bindClassModifiers(this.element);const L=v.createElement("button");L.classList.add(C("b")),S.viewProps.bindDisabled(L),this.element.appendChild(L),this.buttonElement=L;const z=v.createElement("div");z.classList.add(C("t")),D(S.props.value("title"),z),this.buttonElement.appendChild(z)}}class I{constructor(v,S){this.emitter=new f,this.onClick_=this.onClick_.bind(this),this.props=S.props,this.viewProps=S.viewProps,this.view=new P(v,{props:this.props,viewProps:this.viewProps}),this.view.buttonElement.addEventListener("click",this.onClick_)}onClick_(){this.emitter.emit("click",{sender:this})}}class F{constructor(v,S){var L;this.constraint_=S==null?void 0:S.constraint,this.equals_=(L=S==null?void 0:S.equals)!==null&&L!==void 0?L:(z,re)=>z===re,this.emitter=new f,this.rawValue_=v}get constraint(){return this.constraint_}get rawValue(){return this.rawValue_}set rawValue(v){this.setRawValue(v,{forceEmit:!1,last:!0})}setRawValue(v,S){const L=S??{forceEmit:!1,last:!0},z=this.constraint_?this.constraint_.constrain(v):v,re=this.rawValue_;this.equals_(re,z)&&!L.forceEmit||(this.emitter.emit("beforechange",{sender:this}),this.rawValue_=z,this.emitter.emit("change",{options:L,previousRawValue:re,rawValue:z,sender:this}))}}class A{constructor(v){this.emitter=new f,this.value_=v}get rawValue(){return this.value_}set rawValue(v){this.setRawValue(v,{forceEmit:!1,last:!0})}setRawValue(v,S){const L=S??{forceEmit:!1,last:!0},z=this.value_;z===v&&!L.forceEmit||(this.emitter.emit("beforechange",{sender:this}),this.value_=v,this.emitter.emit("change",{options:L,previousRawValue:z,rawValue:this.value_,sender:this}))}}function k(T,v){const S=v==null?void 0:v.constraint,L=v==null?void 0:v.equals;return!S&&!L?new A(T):new F(T,v)}class O{constructor(v){this.emitter=new f,this.valMap_=v;for(const S in this.valMap_)this.valMap_[S].emitter.on("change",()=>{this.emitter.emit("change",{key:S,sender:this})})}static createCore(v){return Object.keys(v).reduce((L,z)=>Object.assign(L,{[z]:k(v[z])}),{})}static fromObject(v){const S=this.createCore(v);return new O(S)}get(v){return this.valMap_[v].rawValue}set(v,S){this.valMap_[v].rawValue=S}value(v){return this.valMap_[v]}}function J(T,v){const L=Object.keys(v).reduce((z,re)=>{if(z===void 0)return;const ve=v[re],Ae=ve(T[re]);return Ae.succeeded?Object.assign(Object.assign({},z),{[re]:Ae.value}):void 0},{});return L}function Q(T,v){return T.reduce((S,L)=>{if(S===void 0)return;const z=v(L);if(!(!z.succeeded||z.value===void 0))return[...S,z.value]},[])}function X(T){return T===null?!1:typeof T=="object"}function j(T){return v=>S=>{if(!v&&S===void 0)return{succeeded:!1,value:void 0};if(v&&S===void 0)return{succeeded:!0,value:void 0};const L=T(S);return L!==void 0?{succeeded:!0,value:L}:{succeeded:!1,value:void 0}}}function K(T){return{custom:v=>j(v)(T),boolean:j(v=>typeof v=="boolean"?v:void 0)(T),number:j(v=>typeof v=="number"?v:void 0)(T),string:j(v=>typeof v=="string"?v:void 0)(T),function:j(v=>typeof v=="function"?v:void 0)(T),constant:v=>j(S=>S===v?v:void 0)(T),raw:j(v=>v)(T),object:v=>j(S=>{if(X(S))return J(S,v)})(T),array:v=>j(S=>{if(Array.isArray(S))return Q(S,v)})(T)}}const ie={optional:K(!0),required:K(!1)};function ee(T,v){const S=ie.required.object(v)(T);return S.succeeded?S.value:void 0}function V(T){console.warn([`Missing '${T.key}' of ${T.target} in ${T.place}.`,"Please rebuild plugins with the latest core package."].join(" "))}function _e(T){return T&&T.parentElement&&T.parentElement.removeChild(T),null}class U{constructor(v){this.value_=v}static create(v){return[new U(v),(S,L)=>{v.setRawValue(S,L)}]}get emitter(){return this.value_.emitter}get rawValue(){return this.value_.rawValue}}const oe=d("");function ce(T,v){return M(T,oe(void 0,v))}class me extends O{constructor(v){var S;super(v),this.onDisabledChange_=this.onDisabledChange_.bind(this),this.onParentChange_=this.onParentChange_.bind(this),this.onParentGlobalDisabledChange_=this.onParentGlobalDisabledChange_.bind(this),[this.globalDisabled_,this.setGlobalDisabled_]=U.create(k(this.getGlobalDisabled_())),this.value("disabled").emitter.on("change",this.onDisabledChange_),this.value("parent").emitter.on("change",this.onParentChange_),(S=this.get("parent"))===null||S===void 0||S.globalDisabled.emitter.on("change",this.onParentGlobalDisabledChange_)}static create(v){var S,L,z;const re=v??{};return new me(O.createCore({disabled:(S=re.disabled)!==null&&S!==void 0?S:!1,disposed:!1,hidden:(L=re.hidden)!==null&&L!==void 0?L:!1,parent:(z=re.parent)!==null&&z!==void 0?z:null}))}get globalDisabled(){return this.globalDisabled_}bindClassModifiers(v){_(this.globalDisabled_,ce(v,"disabled")),b(this,"hidden",ce(v,"hidden"))}bindDisabled(v){_(this.globalDisabled_,S=>{v.disabled=S})}bindTabIndex(v){_(this.globalDisabled_,S=>{v.tabIndex=S?-1:0})}handleDispose(v){this.value("disposed").emitter.on("change",S=>{S&&v()})}getGlobalDisabled_(){const v=this.get("parent");return(v?v.globalDisabled.rawValue:!1)||this.get("disabled")}updateGlobalDisabled_(){this.setGlobalDisabled_(this.getGlobalDisabled_())}onDisabledChange_(){this.updateGlobalDisabled_()}onParentGlobalDisabledChange_(){this.updateGlobalDisabled_()}onParentChange_(v){var S;const L=v.previousRawValue;L==null||L.globalDisabled.emitter.off("change",this.onParentGlobalDisabledChange_),(S=this.get("parent"))===null||S===void 0||S.globalDisabled.emitter.on("change",this.onParentGlobalDisabledChange_),this.updateGlobalDisabled_()}}function le(){return["veryfirst","first","last","verylast"]}const be=d(""),ue={veryfirst:"vfst",first:"fst",last:"lst",verylast:"vlst"};class We{constructor(v){this.parent_=null,this.blade=v.blade,this.view=v.view,this.viewProps=v.viewProps;const S=this.view.element;this.blade.value("positions").emitter.on("change",()=>{le().forEach(L=>{S.classList.remove(be(void 0,ue[L]))}),this.blade.get("positions").forEach(L=>{S.classList.add(be(void 0,ue[L]))})}),this.viewProps.handleDispose(()=>{_e(S)})}get parent(){return this.parent_}set parent(v){if(this.parent_=v,!("parent"in this.viewProps.valMap_)){V({key:"parent",target:me.name,place:"BladeController.parent"});return}this.viewProps.set("parent",this.parent_?this.parent_.viewProps:null)}}const ye="http://www.w3.org/2000/svg";function Ne(T){T.offsetHeight}function Ce(T,v){const S=T.style.transition;T.style.transition="none",v(),T.style.transition=S}function Ze(T){return T.ontouchstart!==void 0}function Qe(T){for(;T.childNodes.length>0;)T.removeChild(T.childNodes[0])}function Pe(T){return T.relatedTarget?T.relatedTarget:"explicitOriginalTarget"in T?T.explicitOriginalTarget:null}const ct=d("lbl");function xt(T,v){const S=T.createDocumentFragment();return v.split(`
`).map(z=>T.createTextNode(z)).forEach((z,re)=>{re>0&&S.appendChild(T.createElement("br")),S.appendChild(z)}),S}class mt{constructor(v,S){this.element=v.createElement("div"),this.element.classList.add(ct()),S.viewProps.bindClassModifiers(this.element);const L=v.createElement("div");L.classList.add(ct("l")),b(S.props,"label",re=>{o(re)?this.element.classList.add(ct(void 0,"nol")):(this.element.classList.remove(ct(void 0,"nol")),Qe(L),L.appendChild(xt(v,re)))}),this.element.appendChild(L),this.labelElement=L;const z=v.createElement("div");z.classList.add(ct("v")),this.element.appendChild(z),this.valueElement=z}}class he extends We{constructor(v,S){const L=S.valueController.viewProps;super(Object.assign(Object.assign({},S),{view:new mt(v,{props:S.props,viewProps:L}),viewProps:L})),this.props=S.props,this.valueController=S.valueController,this.view.valueElement.appendChild(this.valueController.view.element)}}class Tt extends We{constructor(v){super(v),this.value=v.value}}class _t extends O{constructor(v){super(v)}static create(v){const S={completed:!0,expanded:v,expandedHeight:null,shouldFixHeight:!1,temporaryExpanded:null},L=O.createCore(S);return new _t(L)}get styleExpanded(){var v;return(v=this.get("temporaryExpanded"))!==null&&v!==void 0?v:this.get("expanded")}get styleHeight(){if(!this.styleExpanded)return"0";const v=this.get("expandedHeight");return this.get("shouldFixHeight")&&!o(v)?`${v}px`:"auto"}bindExpandedClass(v,S){const L=()=>{this.styleExpanded?v.classList.add(S):v.classList.remove(S)};b(this,"expanded",L),b(this,"temporaryExpanded",L)}cleanUpTransition(){this.set("shouldFixHeight",!1),this.set("expandedHeight",null),this.set("completed",!0)}}function Ot(T){return _t.create(T)}function wt(T,v){let S=0;return Ce(v,()=>{T.set("expandedHeight",null),T.set("temporaryExpanded",!0),Ne(v),S=v.clientHeight,T.set("temporaryExpanded",null),Ne(v)}),S}function G(T,v){v.style.height=T.styleHeight}function N(T,v){T.value("expanded").emitter.on("beforechange",()=>{T.set("completed",!1),o(T.get("expandedHeight"))&&T.set("expandedHeight",wt(T,v)),T.set("shouldFixHeight",!0),Ne(v)}),T.emitter.on("change",()=>{G(T,v)}),G(T,v),v.addEventListener("transitionend",S=>{S.propertyName==="height"&&T.cleanUpTransition()})}class fe{constructor(v,S){const L=d(S.viewName);this.element=v.createElement("div"),this.element.classList.add(L()),S.viewProps.bindClassModifiers(this.element)}}class xe extends Tt{constructor(v,S){const L=S.valueController.viewProps;super(Object.assign(Object.assign({},S),{value:S.valueController.value,view:new mt(v,{props:S.props,viewProps:L}),viewProps:L})),this.props=S.props,this.valueController=S.valueController,this.view.valueElement.appendChild(this.valueController.view.element)}}class Me{constructor(){this.disabled=!1,this.emitter=new f}dispose(){}tick(){this.disabled||this.emitter.emit("tick",{sender:this})}}class Se{constructor(v,S){this.disabled_=!1,this.timerId_=null,this.onTick_=this.onTick_.bind(this),this.doc_=v,this.emitter=new f,this.interval_=S,this.setTimer_()}get disabled(){return this.disabled_}set disabled(v){this.disabled_=v,this.disabled_?this.clearTimer_():this.setTimer_()}dispose(){this.clearTimer_()}clearTimer_(){if(this.timerId_===null)return;const v=this.doc_.defaultView;v&&v.clearInterval(this.timerId_),this.timerId_=null}setTimer_(){if(this.clearTimer_(),this.interval_<=0)return;const v=this.doc_.defaultView;v&&(this.timerId_=v.setInterval(this.onTick_,this.interval_))}onTick_(){this.disabled_||this.emitter.emit("tick",{sender:this})}}class je{constructor(v){this.constraints=v}constrain(v){return this.constraints.reduce((S,L)=>L.constrain(S),v)}}function H(T,v){if(T instanceof v)return T;if(T instanceof je){const S=T.constraints.reduce((L,z)=>L||(z instanceof v?z:null),null);if(S)return S}return null}class ne{constructor(v){this.values=O.fromObject({max:v.max,min:v.min})}constrain(v){const S=this.values.get("max"),L=this.values.get("min");return Math.min(Math.max(v,L),S)}}class Fe{constructor(v){this.values=O.fromObject({max:v.max,min:v.min})}get maxValue(){return this.values.get("max")}get minValue(){return this.values.get("min")}constrain(v){const S=this.values.get("max"),L=this.values.get("min");let z=v;return o(L)||(z=Math.max(z,L)),o(S)||(z=Math.min(z,S)),z}}class Te{constructor(v,S=0){this.step=v,this.origin=S}constrain(v){const S=this.origin%this.step,L=Math.round((v-S)/this.step);return S+L*this.step}}const Re=d("pop");class He{constructor(v,S){this.element=v.createElement("div"),this.element.classList.add(Re()),S.viewProps.bindClassModifiers(this.element),_(S.shows,M(this.element,Re(void 0,"v")))}}class ze{constructor(v,S){this.shows=k(!1),this.viewProps=S.viewProps,this.view=new He(v,{shows:this.shows,viewProps:this.viewProps})}}const ut=d("txt");class ht{constructor(v,S){this.onChange_=this.onChange_.bind(this),this.element=v.createElement("div"),this.element.classList.add(ut()),S.viewProps.bindClassModifiers(this.element),this.props_=S.props,this.props_.emitter.on("change",this.onChange_);const L=v.createElement("input");L.classList.add(ut("i")),L.type="text",S.viewProps.bindDisabled(L),this.element.appendChild(L),this.inputElement=L,S.value.emitter.on("change",this.onChange_),this.value_=S.value,this.refresh()}refresh(){const v=this.props_.get("formatter");this.inputElement.value=v(this.value_.rawValue)}onChange_(){this.refresh()}}class Ct{constructor(v,S){this.onInputChange_=this.onInputChange_.bind(this),this.parser_=S.parser,this.props=S.props,this.value=S.value,this.viewProps=S.viewProps,this.view=new ht(v,{props:S.props,value:this.value,viewProps:this.viewProps}),this.view.inputElement.addEventListener("change",this.onInputChange_)}onInputChange_(v){const L=v.currentTarget.value,z=this.parser_(L);o(z)||(this.value.rawValue=z),this.view.refresh()}}function $(T){return T==="false"?!1:!!T}class ge{constructor(v){this.text=v}evaluate(){return Number(this.text)}toString(){return this.text}}const we={"**":(T,v)=>Math.pow(T,v),"*":(T,v)=>T*v,"/":(T,v)=>T/v,"%":(T,v)=>T%v,"+":(T,v)=>T+v,"-":(T,v)=>T-v,"<<":(T,v)=>T<<v,">>":(T,v)=>T>>v,">>>":(T,v)=>T>>>v,"&":(T,v)=>T&v,"^":(T,v)=>T^v,"|":(T,v)=>T|v};class ke{constructor(v,S,L){this.left=S,this.operator=v,this.right=L}evaluate(){const v=we[this.operator];if(!v)throw new Error(`unexpected binary operator: '${this.operator}`);return v(this.left.evaluate(),this.right.evaluate())}toString(){return["b(",this.left.toString(),this.operator,this.right.toString(),")"].join(" ")}}const Ge={"+":T=>T,"-":T=>-T,"~":T=>~T};class St{constructor(v,S){this.operator=v,this.expression=S}evaluate(){const v=Ge[this.operator];if(!v)throw new Error(`unexpected unary operator: '${this.operator}`);return v(this.expression.evaluate())}toString(){return["u(",this.operator,this.expression.toString(),")"].join(" ")}}function Vt(T){return(v,S)=>{for(let L=0;L<T.length;L++){const z=T[L](v,S);if(z!=="")return z}return""}}function Lt(T,v){var S;const L=T.substr(v).match(/^\s+/);return(S=L&&L[0])!==null&&S!==void 0?S:""}function bi(T,v){const S=T.substr(v,1);return S.match(/^[1-9]$/)?S:""}function Le(T,v){var S;const L=T.substr(v).match(/^[0-9]+/);return(S=L&&L[0])!==null&&S!==void 0?S:""}function $e(T,v){const S=Le(T,v);if(S!=="")return S;const L=T.substr(v,1);if(v+=1,L!=="-"&&L!=="+")return"";const z=Le(T,v);return z===""?"":L+z}function it(T,v){const S=T.substr(v,1);if(v+=1,S.toLowerCase()!=="e")return"";const L=$e(T,v);return L===""?"":S+L}function Ie(T,v){const S=T.substr(v,1);if(S==="0")return S;const L=bi(T,v);return v+=L.length,L===""?"":L+Le(T,v)}function at(T,v){const S=Ie(T,v);if(v+=S.length,S==="")return"";const L=T.substr(v,1);if(v+=L.length,L!==".")return"";const z=Le(T,v);return v+=z.length,S+L+z+it(T,v)}function et(T,v){const S=T.substr(v,1);if(v+=S.length,S!==".")return"";const L=Le(T,v);return v+=L.length,L===""?"":S+L+it(T,v)}function lt(T,v){const S=Ie(T,v);return v+=S.length,S===""?"":S+it(T,v)}const B=Vt([at,et,lt]);function te(T,v){var S;const L=T.substr(v).match(/^[01]+/);return(S=L&&L[0])!==null&&S!==void 0?S:""}function de(T,v){const S=T.substr(v,2);if(v+=S.length,S.toLowerCase()!=="0b")return"";const L=te(T,v);return L===""?"":S+L}function se(T,v){var S;const L=T.substr(v).match(/^[0-7]+/);return(S=L&&L[0])!==null&&S!==void 0?S:""}function pe(T,v){const S=T.substr(v,2);if(v+=S.length,S.toLowerCase()!=="0o")return"";const L=se(T,v);return L===""?"":S+L}function Oe(T,v){var S;const L=T.substr(v).match(/^[0-9a-f]+/i);return(S=L&&L[0])!==null&&S!==void 0?S:""}function Be(T,v){const S=T.substr(v,2);if(v+=S.length,S.toLowerCase()!=="0x")return"";const L=Oe(T,v);return L===""?"":S+L}const rt=Vt([de,pe,Be]),Ye=Vt([rt,B]);function ot(T,v){const S=Ye(T,v);return v+=S.length,S===""?null:{evaluable:new ge(S),cursor:v}}function gt(T,v){const S=T.substr(v,1);if(v+=S.length,S!=="(")return null;const L=yt(T,v);if(!L)return null;v=L.cursor,v+=Lt(T,v).length;const z=T.substr(v,1);return v+=z.length,z!==")"?null:{evaluable:L.evaluable,cursor:v}}function nt(T,v){var S;return(S=ot(T,v))!==null&&S!==void 0?S:gt(T,v)}function bt(T,v){const S=nt(T,v);if(S)return S;const L=T.substr(v,1);if(v+=L.length,L!=="+"&&L!=="-"&&L!=="~")return null;const z=bt(T,v);return z?(v=z.cursor,{cursor:v,evaluable:new St(L,z.evaluable)}):null}function Ft(T,v,S){S+=Lt(v,S).length;const L=T.filter(z=>v.startsWith(z,S))[0];return L?(S+=L.length,S+=Lt(v,S).length,{cursor:S,operator:L}):null}function Yt(T,v){return(S,L)=>{const z=T(S,L);if(!z)return null;L=z.cursor;let re=z.evaluable;for(;;){const ve=Ft(v,S,L);if(!ve)break;L=ve.cursor;const Ae=T(S,L);if(!Ae)return null;L=Ae.cursor,re=new ke(ve.operator,re,Ae.evaluable)}return re?{cursor:L,evaluable:re}:null}}const Ii=[["**"],["*","/","%"],["+","-"],["<<",">>>",">>"],["&"],["^"],["|"]].reduce((T,v)=>Yt(T,v),bt);function yt(T,v){return v+=Lt(T,v).length,Ii(T,v)}function tt(T){const v=yt(T,0);return!v||v.cursor+Lt(T,v.cursor).length!==T.length?null:v.evaluable}function ai(T){var v;const S=tt(T);return(v=S==null?void 0:S.evaluate())!==null&&v!==void 0?v:null}function Kt(T){if(typeof T=="number")return T;if(typeof T=="string"){const v=ai(T);if(!o(v))return v}return 0}function zt(T){return v=>v.toFixed(Math.max(Math.min(T,20),0))}const Hn=zt(0);function ii(T){return Hn(T)+"%"}function hn(T){return String(T)}function Zt(T,v){for(;T.length<v;)T.push(void 0)}function Ti(T){const v=[];return Zt(v,T),k(v)}function br(T){const v=T.indexOf(void 0);return v<0?T:T.slice(0,v)}function Fi(T,v){const S=[...br(T),v];return S.length>T.length?S.splice(0,S.length-T.length):Zt(S,T.length),S}function Wn({primary:T,secondary:v,forward:S,backward:L}){let z=!1;function re(ve){z||(z=!0,ve(),z=!1)}T.emitter.on("change",ve=>{re(()=>{v.setRawValue(S(T,v),ve.options)})}),v.emitter.on("change",ve=>{re(()=>{T.setRawValue(L(T,v),ve.options)}),re(()=>{v.setRawValue(S(T,v),ve.options)})}),re(()=>{v.setRawValue(S(T,v),{forceEmit:!1,last:!0})})}function bs(T,v){const S=T*(v.altKey?.1:1)*(v.shiftKey?10:1);return v.upKey?+S:v.downKey?-S:0}function xs(T){return{altKey:T.altKey,downKey:T.key==="ArrowDown",shiftKey:T.shiftKey,upKey:T.key==="ArrowUp"}}function Ll(T){return{altKey:T.altKey,downKey:T.key==="ArrowLeft",shiftKey:T.shiftKey,upKey:T.key==="ArrowRight"}}function Md(T){return T==="ArrowUp"||T==="ArrowDown"}function xu(T){return Md(T)||T==="ArrowLeft"||T==="ArrowRight"}function Rl(T,v){var S,L;const z=v.ownerDocument.defaultView,re=v.getBoundingClientRect();return{x:T.pageX-(((S=z&&z.scrollX)!==null&&S!==void 0?S:0)+re.left),y:T.pageY-(((L=z&&z.scrollY)!==null&&L!==void 0?L:0)+re.top)}}class la{constructor(v){this.lastTouch_=null,this.onDocumentMouseMove_=this.onDocumentMouseMove_.bind(this),this.onDocumentMouseUp_=this.onDocumentMouseUp_.bind(this),this.onMouseDown_=this.onMouseDown_.bind(this),this.onTouchEnd_=this.onTouchEnd_.bind(this),this.onTouchMove_=this.onTouchMove_.bind(this),this.onTouchStart_=this.onTouchStart_.bind(this),this.elem_=v,this.emitter=new f,v.addEventListener("touchstart",this.onTouchStart_,{passive:!1}),v.addEventListener("touchmove",this.onTouchMove_,{passive:!0}),v.addEventListener("touchend",this.onTouchEnd_),v.addEventListener("mousedown",this.onMouseDown_)}computePosition_(v){const S=this.elem_.getBoundingClientRect();return{bounds:{width:S.width,height:S.height},point:v?{x:v.x,y:v.y}:null}}onMouseDown_(v){var S;v.preventDefault(),(S=v.currentTarget)===null||S===void 0||S.focus();const L=this.elem_.ownerDocument;L.addEventListener("mousemove",this.onDocumentMouseMove_),L.addEventListener("mouseup",this.onDocumentMouseUp_),this.emitter.emit("down",{altKey:v.altKey,data:this.computePosition_(Rl(v,this.elem_)),sender:this,shiftKey:v.shiftKey})}onDocumentMouseMove_(v){this.emitter.emit("move",{altKey:v.altKey,data:this.computePosition_(Rl(v,this.elem_)),sender:this,shiftKey:v.shiftKey})}onDocumentMouseUp_(v){const S=this.elem_.ownerDocument;S.removeEventListener("mousemove",this.onDocumentMouseMove_),S.removeEventListener("mouseup",this.onDocumentMouseUp_),this.emitter.emit("up",{altKey:v.altKey,data:this.computePosition_(Rl(v,this.elem_)),sender:this,shiftKey:v.shiftKey})}onTouchStart_(v){v.preventDefault();const S=v.targetTouches.item(0),L=this.elem_.getBoundingClientRect();this.emitter.emit("down",{altKey:v.altKey,data:this.computePosition_(S?{x:S.clientX-L.left,y:S.clientY-L.top}:void 0),sender:this,shiftKey:v.shiftKey}),this.lastTouch_=S}onTouchMove_(v){const S=v.targetTouches.item(0),L=this.elem_.getBoundingClientRect();this.emitter.emit("move",{altKey:v.altKey,data:this.computePosition_(S?{x:S.clientX-L.left,y:S.clientY-L.top}:void 0),sender:this,shiftKey:v.shiftKey}),this.lastTouch_=S}onTouchEnd_(v){var S;const L=(S=v.targetTouches.item(0))!==null&&S!==void 0?S:this.lastTouch_,z=this.elem_.getBoundingClientRect();this.emitter.emit("up",{altKey:v.altKey,data:this.computePosition_(L?{x:L.clientX-z.left,y:L.clientY-z.top}:void 0),sender:this,shiftKey:v.shiftKey})}}function li(T,v,S,L,z){const re=(T-v)/(S-v);return L+re*(z-L)}function wu(T){return String(T.toFixed(10)).split(".")[1].replace(/0+$/,"").length}function xr(T,v,S){return Math.min(Math.max(T,v),S)}const dn=d("txt");class Td{constructor(v,S){this.onChange_=this.onChange_.bind(this),this.props_=S.props,this.props_.emitter.on("change",this.onChange_),this.element=v.createElement("div"),this.element.classList.add(dn(),dn(void 0,"num")),S.arrayPosition&&this.element.classList.add(dn(void 0,S.arrayPosition)),S.viewProps.bindClassModifiers(this.element);const L=v.createElement("input");L.classList.add(dn("i")),L.type="text",S.viewProps.bindDisabled(L),this.element.appendChild(L),this.inputElement=L,this.onDraggingChange_=this.onDraggingChange_.bind(this),this.dragging_=S.dragging,this.dragging_.emitter.on("change",this.onDraggingChange_),this.element.classList.add(dn()),this.inputElement.classList.add(dn("i"));const z=v.createElement("div");z.classList.add(dn("k")),this.element.appendChild(z),this.knobElement=z;const re=v.createElementNS(ye,"svg");re.classList.add(dn("g")),this.knobElement.appendChild(re);const ve=v.createElementNS(ye,"path");ve.classList.add(dn("gb")),re.appendChild(ve),this.guideBodyElem_=ve;const Ae=v.createElementNS(ye,"path");Ae.classList.add(dn("gh")),re.appendChild(Ae),this.guideHeadElem_=Ae;const Rt=v.createElement("div");Rt.classList.add(d("tt")()),this.knobElement.appendChild(Rt),this.tooltipElem_=Rt,S.value.emitter.on("change",this.onChange_),this.value=S.value,this.refresh()}onDraggingChange_(v){if(v.rawValue===null){this.element.classList.remove(dn(void 0,"drg"));return}this.element.classList.add(dn(void 0,"drg"));const S=v.rawValue/this.props_.get("draggingScale"),L=S+(S>0?-1:S<0?1:0),z=xr(-L,-4,4);this.guideHeadElem_.setAttributeNS(null,"d",[`M ${L+z},0 L${L},4 L${L+z},8`,`M ${S},-1 L${S},9`].join(" ")),this.guideBodyElem_.setAttributeNS(null,"d",`M 0,4 L${S},4`);const re=this.props_.get("formatter");this.tooltipElem_.textContent=re(this.value.rawValue),this.tooltipElem_.style.left=`${S}px`}refresh(){const v=this.props_.get("formatter");this.inputElement.value=v(this.value.rawValue)}onChange_(){this.refresh()}}class io{constructor(v,S){var L;this.originRawValue_=0,this.onInputChange_=this.onInputChange_.bind(this),this.onInputKeyDown_=this.onInputKeyDown_.bind(this),this.onInputKeyUp_=this.onInputKeyUp_.bind(this),this.onPointerDown_=this.onPointerDown_.bind(this),this.onPointerMove_=this.onPointerMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.baseStep_=S.baseStep,this.parser_=S.parser,this.props=S.props,this.sliderProps_=(L=S.sliderProps)!==null&&L!==void 0?L:null,this.value=S.value,this.viewProps=S.viewProps,this.dragging_=k(null),this.view=new Td(v,{arrayPosition:S.arrayPosition,dragging:this.dragging_,props:this.props,value:this.value,viewProps:this.viewProps}),this.view.inputElement.addEventListener("change",this.onInputChange_),this.view.inputElement.addEventListener("keydown",this.onInputKeyDown_),this.view.inputElement.addEventListener("keyup",this.onInputKeyUp_);const z=new la(this.view.knobElement);z.emitter.on("down",this.onPointerDown_),z.emitter.on("move",this.onPointerMove_),z.emitter.on("up",this.onPointerUp_)}constrainValue_(v){var S,L;const z=(S=this.sliderProps_)===null||S===void 0?void 0:S.get("minValue"),re=(L=this.sliderProps_)===null||L===void 0?void 0:L.get("maxValue");let ve=v;return z!==void 0&&(ve=Math.max(ve,z)),re!==void 0&&(ve=Math.min(ve,re)),ve}onInputChange_(v){const L=v.currentTarget.value,z=this.parser_(L);o(z)||(this.value.rawValue=this.constrainValue_(z)),this.view.refresh()}onInputKeyDown_(v){const S=bs(this.baseStep_,xs(v));S!==0&&this.value.setRawValue(this.constrainValue_(this.value.rawValue+S),{forceEmit:!1,last:!1})}onInputKeyUp_(v){bs(this.baseStep_,xs(v))!==0&&this.value.setRawValue(this.value.rawValue,{forceEmit:!0,last:!0})}onPointerDown_(){this.originRawValue_=this.value.rawValue,this.dragging_.rawValue=0}computeDraggingValue_(v){if(!v.point)return null;const S=v.point.x-v.bounds.width/2;return this.constrainValue_(this.originRawValue_+S*this.props.get("draggingScale"))}onPointerMove_(v){const S=this.computeDraggingValue_(v.data);S!==null&&(this.value.setRawValue(S,{forceEmit:!1,last:!1}),this.dragging_.rawValue=this.value.rawValue-this.originRawValue_)}onPointerUp_(v){const S=this.computeDraggingValue_(v.data);S!==null&&(this.value.setRawValue(S,{forceEmit:!0,last:!0}),this.dragging_.rawValue=null)}}function Cn(T,v){T.write(v)}function wr(T){const v=T?H(T,Te):null;return v?v.step:null}function no(T,v){const S=T&&H(T,Te);return S?wu(S.step):Math.max(wu(v),2)}function kl(T){const v=wr(T);return v??1}function ca(T,v){var S;const L=T&&H(T,Te),z=Math.abs((S=L==null?void 0:L.step)!==null&&S!==void 0?S:v);return z===0?.1:Math.pow(10,Math.floor(Math.log10(z))-1)}function yr(T){return[T[0],T[1],T[2]]}function yu(T){const v=xr(Math.floor(T),0,255).toString(16);return v.length===1?`0${v}`:v}function so(T,v="#"){const S=yr(T.getComponents("rgb")).map(yu).join("");return`${v}${S}`}function Su(T,v="#"){const S=T.getComponents("rgb"),L=[S[0],S[1],S[2],S[3]*255].map(yu).join("");return`${v}${L}`}function Ed(T,v){const S=zt(v==="float"?2:0);return`rgb(${yr(T.getComponents("rgb",v)).map(z=>S(z)).join(", ")})`}function Mu(T){return v=>Ed(v,T)}function Tu(T,v){const S=zt(2),L=zt(v==="float"?2:0);return`rgba(${T.getComponents("rgb",v).map((re,ve)=>(ve===3?S:L)(re)).join(", ")})`}function Cd(T){return v=>Tu(v,T)}function ua(T){const v=[zt(0),ii,ii];return`hsl(${yr(T.getComponents("hsl")).map((L,z)=>v[z](L)).join(", ")})`}function Dd(T){const v=[zt(0),ii,ii,zt(2)];return`hsla(${T.getComponents("hsl").map((L,z)=>v[z](L)).join(", ")})`}function Eu(T,v){const S=zt(v==="float"?2:0),L=["r","g","b"];return`{${yr(T.getComponents("rgb",v)).map((re,ve)=>`${L[ve]}: ${S(re)}`).join(", ")}}`}function Cu(T){return v=>Eu(v,T)}function Pd(T,v){const S=zt(2),L=zt(v==="float"?2:0),z=["r","g","b","a"];return`{${T.getComponents("rgb",v).map((ve,Ae)=>{const Rt=Ae===3?S:L;return`${z[Ae]}: ${Rt(ve)}`}).join(", ")}}`}function Ad(T){return v=>Pd(v,T)}[...["int","float"].reduce((T,v)=>[...T,{format:{alpha:!1,mode:"rgb",notation:"func",type:v},stringifier:Mu(v)},{format:{alpha:!0,mode:"rgb",notation:"func",type:v},stringifier:Cd(v)},{format:{alpha:!1,mode:"rgb",notation:"object",type:v},stringifier:Cu(v)},{format:{alpha:!0,mode:"rgb",notation:"object",type:v},stringifier:Ad(v)}],[])];class Ld{constructor(v){this.components=v.components,this.asm_=v.assembly}constrain(v){const S=this.asm_.toComponents(v).map((L,z)=>{var re,ve;return(ve=(re=this.components[z])===null||re===void 0?void 0:re.constrain(L))!==null&&ve!==void 0?ve:L});return this.asm_.fromComponents(S)}}const Du=d("pndtxt");class Rd{constructor(v,S){this.textViews=S.textViews,this.element=v.createElement("div"),this.element.classList.add(Du()),this.textViews.forEach(L=>{const z=v.createElement("div");z.classList.add(Du("a")),z.appendChild(L.element),this.element.appendChild(z)})}}function Il(T,v,S){return new io(T,{arrayPosition:S===0?"fst":S===v.axes.length-1?"lst":"mid",baseStep:v.axes[S].baseStep,parser:v.parser,props:v.axes[S].textProps,value:k(0,{constraint:v.axes[S].constraint}),viewProps:v.viewProps})}class Us{constructor(v,S){this.value=S.value,this.viewProps=S.viewProps,this.acs_=S.axes.map((L,z)=>Il(v,S,z)),this.acs_.forEach((L,z)=>{Wn({primary:this.value,secondary:L.value,forward:re=>S.assembly.toComponents(re.rawValue)[z],backward:(re,ve)=>{const Ae=S.assembly.toComponents(re.rawValue);return Ae[z]=ve.rawValue,S.assembly.fromComponents(Ae)}})}),this.view=new Rd(v,{textViews:this.acs_.map(L=>L.view)})}}function kd(T,v){return"step"in T&&!o(T.step)?new Te(T.step,v):null}function ro(T){return!o(T.max)&&!o(T.min)?new ne({max:T.max,min:T.min}):!o(T.max)||!o(T.min)?new Fe({max:T.max,min:T.min}):null}const Id={monitor:{defaultInterval:200,defaultLineCount:3}},jn=d("grl");class Pu{constructor(v,S){this.onCursorChange_=this.onCursorChange_.bind(this),this.onValueUpdate_=this.onValueUpdate_.bind(this),this.element=v.createElement("div"),this.element.classList.add(jn()),S.viewProps.bindClassModifiers(this.element),this.formatter_=S.formatter,this.props_=S.props,this.cursor_=S.cursor,this.cursor_.emitter.on("change",this.onCursorChange_);const L=v.createElementNS(ye,"svg");L.classList.add(jn("g")),L.style.height=`calc(var(--bld-us) * ${S.lineCount})`,this.element.appendChild(L),this.svgElem_=L;const z=v.createElementNS(ye,"polyline");this.svgElem_.appendChild(z),this.lineElem_=z;const re=v.createElement("div");re.classList.add(jn("t"),d("tt")()),this.element.appendChild(re),this.tooltipElem_=re,S.value.emitter.on("change",this.onValueUpdate_),this.value=S.value,this.update_()}get graphElement(){return this.svgElem_}update_(){const v=this.svgElem_.getBoundingClientRect(),S=this.value.rawValue.length-1,L=this.props_.get("minValue"),z=this.props_.get("maxValue"),re=[];this.value.rawValue.forEach((mn,Et)=>{if(mn===void 0)return;const Ss=li(Et,0,S,0,v.width),$d=li(mn,L,z,v.height,0);re.push([Ss,$d].join(","))}),this.lineElem_.setAttributeNS(null,"points",re.join(" "));const ve=this.tooltipElem_,Ae=this.value.rawValue[this.cursor_.rawValue];if(Ae===void 0){ve.classList.remove(jn("t","a"));return}const Rt=li(this.cursor_.rawValue,0,S,0,v.width),fn=li(Ae,L,z,v.height,0);ve.style.left=`${Rt}px`,ve.style.top=`${fn}px`,ve.textContent=`${this.formatter_(Ae)}`,ve.classList.contains(jn("t","a"))||(ve.classList.add(jn("t","a"),jn("t","in")),Ne(ve),ve.classList.remove(jn("t","in")))}onValueUpdate_(){this.update_()}onCursorChange_(){this.update_()}}class Fd{constructor(v,S){if(this.onGraphMouseMove_=this.onGraphMouseMove_.bind(this),this.onGraphMouseLeave_=this.onGraphMouseLeave_.bind(this),this.onGraphPointerDown_=this.onGraphPointerDown_.bind(this),this.onGraphPointerMove_=this.onGraphPointerMove_.bind(this),this.onGraphPointerUp_=this.onGraphPointerUp_.bind(this),this.props_=S.props,this.value=S.value,this.viewProps=S.viewProps,this.cursor_=k(-1),this.view=new Pu(v,{cursor:this.cursor_,formatter:S.formatter,lineCount:S.lineCount,props:this.props_,value:this.value,viewProps:this.viewProps}),!Ze(v))this.view.element.addEventListener("mousemove",this.onGraphMouseMove_),this.view.element.addEventListener("mouseleave",this.onGraphMouseLeave_);else{const L=new la(this.view.element);L.emitter.on("down",this.onGraphPointerDown_),L.emitter.on("move",this.onGraphPointerMove_),L.emitter.on("up",this.onGraphPointerUp_)}}onGraphMouseLeave_(){this.cursor_.rawValue=-1}onGraphMouseMove_(v){const S=this.view.element.getBoundingClientRect();this.cursor_.rawValue=Math.floor(li(v.offsetX,0,S.width,0,this.value.rawValue.length))}onGraphPointerDown_(v){this.onGraphPointerMove_(v)}onGraphPointerMove_(v){if(!v.data.point){this.cursor_.rawValue=-1;return}this.cursor_.rawValue=Math.floor(li(v.data.point.x,0,v.data.bounds.width,0,this.value.rawValue.length))}onGraphPointerUp_(){this.cursor_.rawValue=-1}}class Au{constructor(v){this.controller_=v}get disabled(){return this.controller_.viewProps.get("disabled")}set disabled(v){this.controller_.viewProps.set("disabled",v)}get title(){var v;return(v=this.controller_.props.get("title"))!==null&&v!==void 0?v:""}set title(v){this.controller_.props.set("title",v)}on(v,S){const L=S.bind(this);return this.controller_.emitter.on(v,()=>{L(new n(this))}),this}}class Od extends n{constructor(v,S,L){super(v),this.cell=S,this.index=L}}class Lu extends i{constructor(v){super(v),this.cellToApiMap_=new Map,this.emitter_=new f;const S=this.controller_.valueController;S.cellControllers.forEach((L,z)=>{const re=new Au(L);this.cellToApiMap_.set(L,re),L.emitter.on("click",()=>{const ve=z%S.size[0],Ae=Math.floor(z/S.size[0]);this.emitter_.emit("click",{event:new Od(this,re,[ve,Ae])})})})}cell(v,S){const L=this.controller_.valueController,z=L.cellControllers[S*L.size[0]+v];return this.cellToApiMap_.get(z)}on(v,S){const L=S.bind(this);return this.emitter_.on(v,z=>{L(z.event)}),this}}class Fl{constructor(v,S){this.size=S.size;const[L,z]=this.size,re=[];for(let ve=0;ve<z;ve++)for(let Ae=0;Ae<L;Ae++){const Rt=new I(v,{props:O.fromObject(Object.assign({},S.cellConfig(Ae,ve))),viewProps:me.create()});re.push(Rt)}this.cellCs_=re,this.viewProps=me.create(),this.viewProps.handleDispose(()=>{this.cellCs_.forEach(ve=>{ve.viewProps.set("disposed",!0)})}),this.view=new fe(v,{viewProps:this.viewProps,viewName:"btngrid"}),this.view.element.style.gridTemplateColumns=`repeat(${L}, 1fr)`,this.cellCs_.forEach(ve=>{this.view.element.appendChild(ve.view.element)})}get cellControllers(){return this.cellCs_}}const Nd={id:"buttongrid",type:"blade",css:'.tp-cbzgv,.tp-radv_b,.tp-rslv_k,.tp-cbzv_b{-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:rgba(0,0,0,0);border-width:0;font-family:inherit;font-size:inherit;font-weight:inherit;margin:0;outline:none;padding:0}.tp-radv_b,.tp-rslv_k,.tp-cbzv_b{background-color:var(--btn-bg);border-radius:var(--elm-br);color:var(--btn-fg);cursor:pointer;display:block;font-weight:bold;height:var(--bld-us);line-height:var(--bld-us);overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.tp-radv_b:hover,.tp-rslv_k:hover,.tp-cbzv_b:hover{background-color:var(--btn-bg-h)}.tp-radv_b:focus,.tp-rslv_k:focus,.tp-cbzv_b:focus{background-color:var(--btn-bg-f)}.tp-radv_b:active,.tp-rslv_k:active,.tp-cbzv_b:active{background-color:var(--btn-bg-a)}.tp-radv_b:disabled,.tp-rslv_k:disabled,.tp-cbzv_b:disabled{opacity:.5}.tp-cbzgv{background-color:var(--in-bg);border-radius:var(--elm-br);box-sizing:border-box;color:var(--in-fg);font-family:inherit;height:var(--bld-us);line-height:var(--bld-us);min-width:0;width:100%}.tp-cbzgv:hover{background-color:var(--in-bg-h)}.tp-cbzgv:focus{background-color:var(--in-bg-f)}.tp-cbzgv:active{background-color:var(--in-bg-a)}.tp-cbzgv:disabled{opacity:.5}.tp-btngridv{border-radius:var(--elm-br);display:grid;overflow:hidden;gap:2px}.tp-btngridv.tp-v-disabled{opacity:.5}.tp-btngridv .tp-btnv_b:disabled{opacity:1}.tp-btngridv .tp-btnv_b:disabled .tp-btnv_t{opacity:.5}.tp-btngridv .tp-btnv_b{border-radius:0}.tp-cbzv{position:relative}.tp-cbzv_h{display:flex}.tp-cbzv_b{margin-right:4px;position:relative;width:var(--bld-us)}.tp-cbzv_b svg{display:block;height:16px;left:50%;margin-left:-8px;margin-top:-8px;position:absolute;top:50%;width:16px}.tp-cbzv_b svg path{stroke:var(--bs-bg);stroke-width:2}.tp-cbzv_t{flex:1}.tp-cbzv_p{height:0;margin-top:0;opacity:0;overflow:hidden;transition:height .2s ease-in-out,opacity .2s linear,margin .2s ease-in-out}.tp-cbzv.tp-cbzv-expanded .tp-cbzv_p{margin-top:var(--bld-s);opacity:1}.tp-cbzv.tp-cbzv-cpl .tp-cbzv_p{overflow:visible}.tp-cbzv .tp-popv{left:calc(-1*var(--cnt-h-p));position:absolute;right:calc(-1*var(--cnt-h-p));top:var(--bld-us)}.tp-cbzpv_t{margin-top:var(--bld-s)}.tp-cbzgv{height:auto;overflow:hidden;position:relative}.tp-cbzgv.tp-v-disabled{opacity:.5}.tp-cbzgv_p{left:16px;position:absolute;right:16px;top:0}.tp-cbzgv_g{cursor:pointer;display:block;height:calc(var(--bld-us)*5);width:100%}.tp-cbzgv_u{opacity:.1;stroke:var(--in-fg);stroke-dasharray:1}.tp-cbzgv_l{fill:rgba(0,0,0,0);stroke:var(--in-fg)}.tp-cbzgv_v{opacity:.5;stroke:var(--in-fg);stroke-dasharray:1}.tp-cbzgv_h{border:var(--in-fg) solid 1px;border-radius:50%;box-sizing:border-box;height:4px;margin-left:-2px;margin-top:-2px;pointer-events:none;position:absolute;width:4px}.tp-cbzgv:focus .tp-cbzgv_h-sel{background-color:var(--in-fg);border-width:0}.tp-cbzprvv{cursor:pointer;height:4px;padding:4px 0;position:relative}.tp-cbzprvv_g{display:block;height:100%;overflow:visible;width:100%}.tp-cbzprvv_t{opacity:.5;stroke:var(--mo-fg)}.tp-cbzprvv_m{background-color:var(--mo-fg);border-radius:50%;height:4px;margin-left:-2px;margin-top:-2px;opacity:0;position:absolute;top:50%;transition:opacity .2s ease-out;width:4px}.tp-cbzprvv_m.tp-cbzprvv_m-a{opacity:1}.tp-fpsv{position:relative}.tp-fpsv_l{bottom:4px;color:var(--mo-fg);line-height:1;right:4px;pointer-events:none;position:absolute}.tp-fpsv_u{margin-left:.2em;opacity:.7}.tp-rslv{cursor:pointer;padding-left:8px;padding-right:8px}.tp-rslv.tp-v-disabled{opacity:.5}.tp-rslv_t{height:calc(var(--bld-us));position:relative}.tp-rslv_t::before{background-color:var(--in-bg);border-radius:1px;content:"";height:2px;margin-top:-1px;position:absolute;top:50%;left:-4px;right:-4px}.tp-rslv_b{bottom:0;top:0;position:absolute}.tp-rslv_b::before{background-color:var(--in-fg);content:"";height:2px;margin-top:-1px;position:absolute;top:50%;left:0;right:0}.tp-rslv_k{height:calc(var(--bld-us) - 8px);margin-top:calc((var(--bld-us) - 8px)/-2);position:absolute;top:50%;width:8px}.tp-rslv_k.tp-rslv_k-min{margin-left:-8px}.tp-rslv_k.tp-rslv_k-max{margin-left:0}.tp-rslv.tp-rslv-zero .tp-rslv_k.tp-rslv_k-min{border-bottom-right-radius:0;border-top-right-radius:0}.tp-rslv.tp-rslv-zero .tp-rslv_k.tp-rslv_k-max{border-bottom-left-radius:0;border-top-left-radius:0}.tp-rsltxtv{display:flex}.tp-rsltxtv_s{flex:1}.tp-rsltxtv_t{flex:1;margin-left:4px}.tp-radv_l{display:block;position:relative}.tp-radv_i{left:0;opacity:0;position:absolute;top:0}.tp-radv_b{opacity:.5}.tp-radv_i:hover+.tp-radv_b{background-color:var(--btn-bg-h)}.tp-radv_i:focus+.tp-radv_b{background-color:var(--btn-bg-f)}.tp-radv_i:active+.tp-radv_b{background-color:var(--btn-bg-a)}.tp-radv_i:checked+.tp-radv_b{opacity:1}.tp-radv_t{bottom:0;color:inherit;left:0;overflow:hidden;position:absolute;right:0;text-align:center;text-overflow:ellipsis;top:0}.tp-radv_i:disabled+.tp-radv_b>.tp-radv_t{opacity:.5}.tp-radgridv{border-radius:var(--elm-br);display:grid;overflow:hidden;gap:2px}.tp-radgridv.tp-v-disabled{opacity:.5}.tp-radgridv .tp-radv_b{border-radius:0}',accept(T){const v=ie,S=ee(T,{cells:v.required.function,size:v.required.array(v.required.number),view:v.required.constant("buttongrid"),label:v.optional.string});return S?{params:S}:null},controller(T){return new he(T.document,{blade:T.blade,props:O.fromObject({label:T.params.label}),valueController:new Fl(T.document,{cellConfig:T.params.cells,size:T.params.size})})},api(T){return!(T.controller instanceof he)||!(T.controller.valueController instanceof Fl)?null:new Lu(T.controller)}};class Ru extends i{get label(){return this.controller_.props.get("label")}set label(v){this.controller_.props.set("label",v)}get value(){return this.controller_.valueController.value.rawValue}set value(v){this.controller_.valueController.value.rawValue=v}on(v,S){const L=S.bind(this);return this.controller_.valueController.value.emitter.on(v,z=>{L(new s(this,z.rawValue,void 0,z.options.last))}),this}}function pn(T,v,S){return T*(1-S)+v*S}const Bd=20,Vd=.001,Ol=100;function zd(T,v){let S=.25,L=.5,z=-1;for(let re=0;re<Bd;re++){const[ve,Ae]=T.curve(L);if(L+=S*(ve<v?1:-1),z=Ae,S*=.5,Math.abs(v-ve)<Vd)break}return z}class ws{constructor(v=0,S=0,L=1,z=1){this.cache_=[],this.comps_=[v,S,L,z]}get x1(){return this.comps_[0]}get y1(){return this.comps_[1]}get x2(){return this.comps_[2]}get y2(){return this.comps_[3]}static isObject(v){return o(v)||!Array.isArray(v)?!1:typeof v[0]=="number"&&typeof v[1]=="number"&&typeof v[2]=="number"&&typeof v[3]=="number"}static equals(v,S){return v.x1===S.x1&&v.y1===S.y1&&v.x2===S.x2&&v.y2===S.y2}curve(v){const S=pn(0,this.x1,v),L=pn(0,this.y1,v),z=pn(this.x1,this.x2,v),re=pn(this.y1,this.y2,v),ve=pn(this.x2,1,v),Ae=pn(this.y2,1,v),Rt=pn(S,z,v),fn=pn(L,re,v),mn=pn(z,ve,v),Et=pn(re,Ae,v);return[pn(Rt,mn,v),pn(fn,Et,v)]}y(v){if(this.cache_.length===0){const S=[];for(let L=0;L<Ol;L++)S.push(zd(this,li(L,0,Ol-1,0,1)));this.cache_=S}return this.cache_[Math.round(li(xr(v,0,1),0,1,0,Ol-1))]}toObject(){return[this.comps_[0],this.comps_[1],this.comps_[2],this.comps_[3]]}}const Nl={toComponents:T=>T.toObject(),fromComponents:T=>new ws(...T)};function Ud(T){const v=zt(2);return`cubic-bezier(${T.toObject().map(L=>v(L)).join(", ")})`}const Bl=[0,.5,.5,1];function Gd(T){const v=T.match(/^cubic-bezier\s*\(\s*([0-9.]+)\s*,\s*([0-9.]+)\s*,\s*([0-9.]+)\s*,\s*([0-9.]+)\s*\)$/);if(!v)return new ws(...Bl);const S=[v[1],v[2],v[3],v[4]].reduce((L,z)=>{if(!L)return null;const re=Number(z);return isNaN(re)?null:[...L,re]},[]);return new ws(...S??Bl)}const Gs=d("cbz");class ku{constructor(v,S){this.element=v.createElement("div"),this.element.classList.add(Gs()),S.viewProps.bindClassModifiers(this.element),S.foldable.bindExpandedClass(this.element,Gs(void 0,"expanded")),b(S.foldable,"completed",M(this.element,Gs(void 0,"cpl")));const L=v.createElement("div");L.classList.add(Gs("h")),this.element.appendChild(L);const z=v.createElement("button");z.classList.add(Gs("b")),S.viewProps.bindDisabled(z);const re=v.createElementNS(ye,"svg");re.innerHTML='<path d="M2 13C8 13 8 3 14 3"/>',z.appendChild(re),L.appendChild(z),this.buttonElement=z;const ve=v.createElement("div");if(ve.classList.add(Gs("t")),L.appendChild(ve),this.textElement=ve,S.pickerLayout==="inline"){const Ae=v.createElement("div");Ae.classList.add(Gs("p")),this.element.appendChild(Ae),this.pickerElement=Ae}else this.pickerElement=null}}const ha=d("cbzp");class Iu{constructor(v,S){this.element=v.createElement("div"),this.element.classList.add(ha()),S.viewProps.bindClassModifiers(this.element);const L=v.createElement("div");L.classList.add(ha("g")),this.element.appendChild(L),this.graphElement=L;const z=v.createElement("div");z.classList.add(ha("t")),this.element.appendChild(z),this.textElement=z}}function qn(T,v){const S=new MutationObserver(z=>{for(const re of z)re.type==="childList"&&re.addedNodes.forEach(ve=>{ve.contains(ve)&&(v(),S.disconnect())})}),L=T.ownerDocument;S.observe(L.body,{attributes:!0,childList:!0,subtree:!0})}const cs=d("cbzg");function Hd(T,v){return S=>v(T(S))}class fi{constructor(v,S){this.element=v.createElement("div"),this.element.classList.add(cs()),S.viewProps.bindClassModifiers(this.element),S.viewProps.bindTabIndex(this.element);const L=v.createElement("div");L.classList.add(cs("p")),this.element.appendChild(L),this.previewElement=L;const z=v.createElementNS(ye,"svg");z.classList.add(cs("g")),this.element.appendChild(z),this.svgElem_=z;const re=v.createElementNS(ye,"path");re.classList.add(cs("u")),this.svgElem_.appendChild(re),this.guideElem_=re;const ve=v.createElementNS(ye,"polyline");ve.classList.add(cs("l")),this.svgElem_.appendChild(ve),this.lineElem_=ve,this.handleElems_=[v.createElement("div"),v.createElement("div")],this.handleElems_.forEach(Ae=>{Ae.classList.add(cs("h")),this.element.appendChild(Ae)}),this.vectorElems_=[v.createElementNS(ye,"line"),v.createElementNS(ye,"line")],this.vectorElems_.forEach(Ae=>{Ae.classList.add(cs("v")),this.svgElem_.appendChild(Ae)}),this.value_=S.value,this.value_.emitter.on("change",this.onValueChange_.bind(this)),this.sel_=S.selection,this.handleElems_.forEach((Ae,Rt)=>{_(this.sel_,Hd(fn=>fn===Rt,M(Ae,cs("h","sel"))))}),qn(this.element,()=>{this.refresh()})}getVertMargin_(v){return v*.25}valueToPosition(v,S){const L=this.element.getBoundingClientRect(),z=L.width,re=L.height,ve=this.getVertMargin_(re);return{x:li(v,0,1,0,z),y:li(S,0,1,re-ve,ve)}}positionToValue(v,S){const L=this.element.getBoundingClientRect(),z=L.width,re=L.height,ve=this.getVertMargin_(re);return{x:xr(li(v,0,z,0,1),0,1),y:li(S,re-ve,ve,0,1)}}refresh(){this.guideElem_.setAttributeNS(null,"d",[0,1].map(re=>{const ve=this.valueToPosition(0,re),Ae=this.valueToPosition(1,re);return[`M ${ve.x},${ve.y}`,`L ${Ae.x},${Ae.y}`].join(" ")}).join(" "));const v=this.value_.rawValue,S=[];let L=0;for(;;){const re=this.valueToPosition(...v.curve(L));if(S.push([re.x,re.y].join(",")),L>=1)break;L=Math.min(L+.05,1)}this.lineElem_.setAttributeNS(null,"points",S.join(" "));const z=v.toObject();[0,1].forEach(re=>{const ve=this.valueToPosition(re,re),Ae=this.valueToPosition(z[re*2],z[re*2+1]),Rt=this.vectorElems_[re];Rt.setAttributeNS(null,"x1",String(ve.x)),Rt.setAttributeNS(null,"y1",String(ve.y)),Rt.setAttributeNS(null,"x2",String(Ae.x)),Rt.setAttributeNS(null,"y2",String(Ae.y));const fn=this.handleElems_[re];fn.style.left=`${Ae.x}px`,fn.style.top=`${Ae.y}px`})}onValueChange_(){this.refresh()}}const Fu=24,oo=400,Vl=1e3,ys=d("cbzprv");class Sr{constructor(v,S){this.stopped_=!0,this.startTime_=-1,this.onDispose_=this.onDispose_.bind(this),this.onTimer_=this.onTimer_.bind(this),this.onValueChange_=this.onValueChange_.bind(this),this.element=v.createElement("div"),this.element.classList.add(ys()),S.viewProps.bindClassModifiers(this.element);const L=v.createElementNS(ye,"svg");L.classList.add(ys("g")),this.element.appendChild(L),this.svgElem_=L;const z=v.createElementNS(ye,"path");z.classList.add(ys("t")),this.svgElem_.appendChild(z),this.ticksElem_=z;const re=v.createElement("div");re.classList.add(ys("m")),this.element.appendChild(re),this.markerElem_=re,this.value_=S.value,this.value_.emitter.on("change",this.onValueChange_),S.viewProps.handleDispose(this.onDispose_),qn(this.element,()=>{this.refresh()})}play(){this.stop(),this.updateMarker_(0),this.markerElem_.classList.add(ys("m","a")),this.startTime_=new Date().getTime()+oo,this.stopped_=!1,requestAnimationFrame(this.onTimer_)}stop(){this.stopped_=!0,this.markerElem_.classList.remove(ys("m","a"))}onDispose_(){this.stop()}updateMarker_(v){const S=this.value_.rawValue.y(xr(v,0,1));this.markerElem_.style.left=`${S*100}%`}refresh(){const v=this.svgElem_.getBoundingClientRect(),S=v.width,L=v.height,z=[],re=this.value_.rawValue;for(let ve=0;ve<Fu;ve++){const Ae=li(ve,0,Fu-1,0,1),Rt=li(re.y(Ae),0,1,0,S);z.push(`M ${Rt},0 v${L}`)}this.ticksElem_.setAttributeNS(null,"d",z.join(" "))}onTimer_(){if(this.startTime_===null)return;const v=new Date().getTime()-this.startTime_,S=v/Vl;this.updateMarker_(S),v>Vl+oo&&this.stop(),this.stopped_||requestAnimationFrame(this.onTimer_)}onValueChange_(){this.refresh(),this.play()}}function Ei(T,v,S,L){const z=S-T,re=L-v;return Math.sqrt(z*z+re*re)}function ao(T,v,S,L){const z=Ei(T,v,S,L),re=Math.atan2(L-v,S-T),ve=Math.round(re/(Math.PI/4))*Math.PI/4;return{x:T+Math.cos(ve)*z,y:v+Math.sin(ve)*z}}class Xn{constructor(v,S){this.onKeyDown_=this.onKeyDown_.bind(this),this.onKeyUp_=this.onKeyUp_.bind(this),this.onPointerDown_=this.onPointerDown_.bind(this),this.onPointerMove_=this.onPointerMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.baseStep_=S.baseStep,this.value=S.value,this.sel_=k(0),this.viewProps=S.viewProps,this.view=new fi(v,{selection:this.sel_,value:this.value,viewProps:this.viewProps}),this.view.element.addEventListener("keydown",this.onKeyDown_),this.view.element.addEventListener("keyup",this.onKeyUp_),this.prevView_=new Sr(v,{value:this.value,viewProps:this.viewProps}),this.prevView_.element.addEventListener("mousedown",z=>{z.stopImmediatePropagation(),z.preventDefault(),this.prevView_.play()}),this.view.previewElement.appendChild(this.prevView_.element);const L=new la(this.view.element);L.emitter.on("down",this.onPointerDown_),L.emitter.on("move",this.onPointerMove_),L.emitter.on("up",this.onPointerUp_)}refresh(){this.view.refresh(),this.prevView_.refresh(),this.prevView_.play()}updateValue_(v,S,L){const z=this.sel_.rawValue,re=this.value.rawValue.toObject(),ve=this.view.positionToValue(v.x,v.y),Ae=S?ao(z,z,ve.x,ve.y):ve;re[z*2]=Ae.x,re[z*2+1]=Ae.y,this.value.setRawValue(new ws(...re),L)}onPointerDown_(v){const S=v.data;if(!S.point)return;const L=this.value.rawValue,z=this.view.valueToPosition(L.x1,L.y1),re=Ei(S.point.x,S.point.y,z.x,z.y),ve=this.view.valueToPosition(L.x2,L.y2),Ae=Ei(S.point.x,S.point.y,ve.x,ve.y);this.sel_.rawValue=re<=Ae?0:1,this.updateValue_(S.point,v.shiftKey,{forceEmit:!1,last:!1})}onPointerMove_(v){const S=v.data;S.point&&this.updateValue_(S.point,v.shiftKey,{forceEmit:!1,last:!1})}onPointerUp_(v){const S=v.data;S.point&&this.updateValue_(S.point,v.shiftKey,{forceEmit:!0,last:!0})}onKeyDown_(v){xu(v.key)&&v.preventDefault();const S=this.sel_.rawValue,L=this.value.rawValue.toObject();L[S*2]+=bs(this.baseStep_,Ll(v)),L[S*2+1]+=bs(this.baseStep_,xs(v)),this.value.setRawValue(new ws(...L),{forceEmit:!1,last:!1})}onKeyUp_(v){xu(v.key)&&v.preventDefault();const S=bs(this.baseStep_,Ll(v)),L=bs(this.baseStep_,xs(v));S===0&&L===0||this.value.setRawValue(this.value.rawValue,{forceEmit:!0,last:!0})}}class Ou{constructor(v,S){this.value=S.value,this.viewProps=S.viewProps,this.view=new Iu(v,{viewProps:this.viewProps}),this.gc_=new Xn(v,{baseStep:S.axis.baseStep,value:this.value,viewProps:this.viewProps}),this.view.graphElement.appendChild(this.gc_.view.element);const L=Object.assign(Object.assign({},S.axis),{constraint:new Fe({max:1,min:0})}),z=Object.assign(Object.assign({},S.axis),{constraint:void 0});this.tc_=new Us(v,{assembly:Nl,axes:[L,z,L,z],parser:ai,value:this.value,viewProps:this.viewProps}),this.view.textElement.appendChild(this.tc_.view.element)}get allFocusableElements(){return[this.gc_.view.element,...this.tc_.view.textViews.map(v=>v.inputElement)]}refresh(){this.gc_.refresh()}}class da{constructor(v,S){this.onButtonBlur_=this.onButtonBlur_.bind(this),this.onButtonClick_=this.onButtonClick_.bind(this),this.onPopupChildBlur_=this.onPopupChildBlur_.bind(this),this.onPopupChildKeydown_=this.onPopupChildKeydown_.bind(this),this.value=S.value,this.viewProps=S.viewProps,this.foldable_=Ot(S.expanded),this.view=new ku(v,{foldable:this.foldable_,pickerLayout:S.pickerLayout,viewProps:this.viewProps}),this.view.buttonElement.addEventListener("blur",this.onButtonBlur_),this.view.buttonElement.addEventListener("click",this.onButtonClick_),this.tc_=new Ct(v,{parser:Gd,props:O.fromObject({formatter:Ud}),value:this.value,viewProps:this.viewProps}),this.view.textElement.appendChild(this.tc_.view.element),this.popC_=S.pickerLayout==="popup"?new ze(v,{viewProps:this.viewProps}):null;const L=new Ou(v,{axis:S.axis,value:this.value,viewProps:this.viewProps});L.allFocusableElements.forEach(z=>{z.addEventListener("blur",this.onPopupChildBlur_),z.addEventListener("keydown",this.onPopupChildKeydown_)}),this.pickerC_=L,this.popC_?(this.view.element.appendChild(this.popC_.view.element),this.popC_.view.element.appendChild(this.pickerC_.view.element),_(this.popC_.shows,z=>{z&&L.refresh()}),Wn({primary:this.foldable_.value("expanded"),secondary:this.popC_.shows,forward:z=>z.rawValue,backward:(z,re)=>re.rawValue})):this.view.pickerElement&&(this.view.pickerElement.appendChild(this.pickerC_.view.element),N(this.foldable_,this.view.pickerElement))}onButtonBlur_(v){if(!this.popC_)return;const S=v.relatedTarget;(!S||!this.popC_.view.element.contains(S))&&(this.popC_.shows.rawValue=!1)}onButtonClick_(){this.foldable_.set("expanded",!this.foldable_.get("expanded")),this.foldable_.get("expanded")&&this.pickerC_.allFocusableElements[0].focus()}onPopupChildBlur_(v){if(!this.popC_)return;const S=this.popC_.view.element,L=Pe(v);L&&S.contains(L)||L&&L===this.view.buttonElement&&!Ze(S.ownerDocument)||(this.popC_.shows.rawValue=!1)}onPopupChildKeydown_(v){this.popC_&&v.key==="Escape"&&(this.popC_.shows.rawValue=!1)}}function zl(){return new Ld({assembly:Nl,components:[0,1,2,3].map(T=>T%2===0?new Fe({min:0,max:1}):void 0)})}const Hs={id:"cubic-bezier",type:"blade",css:'.tp-cbzgv,.tp-radv_b,.tp-rslv_k,.tp-cbzv_b{-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:rgba(0,0,0,0);border-width:0;font-family:inherit;font-size:inherit;font-weight:inherit;margin:0;outline:none;padding:0}.tp-radv_b,.tp-rslv_k,.tp-cbzv_b{background-color:var(--btn-bg);border-radius:var(--elm-br);color:var(--btn-fg);cursor:pointer;display:block;font-weight:bold;height:var(--bld-us);line-height:var(--bld-us);overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.tp-radv_b:hover,.tp-rslv_k:hover,.tp-cbzv_b:hover{background-color:var(--btn-bg-h)}.tp-radv_b:focus,.tp-rslv_k:focus,.tp-cbzv_b:focus{background-color:var(--btn-bg-f)}.tp-radv_b:active,.tp-rslv_k:active,.tp-cbzv_b:active{background-color:var(--btn-bg-a)}.tp-radv_b:disabled,.tp-rslv_k:disabled,.tp-cbzv_b:disabled{opacity:.5}.tp-cbzgv{background-color:var(--in-bg);border-radius:var(--elm-br);box-sizing:border-box;color:var(--in-fg);font-family:inherit;height:var(--bld-us);line-height:var(--bld-us);min-width:0;width:100%}.tp-cbzgv:hover{background-color:var(--in-bg-h)}.tp-cbzgv:focus{background-color:var(--in-bg-f)}.tp-cbzgv:active{background-color:var(--in-bg-a)}.tp-cbzgv:disabled{opacity:.5}.tp-btngridv{border-radius:var(--elm-br);display:grid;overflow:hidden;gap:2px}.tp-btngridv.tp-v-disabled{opacity:.5}.tp-btngridv .tp-btnv_b:disabled{opacity:1}.tp-btngridv .tp-btnv_b:disabled .tp-btnv_t{opacity:.5}.tp-btngridv .tp-btnv_b{border-radius:0}.tp-cbzv{position:relative}.tp-cbzv_h{display:flex}.tp-cbzv_b{margin-right:4px;position:relative;width:var(--bld-us)}.tp-cbzv_b svg{display:block;height:16px;left:50%;margin-left:-8px;margin-top:-8px;position:absolute;top:50%;width:16px}.tp-cbzv_b svg path{stroke:var(--bs-bg);stroke-width:2}.tp-cbzv_t{flex:1}.tp-cbzv_p{height:0;margin-top:0;opacity:0;overflow:hidden;transition:height .2s ease-in-out,opacity .2s linear,margin .2s ease-in-out}.tp-cbzv.tp-cbzv-expanded .tp-cbzv_p{margin-top:var(--bld-s);opacity:1}.tp-cbzv.tp-cbzv-cpl .tp-cbzv_p{overflow:visible}.tp-cbzv .tp-popv{left:calc(-1*var(--cnt-h-p));position:absolute;right:calc(-1*var(--cnt-h-p));top:var(--bld-us)}.tp-cbzpv_t{margin-top:var(--bld-s)}.tp-cbzgv{height:auto;overflow:hidden;position:relative}.tp-cbzgv.tp-v-disabled{opacity:.5}.tp-cbzgv_p{left:16px;position:absolute;right:16px;top:0}.tp-cbzgv_g{cursor:pointer;display:block;height:calc(var(--bld-us)*5);width:100%}.tp-cbzgv_u{opacity:.1;stroke:var(--in-fg);stroke-dasharray:1}.tp-cbzgv_l{fill:rgba(0,0,0,0);stroke:var(--in-fg)}.tp-cbzgv_v{opacity:.5;stroke:var(--in-fg);stroke-dasharray:1}.tp-cbzgv_h{border:var(--in-fg) solid 1px;border-radius:50%;box-sizing:border-box;height:4px;margin-left:-2px;margin-top:-2px;pointer-events:none;position:absolute;width:4px}.tp-cbzgv:focus .tp-cbzgv_h-sel{background-color:var(--in-fg);border-width:0}.tp-cbzprvv{cursor:pointer;height:4px;padding:4px 0;position:relative}.tp-cbzprvv_g{display:block;height:100%;overflow:visible;width:100%}.tp-cbzprvv_t{opacity:.5;stroke:var(--mo-fg)}.tp-cbzprvv_m{background-color:var(--mo-fg);border-radius:50%;height:4px;margin-left:-2px;margin-top:-2px;opacity:0;position:absolute;top:50%;transition:opacity .2s ease-out;width:4px}.tp-cbzprvv_m.tp-cbzprvv_m-a{opacity:1}.tp-fpsv{position:relative}.tp-fpsv_l{bottom:4px;color:var(--mo-fg);line-height:1;right:4px;pointer-events:none;position:absolute}.tp-fpsv_u{margin-left:.2em;opacity:.7}.tp-rslv{cursor:pointer;padding-left:8px;padding-right:8px}.tp-rslv.tp-v-disabled{opacity:.5}.tp-rslv_t{height:calc(var(--bld-us));position:relative}.tp-rslv_t::before{background-color:var(--in-bg);border-radius:1px;content:"";height:2px;margin-top:-1px;position:absolute;top:50%;left:-4px;right:-4px}.tp-rslv_b{bottom:0;top:0;position:absolute}.tp-rslv_b::before{background-color:var(--in-fg);content:"";height:2px;margin-top:-1px;position:absolute;top:50%;left:0;right:0}.tp-rslv_k{height:calc(var(--bld-us) - 8px);margin-top:calc((var(--bld-us) - 8px)/-2);position:absolute;top:50%;width:8px}.tp-rslv_k.tp-rslv_k-min{margin-left:-8px}.tp-rslv_k.tp-rslv_k-max{margin-left:0}.tp-rslv.tp-rslv-zero .tp-rslv_k.tp-rslv_k-min{border-bottom-right-radius:0;border-top-right-radius:0}.tp-rslv.tp-rslv-zero .tp-rslv_k.tp-rslv_k-max{border-bottom-left-radius:0;border-top-left-radius:0}.tp-rsltxtv{display:flex}.tp-rsltxtv_s{flex:1}.tp-rsltxtv_t{flex:1;margin-left:4px}.tp-radv_l{display:block;position:relative}.tp-radv_i{left:0;opacity:0;position:absolute;top:0}.tp-radv_b{opacity:.5}.tp-radv_i:hover+.tp-radv_b{background-color:var(--btn-bg-h)}.tp-radv_i:focus+.tp-radv_b{background-color:var(--btn-bg-f)}.tp-radv_i:active+.tp-radv_b{background-color:var(--btn-bg-a)}.tp-radv_i:checked+.tp-radv_b{opacity:1}.tp-radv_t{bottom:0;color:inherit;left:0;overflow:hidden;position:absolute;right:0;text-align:center;text-overflow:ellipsis;top:0}.tp-radv_i:disabled+.tp-radv_b>.tp-radv_t{opacity:.5}.tp-radgridv{border-radius:var(--elm-br);display:grid;overflow:hidden;gap:2px}.tp-radgridv.tp-v-disabled{opacity:.5}.tp-radgridv .tp-radv_b{border-radius:0}',accept(T){const v=ie,S=ee(T,{value:v.required.array(v.required.number),view:v.required.constant("cubicbezier"),expanded:v.optional.boolean,label:v.optional.string,picker:v.optional.custom(L=>L==="inline"||L==="popup"?L:void 0)});return S?{params:S}:null},controller(T){var v,S;const L=new ws(...T.params.value),z=k(L,{constraint:zl(),equals:ws.equals}),re=new da(T.document,{axis:{baseStep:.1,textProps:O.fromObject({draggingScale:.01,formatter:zt(2)})},expanded:(v=T.params.expanded)!==null&&v!==void 0?v:!1,pickerLayout:(S=T.params.picker)!==null&&S!==void 0?S:"popup",value:z,viewProps:T.viewProps});return new xe(T.document,{blade:T.blade,props:O.fromObject({label:T.params.label}),valueController:re})},api(T){return!(T.controller instanceof xe)||!(T.controller.valueController instanceof da)?null:new Ru(T.controller)}};class jt extends i{begin(){this.controller_.valueController.begin()}end(){this.controller_.valueController.end()}}const Ul=20;class ci{constructor(){this.start_=null,this.duration_=0,this.fps_=null,this.frameCount_=0,this.timestamps_=[]}get duration(){return this.duration_}get fps(){return this.fps_}begin(v){this.start_=v.getTime()}calculateFps_(v){if(this.timestamps_.length===0)return null;const S=this.timestamps_[0];return 1e3*(this.frameCount_-S.frameCount)/(v-S.time)}compactTimestamps_(){if(this.timestamps_.length<=Ul)return;const v=this.timestamps_.length-Ul;this.timestamps_.splice(0,v);const S=this.timestamps_[0].frameCount;this.timestamps_.forEach(L=>{L.frameCount-=S}),this.frameCount_-=S}end(v){if(this.start_===null)return;const S=v.getTime();this.duration_=S-this.start_,this.start_=null,this.fps_=this.calculateFps_(S),this.timestamps_.push({frameCount:this.frameCount_,time:S}),++this.frameCount_,this.compactTimestamps_()}}const Mr=d("fps");class $i{constructor(v,S){this.element=v.createElement("div"),this.element.classList.add(Mr()),S.viewProps.bindClassModifiers(this.element),this.graphElement=v.createElement("div"),this.graphElement.classList.add(Mr("g")),this.element.appendChild(this.graphElement);const L=v.createElement("div");L.classList.add(Mr("l")),this.element.appendChild(L);const z=v.createElement("span");z.classList.add(Mr("v")),z.textContent="--",L.appendChild(z),this.valueElement=z;const re=v.createElement("span");re.classList.add(Mr("u")),re.textContent="FPS",L.appendChild(re)}}class Gl{constructor(v,S){this.stopwatch_=new ci,this.onTick_=this.onTick_.bind(this),this.ticker_=S.ticker,this.ticker_.emitter.on("tick",this.onTick_),this.value_=S.value,this.viewProps=S.viewProps,this.view=new $i(v,{viewProps:this.viewProps}),this.graphC_=new Fd(v,{formatter:zt(0),lineCount:S.lineCount,props:O.fromObject({maxValue:S.maxValue,minValue:S.minValue}),value:this.value_,viewProps:this.viewProps}),this.view.graphElement.appendChild(this.graphC_.view.element),this.viewProps.handleDispose(()=>{this.graphC_.viewProps.set("disposed",!0),this.ticker_.dispose()})}begin(){this.stopwatch_.begin(new Date)}end(){this.stopwatch_.end(new Date)}onTick_(){const v=this.stopwatch_.fps;if(v!==null){const S=this.value_.rawValue;this.value_.rawValue=Fi(S,v),this.view.valueElement.textContent=v.toFixed(0)}}}function lo(T,v){return v===0?new Me:new Se(T,v??Id.monitor.defaultInterval)}const Hl={id:"fpsgraph",type:"blade",accept(T){const v=ie,S=ee(T,{view:v.required.constant("fpsgraph"),interval:v.optional.number,label:v.optional.string,lineCount:v.optional.number,max:v.optional.number,min:v.optional.number});return S?{params:S}:null},controller(T){var v,S,L,z;const re=(v=T.params.interval)!==null&&v!==void 0?v:500;return new he(T.document,{blade:T.blade,props:O.fromObject({label:T.params.label}),valueController:new Gl(T.document,{lineCount:(S=T.params.lineCount)!==null&&S!==void 0?S:2,maxValue:(L=T.params.max)!==null&&L!==void 0?L:90,minValue:(z=T.params.min)!==null&&z!==void 0?z:0,ticker:lo(T.document,re),value:Ti(80),viewProps:T.viewProps})})},api(T){return!(T.controller instanceof he)||!(T.controller.valueController instanceof Gl)?null:new jt(T.controller)}};class Yi{constructor(v,S){this.min=v,this.max=S}static isObject(v){if(typeof v!="object"||v===null)return!1;const S=v.min,L=v.max;return!(typeof S!="number"||typeof L!="number")}static equals(v,S){return v.min===S.min&&v.max===S.max}get length(){return this.max-this.min}toObject(){return{min:this.min,max:this.max}}}const Wl={fromComponents:T=>new Yi(T[0],T[1]),toComponents:T=>[T.min,T.max]};class co{constructor(v){this.edge=v}constrain(v){var S,L,z,re,ve,Ae,Rt,fn;if(v.min<=v.max)return new Yi((L=(S=this.edge)===null||S===void 0?void 0:S.constrain(v.min))!==null&&L!==void 0?L:v.min,(re=(z=this.edge)===null||z===void 0?void 0:z.constrain(v.max))!==null&&re!==void 0?re:v.max);const mn=(v.min+v.max)/2;return new Yi((Ae=(ve=this.edge)===null||ve===void 0?void 0:ve.constrain(mn))!==null&&Ae!==void 0?Ae:mn,(fn=(Rt=this.edge)===null||Rt===void 0?void 0:Rt.constrain(mn))!==null&&fn!==void 0?fn:mn)}}const jl=d("rsltxt");class pa{constructor(v,S){this.sliderView_=S.sliderView,this.textView_=S.textView,this.element=v.createElement("div"),this.element.classList.add(jl());const L=v.createElement("div");L.classList.add(jl("s")),L.appendChild(this.sliderView_.element),this.element.appendChild(L);const z=v.createElement("div");z.classList.add(jl("t")),z.appendChild(this.textView_.element),this.element.appendChild(z)}}const Dn=d("rsl");class uo{constructor(v,S){this.onSliderPropsChange_=this.onSliderPropsChange_.bind(this),this.onValueChange_=this.onValueChange_.bind(this),this.sliderProps_=S.sliderProps,this.sliderProps_.emitter.on("change",this.onSliderPropsChange_),this.element=v.createElement("div"),this.element.classList.add(Dn()),S.viewProps.bindClassModifiers(this.element),this.value_=S.value,this.value_.emitter.on("change",this.onValueChange_);const L=v.createElement("div");L.classList.add(Dn("t")),this.element.appendChild(L),this.trackElement=L;const z=v.createElement("div");z.classList.add(Dn("b")),L.appendChild(z),this.barElement=z;const re=["min","max"].map(ve=>{const Ae=v.createElement("div");return Ae.classList.add(Dn("k"),Dn("k",ve)),L.appendChild(Ae),Ae});this.knobElements=[re[0],re[1]],this.update_()}valueToX_(v){const S=this.sliderProps_.get("minValue"),L=this.sliderProps_.get("maxValue");return xr(li(v,S,L,0,1),0,1)*100}update_(){const v=this.value_.rawValue;v.length===0?this.element.classList.add(Dn(void 0,"zero")):this.element.classList.remove(Dn(void 0,"zero"));const S=[this.valueToX_(v.min),this.valueToX_(v.max)];this.barElement.style.left=`${S[0]}%`,this.barElement.style.right=`${100-S[1]}%`,this.knobElements.forEach((L,z)=>{L.style.left=`${S[z]}%`})}onSliderPropsChange_(){this.update_()}onValueChange_(){this.update_()}}class ql{constructor(v,S){this.grabbing_=null,this.grabOffset_=0,this.onPointerDown_=this.onPointerDown_.bind(this),this.onPointerMove_=this.onPointerMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.sliderProps=S.sliderProps,this.viewProps=S.viewProps,this.value=S.value,this.view=new uo(v,{sliderProps:this.sliderProps,value:this.value,viewProps:S.viewProps});const L=new la(this.view.trackElement);L.emitter.on("down",this.onPointerDown_),L.emitter.on("move",this.onPointerMove_),L.emitter.on("up",this.onPointerUp_)}ofs_(){return this.grabbing_==="min"?this.view.knobElements[0].getBoundingClientRect().width/2:this.grabbing_==="max"?-this.view.knobElements[1].getBoundingClientRect().width/2:0}valueFromData_(v){if(!v.point)return null;const S=(v.point.x+this.ofs_())/v.bounds.width,L=this.sliderProps.get("minValue"),z=this.sliderProps.get("maxValue");return li(S,0,1,L,z)}onPointerDown_(v){if(!v.data.point)return;const S=v.data.point.x/v.data.bounds.width,L=this.value.rawValue,z=this.sliderProps.get("minValue"),re=this.sliderProps.get("maxValue"),ve=li(L.min,z,re,0,1),Ae=li(L.max,z,re,0,1);Math.abs(Ae-S)<=.025?this.grabbing_="max":Math.abs(ve-S)<=.025?this.grabbing_="min":S>=ve&&S<=Ae?(this.grabbing_="length",this.grabOffset_=li(S-ve,0,1,0,re-z)):S<ve?(this.grabbing_="min",this.onPointerMove_(v)):S>Ae&&(this.grabbing_="max",this.onPointerMove_(v))}applyPointToValue_(v,S){const L=this.valueFromData_(v);if(L===null)return;const z=this.sliderProps.get("minValue"),re=this.sliderProps.get("maxValue");if(this.grabbing_==="min")this.value.setRawValue(new Yi(L,this.value.rawValue.max),S);else if(this.grabbing_==="max")this.value.setRawValue(new Yi(this.value.rawValue.min,L),S);else if(this.grabbing_==="length"){const ve=this.value.rawValue.length;let Ae=L-this.grabOffset_,Rt=Ae+ve;Ae<z?(Ae=z,Rt=z+ve):Rt>re&&(Ae=re-ve,Rt=re),this.value.setRawValue(new Yi(Ae,Rt),S)}}onPointerMove_(v){this.applyPointToValue_(v.data,{forceEmit:!1,last:!1})}onPointerUp_(v){this.applyPointToValue_(v.data,{forceEmit:!0,last:!0}),this.grabbing_=null}}class us{constructor(v,S){this.value=S.value,this.viewProps=S.viewProps,this.sc_=new ql(v,S);const L={baseStep:S.baseStep,constraint:S.constraint,textProps:O.fromObject({draggingScale:S.draggingScale,formatter:S.formatter})};this.tc_=new Us(v,{assembly:Wl,axes:[L,L],parser:S.parser,value:this.value,viewProps:S.viewProps}),this.view=new pa(v,{sliderView:this.sc_.view,textView:this.tc_.view})}get textController(){return this.tc_}}function Nu(T){return Yi.isObject(T)?new Yi(T.min,T.max):new Yi(0,0)}function Xl(T,v){T.writeProperty("max",v.max),T.writeProperty("min",v.min)}function Wd(T){const v=[],S=ro(T);S&&v.push(S);const L=kd(T);return L&&v.push(L),new co(new je(v))}const fa={id:"input-interval",type:"input",css:'.tp-cbzgv,.tp-radv_b,.tp-rslv_k,.tp-cbzv_b{-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:rgba(0,0,0,0);border-width:0;font-family:inherit;font-size:inherit;font-weight:inherit;margin:0;outline:none;padding:0}.tp-radv_b,.tp-rslv_k,.tp-cbzv_b{background-color:var(--btn-bg);border-radius:var(--elm-br);color:var(--btn-fg);cursor:pointer;display:block;font-weight:bold;height:var(--bld-us);line-height:var(--bld-us);overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.tp-radv_b:hover,.tp-rslv_k:hover,.tp-cbzv_b:hover{background-color:var(--btn-bg-h)}.tp-radv_b:focus,.tp-rslv_k:focus,.tp-cbzv_b:focus{background-color:var(--btn-bg-f)}.tp-radv_b:active,.tp-rslv_k:active,.tp-cbzv_b:active{background-color:var(--btn-bg-a)}.tp-radv_b:disabled,.tp-rslv_k:disabled,.tp-cbzv_b:disabled{opacity:.5}.tp-cbzgv{background-color:var(--in-bg);border-radius:var(--elm-br);box-sizing:border-box;color:var(--in-fg);font-family:inherit;height:var(--bld-us);line-height:var(--bld-us);min-width:0;width:100%}.tp-cbzgv:hover{background-color:var(--in-bg-h)}.tp-cbzgv:focus{background-color:var(--in-bg-f)}.tp-cbzgv:active{background-color:var(--in-bg-a)}.tp-cbzgv:disabled{opacity:.5}.tp-btngridv{border-radius:var(--elm-br);display:grid;overflow:hidden;gap:2px}.tp-btngridv.tp-v-disabled{opacity:.5}.tp-btngridv .tp-btnv_b:disabled{opacity:1}.tp-btngridv .tp-btnv_b:disabled .tp-btnv_t{opacity:.5}.tp-btngridv .tp-btnv_b{border-radius:0}.tp-cbzv{position:relative}.tp-cbzv_h{display:flex}.tp-cbzv_b{margin-right:4px;position:relative;width:var(--bld-us)}.tp-cbzv_b svg{display:block;height:16px;left:50%;margin-left:-8px;margin-top:-8px;position:absolute;top:50%;width:16px}.tp-cbzv_b svg path{stroke:var(--bs-bg);stroke-width:2}.tp-cbzv_t{flex:1}.tp-cbzv_p{height:0;margin-top:0;opacity:0;overflow:hidden;transition:height .2s ease-in-out,opacity .2s linear,margin .2s ease-in-out}.tp-cbzv.tp-cbzv-expanded .tp-cbzv_p{margin-top:var(--bld-s);opacity:1}.tp-cbzv.tp-cbzv-cpl .tp-cbzv_p{overflow:visible}.tp-cbzv .tp-popv{left:calc(-1*var(--cnt-h-p));position:absolute;right:calc(-1*var(--cnt-h-p));top:var(--bld-us)}.tp-cbzpv_t{margin-top:var(--bld-s)}.tp-cbzgv{height:auto;overflow:hidden;position:relative}.tp-cbzgv.tp-v-disabled{opacity:.5}.tp-cbzgv_p{left:16px;position:absolute;right:16px;top:0}.tp-cbzgv_g{cursor:pointer;display:block;height:calc(var(--bld-us)*5);width:100%}.tp-cbzgv_u{opacity:.1;stroke:var(--in-fg);stroke-dasharray:1}.tp-cbzgv_l{fill:rgba(0,0,0,0);stroke:var(--in-fg)}.tp-cbzgv_v{opacity:.5;stroke:var(--in-fg);stroke-dasharray:1}.tp-cbzgv_h{border:var(--in-fg) solid 1px;border-radius:50%;box-sizing:border-box;height:4px;margin-left:-2px;margin-top:-2px;pointer-events:none;position:absolute;width:4px}.tp-cbzgv:focus .tp-cbzgv_h-sel{background-color:var(--in-fg);border-width:0}.tp-cbzprvv{cursor:pointer;height:4px;padding:4px 0;position:relative}.tp-cbzprvv_g{display:block;height:100%;overflow:visible;width:100%}.tp-cbzprvv_t{opacity:.5;stroke:var(--mo-fg)}.tp-cbzprvv_m{background-color:var(--mo-fg);border-radius:50%;height:4px;margin-left:-2px;margin-top:-2px;opacity:0;position:absolute;top:50%;transition:opacity .2s ease-out;width:4px}.tp-cbzprvv_m.tp-cbzprvv_m-a{opacity:1}.tp-fpsv{position:relative}.tp-fpsv_l{bottom:4px;color:var(--mo-fg);line-height:1;right:4px;pointer-events:none;position:absolute}.tp-fpsv_u{margin-left:.2em;opacity:.7}.tp-rslv{cursor:pointer;padding-left:8px;padding-right:8px}.tp-rslv.tp-v-disabled{opacity:.5}.tp-rslv_t{height:calc(var(--bld-us));position:relative}.tp-rslv_t::before{background-color:var(--in-bg);border-radius:1px;content:"";height:2px;margin-top:-1px;position:absolute;top:50%;left:-4px;right:-4px}.tp-rslv_b{bottom:0;top:0;position:absolute}.tp-rslv_b::before{background-color:var(--in-fg);content:"";height:2px;margin-top:-1px;position:absolute;top:50%;left:0;right:0}.tp-rslv_k{height:calc(var(--bld-us) - 8px);margin-top:calc((var(--bld-us) - 8px)/-2);position:absolute;top:50%;width:8px}.tp-rslv_k.tp-rslv_k-min{margin-left:-8px}.tp-rslv_k.tp-rslv_k-max{margin-left:0}.tp-rslv.tp-rslv-zero .tp-rslv_k.tp-rslv_k-min{border-bottom-right-radius:0;border-top-right-radius:0}.tp-rslv.tp-rslv-zero .tp-rslv_k.tp-rslv_k-max{border-bottom-left-radius:0;border-top-left-radius:0}.tp-rsltxtv{display:flex}.tp-rsltxtv_s{flex:1}.tp-rsltxtv_t{flex:1;margin-left:4px}.tp-radv_l{display:block;position:relative}.tp-radv_i{left:0;opacity:0;position:absolute;top:0}.tp-radv_b{opacity:.5}.tp-radv_i:hover+.tp-radv_b{background-color:var(--btn-bg-h)}.tp-radv_i:focus+.tp-radv_b{background-color:var(--btn-bg-f)}.tp-radv_i:active+.tp-radv_b{background-color:var(--btn-bg-a)}.tp-radv_i:checked+.tp-radv_b{opacity:1}.tp-radv_t{bottom:0;color:inherit;left:0;overflow:hidden;position:absolute;right:0;text-align:center;text-overflow:ellipsis;top:0}.tp-radv_i:disabled+.tp-radv_b>.tp-radv_t{opacity:.5}.tp-radgridv{border-radius:var(--elm-br);display:grid;overflow:hidden;gap:2px}.tp-radgridv.tp-v-disabled{opacity:.5}.tp-radgridv .tp-radv_b{border-radius:0}',accept:(T,v)=>{if(!Yi.isObject(T))return null;const S=ie,L=ee(v,{format:S.optional.function,max:S.optional.number,min:S.optional.number,step:S.optional.number});return L?{initialValue:new Yi(T.min,T.max),params:L}:null},binding:{reader:T=>Nu,constraint:T=>Wd(T.params),equals:Yi.equals,writer:T=>Xl},controller(T){var v;const S=T.value,L=T.constraint;if(!(L instanceof co))throw h.shouldNeverHappen();const z=(S.rawValue.min+S.rawValue.max)/2,re=(v=T.params.format)!==null&&v!==void 0?v:zt(no(L.edge,z)),ve=L.edge&&H(L.edge,ne);if(ve)return new us(T.document,{baseStep:kl(L.edge),constraint:L.edge,draggingScale:ca(L.edge,z),formatter:re,parser:ai,sliderProps:new O({maxValue:ve.values.value("max"),minValue:ve.values.value("min")}),value:S,viewProps:T.viewProps});const Ae={baseStep:kl(L.edge),constraint:L.edge,textProps:O.fromObject({draggingScale:z,formatter:re})};return new Us(T.document,{assembly:Wl,axes:[Ae,Ae],parser:ai,value:S,viewProps:T.viewProps})}};class Ws{constructor(v){this.controller_=v}get disabled(){return this.controller_.viewProps.get("disabled")}set disabled(v){this.controller_.viewProps.set("disabled",v)}get title(){var v;return(v=this.controller_.props.get("title"))!==null&&v!==void 0?v:""}set title(v){this.controller_.props.set("title",v)}}class js extends s{constructor(v,S,L,z,re){super(v,z,re),this.cell=S,this.index=L}}class ho extends i{constructor(v){super(v),this.cellToApiMap_=new Map,this.controller_.valueController.cellControllers.forEach(L=>{const z=new Ws(L);this.cellToApiMap_.set(L,z)})}get value(){return this.controller_.value}cell(v,S){const L=this.controller_.valueController,z=L.cellControllers[S*L.size[0]+v];return this.cellToApiMap_.get(z)}on(v,S){const L=S.bind(this);this.controller_.value.emitter.on(v,z=>{const re=this.controller_.valueController,ve=re.findCellByValue(z.rawValue);if(!ve)return;const Ae=this.cellToApiMap_.get(ve);if(!Ae)return;const Rt=re.cellControllers.indexOf(ve);L(new js(this,Ae,[Rt%re.size[0],Math.floor(Rt/re.size[0])],z.rawValue,void 0))})}}const po=d("rad");class Bu{constructor(v,S){this.element=v.createElement("div"),this.element.classList.add(po()),S.viewProps.bindClassModifiers(this.element);const L=v.createElement("label");L.classList.add(po("l")),this.element.appendChild(L);const z=v.createElement("input");z.classList.add(po("i")),z.name=S.name,z.type="radio",S.viewProps.bindDisabled(z),L.appendChild(z),this.inputElement=z;const re=v.createElement("div");re.classList.add(po("b")),L.appendChild(re);const ve=v.createElement("div");ve.classList.add(po("t")),re.appendChild(ve),b(S.props,"title",Ae=>{ve.textContent=Ae})}}class Vu{constructor(v,S){this.props=S.props,this.viewProps=S.viewProps,this.view=new Bu(v,{name:S.name,props:this.props,viewProps:this.viewProps})}}class ma{constructor(v,S){this.cellCs_=[],this.cellValues_=[],this.onCellInputChange_=this.onCellInputChange_.bind(this),this.size=S.size;const[L,z]=this.size;for(let re=0;re<z;re++)for(let ve=0;ve<L;ve++){const Ae=new Vu(v,{name:S.groupName,props:O.fromObject(Object.assign({},S.cellConfig(ve,re))),viewProps:me.create()});this.cellCs_.push(Ae),this.cellValues_.push(S.cellConfig(ve,re).value)}this.value=S.value,_(this.value,re=>{const ve=this.findCellByValue(re);ve&&(ve.view.inputElement.checked=!0)}),this.viewProps=me.create(),this.view=new fe(v,{viewProps:this.viewProps,viewName:"radgrid"}),this.view.element.style.gridTemplateColumns=`repeat(${L}, 1fr)`,this.cellCs_.forEach(re=>{re.view.inputElement.addEventListener("change",this.onCellInputChange_),this.view.element.appendChild(re.view.element)})}get cellControllers(){return this.cellCs_}findCellByValue(v){const S=this.cellValues_.findIndex(L=>L===v);return S<0?null:this.cellCs_[S]}onCellInputChange_(v){const S=v.currentTarget,L=this.cellCs_.findIndex(z=>z.view.inputElement===S);L<0||(this.value.rawValue=this.cellValues_[L])}}const qs=function(){return{id:"radiogrid",type:"blade",accept(T){const v=ie,S=ee(T,{cells:v.required.function,groupName:v.required.string,size:v.required.array(v.required.number),value:v.required.raw,view:v.required.constant("radiogrid"),label:v.optional.string});return S?{params:S}:null},controller(T){return new xe(T.document,{blade:T.blade,props:O.fromObject({label:T.params.label}),valueController:new ma(T.document,{groupName:T.params.groupName,cellConfig:T.params.cells,size:T.params.size,value:k(T.params.value)})})},api(T){return!(T.controller instanceof xe)||!(T.controller.valueController instanceof ma)?null:new ho(T.controller)}}}();function $l(T){return{id:"input-radiogrid",type:"input",accept(v,S){if(!T.isType(v))return null;const L=ie,z=ee(S,{cells:L.required.function,groupName:L.required.string,size:L.required.array(L.required.number),view:L.required.constant("radiogrid")});return z?{initialValue:v,params:z}:null},binding:T.binding,controller:v=>new ma(v.document,{cellConfig:v.params.cells,groupName:v.params.groupName,size:v.params.size,value:v.value})}}const jd=$l({isType:T=>typeof T=="number",binding:{reader:T=>Kt,writer:T=>Cn}}),qd=$l({isType:T=>typeof T=="string",binding:{reader:T=>hn,writer:T=>Cn}}),Xd=$l({isType:T=>typeof T=="boolean",binding:{reader:T=>$,writer:T=>Cn}}),zu=[Nd,Hs,Hl,fa,qs,Xd,jd,qd];t.ButtonCellApi=Au,t.ButtonGridApi=Lu,t.ButtonGridController=Fl,t.CubicBezier=ws,t.CubicBezierApi=Ru,t.CubicBezierAssembly=Nl,t.CubicBezierController=da,t.CubicBezierGraphController=Xn,t.CubicBezierGraphView=fi,t.CubicBezierPickerController=Ou,t.CubicBezierPickerView=Iu,t.CubicBezierPreviewView=Sr,t.CubicBezierView=ku,t.FpsGraphBladeApi=jt,t.FpsGraphController=Gl,t.FpsView=$i,t.Fpswatch=ci,t.Interval=Yi,t.IntervalAssembly=Wl,t.IntervalConstraint=co,t.RadioCellApi=Ws,t.RadioController=Vu,t.RadioGridApi=ho,t.RadioGridController=ma,t.RadioView=Bu,t.RangeSliderController=ql,t.RangeSliderTextController=us,t.RangeSliderTextView=pa,t.RangeSliderView=uo,t.TpRadioGridChangeEvent=js,t.plugins=zu,Object.defineProperty(t,"__esModule",{value:!0})})})(hm,hm.exports);var _w=hm.exports;const V2=N2(_w),z2=z1({__proto__:null,default:V2},[_w]);const U2="tp";function G2(r){return(t,i)=>[U2,"-",r,"v",t?`_${t}`:"",i?`-${i}`:""].join("")}function H2(r,e){const i=Object.keys(e).reduce((n,s)=>{if(n===void 0)return;const a=e[s],o=a(r[s]);return o.succeeded?Object.assign(Object.assign({},n),{[s]:o.value}):void 0},{});return i}function W2(r,e){return r.reduce((t,i)=>{if(t===void 0)return;const n=e(i);if(!(!n.succeeded||n.value===void 0))return[...t,n.value]},[])}function j2(r){return r===null?!1:typeof r=="object"}function er(r){return e=>t=>{if(!e&&t===void 0)return{succeeded:!1,value:void 0};if(e&&t===void 0)return{succeeded:!0,value:void 0};const i=r(t);return i!==void 0?{succeeded:!0,value:i}:{succeeded:!1,value:void 0}}}function O0(r){return{custom:e=>er(e)(r),boolean:er(e=>typeof e=="boolean"?e:void 0)(r),number:er(e=>typeof e=="number"?e:void 0)(r),string:er(e=>typeof e=="string"?e:void 0)(r),function:er(e=>typeof e=="function"?e:void 0)(r),constant:e=>er(t=>t===e?e:void 0)(r),raw:er(e=>e)(r),object:e=>er(t=>{if(j2(t))return H2(t,e)})(r),array:e=>er(t=>{if(Array.isArray(t))return W2(t,e)})(r)}}const vw={optional:O0(!0),required:O0(!1)};function q2(r,e){const t=vw.required.object(e)(r);return t.succeeded?t.value:void 0}function ja(r,e,t,i){function n(s){return s instanceof t?s:new t(function(a){a(s)})}return new(t||(t=Promise))(function(s,a){function o(f){try{h(i.next(f))}catch(c){a(c)}}function u(f){try{h(i.throw(f))}catch(c){a(c)}}function h(f){f.done?s(f.value):n(f.value).then(o,u)}h((i=i.apply(r,e||[])).next())})}function X2(){const r=document.createElement("canvas");r.width=128,r.height=64;const e=r.getContext("2d");return e.fillStyle="#222",e.fillRect(0,0,r.width,r.height),e.fillStyle="#ddd",e.font="monospaced",e.textAlign="center",e.textBaseline="middle",e.fillText("No image",r.width*.5,r.height*.5),new Promise(t=>{r.toBlob(i=>{const n=new Image;n.src=URL.createObjectURL(i),n.onload=()=>{t(n)}})})}function ff(r){return ja(this,void 0,void 0,function*(){const e=new Image;return e.crossOrigin="anonymous",new Promise(t=>{e.src=r,e.decode().then(()=>{t(e)})})})}function N0(r){return new Promise(e=>{e(r)})}const yo=G2("img");class $2{constructor(e,t){this.element=e.createElement("div"),this.element.classList.add(yo()),t.viewProps.bindClassModifiers(this.element),this.input=e.createElement("input"),this.input.classList.add(yo("input")),this.input.setAttribute("type","file"),this.input.setAttribute("accept",t.extensions.join(",")),this.element.appendChild(this.input),this.image_=e.createElement("img"),this.image_.classList.add(yo("image")),this.image_.classList.add(yo(`image_${t.imageFit}`)),this.element.classList.add(yo("area_root")),this.element.appendChild(this.image_)}changeImage(e){this.image_.src=e}changeDraggingState(e){const t=this.element;e?t==null||t.classList.add(yo("area_dragging")):t==null||t.classList.remove(yo("area_dragging"))}}class Y2{constructor(e,t){this.placeholderImage=null,this.value=t.value,this.viewProps=t.viewProps,this.view=new $2(e,{viewProps:this.viewProps,extensions:t.extensions,imageFit:t.imageFit}),this.onFile=this.onFile.bind(this),this.onDrop=this.onDrop.bind(this),this.onDragOver=this.onDragOver.bind(this),this.onDragLeave=this.onDragLeave.bind(this),this.view.input.addEventListener("change",this.onFile),this.view.element.addEventListener("drop",this.onDrop),this.view.element.addEventListener("dragover",this.onDragOver),this.view.element.addEventListener("dragleave",this.onDragLeave),this.viewProps.handleDispose(()=>{this.view.input.removeEventListener("change",this.onFile),this.view.input.removeEventListener("drop",this.onDrop),this.view.input.removeEventListener("dragover",this.onDragOver),this.view.input.removeEventListener("dragleave",this.onDragLeave)}),this.value.emitter.on("change",this.handleValueChange.bind(this)),this.handleValueChange()}onFile(e){const t=(e==null?void 0:e.target).files;if(!t||!t.length)return;const i=t[0],n=URL.createObjectURL(i);this.setValue(n),this.updateImage(n)}onDrop(e){return ja(this,void 0,void 0,function*(){e.preventDefault();try{const{dataTransfer:t}=e,i=t==null?void 0:t.files[0];if(i){const n=URL.createObjectURL(i);this.updateImage(n),this.setValue(n)}else{const n=t==null?void 0:t.getData("url");if(!n)throw new Error("No url");ff(n).then(s=>ja(this,void 0,void 0,function*(){const a=yield N0(s);this.updateImage(a.src),this.setValue(a)}))}}catch(t){console.error("Could not parse the dropped image",t)}finally{this.view.changeDraggingState(!1)}})}onDragOver(e){e.preventDefault(),this.view.changeDraggingState(!0)}onDragLeave(){this.view.changeDraggingState(!1)}handleImage(e){return ja(this,void 0,void 0,function*(){if(e instanceof HTMLImageElement)N0(e).then(t=>{this.updateImage(t.src)});else if(typeof e=="string"){let t="";try{if(e==="placeholder")throw new Error("placeholder");new URL(e),t=(yield ff(e)).src}catch{t=(yield this.handlePlaceholderImage()).src}finally{this.updateImage(t),this.setValue(t)}}})}updateImage(e){this.view.changeImage(e)}setValue(e){return ja(this,void 0,void 0,function*(){e instanceof HTMLImageElement?this.value.setRawValue(e):e?this.value.setRawValue(yield ff(e)):this.value.setRawValue(yield this.handlePlaceholderImage())})}handleValueChange(){this.handleImage(this.value.rawValue)}handlePlaceholderImage(){return ja(this,void 0,void 0,function*(){return this.placeholderImage||(this.placeholderImage=yield X2()),this.placeholderImage})}}const K2=[".jpg",".png",".gif"],Z2={id:"input-image",type:"input",css:".tp-imgv{-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:transparent;border-width:0;font-family:inherit;font-size:inherit;font-weight:inherit;margin:0;outline:none;padding:0}.tp-imgv{background-color:var(--in-bg);border-radius:var(--elm-br);box-sizing:border-box;color:var(--in-fg);font-family:inherit;height:var(--bld-us);line-height:var(--bld-us);min-width:0;width:100%}.tp-imgv:hover{background-color:var(--in-bg-h)}.tp-imgv:focus{background-color:var(--in-bg-f)}.tp-imgv:active{background-color:var(--in-bg-a)}.tp-imgv:disabled{opacity:0.5}:root{--tp-plugin-image-dragging-color: hsla(230, 100%, 66%, 1.00)}.tp-imgv{cursor:pointer;display:grid;height:calc(var(--bld-us) * 3);overflow:hidden;position:relative}.tp-imgv.tp-v-disabled{opacity:0.5}.tp-imgv_input{width:100%;height:100%;opacity:0}.tp-imgv_image{width:100%;height:100%;position:absolute;pointer-events:none;border:0}.tp-imgv_image_contain{-o-object-fit:contain;object-fit:contain}.tp-imgv_image_cover{-o-object-fit:cover;object-fit:cover}.tp-imgv_area_root{transition:opacity 0.16s ease-in-out}.tp-imgv_area_dragging{border:2px dashed var(--tp-plugin-image-dragging-color);border-radius:6px;opacity:0.6}",accept(r,e){if(!(r instanceof HTMLImageElement||typeof r=="string"))return null;const t=vw,i=q2(e,{view:t.required.constant("input-image"),acceptUrl:t.optional.boolean,imageFit:t.optional.custom(n=>n==="contain"||n==="cover"?n:void 0),extensions:t.optional.array(t.required.string)});return i?{initialValue:r,params:i}:null},binding:{reader(r){return e=>e instanceof HTMLImageElement?e.src===""?"placeholder":e.src:typeof e=="string"?e:"placeholder"},writer(r){return(e,t)=>{e.write(t)}}},controller(r){let e,t;return new Y2(r.document,{value:r.value,imageFit:(e=r.params.imageFit)!==null&&e!==void 0?e:"cover",viewProps:r.viewProps,extensions:(t=r.params.extensions)!==null&&t!==void 0?t:K2})}},J2=Z2,Q2=Object.freeze(Object.defineProperty({__proto__:null,plugin:J2},Symbol.toStringTag,{value:"Module"}));var eR=`<div class="gl-box">
  <svg viewBox="0 0 55 60">
    <text x="27" y="56" class="gl-fps">00 FPS</text>
    <text x="28" y="8" class="gl-mem"></text>
    <rect x="0" y="14" rx="4" ry="4" width="55" height="32"></rect>
    <polyline class="gl-chart"></polyline>
  </svg>
  <svg viewBox="0 0 14 60" class="gl-cpu-svg">
    <line x1="7" y1="38" x2="7" y2="11" class="opacity"/>
    <line x1="7" y1="38" x2="7" y2="11" class="gl-cpu" stroke-dasharray="0 27"/>
    <path d="M5.35 43c-.464 0-.812.377-.812.812v1.16c-.783.1972-1.421.812-1.595 1.624h-1.16c-.435 0-.812.348-.812.812s.348.812.812.812h1.102v1.653H1.812c-.464 0-.812.377-.812.812 0 .464.377.812.812.812h1.131c.1943.783.812 1.392 1.595 1.595v1.131c0 .464.377.812.812.812.464 0 .812-.377.812-.812V53.15h1.653v1.073c0 .464.377.812.812.812.464 0 .812-.377.812-.812v-1.131c.783-.1943 1.392-.812 1.595-1.595h1.131c.464 0 .812-.377.812-.812 0-.464-.377-.812-.812-.812h-1.073V48.22h1.102c.435 0 .812-.348.812-.812s-.348-.812-.812-.812h-1.16c-.1885-.783-.812-1.421-1.595-1.624v-1.131c0-.464-.377-.812-.812-.812-.464 0-.812.377-.812.812v1.073H6.162v-1.073c0-.464-.377-.812-.812-.812zm.58 3.48h2.088c.754 0 1.363.609 1.363 1.363v2.088c0 .754-.609 1.363-1.363 1.363H5.93c-.754 0-1.363-.609-1.363-1.363v-2.088c0-.754.609-1.363 1.363-1.363z"/>
  </svg>
  <svg viewBox="0 0 14 60" class="gl-gpu-svg">
    <line x1="7" y1="38" x2="7" y2="11" class="opacity"/>
    <line x1="7" y1="38" x2="7" y2="11" class="gl-gpu" stroke-dasharray="0 27"/>
    <path d="M1.94775 43.3772a.736.736 0 10-.00416 1.472c.58535.00231.56465.1288.6348.3197.07015.18975.04933.43585.04933.43585l-.00653.05405v8.671a.736.736 0 101.472 0v-1.4145c.253.09522.52785.1495.81765.1495h5.267c1.2535 0 2.254-.9752 2.254-2.185v-3.105c0-1.2075-1.00625-2.185-2.254-2.185h-5.267c-.28865 0-.5635.05405-.8165.1495.01806-.16445.04209-.598-.1357-1.0787-.22425-.6072-.9499-1.2765-2.0125-1.2765zm2.9095 3.6455c.42435 0 .7659.36225.7659.8119v2.9785c0 .44965-.34155.8119-.7659.8119s-.7659-.36225-.7659-.8119v-2.9785c0-.44965.34155-.8119.7659-.8119zm4.117 0a2.3 2.3 0 012.3 2.3 2.3 2.3 0 01-2.3 2.3 2.3 2.3 0 01-2.3-2.3 2.3 2.3 0 012.3-2.3z"/>
  </svg>
</div>`,tR=`#gl-bench {
  position:absolute;
  left:0;
  top:0;
  z-index:1000;
  -webkit-user-select: none;
  -moz-user-select: none;
  user-select: none;
}

#gl-bench div {
  position: relative;
  display: block;
  margin: 4px;
  padding: 0 7px 0 10px;
  background: #6c6;
  border-radius: 15px;
  cursor: pointer;
  opacity: 0.9;
}

#gl-bench svg {
  height: 60px;
  margin: 0 -1px;
}

#gl-bench text {
  font-size: 12px;
  font-family: Helvetica,Arial,sans-serif;
  font-weight: 700;
  dominant-baseline: middle;
  text-anchor: middle;
}

#gl-bench .gl-mem {
  font-size: 9px;
}

#gl-bench line {
  stroke-width: 5;
  stroke: #112211;
  stroke-linecap: round;
}

#gl-bench polyline {
  fill: none;
  stroke: #112211;
  stroke-linecap: round;
  stroke-linejoin: round;
  stroke-width: 3.5;
}

#gl-bench rect {
  fill: #448844;
}

#gl-bench .opacity {
  stroke: #448844;
}
`;class iR{constructor(e,t={}){this.css=tR,this.svg=eR,this.paramLogger=()=>{},this.chartLogger=()=>{},this.chartLen=20,this.chartHz=20,this.names=[],this.cpuAccums=[],this.gpuAccums=[],this.activeAccums=[],this.chart=new Array(this.chartLen),this.now=()=>performance&&performance.now?performance.now():Date.now(),this.updateUI=()=>{[].forEach.call(this.nodes["gl-gpu-svg"],o=>{o.style.display=this.trackGPU?"inline":"none"})},Object.assign(this,t),this.detected=0,this.finished=[],this.isFramebuffer=0,this.frameId=0;let i,n=0,s,a=o=>{++n<20?i=requestAnimationFrame(a):(this.detected=Math.ceil(1e3*n/(o-s)/70),cancelAnimationFrame(i)),s||(s=o)};if(requestAnimationFrame(a),e){const o=async(h,f)=>Promise.resolve(setTimeout(()=>{e.getError();const c=this.now()-h;f.forEach((d,m)=>{d&&(this.gpuAccums[m]+=c)})},0)),u=(h,f,c)=>function(){const d=f.now();h.apply(c,arguments),f.trackGPU&&f.finished.push(o(d,f.activeAccums.slice(0)))};["drawArrays","drawElements","drawArraysInstanced","drawBuffers","drawElementsInstanced","drawRangeElements"].forEach(h=>{e[h]&&(e[h]=u(e[h],this,e))}),e.getExtension=((h,f)=>function(){let c=h.apply(e,arguments);return c&&["drawElementsInstancedANGLE","drawBuffersWEBGL"].forEach(d=>{c[d]&&(c[d]=u(c[d],f,c))}),c})(e.getExtension,this)}if(!this.withoutUI){this.dom||(this.dom=document.body);let o=document.createElement("div");o.id="gl-bench",this.dom.appendChild(o),this.dom.insertAdjacentHTML("afterbegin",'<style id="gl-bench-style">'+this.css+"</style>"),this.dom=o,this.dom.addEventListener("click",()=>{this.trackGPU=!this.trackGPU,this.updateUI()}),this.paramLogger=((u,h,f)=>{const c=["gl-cpu","gl-gpu","gl-mem","gl-fps","gl-gpu-svg","gl-chart"],d=Object.assign({},c);return c.forEach(m=>d[m]=h.getElementsByClassName(m)),this.nodes=d,(m,x,_,b,y,M,D)=>{d["gl-cpu"][m].style.strokeDasharray=(x*.27).toFixed(0)+" 100",d["gl-gpu"][m].style.strokeDasharray=(_*.27).toFixed(0)+" 100",d["gl-mem"][m].innerHTML=f[m]?f[m]:b?"mem: "+b.toFixed(0)+"mb":"",d["gl-fps"][m].innerHTML=y.toFixed(0)+" FPS",u(f[m],x,_,b,y,M,D)}})(this.paramLogger,this.dom,this.names),this.chartLogger=((u,h)=>{let f={"gl-chart":h.getElementsByClassName("gl-chart")};return(c,d,m)=>{let x="",_=d.length;for(let b=0;b<_;b++){let y=(m+b+1)%_;d[y]!=null&&(x=x+" "+(55*b/(_-1)).toFixed(1)+","+(45-d[y]*22/60/this.detected).toFixed(1))}f["gl-chart"][c].setAttribute("points",x),u(this.names[c],d,m)}})(this.chartLogger,this.dom)}}addUI(e){this.names.indexOf(e)==-1&&(this.names.push(e),this.dom&&(this.dom.insertAdjacentHTML("beforeend",this.svg),this.updateUI()),this.cpuAccums.push(0),this.gpuAccums.push(0),this.activeAccums.push(!1))}nextFrame(e){this.frameId++;const t=e||this.now();if(this.frameId<=1)this.paramFrame=this.frameId,this.paramTime=t;else{let i=t-this.paramTime;if(i>=1e3){const n=this.frameId-this.paramFrame,s=n/i*1e3;for(let a=0;a<this.names.length;a++){const o=this.cpuAccums[a]/i*100,u=this.gpuAccums[a]/i*100,h=performance&&performance.memory?performance.memory.usedJSHeapSize/(1<<20):0;this.paramLogger(a,o,u,h,s,i,n),this.cpuAccums[a]=0,Promise.all(this.finished).then(()=>{this.gpuAccums[a]=0,this.finished=[]})}this.paramFrame=this.frameId,this.paramTime=t}}if(!this.detected||!this.chartFrame)this.chartFrame=this.frameId,this.chartTime=t,this.circularId=0;else{let i=t-this.chartTime,n=this.chartHz*i/1e3;for(;--n>0&&this.detected;){const a=(this.frameId-this.chartFrame)/i*1e3;this.chart[this.circularId%this.chartLen]=a;for(let o=0;o<this.names.length;o++)this.chartLogger(o,this.chart,this.circularId);this.circularId++,this.chartFrame=this.frameId,this.chartTime=t}}}begin(e){this.updateAccums(e)}end(e){this.updateAccums(e)}updateAccums(e){let t=this.names.indexOf(e);t==-1&&(t=this.names.length,this.addUI(e));const i=this.now(),n=i-this.t0;for(let s=0;s<t+1;s++)this.activeAccums[s]&&(this.cpuAccums[s]+=n);this.activeAccums[t]=!this.activeAccums[t],this.t0=i}}class nR extends B2.Pane{constructor(){super({title:"Options"});q(this,"exportPreset",t=>{const i={},n=(a,o)=>{if(a.allowExport!==!1&&a.controller_.rackController){const h=a.controller_.rackController.rack.bcSet_.items.filter(f=>f.binding).map(f=>f.binding.target).reduce((f,c)=>{const d=c.read();return d instanceof Image?f:Object.assign(f,{[c.presetKey]:d})},{});o||(o={},i[a._id]=o),o[a._id]=h,a.children.forEach(f=>{let c=!1;f.children&&(c={},o[f._id]=c),n(f,c)})}};return this.children.forEach(a=>{n(a)}),JSON.stringify(i)});q(this,"importPreset",t=>{const i=(n,s)=>{if(n.allowExport!==!1&&n.controller_.rackController){const a=n.controller_.rackController.rack.bcSet_.items.filter(o=>o.binding).map(o=>o.binding.target);s||(s=t[n._id]),a.forEach(o=>{const u=o.obj_[o.key],h=s[n._id][o.presetKey];h!==void 0&&(u.copy?u.copy(h):o.write(h))}),n.children.forEach(o=>{i(o,s[o._id])})}};this.children.forEach(n=>{i(n)}),this.refresh()});this.setTheme(),this.containerElem_.addEventListener("wheel",i=>{i.stopPropagation()}),this.containerElem_.querySelector("button.tp-rotv_b").style.cursor="move",this.enableDrag(this.containerElem_),this.registerPlugin(z2),this.registerPlugin(Q2),this.idCount=0,this.fireChange=!0,this.options={syncGuiValues:!1,saveState:!1};const t=localStorage.getItem(window.location.href+".guiSaveState");t!==null&&(this.options.saveState=t==="true"),this.addFps(),this.settingsFolder=this.addFolder({title:"Gui Settings",expanded:!1,allowExport:!1}),this.settingsFolder.addInput(this.options,"syncGuiValues"),localStorage.setItem(window.location.href+".guiSaveState",this.options.saveState),this.settingsFolder.addInput(this.options,"saveState").on("change",i=>{localStorage.setItem(window.location.href+".guiSaveState",i.value),i.value===!1&&localStorage.removeItem(window.location.href+".gui")}),this.addPerf(),this.addImportExport()}addPerf(){if(!E.WebGL)return;this.initGlBench();const t=this.addFolder({title:"Performance",expanded:!1,allowExport:!1});t.addMonitor(this.perfStats,"cpu",{label:"cpu (ms)"}),t.addMonitor(this.perfStats,"gpu",{label:"gpu (ms)"}),t.addMonitor(this.perfStats,"mem",{label:"mem (mb)"}),t.addMonitor(E.WebGL.renderer.info.render,"calls",{label:"draw calls",interval:500}),t.addMonitor(E.WebGL.renderer.info.render,"triangles",{interval:500}),t.addMonitor(E.WebGL.renderer.info.memory,"geometries",{interval:1e4}),t.addMonitor(E.WebGL.renderer.info.memory,"textures",{interval:1e4})}initGlBench(){this.perfStats={cpu:0,gpu:0,mem:0},this.glBench=new iR(E.WebGL.renderer.getContext(),{withoutUI:!0,trackGPU:!0,paramLogger:(t,i,n,s,a,o,u)=>{this.perfStats.cpu=(i*o/1e3/u).toFixed(3),this.perfStats.gpu=(n*o/1e4/u).toFixed(3),this.perfStats.mem=s.toFixed(1)}})}perfBegin(){this.fps.begin(),this.glBench.begin(),this.refresh(!1),E.WebGL.renderer.info.reset()}perfEnd(t){this.fps.end(),this.glBench.end(),this.glBench.nextFrame(t)}addFolder(t){const i=super.addFolder(t);return i._id=this.idCount++,i.idCount=0,i.allowExport=t.allowExport!==void 0?t.allowExport:!0,i.addFolder=this.addFolder,i.addInput=this.addInput,i}addInput(t,i,n){return n&&!n.presetKey&&n.label&&(n.presetKey=n.label.replace(" ","_").replace("-","_")),super.addInput(t,i,n)}addImportExport(){const t=this.settingsFolder.addFolder({title:"Import/Export",expanded:!0,allowExport:!1});this.originalData={};const i=document.createElement("div");Object.assign(i.style,{display:"none",flexDirection:"column",justifyContent:"center",alignItems:"center",width:"100vw",height:"100vh",position:"fixed",top:"0px",left:"0px",zIndex:"99999999",backdropFilter:"blur(10px)"}),i.addEventListener("click",u=>{u.target!==n&&(i.style.display="none")});const n=document.createElement("textarea");n.placeholder="Paste exported data here...",Object.assign(n.style,{width:"90%",height:"90%",maxWidth:"400px",maxHeight:"300px",background:"rgba(0, 0, 0, 0.8)",color:"white",fontFamily:"monospace",fontSize:"11px",marginBottom:"2rem"}),i.appendChild(n);const s=document.createElement("button");s.innerHTML="Apply",s.addEventListener("click",()=>{n.value&&(localStorage.setItem(window.location.href+".gui",n.value),this.importPreset(JSON.parse(n.value)),n.value="")}),i.appendChild(s),document.body.appendChild(i),t.addButton({title:"Import"}).on("click",()=>{i.style.display="flex",n.focus()});let a;const o=t.addButton({title:"Export"}).on("click",()=>{o.disabled=!0;const u=this.exportPreset();localStorage.setItem(window.location.href+".gui",u),navigator.clipboard?navigator.clipboard.writeText(u):(i.style.display="flex",n.value=u,n.focus(),n.select(),document.execCommand("copy"),n.value="",i.style.display="none"),o.title="Copied to clipboard!",clearTimeout(a),setTimeout(()=>{o.title="Export",o.disabled=!1},2e3)});t.addButton({title:"Reset"}).on("click",()=>{this.importPreset(JSON.parse(this.originalData)),localStorage.setItem(window.location.href+".gui",this.originalData)}),setTimeout(()=>{if(this.originalData=this.exportPreset(),this.options.saveState){const u=localStorage.getItem(window.location.href+".gui");u&&this.importPreset(JSON.parse(u))}},500),setInterval(()=>{this.options.saveState&&localStorage.setItem(window.location.href+".gui",this.exportPreset())},5e3)}refresh(t=!0){this.options.syncGuiValues&&(this.fireChange=t,super.refresh(),this.fireChange=!0)}autoAddObject({object:t,exclude:i=[],include:n=[],transforms:s=!0,expanded:a=!1,parentFolder:o=null}){const h=(o||this).addFolder({title:t.name?`${t.type}: ${t.name}`:t.type,expanded:a});h.addInput(t,"visible",{index:0});let f=!1;s&&(f=h.addFolder({title:"transforms",expanded:!0}),f.addInput(t,"position"),f.addInput(t,"rotation"),f.addInput(t,"scale"));const c=h.addFolder({title:"material",expanded:!0}),d=c.addFolder({title:"options",expanded:!1});d.addInput(t.material,"wireframe"),d.addBlade({view:"list",label:"side",value:t.material.side,options:{front:Ns,back:Vn,double:lu}}).on("change",x=>{t.material.side=x.value}),d.addBlade({view:"list",label:"blending",value:t.material.blending,options:{NoBlending:cr,NormalBlending:Fo,AdditiveBlending:xf,SubtractiveBlending:wf,MultiplyBlending:yf,CustomBlending:J0}}).on("change",x=>{t.material.blending=x.value}),d.addInput(t.material,"transparent"),d.addInput(t.material,"depthTest"),d.addInput(t.material,"depthWrite"),d.addInput(t.material,"colorWrite"),this.autoAddUniforms(h,t.material.uniforms,i,n);const m=["color","bumpMap","bumpScale","displacementBias","displacementMap","displacementScale","emissive","emissiveIntensity","emissiveMap","ior","map","metalness","metalnessMap","normalMap","normalScale","opacity","reflectivity","roughness","roughnessMap","specular","specularColor","specularMap","specularIntensity","specularColorMap","specularIntensityMap","thickness","_transmission"];if(t.material.type!=="ShaderMaterial"&&t.material.type!=="RawShaderMaterial"){for(const x in t.material)if(m.includes(x))if(t.material[x]===null){if(x.toLowerCase().includes("map")){const _={tex:new vi};this.addImage(c,_,"tex",x,{wrapping:Kr},b=>{t.material[x]=_.tex,t.material.needsUpdate=!0}),c.addInput(_.tex,"repeat",{label:x+" repeat",step:.01}).on("change",b=>{t.material[x].needsUpdate=!0})}}else if(t.material[x].isColor)this.addColor(c,t.material,x,x,!1);else if(t.material[x].isTexture){if(t.material[x].isDataTexture)continue;this.addImage(c,t.material,x,x),c.addInput(t.material[x],"repeat",{label:x+" repeat",step:.01}).on("change",_=>{t.material[x].needsUpdate=!0})}else if(x.includes("_")){const _=x.replace("_","");c.addInput(t.material,x).on("change",b=>{t.material.needsUpdate=!0,t.material[_]=b.value})}else c.addInput(t.material,x,{step:.01})}return{folder:h,transformsFolder:f,materialFolder:c}}autoAddUniforms(t,i,n=[],s=[]){for(const a in i){if(a==="uTime"||a.toUpperCase().includes("FOG")||n.includes(a)||s.length&&!s.includes(a))continue;const o=i[a];if(o.value===null||o.value===void 0){console.error("Error when attempting to auto-add uniform: "+a+" has no value");continue}o.value.isMatrix4||o.value.isRenderTargetTexture||(o.value.isColor?this.addColor(t,o,"value",a):o.value.isTexture?this.addImage(t,o,"value",a):t.addInput(o,"value",{label:a,...o.gui}))}}addColor(t,i,n,s,a=!0,o=[]){return a?this.setupColorUniform(i):i.guiValue="#"+i[n].getHexString(),t.addInput(i,"guiValue",{label:s,picker:"inline"}).on("change",()=>{if(this.fireChange&&(i[n].set(i.guiValue),o&&o.length>0))for(const u of o)u[n].set(i.guiValue)})}setupColorUniform(t){t.guiValue="#"+t.value.getHexString()}addImage(t,i,n,s,a={},o){i[n].firstLoad=!0,i[n].image||(i[n].image=new Image),a=Object.assign({minFilter:i[n].minFilter,magFilter:i[n].magFilter,wrapping:i[n].wrapS,flipY:i[n].flipY,encoding:i[n].encoding},a);const u=t.addInput(i[n],"image",{label:s,view:"input-image"}).on("change",h=>{if(i[n].firstLoad){i[n].firstLoad=!1;return}i[n]=E.WebGL.generateTexture(h.value,a),i[n].needsUpdate=!0,o&&o(i[n])});u.controller_.binding.read=()=>{}}addFps(){this.fps=this.addBlade({view:"fpsgraph"}),this.fps.allowExport=!1,Y.ticker.fps(999);const t=document.createElement("div");t.classList.add("force-unlocked-fps"),this.containerElem_.appendChild(t);const i=document.createElement("style"),n=`
			.force-unlocked-fps {
				animation-name: forceUnlockedFps;
				animation-duration: 4s;
				animation-iteration-count: infinite;
			}

			@keyframes forceUnlockedFps {
				from { transform: translateX(-1%) }
				to { transform: translateX(0%) }
			}
			`;i.innerHTML=n,this.containerElem_.appendChild(i)}setTheme(){this.containerElem_.style.width="350px",this.containerElem_.style.position="fixed",this.containerElem_.style.maxHeight="98vh",this.containerElem_.style.overflowY="auto",this.containerElem_.style.zIndex="9999999",this.containerElem_.style.backdropFilter="blur(10px)",this.containerElem_.firstChild.style.overflow="hidden";const t=document.createElement("style");t.innerHTML=`
			:root {
				--tp-base-background-color: hsla(0, 0%, 10%, 0.80);
				--tp-base-shadow-color: hsla(0, 0%, 0%, 0.2);
				--tp-button-background-color: hsla(0, 0%, 80%, 1.00);
				--tp-button-background-color-active: hsla(0, 0%, 100%, 1.00);
				--tp-button-background-color-focus: hsla(0, 0%, 95%, 1.00);
				--tp-button-background-color-hover: hsla(0, 0%, 85%, 1.00);
				--tp-button-foreground-color: hsla(0, 0%, 0%, 0.80);
				--tp-container-background-color: hsla(0, 0%, 0%, 0.30);
				--tp-container-background-color-active: hsla(0, 0%, 0%, 0.60);
				--tp-container-background-color-focus: hsla(0, 0%, 0%, 0.50);
				--tp-container-background-color-hover: hsla(0, 0%, 0%, 0.40);
				--tp-container-foreground-color: hsla(0, 0%, 100%, 0.50);
				--tp-groove-foreground-color: hsla(0, 0%, 0%, 0.20);
				--tp-input-background-color: hsla(0, 0%, 0%, 0.30);
				--tp-input-background-color-active: hsla(0, 0%, 0%, 0.60);
				--tp-input-background-color-focus: hsla(0, 0%, 0%, 0.50);
				--tp-input-background-color-hover: hsla(0, 0%, 0%, 0.40);
				--tp-input-foreground-color: hsla(0, 0%, 100%, 0.50);
				--tp-label-foreground-color: hsla(0, 0%, 100%, 0.50);
				--tp-monitor-background-color: hsla(0, 0%, 0%, 0.30);
				--tp-monitor-foreground-color: hsla(0, 0%, 100%, 0.30);
			}
			`,document.head.appendChild(t)}enableDrag(t){let i=0,n=0,s=0,a=0;const o=this.containerElem_.querySelector("button.tp-rotv_b");o.onmousedown=u;function u(c){c=c||window.event,c.preventDefault(),s=c.clientX,a=c.clientY,document.onmouseup=f,document.onmousemove=h}function h(c){c=c||window.event,c.preventDefault(),i=s-c.clientX,n=a-c.clientY,s=c.clientX,a=c.clientY,t.style.top=t.offsetTop-n+"px",t.style.left=t.offsetLeft-i+"px",o.style.pointerEvents="none"}function f(){document.onmouseup=null,document.onmousemove=null,o.style.pointerEvents="auto"}}}class bw extends nR{constructor(){super();q(this,"buildRocks",t=>{t.last&&(this.count.disabled=!0,E.rocksWebGL.scenes.rocks.destroy(),E.rocksWebGL.scenes.rocks.buildRocks(),requestAnimationFrame(()=>{E.rocksWebGL.scenes.rocks.start(),this.count.disabled=!1}))});q(this,"addRocks",()=>{if(!E.rocksWebGL.scenes.rocks)return;const t=this.addFolder({title:"Rocks",expanded:!0});this.count=t.addInput(E.rocksWebGL.scenes.rocks.options.rocks,"count",{min:1,max:15,step:1}).on("change",this.buildRocks),t.addInput(E.rocksWebGL.scenes.rocks.components.rocks.options,"radius",{min:0,max:5,step:.01}).on("change",E.rocksWebGL.scenes.rocks.components.rocks.updateRocksPos),t.addInput(E.rocksWebGL.scenes.rocks.options.rocks,"baseScale",{min:.1,max:2,step:.01}).on("change",E.rocksWebGL.scenes.rocks.components.rocks.updateRocksPos),t.addInput(E.rocksWebGL.scenes.rocks.options.rocks,"scaleOffset",{min:0,max:.5,step:.01}).on("change",E.rocksWebGL.scenes.rocks.components.rocks.updateRocksPos),t.addInput(E.rocksWebGL.scenes.rocks.options.rocks,"speed",{label:"Global rotation speed",min:.1,max:10,step:.1}),t.addInput(E.rocksWebGL.scenes.rocks.camera,"position",{label:"Camera pos"}),t.addInput(E.rocksWebGL.scenes.rocks.camera,"fov",{label:"Camera FOV"}).on("change",()=>E.rocksWebGL.scenes.rocks.camera.updateProjectionMatrix()),t.addInput(E.rocksWebGL.scenes.rocks.components.rocks.uniforms.uRotateSpeed,"value",{label:"Individual rotation speed",min:.1,max:15,step:.1}),this.addInputs(t,E.rocksWebGL.scenes.rocks.options,{name:"lightLerp",label:"Light lerp",min:.01,max:1,step:.01}),t.addSeparator(),this.addInputs(t,E.rocksWebGL.scenes.rocks.planeRaycast.material,{name:"visible",label:"Show Plane - Raycaster"}),t.addSeparator(),this.addFog(t),this.addRocksLights(t),t.addSeparator(),this.autoAddObject({parentFolder:t,object:E.rocksWebGL.scenes.rocks.components.rocks.mesh,expanded:!1})});this.options.syncGuiValues=!0,this.addTrailCurve(),this.addRocks()}addInputs(t,i,n){if(Array.isArray(n))n.forEach(s=>{const a=s.name;delete s.name,t.addInput(i,a,s)});else{const s=n.name;delete n.name,t.addInput(i,s,n)}}addTrailCurve(){}addFog(t){const i=t.addFolder({title:"Fog",expanded:!1});this.addInputs(i,E.rocksWebGL.scenes.rocks.fog,[{name:"near",min:0,max:15,step:.01},{name:"far",min:0,max:15,step:.01}]),this.addColor(i,E.rocksWebGL.scenes.rocks.fog,"color","color",!1)}addRocksLights(t){const i=t.addFolder({title:"Ambient Light",expanded:!1});this.addInputs(i,E.rocksWebGL.scenes.rocks.ambient,{name:"intensity",min:0,max:50,step:.01}),this.addColor(i,E.rocksWebGL.scenes.rocks.ambient,"color","color",!1);const n=t.addFolder({title:"Fixed Directional Light",expanded:!1}),s=[{name:"intensity",min:0,max:25,step:.1},{name:"position"}];this.addInputs(n,E.rocksWebGL.scenes.rocks.fixedLight,s),this.addColor(n,E.rocksWebGL.scenes.rocks.fixedLight,"color","color",!1);const a=t.addFolder({title:"Moving SpotLight",expanded:!1}),o=[{name:"intensity",min:0,max:25,step:.1},{name:"distance",min:1,max:25,step:.1},{name:"angle",min:0,max:Math.PI/2,step:.01},{name:"position"}];this.addInputs(a,E.rocksWebGL.scenes.rocks.movingLight,o),this.addColor(a,E.rocksWebGL.scenes.rocks.movingLight,"color","color",!1)}}const sR=Object.freeze(Object.defineProperty({__proto__:null,Gui:bw},Symbol.toStringTag,{value:"Module"})),rR=`precision highp float;precision highp int;
#define GLSLIFY 1
uniform mat4 modelViewMatrix;uniform mat4 modelMatrix;uniform mat4 viewMatrix;uniform mat4 projectionMatrix;uniform mat3 normalMatrix;attribute vec3 position;attribute vec3 normal;attribute vec2 uv;attribute vec4 color;`,oR=`precision highp float;precision highp int;
#define GLSLIFY 1
`,aR=`#define GLSLIFY 1
vec3 objectNormal=vec3(normal);vec3 transformedNormal=objectNormal;
#ifdef USE_INSTANCING
mat3 m=mat3(instanceMatrix);transformedNormal/=vec3(dot(m[0],m[0]),dot(m[1],m[1]),dot(m[2],m[2]));transformedNormal=m*transformedNormal;
#endif
transformedNormal=normalMatrix*transformedNormal;vNormal=normalize(transformedNormal);`,lR=`#define GLSLIFY 1
#include <defaultVert>
uniform vec3 uTrailPosition;uniform float uScale;uniform float uRotation;varying vec3 vNormal;varying vec2 vUv;mat2 rotate2d(in float radians){float c=cos(radians);float s=sin(radians);return mat2(c,-s,s,c);}void main(){vUv=uv;
#include <normalsVert>
vec3 newPos=uTrailPosition;float scale=uScale;vec4 newMvPosition=vec4(position,1.);newMvPosition.xy*=rotate2d(uRotation);newMvPosition.xyz*=scale;newMvPosition.xyz+=newPos.xyz;newMvPosition=modelMatrix*newMvPosition;newMvPosition=viewMatrix*newMvPosition;gl_Position=projectionMatrix*newMvPosition;}`,cR=`#define GLSLIFY 1
#include <defaultFrag>
uniform vec3 uColorLight;uniform vec3 uColorDark;uniform float uTransparency;uniform sampler2D uImage;uniform float uModeProgress;varying vec2 vUv;varying vec3 vNormal;void main(){vec4 tex=texture2D(uImage,vUv);float transparencyMultiplier=mix(0.7,0.9,uModeProgress);vec3 col=mix(tex.rgb+(uColorLight*vec3(0.2)),tex.rgb*uColorDark,uModeProgress);gl_FragColor=vec4(col,uTransparency*transparencyMultiplier);}`;class uR extends cP{constructor(e={}){e=rg({uniforms:{uColorLight:{value:new pt(15329507)},uColorDark:{value:new pt(9342606)},uTransparency:{value:.5},uTrailPosition:{value:new Ue(0,0)},uScale:{value:1},uRotation:{value:10},uImage:{value:null},uModeProgress:{value:1}},defines:{}},e),super({vertexShader:lR,fragmentShader:cR,uniforms:e.uniforms,defines:e.defines,transparent:!0,side:Ns}),this.globalUniforms=e.globalUniforms,this.uniforms=Object.assign(this.uniforms,this.globalUniforms)}clone(e){const t=super.clone();return t.uniforms=Object.assign(t.uniforms,this.globalUniforms),t.uniforms=Object.assign(t.uniforms,e),t}}const hR=`precision highp float;precision highp int;
#define GLSLIFY 1
attribute vec3 aPos;attribute float yPosMultiplier;attribute float opacityPosMultiplier;varying vec3 vNormal;varying vec2 vUv;varying float zPos;varying float yPos;varying float opacityMultiplier;uniform float uTime;uniform float uRadius;uniform float uYPosMultiplier;float map(float value,float min1,float max1,float min2,float max2){return min2+(value-min1)*(max2-min2)/(max1-min1);}void main(){
#include <normalsVert>
opacityMultiplier=opacityPosMultiplier;vUv=uv;vec3 transformedPosition=position;transformedPosition+=vec3(aPos.x,aPos.y,aPos.z);vec4 newPos=projectionMatrix*modelViewMatrix*vec4(transformedPosition,1.0);zPos=newPos.z;yPos=map(aPos.y,-uRadius,uRadius,0.0,1.0);yPos=smoothstep(0.05,0.99,yPos);gl_Position=vec4(newPos.x,newPos.y+(uYPosMultiplier*yPosMultiplier),newPos.z,newPos.w);}`,dR=`#define GLSLIFY 1
#include <defaultFrag>
varying vec3 vNormal;varying vec2 vUv;varying float zPos;varying float yPos;varying float opacityMultiplier;uniform float uTime;uniform vec3 uBaseColor;void main(){float mySin=sin(uTime*opacityMultiplier);mySin=(mySin+1.4)/2.0;gl_FragColor=vec4(vec3(uBaseColor),yPos*mySin);}`;class pR extends fr{constructor(e={}){e=rg({uniforms:{uTime:E.WebGL.globalUniforms.uTime,uBaseColor:{value:new pt(16777215)},uRadius:{value:null},uYPosMultiplier:{value:-2.5}},defines:{}},e),super({vertexShader:hR,fragmentShader:dR,uniforms:e.uniforms,defines:e.defines,transparent:!0}),this.globalUniforms=e.globalUniforms,this.uniforms=Object.assign(this.uniforms,this.globalUniforms)}clone(e){const t=super.clone();return t.uniforms=Object.assign(t.uniforms,this.globalUniforms),t.uniforms=Object.assign(t.uniforms,e),t}}function fR(){Mt.defaultVert=pf(rR),Mt.defaultFrag=pf(oR),Mt.normalsVert=pf(aR)}class Va extends ts{constructor(e,t){super(),this.imageRangeOffset=e>0?e:"",this.indexOffset=t}build(){this.planes=[],this.progress=[],this.createPlanes()}createPlanes(){const e=Y.utils.wrap(0,10);for(let t=0;t<10;t++){let i=e(t+this.indexOffset);i=`${this.imageRangeOffset}`+i;const n=Y.utils.clamp(0,335,E.WebGL.scenes.vortex.assets.textures[`image${i}`].width),s=E.WebGL.scenes.vortex.assets.textures[`image${i}`].height/E.WebGL.scenes.vortex.assets.textures[`image${i}`].width,a=new uu(n*.005,n*s*.005),o=new uR({transparent:!0,uniforms:{uImage:{value:E.WebGL.scenes.vortex.assets.textures[`image${i}`]}}}),u=new Wi(a,o);this.planes[t]=u,u.visible=!1,this.add(u)}}}class mR extends ts{constructor(){if(super(),this.curve=new Eb([new Z(-7,1,-8),new Z(-6.8,.2,-7),new Z(-6.4,-.3,-6),new Z(-5.9,-.7,-5),new Z(-5.4,-1,-4),new Z(-4.8,-1.2,-3),new Z(-3.9,-1.3,-1.8),new Z(-2.8,-1,-1),new Z(-1.5,-.6,0),new Z(-1,-.4,0)],!1,"chordal",.5),this.points=this.curve.getPoints(9),this.debugVortexCurve=!1,this.debugVortexCurve){console.log("wpeoiwopi");const e=new pd(.05),t=new ar({color:16711680});for(const a of this.points){const o=new Wi(e,t);o.position.copy(a),this.add(o)}const i=new un().setFromPoints(this.points),n=new hu({color:16711680}),s=new du(i,n);this.add(s)}}}const B0={type:"change"},mf={type:"start"},V0={type:"end"};class gR extends ra{constructor(e,t){super(),this.object=e,this.domElement=t,this.domElement.style.touchAction="none",this.enabled=!0,this.target=new Z,this.minDistance=0,this.maxDistance=1/0,this.minZoom=0,this.maxZoom=1/0,this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.minAzimuthAngle=-1/0,this.maxAzimuthAngle=1/0,this.enableDamping=!1,this.dampingFactor=.05,this.enableZoom=!0,this.zoomSpeed=1,this.enableRotate=!0,this.rotateSpeed=1,this.enablePan=!0,this.panSpeed=1,this.screenSpacePanning=!0,this.keyPanSpeed=7,this.autoRotate=!1,this.autoRotateSpeed=2,this.keys={LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",BOTTOM:"ArrowDown"},this.mouseButtons={LEFT:xa.ROTATE,MIDDLE:xa.DOLLY,RIGHT:xa.PAN},this.touches={ONE:wa.ROTATE,TWO:wa.DOLLY_PAN},this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this._domElementKeyEvents=null,this.getPolarAngle=function(){return o.phi},this.getAzimuthalAngle=function(){return o.theta},this.getDistance=function(){return this.object.position.distanceTo(this.target)},this.listenToKeyEvents=function(H){H.addEventListener("keydown",wt),this._domElementKeyEvents=H},this.saveState=function(){i.target0.copy(i.target),i.position0.copy(i.object.position),i.zoom0=i.object.zoom},this.reset=function(){i.target.copy(i.target0),i.object.position.copy(i.position0),i.object.zoom=i.zoom0,i.object.updateProjectionMatrix(),i.dispatchEvent(B0),i.update(),s=n.NONE},this.update=function(){const H=new Z,ne=new vs().setFromUnitVectors(e.up,new Z(0,1,0)),Fe=ne.clone().invert(),Te=new Z,Re=new vs,He=2*Math.PI;return function(){const ut=i.object.position;H.copy(ut).sub(i.target),H.applyQuaternion(ne),o.setFromVector3(H),i.autoRotate&&s===n.NONE&&k(F()),i.enableDamping?(o.theta+=u.theta*i.dampingFactor,o.phi+=u.phi*i.dampingFactor):(o.theta+=u.theta,o.phi+=u.phi);let ht=i.minAzimuthAngle,Ct=i.maxAzimuthAngle;return isFinite(ht)&&isFinite(Ct)&&(ht<-Math.PI?ht+=He:ht>Math.PI&&(ht-=He),Ct<-Math.PI?Ct+=He:Ct>Math.PI&&(Ct-=He),ht<=Ct?o.theta=Math.max(ht,Math.min(Ct,o.theta)):o.theta=o.theta>(ht+Ct)/2?Math.max(ht,o.theta):Math.min(Ct,o.theta)),o.phi=Math.max(i.minPolarAngle,Math.min(i.maxPolarAngle,o.phi)),o.makeSafe(),o.radius*=h,o.radius=Math.max(i.minDistance,Math.min(i.maxDistance,o.radius)),i.enableDamping===!0?i.target.addScaledVector(f,i.dampingFactor):i.target.add(f),H.setFromSpherical(o),H.applyQuaternion(Fe),ut.copy(i.target).add(H),i.object.lookAt(i.target),i.enableDamping===!0?(u.theta*=1-i.dampingFactor,u.phi*=1-i.dampingFactor,f.multiplyScalar(1-i.dampingFactor)):(u.set(0,0,0),f.set(0,0,0)),h=1,c||Te.distanceToSquared(i.object.position)>a||8*(1-Re.dot(i.object.quaternion))>a?(i.dispatchEvent(B0),Te.copy(i.object.position),Re.copy(i.object.quaternion),c=!1,!0):!1}}(),this.dispose=function(){i.domElement.removeEventListener("contextmenu",fe),i.domElement.removeEventListener("pointerdown",ct),i.domElement.removeEventListener("pointercancel",he),i.domElement.removeEventListener("wheel",Ot),i.domElement.removeEventListener("pointermove",xt),i.domElement.removeEventListener("pointerup",mt),i._domElementKeyEvents!==null&&i._domElementKeyEvents.removeEventListener("keydown",wt)};const i=this,n={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_PAN:4,TOUCH_DOLLY_PAN:5,TOUCH_DOLLY_ROTATE:6};let s=n.NONE;const a=1e-6,o=new Lv,u=new Lv;let h=1;const f=new Z;let c=!1;const d=new Ue,m=new Ue,x=new Ue,_=new Ue,b=new Ue,y=new Ue,M=new Ue,D=new Ue,C=new Ue,P=[],I={};function F(){return 2*Math.PI/60/60*i.autoRotateSpeed}function A(){return Math.pow(.95,i.zoomSpeed)}function k(H){u.theta-=H}function O(H){u.phi-=H}const J=function(){const H=new Z;return function(Fe,Te){H.setFromMatrixColumn(Te,0),H.multiplyScalar(-Fe),f.add(H)}}(),Q=function(){const H=new Z;return function(Fe,Te){i.screenSpacePanning===!0?H.setFromMatrixColumn(Te,1):(H.setFromMatrixColumn(Te,0),H.crossVectors(i.object.up,H)),H.multiplyScalar(Fe),f.add(H)}}(),X=function(){const H=new Z;return function(Fe,Te){const Re=i.domElement;if(i.object.isPerspectiveCamera){const He=i.object.position;H.copy(He).sub(i.target);let ze=H.length();ze*=Math.tan(i.object.fov/2*Math.PI/180),J(2*Fe*ze/Re.clientHeight,i.object.matrix),Q(2*Te*ze/Re.clientHeight,i.object.matrix)}else i.object.isOrthographicCamera?(J(Fe*(i.object.right-i.object.left)/i.object.zoom/Re.clientWidth,i.object.matrix),Q(Te*(i.object.top-i.object.bottom)/i.object.zoom/Re.clientHeight,i.object.matrix)):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."),i.enablePan=!1)}}();function j(H){i.object.isPerspectiveCamera?h/=H:i.object.isOrthographicCamera?(i.object.zoom=Math.max(i.minZoom,Math.min(i.maxZoom,i.object.zoom*H)),i.object.updateProjectionMatrix(),c=!0):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),i.enableZoom=!1)}function K(H){i.object.isPerspectiveCamera?h*=H:i.object.isOrthographicCamera?(i.object.zoom=Math.max(i.minZoom,Math.min(i.maxZoom,i.object.zoom/H)),i.object.updateProjectionMatrix(),c=!0):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),i.enableZoom=!1)}function ie(H){d.set(H.clientX,H.clientY)}function ee(H){M.set(H.clientX,H.clientY)}function V(H){_.set(H.clientX,H.clientY)}function _e(H){m.set(H.clientX,H.clientY),x.subVectors(m,d).multiplyScalar(i.rotateSpeed);const ne=i.domElement;k(2*Math.PI*x.x/ne.clientHeight),O(2*Math.PI*x.y/ne.clientHeight),d.copy(m),i.update()}function U(H){D.set(H.clientX,H.clientY),C.subVectors(D,M),C.y>0?j(A()):C.y<0&&K(A()),M.copy(D),i.update()}function oe(H){b.set(H.clientX,H.clientY),y.subVectors(b,_).multiplyScalar(i.panSpeed),X(y.x,y.y),_.copy(b),i.update()}function ce(H){H.deltaY<0?K(A()):H.deltaY>0&&j(A()),i.update()}function me(H){let ne=!1;switch(H.code){case i.keys.UP:H.ctrlKey||H.metaKey||H.shiftKey?O(2*Math.PI*i.rotateSpeed/i.domElement.clientHeight):X(0,i.keyPanSpeed),ne=!0;break;case i.keys.BOTTOM:H.ctrlKey||H.metaKey||H.shiftKey?O(-2*Math.PI*i.rotateSpeed/i.domElement.clientHeight):X(0,-i.keyPanSpeed),ne=!0;break;case i.keys.LEFT:H.ctrlKey||H.metaKey||H.shiftKey?k(2*Math.PI*i.rotateSpeed/i.domElement.clientHeight):X(i.keyPanSpeed,0),ne=!0;break;case i.keys.RIGHT:H.ctrlKey||H.metaKey||H.shiftKey?k(-2*Math.PI*i.rotateSpeed/i.domElement.clientHeight):X(-i.keyPanSpeed,0),ne=!0;break}ne&&(H.preventDefault(),i.update())}function le(){if(P.length===1)d.set(P[0].pageX,P[0].pageY);else{const H=.5*(P[0].pageX+P[1].pageX),ne=.5*(P[0].pageY+P[1].pageY);d.set(H,ne)}}function be(){if(P.length===1)_.set(P[0].pageX,P[0].pageY);else{const H=.5*(P[0].pageX+P[1].pageX),ne=.5*(P[0].pageY+P[1].pageY);_.set(H,ne)}}function ue(){const H=P[0].pageX-P[1].pageX,ne=P[0].pageY-P[1].pageY,Fe=Math.sqrt(H*H+ne*ne);M.set(0,Fe)}function We(){i.enableZoom&&ue(),i.enablePan&&be()}function ye(){i.enableZoom&&ue(),i.enableRotate&&le()}function Ne(H){if(P.length==1)m.set(H.pageX,H.pageY);else{const Fe=je(H),Te=.5*(H.pageX+Fe.x),Re=.5*(H.pageY+Fe.y);m.set(Te,Re)}x.subVectors(m,d).multiplyScalar(i.rotateSpeed);const ne=i.domElement;k(2*Math.PI*x.x/ne.clientHeight),O(2*Math.PI*x.y/ne.clientHeight),d.copy(m)}function Ce(H){if(P.length===1)b.set(H.pageX,H.pageY);else{const ne=je(H),Fe=.5*(H.pageX+ne.x),Te=.5*(H.pageY+ne.y);b.set(Fe,Te)}y.subVectors(b,_).multiplyScalar(i.panSpeed),X(y.x,y.y),_.copy(b)}function Ze(H){const ne=je(H),Fe=H.pageX-ne.x,Te=H.pageY-ne.y,Re=Math.sqrt(Fe*Fe+Te*Te);D.set(0,Re),C.set(0,Math.pow(D.y/M.y,i.zoomSpeed)),j(C.y),M.copy(D)}function Qe(H){i.enableZoom&&Ze(H),i.enablePan&&Ce(H)}function Pe(H){i.enableZoom&&Ze(H),i.enableRotate&&Ne(H)}function ct(H){i.enabled!==!1&&(P.length===0&&(i.domElement.setPointerCapture(H.pointerId),i.domElement.addEventListener("pointermove",xt),i.domElement.addEventListener("pointerup",mt)),xe(H),H.pointerType==="touch"?G(H):Tt(H))}function xt(H){i.enabled!==!1&&(H.pointerType==="touch"?N(H):_t(H))}function mt(H){Me(H),P.length===0&&(i.domElement.releasePointerCapture(H.pointerId),i.domElement.removeEventListener("pointermove",xt),i.domElement.removeEventListener("pointerup",mt)),i.dispatchEvent(V0),s=n.NONE}function he(H){Me(H)}function Tt(H){let ne;switch(H.button){case 0:ne=i.mouseButtons.LEFT;break;case 1:ne=i.mouseButtons.MIDDLE;break;case 2:ne=i.mouseButtons.RIGHT;break;default:ne=-1}switch(ne){case xa.DOLLY:if(i.enableZoom===!1)return;ee(H),s=n.DOLLY;break;case xa.ROTATE:if(H.ctrlKey||H.metaKey||H.shiftKey){if(i.enablePan===!1)return;V(H),s=n.PAN}else{if(i.enableRotate===!1)return;ie(H),s=n.ROTATE}break;case xa.PAN:if(H.ctrlKey||H.metaKey||H.shiftKey){if(i.enableRotate===!1)return;ie(H),s=n.ROTATE}else{if(i.enablePan===!1)return;V(H),s=n.PAN}break;default:s=n.NONE}s!==n.NONE&&i.dispatchEvent(mf)}function _t(H){switch(s){case n.ROTATE:if(i.enableRotate===!1)return;_e(H);break;case n.DOLLY:if(i.enableZoom===!1)return;U(H);break;case n.PAN:if(i.enablePan===!1)return;oe(H);break}}function Ot(H){i.enabled===!1||i.enableZoom===!1||s!==n.NONE||(H.preventDefault(),i.dispatchEvent(mf),ce(H),i.dispatchEvent(V0))}function wt(H){i.enabled===!1||i.enablePan===!1||me(H)}function G(H){switch(Se(H),P.length){case 1:switch(i.touches.ONE){case wa.ROTATE:if(i.enableRotate===!1)return;le(),s=n.TOUCH_ROTATE;break;case wa.PAN:if(i.enablePan===!1)return;be(),s=n.TOUCH_PAN;break;default:s=n.NONE}break;case 2:switch(i.touches.TWO){case wa.DOLLY_PAN:if(i.enableZoom===!1&&i.enablePan===!1)return;We(),s=n.TOUCH_DOLLY_PAN;break;case wa.DOLLY_ROTATE:if(i.enableZoom===!1&&i.enableRotate===!1)return;ye(),s=n.TOUCH_DOLLY_ROTATE;break;default:s=n.NONE}break;default:s=n.NONE}s!==n.NONE&&i.dispatchEvent(mf)}function N(H){switch(Se(H),s){case n.TOUCH_ROTATE:if(i.enableRotate===!1)return;Ne(H),i.update();break;case n.TOUCH_PAN:if(i.enablePan===!1)return;Ce(H),i.update();break;case n.TOUCH_DOLLY_PAN:if(i.enableZoom===!1&&i.enablePan===!1)return;Qe(H),i.update();break;case n.TOUCH_DOLLY_ROTATE:if(i.enableZoom===!1&&i.enableRotate===!1)return;Pe(H),i.update();break;default:s=n.NONE}}function fe(H){i.enabled!==!1&&H.preventDefault()}function xe(H){P.push(H)}function Me(H){delete I[H.pointerId];for(let ne=0;ne<P.length;ne++)if(P[ne].pointerId==H.pointerId){P.splice(ne,1);return}}function Se(H){let ne=I[H.pointerId];ne===void 0&&(ne=new Ue,I[H.pointerId]=ne),ne.set(H.pageX,H.pageY)}function je(H){const ne=H.pointerId===P[0].pointerId?P[1]:P[0];return I[ne.pointerId]}i.domElement.addEventListener("contextmenu",fe),i.domElement.addEventListener("pointerdown",ct),i.domElement.addEventListener("pointercancel",he),i.domElement.addEventListener("wheel",Ot,{passive:!1}),this.update()}}class og extends $D{constructor(e,t={}){super(),this.options=Object.assign({controls:E.urlParams.has("controls"),cameraZOffset:10,mouseMoveAngle:new Ue(.1,.1),pointerNormalize1:.04,pointerNormalize2:.03,cameraZPos:10,cameraMultiplier:0}),this.cameraLookAt=new Z(0,0,0),this.smoothMouse=[new Ue,new Ue],this._quaternion=new vs,this._euler=new El,this.name=e||E.sceneName,this.camera=new Gi(45,E.window.w/E.window.h,.1,50),this.camera.position.z=10,this.add(this.camera),this.cameraHelper=new zP(this.camera),this.cameraHelper.visible=!1,this.add(this.cameraHelper),this.devCamera=new Gi(45,E.window.w/E.window.h,1,1e3),this.devCamera.position.z=10,this.devCamera.position.y=3,this.add(this.devCamera),this.controls=new gR(this.devCamera,E.WebGL.renderer.domElement),this.controls.target.set(0,0,0),this.controls.enabled=this.options.controls,this.controls.enableDamping=!0,this.breakpointTest()}updateCamera(){this.controls.enabled||E.isTouch||(this.camera.translateZ(-this.options.cameraZOffset),this._euler.set(this.smoothMouse[0].y*(this.options.mouseMoveAngle.y+this.options.cameraMultiplier),-this.smoothMouse[0].x*(this.options.mouseMoveAngle.x+this.options.cameraMultiplier),0),this._quaternion.setFromEuler(this._euler),this.camera.quaternion.multiply(this._quaternion),this._euler.set(0,0,(this.smoothMouse[0].x-this.smoothMouse[1].x)*-.05),this._quaternion.setFromEuler(this._euler),this.camera.quaternion.multiply(this._quaternion),this.camera.translateZ(this.options.cameraZOffset),this.camera.updateMatrixWorld())}breakpointTest(){}easeHelper(e){const t=e.getPoints(20),i=new un().setFromPoints(t),n=new hu({color:16711680}),s=new du(i,n);this.add(s)}}class _R extends og{constructor(){super();console.log("_R constructor called");q(this,"enableDarkMode",()=>{this.trails.forEach((t,i)=>{t.planes.forEach((n,s)=>{Y.to(n.material.uniforms.uModeProgress,{value:1,duration:.2})})})});q(this,"disableDarkMode",()=>{this.trails.forEach((t,i)=>{t.planes.forEach((n,s)=>{Y.to(n.material.uniforms.uModeProgress,{value:0,duration:.2})})})});q(this,"onPointerDown",()=>{this.mouseDown=!0,this.startPoint.x=E.pointer.x,this.startPoint.y=E.pointer.y,this.topHalf=-1,this.startPoint.y<E.window.h*.5&&(this.topHalf=1)});q(this,"onPointerUp",()=>{this.startPoint.x=0,this.startPoint.y=0,this.mouseDown=!1});q(this,"touchDrag",(t,i)=>{this.mouseArgs=i});q(this,"onRaf",()=>{if(!this.pausedRaf){if(this.controls.enabled&&this.controls.update(),this.camera.position.set(0,0,this.options.cameraZPos),this.camera.lookAt(this.cameraLookAt),this.smoothMouse[0].lerp(E.pointer.glNormalized,.02),this.smoothMouse[1].lerp(E.pointer.glNormalized,.02),this.mouseDown&&this.mouseArgs){this.x=E.pointer.x-this.startPoint.x,this.y=E.pointer.y-this.startPoint.y,this.prevTime=this.currentTime,this.currentTime=new Date().getTime(),this.deltaTime=this.currentTime-this.prevTime,this.distance=Math.sqrt(this.x*this.x+this.y*this.y);const t=this.distance*2/this.deltaTime*2;this.tweenParams.mouseSpeedMultiplier=Math.abs(this.distance)*t*1e-7,this.tweenParams.mouseSpeedMultiplier=Y.utils.clamp(0,.01,this.tweenParams.mouseSpeedMultiplier)}else this.tweenParams.mouseSpeedMultiplier=this.lerp(this.tweenParams.mouseSpeedMultiplier,0,.05),this.options.cameraMultiplier=this.lerp(this.options.cameraMultiplier,0,.05);this.options.cameraMultiplier+=this.tweenParams.mouseSpeedMultiplier*.09*E.WebGL.normalizeDelta,this.updateCamera();for(let t=0;t<10;t++){this.vortexPlaying&&this.progress[t]<.05&&(this.trails[0].planes[t].visible=!0,this.trails[1].planes[t].visible=!0,this.trails[2].planes[t].visible=!0,this.trails[3].planes[t].visible=!0,this.trails[4].planes[t].visible=!0,this.trails[5].planes[t].visible=!0),this.progress[t]+=.0018*E.WebGL.normalizeDelta,this.progress[t]+=this.tweenParams.speedMultiplier*E.WebGL.normalizeDelta,this.progress[t]+=this.tweenParams.mouseSpeedMultiplier*E.WebGL.normalizeDelta,this.loopVortex?this.progress[t]=this.progressWrap(this.progress[t]):this.progress[t]=Y.utils.clamp(0,1,this.progress[t]);const i=Math.pow(this.progress[t],1.7);this.curve.getPointAt(i,this.positions[t]),this.scaleEase.getPointAt(i,this.scaleProgress[t]),this.opacityEase.getPointAt(this.progress[t],this.opacityProgress[t]),this.rotationEase.getPointAt(this.progress[t],this.rotationProgress[t]),this.trails.forEach((n,s)=>{n.planes[t].material.uniforms.uTrailPosition.value=this.positions[t],n.planes[t].material.uniforms.uScale.value=this.scaleProgress[t].y,n.planes[t].material.uniforms.uTransparency.value=this.opacityProgress[t].y*this.tweenParams.opacityMultiplier,n.planes[t].material.uniforms.uRotation.value=this.rotationProgress[t].y+this.rotationOffsets[s]})}this.vortexGroup.scale.set(this.tweenParams.groupScale,this.tweenParams.groupScale,this.tweenParams.groupScale),this.options.controls?E.WebGL.renderer.render(this,this.devCamera):E.WebGL.renderer.render(this,this.camera)}});q(this,"onResize",()=>{this.camera.aspect=E.window.w/E.window.h,this.camera.updateProjectionMatrix(),this.devCamera.aspect=E.window.w/E.window.h,this.devCamera.updateProjectionMatrix()});this.origOptions={...this.options},this.mouseDown=!1,this.options.resposive={cameraPositions:{sm:7,md:8,lg:10}},this.startPoint={x:0,y:0},this.options.cameraZOffset=this.options.resposive.cameraPositions.sm,this.options.cameraZPos=this.options.resposive.cameraPositions.sm,this.trailCurve=new mR,this.curve=this.trailCurve.curve,this.createEasings(),this.positions=[],this.progress=[],this.positionProgress=[],this.scaleProgress=[],this.opacityProgress=[],this.rotationProgress=[],this.progressWrap=Y.utils.wrap(0,1),this.components={imageTrail1:new Va(0,0),imageTrail2:new Va(1,0),imageTrail3:new Va(0,4),imageTrail4:new Va(1,4),imageTrail5:new Va(0,7),imageTrail6:new Va(1,7)},this.pausedRaf=!1,this.loopVortex=!0,this.vortexPlaying=!1,this.load(),this.currentTime=new Date().getTime()}start(){this.pausedRaf=!1,this.loopVortex=!0,Y.timeline().set(E.WebGL.canvas.vortex,{autoAlpha:1}).to(E.WebGL.scenes.vortex.tweenParams,{speedMultiplier:0,opacityMultiplier:1,groupScale:1,duration:2,ease:"power1.inOut"},.05),this.addEvents()}stop(){Y.to(E.WebGL.canvas.vortex,{autoAlpha:0}),this.setupPositions(),this.removeEvents()}startVortex(){this.vortexPlaying=!0,this.buildIntro()}createEasings(){this.scaleEase=new Eb([new Z(0,1,0),new Z(.5,.95,0),new Z(.999999,.6,0),new Z(1,0,0)],!1,"catmullrom",.1),this.opacityEase=new aP(new Ue(0,0),new Ue(.01,.2),new Ue(.8,.99),new Ue(1,1)),this.rotationEase=new lP([new Ue(0,-.1),new Ue(1,.7)])}build(){for(const i in this.components)this.components[i].build(this.objectData),this.add(this.components[i]);this.setupPositions(),this.trails=[this.components.imageTrail1,this.components.imageTrail2,this.components.imageTrail3,this.components.imageTrail4,this.components.imageTrail5,this.components.imageTrail6],this.vortexGroup=new ts,this.add(this.vortexGroup);const t=[0,-60,-120,-180,-240,-300];this.rotationOffsets=[0,0,0,90,180,-90],this.trails.forEach((i,n)=>{i.rotation.z=No.degToRad(t[n]),this.vortexGroup.add(i)})}buildIntro(){return Y.timeline().to(this.tweenParams,{speedMultiplier:0,opacityMultiplier:1,groupScale:1,duration:2,ease:"power1.inOut"})}setupPositions(){this.tweenParams={speedMultiplier:.0018*15,opacityMultiplier:.3,groupScale:.7,mouseSpeedMultiplier:0},this.progress=[],this.positions=[],this.positionProgress=[],this.scaleProgress=[],this.opacityProgress=[],this.rotationProgress=[];for(let t=0;t<10;t++)this.progress.push(t*.1),this.positions.push(new Z),this.positionProgress.push(new Ue),this.scaleProgress.push(new Ue),this.opacityProgress.push(new Ue),this.rotationProgress.push(new Ue)}addEvents(){De.on(Je.RESIZE,this.onResize),De.on("DarkMode:enabled",this.enableDarkMode),De.on("DarkMode:disabled",this.disableDarkMode),E.RAFCollection.add(this.onRaf,1),this.startVortex(),De.on(Je.POINTERDOWN,this.onPointerDown),De.on(Je.POINTERUP,this.onPointerUp),De.on(Je.MOUSEDRAG,this.touchDrag)}startRaf(){E.RAFCollection.add(this.onRaf,1)}removeEvents(){De.off(Je.RESIZE,this.onResize),De.off("DarkMode:enabled",this.enableDarkMode),De.off("DarkMode:disabled",this.disableDarkMode),E.RAFCollection.remove(this.onRaf),this.vortexPlaying=!1,De.off(Je.POINTERDOWN,this.onPointerDown),De.off(Je.POINTERUP,this.onPointerUp),De.off(Je.MOUSEDRAG,this.touchDrag)}lerp(t,i,n){return(1-n)*t+n*i}stopRaf(){E.RAFCollection.remove(this.onRaf)}load(){console.log("_R.load called");this.assets={textures:{},models:{}};for(let t=0;t<20;t++)E.AssetLoader.loadTexture(window.globalData.vortexImages[t%window.globalData.vortexImages.length]).then(i=>{this.assets.textures[`image${t}`]=i,this.assets.textures[`image${t}`].width=i.image.width,this.assets.textures[`image${t}`].height=i.image.height})}destroy(){this.stop();for(const t in this.components)this.components[t].destroy&&this.components[t].destroy();Object.assign(this.options,this.origOptions)}}class Wt{constructor(e){q(this,"stCollection",[]);q(this,"el",null);q(this,"dom",{});q(this,"_eventStack",[]);this.el=e}populateDom(){this.dom={};const e=`${this.constructor.selector.replace(/[.#]/g,"")}`,t=ad(`[class^="${e}:"], [class*=" ${e}:"]`,this.el);if(t.length)for(let i=0;i<t.length;i++){const n=t[i].classList.value.match(new RegExp(`${e}[:-]([^ ]+)`));if(n){if(this.dom[n[1]]||(this.dom[n[1]]=t[i]),!this.dom[n[1]+"Array"]){this.dom[n[1]+"Array"]=[t[i]];continue}this.dom[n[1]+"Array"].push(t[i])}}}on(e,t,i,n){De.on(e,t,i,n),this._eventStack.push({event:e,el:t,callback:i,options:n})}delegate(e,t,i){De.delegate(e,t,i),this._eventStack.push({event:e,el:t,callback:i,options:void 0})}off(e,t,i,n){De.off(e,t,i,n)}emit(e,...t){De.emit(e,...t)}destroy(){for(let e=0;e<this._eventStack.length;e++){const{event:t,el:i,callback:n,options:s}=this._eventStack[e];this.off(t,i,n,s)}this._eventStack=[],this.stCollection.length>0&&(this.stCollection.forEach(e=>e.kill()),this.stCollection=[])}}q(Wt,"selector",null),q(Wt,"isSingleton",!1);class xw extends Wt{constructor(t){super(t);q(this,"toggle",()=>{this.isOpen()?this.close():this.open()});const i=this.el.getAttribute("aria-controls");if(this.target=st(`#${i}`),this.openProp=Po(this.el,"aria-expanded")||"false",this.target===null)throw new Error(`The Toggle element must have a valid aria-controls attribute and a matching target element within the DOM. "#${i}" could not be found.`);Po(this.el,"aria-expanded")===null&&Po(this.el,"aria-expanded","false"),this.on("click",this.el,this.toggle)}open(){return new Promise(t=>{this.onOpen(t)}).then(()=>{this.openProp="true",Po(this.el,"aria-expanded","true")})}onOpen(t){this.target.style.display="block",t()}close(){return new Promise(t=>{this.onClose(t)}).then(()=>{this.openProp="false",Po(this.el,"aria-expanded","false")})}onClose(t){this.target.style.display="none",t()}isOpen(){return this.openProp==="true"}}q(xw,"selector",".js-toggle");class ww extends Wt{constructor(t){super(t);q(this,"hostname",null);q(this,"includeSubDomains",!1);q(this,"acceptBtn",null);q(this,"onAccept",()=>{this.setCookie("true"),this.enableAnalytics(),this.updateStore(),this.hide()});q(this,"onReject",()=>{this.setCookie("false"),this.updateStore(),this.hide()});this.hostname===null&&(this.hostname=window.location.hostname),this.acceptBtn=st(".js-cookie-notice-accept",this.el),this.updateStore(),document.cookie.match(/cookie_notice_accepted/)?this.hide():(this.on("click",this.acceptBtn,this.onAccept),this.show())}hide(){this.el.classList.remove("is-open"),this.el.style.display="none"}show(){this.el.classList.add("is-open"),this.el.classList.remove("d-none")}setCookie(t){const i=new Date;i.setMonth(i.getMonth()+1);let n=`cookie_notice_accepted=${t};expires=${i.toUTCString()};path=/`;this.includeSubDomains===!0&&(n+=`;domain=${this.hostname}`),document.cookie=n}enableAnalytics(){window.gtag&&window.gtag("consent","default",{ad_storage:"granted",analytics_storage:"granted"})}updateStore(){E.cookieNoticeAccepted=document.cookie.split(";").some(t=>t.includes("cookie_notice_accepted=true")),E.cookieNoticeAccepted===!0&&this.emit("cookienotice:accepted")}}q(ww,"selector",".js-cookie-notice");class yw extends Wt{constructor(t,i={}){super(t);q(this,"last",{x:0,y:0});q(this,"follow",()=>{const t=E.pointer.x-this.last.x-this.xOffset,i=E.pointer.y-this.last.y-this.yOffset;(Math.abs(t)>=.05||Math.abs(i)>=.05)&&(this.last.x+=t*this.ease,this.last.y+=i*this.ease,this.el.style.transform=`translate(${this.last.x}px, ${this.last.y}px)`)});q(this,"onMouseEnter",t=>{this[t.currentTarget.dataset.cursor](t)});q(this,"onMouseleave",t=>{this.default(t)});!(E.mq.touch.matches&&!i.enableOnTouch)&&(this.ease=i.ease||.05,this.updateOffset(...i.offset||[0,0]),this.populateDom(),this.on(Je.RAF,this.follow),this.delegate("mouseenter","[data-cursor]",this.onMouseEnter),this.delegate("mouseleave","[data-cursor]",this.onMouseleave))}updateOffset(t,i){this.rect=this.el.getBoundingClientRect(),this.xOffset=this.rect.width*t,this.yOffset=this.rect.width*i}default(){}}q(yw,"selector",".js-custom-cursor");class na extends Wt{constructor(t){super(t);q(this,"onResize",()=>{this.ctx.revert(),this.ctx.kill(),this.ctx=Y.context(()=>{this.setup(),this.buildTimeline(),this.tl.pause().seek(1.5).play()})});this.populateDom(),this.container=this.el.closest(".js-dynamic-text-container"),this.ctx=Y.context(()=>{this.setup(),this.buildTimeline()})}setup(){this.widths=[],this.dom.textArray.forEach((t,i)=>{this.widths.push(t.getBoundingClientRect().width),i>0&&Y.set(t,{opacity:0,position:"absolute",top:0,left:0})}),this.progressWrap=Y.utils.wrap(0,this.dom.textArray.length),this.dom.border.style.width=this.widths[0]+"px",this.current=0,this.next=1}buildTimeline(){this.tl=Y.timeline({repeat:-1});for(let t=0;t<this.dom.textArray.length;t++){const i=this.widths[this.current]-this.widths[this.next];this.tl.to(this.dom.border,{width:"-="+i,duration:.5,ease:"expo.inOut"},(t+1)*1.5),this.container&&this.tl.set(this.container,{x:0},0),this.tl.to(this.dom.textArray[this.current],{opacity:0,duration:.5,ease:"expo.out"},(t+1)*1.5).to(this.dom.textArray[this.next],{opacity:1,overwrite:"auto",duration:.5,ease:"expo.in"},(t+1)*1.5),this.container&&this.tl.to(this.container,{x:"+="+i*.5,duration:.5,ease:"expo.inOut"},(t+1)*1.5),this.current++,this.current=this.progressWrap(this.current),this.next++,this.next=this.progressWrap(this.next)}this.tl.pause(),this.tl.seek(1.5)}destroy(){this.ctx.kill(),super.destroy()}}q(na,"selector",".js-dynamic-text");class ag extends Wt{constructor(t){super(t);q(this,"waitlistLoading",()=>{Y.to(this.dom.waitlistLoading,{rotate:360,duration:1,repeat:-1,ease:"linear"},0),this.waitlistLoadingTL=Y.timeline({defaults:{duration:.3}}).to(this.dom.submitText,{opacity:0}).to(this.dom.waitlistLoadingContainer,{opacity:1},.2)});q(this,"returnToPreviousState",()=>{Y.timeline({defaults:{duration:.3}}).to(this.dom.submitText,{opacity:1},.2).to(this.dom.secondaryLoading,{opacity:0},0).set(this.dom.waitlistLoading,{rotate:0,overwrite:"auto"})});q(this,"returnToPreviousStateSecondary",()=>{this.dom.secondaryInputEl.classList.remove("hide-placeholder"),Y.timeline({defaults:{duration:.3}}).to(this.dom.answerSubmitText,{opacity:1},.2).to(this.dom.secondaryLoading,{opacity:0},0).to(this.dom.secondarySubmit,{opacity:1,overwrite:"auto"}).to(this.dom.closeSecondaryForm,{autoAlpha:1},0).set(this.dom.secondaryLoading,{rotate:0,overwrite:"auto"})});q(this,"formSubmissionSuccess",()=>{this.flowStarted=!0,this.waitlistSubmitted=!0,Y.timeline({defaults:{ease:"expo.inOut",duration:.6}}).call(()=>{this.dom.inputEl.classList.add("hide-placeholder"),this.dom.confirmationText.classList.remove("d-none")},0).to([this.dom.confirmationText,this.dom.inputBorder],{opacity:1,duration:.5,pointerEvents:"none"},0).to([this.dom.tickMask,this.dom.tickSvg],{xPercent:0,duration:1},0).to(this.dom.submit,{width:"2.8125rem",padding:0,duration:1,pointerEvents:"none"},0).to([this.dom.waitlistLoadingContainer],{opacity:0,duration:.2},0).set(this.dom.waitlistLoading,{rotate:0,overwrite:"auto"},.2).call(()=>{this.showSecondaryForm(),this.dom.secondaryInputEl.focus()},null,2).set(this.dom.secondaryForm,{pointerEvents:"auto"},2)});q(this,"showSecondaryForm",()=>{this.dom.submit.classList.add("footer-form-submitted"),this.dom.submit.classList.add("hide-glow"),this.dom.tickSvg.classList.add("footer-form-submitted"),Y.timeline({defaults:{ease:"expo.in",duration:.8}}).to(this.dom.inputContainer,{width:0,duration:.4,ease:"linear",transformOrigin:"0 50%"},0).to([this.dom.inputEl,this.dom.confirmationText,this.dom.inputBorder],{opacity:0,duration:.4,ease:"linear"},0).to(this.dom.secondaryForm,{opacity:1,yPercent:0,duration:1.2,ease:"customIn",overwrite:"auto"},.1).set(this.dom.inputEl,{pointerEvents:"none"}).set(this.dom.waitlistError,{yPercent:470,xPercent:-50,opacity:0,pointerEvents:"none"})});q(this,"secondaryWaiting",()=>{Y.to(this.dom.secondaryLoading,{rotate:360,duration:1,repeat:-1,ease:"linear"}),this.secondaryWaitingTL=Y.timeline({defaults:{duration:.3},onStart:()=>{this.dom.secondaryInputEl.blur(),this.dom.secondaryInputEl.classList.add("hide-placeholder")}}).to(this.dom.secondarySubmit,{opacity:0}).to(this.dom.closeSecondaryForm,{autoAlpha:0},0).to(this.dom.secondaryLoading,{opacity:1},.2)});q(this,"secondaryComplete",()=>{Y.timeline({defaults:{ease:"expo.inOut",duration:.6}}).set(this.dom.answerSubmitText,{opacity:0}).to(this.dom.secondaryLoading,{opacity:0,duration:.2},0).set(this.dom.secondaryLoading,{rotate:0,overwrite:"auto"},.2).to([this.dom.secondaryTickMask,this.dom.secondaryTickSvg],{xPercent:0,duration:1},.1).then(()=>{this.resetForm()})});q(this,"resetForm",()=>{Y.timeline({defaults:{duration:.6,ease:"power2.inOut"}}).to(this.dom.secondaryForm,{autoAlpha:0,yPercent:20},0).set(this.dom.secondaryForm,{pointerEvents:"none"}).to(this.dom.inputContainer,{width:"auto",duration:.4,ease:"linear",transformOrigin:"0 50%"},0).to([this.dom.inputEl,this.dom.confirmationText,this.dom.inputBorder],{opacity:1,duration:.4,ease:"linear"},0).call(()=>{this.dom.submit.classList.remove("footer-form-submitted"),this.dom.tickSvg.classList.remove("footer-form-submitted")},null,.3)});q(this,"hideText",()=>{this.waitlistSubmitted&&Y.to([this.dom.confirmationText,this.dom.inputBorder],{opacity:0,duration:.3})});q(this,"showText",()=>{this.waitlistSubmitted&&Y.to([this.dom.confirmationText,this.dom.inputBorder],{opacity:1,duration:.3})});q(this,"onInputChange",()=>{this.dom.secondaryInputEl.value.length>16?Y.to(this.dom.answerSubmitText,{opacity:0,duration:.26}):Y.to(this.dom.answerSubmitText,{opacity:1,duration:.26})});this.populateDom(),this.on("click",this.dom.closeSecondaryForm,this.resetForm),this.on("FooterForm:HideText",this.hideText),this.on("FooterForm:ShowText",this.showText),this.on("input",this.dom.secondaryInputEl,this.onInputChange),this.waitlistSubmitted=!1,this.setInitialPositions()}setInitialPositions(){Y.timeline().set([this.dom.tickContainer,this.dom.secondaryTickContainer],{pointerEvents:"none"}).set([this.dom.tickMask,this.dom.secondaryTickMask],{xPercent:-103}).set([this.dom.tickSvg,this.dom.secondaryTickSvg],{xPercent:103}).set(this.dom.secondaryForm,{pointerEvents:"none",opacity:0,yPercent:20}).set([this.dom.waitlistLoadingContainer,this.dom.secondaryLoading,this.dom.confirmationText],{opacity:0}).set(this.dom.waitlistError,{yPercent:-20,xPercent:-50,opacity:0,pointerEvents:"none"})}showError(){Y.to(this.dom.waitlistError,{yPercent:"+=20",opacity:1,overwrite:"auto",xPercent:-50})}hideError(){Y.to(this.dom.waitlistError,{yPercent:"+=-20",opacity:0,overwrite:"auto",xPercent:-50})}destroy(){super.destroy()}}q(ag,"selector",".js-cta-footer");class lg extends Wt{constructor(t){super(t);q(this,"GRADIENT_OPACITY",.7);q(this,"GLOW_OPACITY",.8);q(this,"GLOW_OPACITY_HOVER",1);q(this,"onMouseEnter",()=>{this.isHovering=!0,this.bounding=this.el.getBoundingClientRect(),Y.to(this.gradient,{opacity:this.GRADIENT_OPACITY,duration:.1}),Y.to(this.glowPanels,{filter:"blur(20px)",opacity:this.GLOW_OPACITY_HOVER,duration:.3}),this.on("mousemove",this.el,this.onMouseMove)});q(this,"onMouseMove",t=>{if(!this.isHovering)return;const i=t.x-Math.floor(this.bounding.left),n=t.y-Math.floor(this.bounding.top),s=i/Math.floor(this.bounding.width)*2-1,a=n/Math.floor(this.bounding.height)*2-1;this.glowXTo(20*s),this.glowYTo(7*a),this.leftTo(i),this.topTo(t.y-this.bounding.top),this.rotateTo(i/this.el.offsetWidth*270)});q(this,"onMouseLeave",()=>{this.isHovering=!1,this.off("mousemove",this.el,this.onMouseMove),Y.to(this.glowPanels,{filter:"blur(15px)",opacity:this.GLOW_OPACITY,duration:.3}),this.glowXTo(0),this.glowYTo(0),Y.to(this.gradient,{opacity:0,duration:.1})});!(this.el.classList.contains("has-overlay")||E.mq.touch.matches)&&(this.createOverlay(),this.el.classList.add("relative","overflow-hidden","has-overlay"),this.el.classList.remove("overflow-hidden"),this.leftTo=Y.quickTo(this.gradient,"left",{duration:.1,ease:"linear"}),this.topTo=Y.quickTo(this.gradient,"top",{duration:.1,ease:"linear"}),this.rotateTo=Y.quickTo(this.gradient,"rotation",{duration:.1,ease:"linear"}),this.glowPanel1=this.createGlowPanel({left:4},1),this.glowPanel2=this.createGlowPanel({right:4},2),this.glowPanels=[this.glowPanel1,this.glowPanel2],this.glowXTo=Y.quickTo(this.glowPanels,"x",{duration:.3,ease:"linear"}),this.glowYTo=Y.quickTo(this.glowPanels,"y",{duration:.3,ease:"linear"}),this.addEvents())}createOverlay(){Y.set(this.el,{position:"relative"}),this.overlay=document.createElement("div"),this.gradient=document.createElement("div"),this.overlay.classList.add("button__overlay","absolute","fill","overflow-hidden","rounded-15"),this.gradient.classList.add("button__overlay__inner","absolute"),this.overlay.appendChild(this.gradient),this.el.appendChild(this.overlay)}createGlowPanel(t,i){const n=document.createElement("div"),s=document.createElement("div");return n.classList.add("button__glow"),s.classList.add("button__glow__panel",`button__glow__panel--${i}`),Y.set(n,t),n.appendChild(s),this.el.appendChild(n),s}hideGlowPanels(){Y.to(this.glowPanels,{opacity:0})}showGlowPanels(){Y.to(this.glowPanels,{opacity:this.GLOW_OPACITY})}addEvents(){this.on("mouseenter",this.el,this.onMouseEnter),this.on("mouseleave",this.el,this.onMouseLeave)}}q(lg,"selector","button.dark\\:bg-off-white");class cg extends Wt{constructor(t){super(t);q(this,"createDummyST",()=>{var t;(t=this.st)==null||t.kill(),E.body.classList.contains("home")||E.body.classList.contains("page-template-manifesto")?(this.dummy.style.height="0px",this.st=ft.create({trigger:this.dummy,start:"top bottom+=1px",end:"top bottom",onEnter:()=>{E.scrollToActive||(E.scrollToActive=!0,requestAnimationFrame(()=>{var i;(i=E.SmoothScroll)==null||i.lock(),E.SmoothScroll.scrollbar.hide(),E.mq.touch.matches&&(st(".scroll-container").style.overscrollBehavior="auto"),clearTimeout(this.scrollTimeout),this.scrollTimeout=setTimeout(()=>{var n;(n=E.SmoothScroll)==null||n.unlock(),this.dummy.style.height=this.dummyHeight,E.scrollToActive=!1,E.mq.md.matches&&this.createParallax()},200)},0))},onLeave:()=>{this.el.style.opacity="1"},onEnterBack:()=>{clearTimeout(this.scrollTimeout),this.el.style.opacity="0",this.revertParallaxes()},onLeaveBack:()=>{clearTimeout(this.scrollTimeout),this.dummy.style.height="0px",this.revertParallaxes(),E.mq.touch.matches&&(st(".scroll-container").style.overscrollBehavior="none")}})):this.st=ft.create({trigger:this.dummy,start:"top bottom+=2%",end:"bottom bottom",onEnter:()=>{this.el.style.opacity="1"},onLeaveBack:()=>{this.el.style.opacity="0"}})});q(this,"createParallax",()=>{this.parallaxTweens.push(Y.from(this.dom.inner,{yPercent:115,ease:"power2.in",scrollTrigger:{trigger:this.dummy,start:"top bottom+=20%",end:"bottom bottom",scrub:!0}})),this.parallaxTweens.push(Y.from(this.dom.logo,{yPercent:60,ease:"power2.in",scrollTrigger:{trigger:this.dummy,start:"top bottom+=20%",end:"bottom bottom",scrub:!0}}))});q(this,"revertParallaxes",()=>{this.parallaxTweens.forEach(t=>{t.revert()})});q(this,"onResize",()=>{this.dummyHeight=this.el.getBoundingClientRect().height+"px",!E.body.classList.contains("home")&&!E.body.classList.contains("page-template-manifesto")&&(this.dummy.style.height=this.el.getBoundingClientRect().height+"px"),this.revertParallaxes(),this.createDummyST(),E.mq.md.matches&&!E.body.classList.contains("home")&&!E.body.classList.contains("page-template-manifesto")&&this.createParallax()});this.populateDom(),this.el.style.opacity="0",this.parallaxTweens=[],this.dummyHeight=0,this.dummy=st(".js-dummmy-footer",E.body),this.on(Je.RESIZE,this.onResize),this.onResize(),this.createDummyST(),E.mq.touch.matches&&(st(".scroll-container").style.overscrollBehavior="none")}destroy(){var t;super.destroy(),(t=this.st)==null||t.kill(),this.parallaxTweens.forEach(i=>{i.kill()})}}q(cg,"selector",".js-footer");class Al extends cm{initialLoad(){this.isInitialLoad=!0,E.WebGL.scenes.vortex=new _R,this.pageTransition=st(".js-page-transition"),Y.set(this.pageTransition,{autoAlpha:0}),this.onEnter(),E.AssetLoader.loaded.then(()=>{E.urlParams.has("nowebgl")||E.WebGL.scenes.vortex.build(),this.onEnterCompleted()})}onEnter(){var e;E.SmoothScroll.Lenis.scrollTo(0,{immediate:!0,force:!0}),this.registerAdditionalWebgl(),this.registerAdditionalComponents(),(e=E.ScrollAnimations)==null||e.build(this.content),E.AssetLoader.load({element:this.content}).then(()=>{E.components.add(na,ag,lg,cg),this.CTAfooter=st(".js-cta-footer"),this.CTAfooter&&(this.footerForm=E.FormsManager.make(this.CTAfooter,!1)),E.urlParams.has("gui")&&O2(()=>Promise.resolve().then(()=>sR),void 0).then(({GUI:t})=>{E.Gui=new bw})})}onEnterCompleted(){var e,t;this.pageTransition=st(".js-page-transition"),Y.to(this.pageTransition,{autoAlpha:0,duration:1,onComplete:()=>{this.isInitialLoad||(this.isInitialLoad=!1,document.body.classList.remove("loader-active"))}}),(e=E.ScrollAnimations)==null||e.enable(),E.urlParams.has("nowebgl")||E.WebGL.start(),this.scrollToAnchor(),(t=E.SmoothScroll)==null||t.unlock()}onLeave(){var e,t;(e=E.ScrollAnimations)==null||e.destroy(),(t=E.SmoothScroll)==null||t.lock(),Y.set(".js-scroll-prompt",{clearProps:"all"}),E.urlParams.has("nowebgl")||E.WebGL.stop()}onLeaveCompleted(){for(const e of E.components)e.destroy()}registerAdditionalWebgl(){}registerAdditionalComponents(){}scrollToAnchor(){if(window.location.hash){const e=document.querySelector(window.location.hash);e&&pl.scrollTo(e,{force:!0})}}}class vR extends lm{constructor({wrapper:e}){super({wrapper:e}),this.pageTransition=st(".js-page-transition")}onLeave({from:e,trigger:t,done:i}){document.body.classList.add("loader-active"),Y.to(this.pageTransition,{autoAlpha:1}).then(()=>i())}onEnter({to:e,trigger:t,done:i}){E.AssetLoader.loaded.then(()=>{i()})}}const bR={mainGrid:{gridIntro:{trigger:".js-home-landing",start:"top top-=5%"},transformGrid:{trigger:".js-home-landing",start:"bottom center",endTrigger:".js-main-grid-st",end:{default:"bottom center",sm:"bottom center",md:"bottom top"}},textTransition:{trigger:".js-home-landing",start:"bottom center",endTrigger:".js-main-grid-st",end:{default:"bottom top+=25%",sm:"bottom top",md:"bottom top"}},extensionMenu:{trigger:".js-main-grid-st",start:{default:"bottom center",sm:"bottom center",md:"bottom top"},endTrigger:".js-main-grid",end:{default:"bottom bottom",sm:"bottom bottom",md:"bottom center"}},loop:{trigger:{default:".js-main-grid",sm:".js-main-grid",md:".js-main-grid-st"},start:{default:"bottom bottom+=10%",sm:"bottom bottom+=10%",md:"bottom top-=5%"},endTrigger:".js-main-grid",end:"bottom center"}},appGrid:{scrubbedTransition:{trigger:".js-main-grid",start:{default:"bottom top+=75%",sm:"bottom bottom",md:"bottom center"},endTrigger:{default:".js-app-grid",sm:".js-app-grid",md:".js-app-grid"},end:{default:"top top",sm:"top top",md:"bottom bottom"}},sectionText:{trigger:".js-app-grid",start:{default:"bottom bottom+=180%",sm:"bottom bottom+=180%",md:"bottom bottom+=180%"},end:{default:"top top+=10%",sm:"top top+=10%",md:"bottom bottom-=20%"}},gridText:{trigger:".js-main-grid",start:{default:"bottom top+=75%",sm:"bottom bottom",md:"bottom center"},endTrigger:{default:".js-app-grid",sm:".js-app-grid",md:".js-app-grid"},end:{default:"top top+=60%",sm:"top top+=60%",md:"bottom bottom"}}},taggingSystem:{section:{trigger:".js-app-grid",start:"bottom bottom",endTrigger:".js-tagging-system",end:"top top"},video:{trigger:".js-tagging-system",start:{default:"top top+=35%",sm:"top top+=35%",md:"top top+=90%",tablet:"top top+=25%"}},switch:{trigger:".js-tagging-system",start:"top top"},text:{trigger:".js-tagging-system",start:{default:"top top+=150%",sm:"top top+=150%",md:"top top+=75%",tablet:"top top+=75%"},end:"top top+=15%"},tags:{trigger:".js-tagging-system",start:"bottom bottom",end:"bottom top+=10%"},hideTags:{trigger:".js-tagging-system",start:"top bottom",end:"top top+=60%"},out:{trigger:".js-tagging-system",start:"bottom bottom",end:"bottom top"}},searchSection:{scrubbed:{trigger:".js-search-section",endTrigger:".js-search-section",start:"top bottom",end:"top top"},queryText:{trigger:".js-search-section",start:"top bottom",end:"top top+=10%"},cluster:{trigger:".js-search-section",start:"top bottom",end:"top top"},sectionText:{trigger:".js-search-section",start:"top bottom",end:{default:"top top",sm:"top top-=20%",md:"top top-=20%"}}},particleGlobe:{scrubbed:{trigger:".js-search-section",endTrigger:".js-search-section",start:"bottom bottom",end:"bottom top"},section:{trigger:".js-globe-section",start:"top bottom"},text:{trigger:".js-globe-section",start:"top bottom",end:{default:"top top",sm:"top top-=30%",md:"top top-=30%"}},imageSlider:{trigger:".js-globe-section",start:"top bottom"},particleScrubbed:{trigger:".js-globe-section",start:"top bottom",end:"top top+=10%"}},appPreview:{text:{trigger:".js-app-preview",start:"top bottom",end:{default:"top top",sm:"top top-=20%",md:"top top-=20%"}}}},Xe={scrollTriggers:bR};let za="default";class gu extends Wt{constructor(t){super(t);q(this,"gridIntro",()=>{this.gridIntroTL=Y.timeline({defaults:{duration:.8,ease:"customIn"},onStart:()=>{var t;(t=E.SmoothScroll)==null||t.lock(),E.mq.sm.matches&&this.emit("ModeToggle:CollapseToggle")}}).call(()=>{E.WebGL.scenes.vortex.loopVortex=!1},null,0).to(".js-scroll-prompt",{opacity:0},0).to(E.WebGL.scenes.vortex.tweenParams,{speedMultiplier:1,duration:1.5,ease:"expo.in"},0).to(E.WebGL.scenes.vortex.tweenParams,{groupScale:0,duration:1,ease:"expo.in"},0).to(E.WebGL.scenes.vortex.tweenParams,{opacityMultiplier:0,duration:1.1,ease:"expo.in"},0).to(this.homeLandingInner,{scale:0,duration:1,force3D:!1},0).call(()=>{this.dynamicText.tl.pause(),this.dynamicText.tl.seek(1.5)},null,1).to(this.homeLanding,{autoAlpha:0,duration:.6},0).to([E.WebGL.canvas.vortex,".vortex-vignette"],{autoAlpha:0,duration:.3},.6).to(this.headerWordmark,{autoAlpha:1,duration:.2},.6).call(()=>{E.WebGL.scenes.vortex.pausedRaf=!0,E.WebGL.scenes.vortex.loopVortex=!0,E.WebGL.scenes.vortex.setupPositions()},null,1.4).to(this.dom.itemArray,{x:0,y:0,scale:1,opacity:1,ease:"power2.out",duration:.6,force3D:!1,onComplete:()=>{var t;(t=E.SmoothScroll)==null||t.unlock()}},.9).to(this.dom.title,{opacity:1,ease:"expo.out",duration:.95},.9).titleIn(this.dom.title,null,.2).transformUp(this.dom.subtitle,null,1).call(()=>{this.dynamicTextGrid.tl.play()})});q(this,"returnToVortex",()=>{this.returnToVortexTL=Y.timeline({onStart:()=>{var t;(t=E.SmoothScroll)==null||t.lock(),E.mq.sm.matches&&this.emit("ModeToggle:ExpandToggle")},onComplete:()=>{var t;(t=E.SmoothScroll)==null||t.unlock()}}).to(this.headerWordmark,{autoAlpha:0,duration:.2},0).to(this.dom.itemArray,{x:t=>this.positions[t][za][0]+"rem",y:t=>this.positions[t][za][1]+"rem",scale:.8,force3D:!1,ease:"expo.in",duration:1},0).to([this.dom.itemArray,this.dom.title,this.dom.subtitle],{opacity:0,ease:"expo.in",duration:1},0).to(this.homeLanding,{autoAlpha:1,duration:.6},1).to(this.homeLandingInner,{scale:1,duration:.6},1).call(()=>{this.dynamicTextGrid.tl.pause(),this.dynamicTextGrid.tl.seek(1.5),this.dynamicText.tl.play()},null,1.6).call(()=>{E.WebGL.scenes.vortex.pausedRaf=!1,E.WebGL.scenes.vortex.loopVortex=!0},null,1).to([E.WebGL.canvas.vortex,".vortex-vignette"],{autoAlpha:1,duration:.4},1.05).to(E.WebGL.scenes.vortex.tweenParams,{speedMultiplier:0,opacityMultiplier:1,groupScale:1,duration:2,ease:"power1.inOut"},1.05).to(".js-scroll-prompt",{opacity:1},.2)});q(this,"onResize",()=>{this.setInitialPositions(),this.buildST(),this.reset(),window.requestAnimationFrame(()=>{this.dynamicTextGrid.onResize(),this.dynamicText.onResize()})});q(this,"reset",()=>{E.WebGL.scenes.vortex.pausedRaf=!1,E.mq.sm.matches&&this.emit("ModeToggle:ExpandToggle"),Y.timeline().set(E.WebGL.canvas.vortex,{autoAlpha:1}).set(E.WebGL.scenes.vortex.tweenParams,{speedMultiplier:0,opacityMultiplier:1,groupScale:1}).set([this.dom.itemArray,this.dom.title,this.dom.subtitle],{opacity:0}).set(this.homeLanding,{autoAlpha:1}).set(this.homeLandingInner,{scale:1})});q(this,"onRaf",()=>{this.allowItemMovement&&(this.current.lerp(E.pointer.glNormalized,.1*E.WebGL.normalizeDelta),this.dom.itemInnerArray[0].style.transform=`translate(${this.current.x*45}px, ${-this.current.y*45}px)`,this.dom.itemInnerArray[1].style.transform=`translate(${this.current.x*60}px, ${-this.current.y*60}px)`,this.dom.itemInnerArray[2].style.transform=`translate(${this.current.x*55}px, ${-this.current.y*55}px)`,this.dom.itemInnerArray[3].style.transform=`translate(${this.current.x*45}px, ${-this.current.y*45}px)`,this.dom.itemInnerArray[4].style.transform=`translate(${this.current.x*60}px, ${-this.current.y*60}px)`,this.dom.itemInnerArray[5].style.transform=`translate(${this.current.x*30*this.tweenParams.amountMultiplier}px, ${-this.current.y*30*this.tweenParams.amountMultiplier}px)`,this.dom.itemInnerArray[6].style.transform=`translate(${this.current.x*50}px, ${-this.current.y*50}px)`,this.dom.itemInnerArray[7].style.transform=`translate(${this.current.x*60}px, ${-this.current.y*60}px)`,this.dom.itemInnerArray[8].style.transform=`translate(${this.current.x*60}px, ${-this.current.y*60}px)`)});this.populateDom(),this.buildST(),E.mainGridItems=this.dom.itemArray,this.homeLanding=st(".js-home-landing"),this.homeLandingInner=st(".js-home-landing > div"),this.headerWordmark=st(".js-header-wordmark"),Y.set(this.headerWordmark,{autoAlpha:0}),this.positions={0:{default:[4,6],sm:[10,10],md:[10,10]},1:{default:[7,-5],sm:[7,-5],md:[7,-5]},2:{default:[-1,5],sm:[4,12],md:[4,12]},3:{default:[4,-8],sm:[4,-8],md:[4,-8]},4:{default:[-2,-11],sm:[-2,-11],md:[-2,-11]},5:{default:[-4,-5],sm:[-4,-5],md:[-13,1]},6:{default:[-24,-16],sm:[-24,-16],md:[-24,-16]},7:{default:[-18,0],sm:[-18,0],md:[-18,0]},8:{default:[0,0],sm:[-4,8],md:[-4,8]}},this.current=new Ue(0,0),E.mq.md.matches&&(this.allowItemMovement=!0),this.tweenParams={amountMultiplier:1},E.isTouch||E.RAFCollection.add(this.onRaf,4),this.scrollPrompt=st(".js-scroll-prompt"),this.on("click",this.scrollPrompt,()=>pl.scrollTo(E.window.h*.06)),this.setInitialPositions(),E.mq.sm.matches&&(za="sm"),E.mq.md.matches&&(za="md"),this.dynamicText=E.components.get(na).get(0),this.dynamicTextGrid=E.components.get(na).get(1)}setInitialPositions(){Y.timeline().set(this.dom.itemArray,{x:t=>this.positions[t][za][0]+"rem",y:t=>this.positions[t][za][1]+"rem",scale:.8,force3D:!1}).set([this.dom.title,this.dom.subtitle],{opacity:0})}buildST(){this.st=ft.create({trigger:Xe.scrollTriggers.mainGrid.gridIntro.trigger,start:Xe.scrollTriggers.mainGrid.gridIntro.start,onEnter:this.gridIntro,onLeaveBack:this.returnToVortex}),this.dom.inner.classList.remove("d-none")}destroy(){super.destroy(),E.isTouch||E.RAFCollection.remove(this.onRaf,4),this.st.kill()}}q(gu,"selector",".js-main-grid");let Bi="default";class su extends Wt{constructor(t){super(t);q(this,"onResize",()=>{Bi="default",E.mq.sm.matches&&(Bi="sm"),E.mq.md.matches&&(Bi="md"),this.el.style.opacity="0",Y.set([this.highlightedImage,this.dom.cursor],{clearProps:"all"}),this.transformGridTL.kill(),this.textST.kill(),this.loopedTL.kill(),this.menuTL.kill(),this.loopST.kill(),this.highlightedImageBCR=this.highlightedImage.getBoundingClientRect(),this.imageXPos=this.highlightedImageBCR.left-E.window.w*.5+this.highlightedImageBCR.width*this.settings.imageScale[Bi]*.5,this.imageYPos=this.highlightedImageBCR.top-E.window.h*.5,this.imageXPos=E.mq.md.matches?0:this.imageXPos,clearTimeout(this.timeout),this.timeout=setTimeout(()=>{this.setInitialPositions(),this.buildTransformGridTL(),this.textTransitionTL(),this.extensionMenuTL(),this.buildLoopedTL(),this.el.style.opacity="1"},100)});E.mq.sm.matches&&(Bi="sm"),E.mq.md.matches&&(Bi="md"),this.populateDom(),this.highlightedImage=st(".js-extension-image"),this.imageTranslate=st(".js-image-translate",this.highlightedImg),this.highlightedImageBCR=this.highlightedImage.getBoundingClientRect(),this.settings={imageScale:{default:1.5,sm:1.3,md:1.1},imageYPos:{default:0,sm:"-2vh",md:"-10vh"},contentSpacing:{default:33,sm:49,md:0},xPosMultiplier:{default:.75,sm:.86},topPos:{default:"70vh",sm:"70vh",md:"50vh"},cursorYPos:{default:70,sm:70,md:50}},this.imageXPos=this.highlightedImageBCR.left-E.window.w*.5+this.highlightedImageBCR.width*this.settings.imageScale[Bi]*.5,this.imageYPos=this.highlightedImageBCR.top-E.window.h*.5,this.imageXPos=E.mq.md.matches?0:this.imageXPos,this.mainGrid=E.components.get(gu).first(),this.dynamicTextGrid=E.components.get(na).get(1),this.setInitialPositions(),this.buildTransformGridTL(),this.textTransitionTL(),this.extensionMenuTL(),this.buildLoopedTL(),this.on(Je.RESIZE,this.onResize)}setInitialPositions(){Y.timeline().set([this.dom.title,this.dom.iconArray],{opacity:0,y:0}).set(this.dom.content,{opacity:1}).set(this.dom.outer,{yPercent:-105}).set(this.dom.inner,{yPercent:105}).set(this.mainGrid.tweenParams,{amountMultiplier:1}).set(this.dom.cursor,{opacity:0})}buildTransformGridTL(){this.transformGridTL=Y.timeline({paused:!0,defaults:{ease:"linear",duration:1,force3D:!1},scrollTrigger:{trigger:Xe.scrollTriggers.mainGrid.transformGrid.trigger,endTrigger:Xe.scrollTriggers.mainGrid.transformGrid.endTrigger,start:Xe.scrollTriggers.mainGrid.transformGrid.start,end:Xe.scrollTriggers.mainGrid.transformGrid.end[Bi],scrub:!0,onEnterBack:()=>{var t;(t=this.dynamicTextGrid.tl)==null||t.play()},onLeave:()=>{var t,i;(t=this.dynamicTextGrid.tl)==null||t.pause(),(i=this.dynamicTextGrid.tl)==null||i.seek(1.5)}}}).set(this.highlightedImage,{y:0},0).to(this.mainGrid.dom.itemArray,{y:"-=10vh"},0),this.stCollection.push(this.transformGridTL)}textTransitionTL(){this.textST=Y.timeline({scrollTrigger:{trigger:Xe.scrollTriggers.mainGrid.textTransition.trigger,start:Xe.scrollTriggers.mainGrid.textTransition.start,endTrigger:Xe.scrollTriggers.mainGrid.textTransition.endTrigger,end:Xe.scrollTriggers.mainGrid.textTransition.end[Bi],scrub:!0},defaults:{force3D:!1}}).to(this.mainGrid.dom.content,{y:"-12rem",opacity:0,ease:"linear"}).titleIn(this.dom.title,null,0).to(this.dom.title,{opacity:1,overwrite:"true",ease:"linear"},0).to(this.dom.iconArray,{opacity:1,stagger:.03,overwrite:"true",duration:.07,ease:"linear"},.77),this.stCollection.push(this.textST)}extensionMenuTL(){this.menuTL=Y.timeline({scrollTrigger:{trigger:Xe.scrollTriggers.mainGrid.extensionMenu.trigger,start:Xe.scrollTriggers.mainGrid.extensionMenu.start[Bi],endTrigger:Xe.scrollTriggers.mainGrid.extensionMenu.endTrigger,end:Xe.scrollTriggers.mainGrid.extensionMenu.end[Bi],scrub:!0},defaults:{ease:"linear"}}).to(this.mainGrid.tweenParams,{amountMultiplier:0},0).to(this.mainGrid.dom.itemArray,{opacity:.2,duration:.6},0).to(this.highlightedImage,{opacity:1,overwrite:"auto"},0).to(this.highlightedImage,{scale:this.settings.imageScale[Bi],y:E.mq.md.matches?0:-this.imageYPos,transformOrigin:"0 0",force3D:!1,x:E.mq.md.matches?0:"-="+this.imageXPos},0).to(".js-image-overlay",{opacity:0},0),this.stCollection.push(this.transformGridTL)}buildLoopedTL(){const t={x:{default:400,sm:400,md:540},y:{default:455,sm:460,md:600}};this.loopedTL=Y.timeline({paused:!0,repeatDelay:.8,repeat:-1,defaults:{force3D:!1},onStart:()=>{},onComplete:()=>{}}).to([this.dom.cursor,this.dom.outer],{opacity:1,duration:.4},0).to(this.dom.cursorOuter,{scale:1.6,opacity:0,duration:.3,ease:"customOut"},.4).set(this.dom.cursorOuter,{scale:0,opacity:1},.8).to(this.dom.cursorOuter,{scale:1,duration:.3,ease:"expo.out"},.81).to([this.dom.outer,this.dom.inner],{yPercent:0,ease:"customIn",duration:1},.4).to(this.dom.cursor,{xPercent:t.x[Bi],yPercent:t.y[Bi],duration:1,ease:"customIn"},1).call(()=>{this.dom.text.classList.add("active")},null,1.8).to(this.dom.cursorOuter,{scale:1.6,opacity:0,duration:.3,ease:"customOut"},2).set(this.dom.cursorOuter,{scale:0,opacity:1},2.4).to(this.dom.cursorOuter,{scale:1,duration:.3,ease:"expo.out"},2.41).to(this.dom.cursor,{opacity:0,duration:.6},2.3).to(this.dom.outer,{yPercent:-105,duration:.6},2.3).to(this.dom.inner,{yPercent:105,duration:.6},2.3).set(this.dom.cursor,{xPercent:0,yPercent:0}).call(()=>{this.dom.text.classList.remove("active")},null,2.3),this.loopST=Y.timeline({scrollTrigger:{trigger:Xe.scrollTriggers.mainGrid.loop.trigger[Bi],start:Xe.scrollTriggers.mainGrid.loop.start[Bi],endTrigger:Xe.scrollTriggers.mainGrid.loop.endTrigger,end:Xe.scrollTriggers.mainGrid.loop.end,toggleActions:"play none none reverse",onEnter:()=>{this.loopedTL.play()},onLeave:()=>{},onLeaveBack:()=>{this.loopedTL.pause(),Y.to([this.dom.cursor,this.dom.outer],{opacity:0,duration:.2,onComplete:()=>{this.loopedTL.progress(0)}})},onEnterBack:()=>{this.loopedTL.play()}}}),this.stCollection.push(this.loopST)}}q(su,"selector",".js-extension");let gn="default";class _u extends Wt{constructor(t){super(t);q(this,"onResize",()=>{gn="default",E.mq.sm.matches&&(gn="sm"),E.mq.md.matches&&(gn="md"),Y.set(this.dom.grid,{y:0}),Y.set([this.dom.itemArray,this.dom.grid,this.dom.dummyImage,this.dom.canvasPlaceholder,this.dom.canvasInner],{clearProps:"all"}),this.calcPositions(),this.buildScrubbedTL(),this.buildTitleTextST(),this.animateGridText()});E.mq.sm.matches&&(gn="sm"),E.mq.md.matches&&(gn="md"),this.populateDom(),this.highlightedImg=st(".js-extension-image"),this.highlightedImgInner=st(".js-extension-image > div"),this.imageTranslate=st(".js-image-translate",this.highlightedImg),this.settings={imageScale:{default:1.5,sm:1.3,md:1.1},itemTranslateValues:[145,160,155,145,160,130,150,160,160],appGridItemStart:[5,10,10,20,20,30,30]},this.calcPositions(),this.extensionSection=E.components.get(su).first(),this.mainGrid=E.components.get(gu).first(),this.itemArray=[...this.mainGrid.dom.itemArray],this.itemArray.splice(this.mainGrid.dom.itemArray.indexOf(this.highlightedImg),1),this.buildScrubbedTL(),this.buildTitleTextST(),this.animateGridText(),E.mq.md.matches&&(Y.set(this.dom.itemArray,{y:i=>this.settings.appGridItemStart[i]+"vh"}),Y.set(this.dom.canvasInner,{y:i=>this.settings.appGridItemStart[6]+"vh"}))}calcPositions(){this.highlightedImgBCR=this.highlightedImg.getBoundingClientRect(),this.gridBCR=this.dom.grid.getBoundingClientRect(),this.dummyImgBCR=this.dom.dummyImage.getBoundingClientRect(),this.highlightedImg.width=this.highlightedImgBCR.width,this.highlightedImg.height=this.highlightedImgBCR.height,E.mq.md.matches?this.dom.dummyImage.style.opacity=0:this.dom.dummyImage.style.opacity=1,this.imgTop=this.dummyImgBCR.top-this.highlightedImgBCR.top,this.imgLeft=this.dummyImgBCR.left-this.highlightedImgBCR.left,this.scale=this.dom.dummyImage.getBoundingClientRect().width/(this.highlightedImgBCR.width*this.settings.imageScale[gn]),this.gridTranslate=E.window.h-this.gridBCR.top,E.mq.md.matches&&Y.set(this.dom.grid,{y:this.gridTranslate})}buildScrubbedTL(){this.menu=E.components.get(su).first(),this.forward=!1,this.scrubbedTL=Y.timeline({paused:!0,defaults:{ease:"linear",duration:1},scrollTrigger:{trigger:Xe.scrollTriggers.appGrid.scrubbedTransition.trigger,start:Xe.scrollTriggers.appGrid.scrubbedTransition.start[gn],endTrigger:Xe.scrollTriggers.appGrid.scrubbedTransition.endTrigger[gn],end:Xe.scrollTriggers.appGrid.scrubbedTransition.end[gn],scrub:!0},onStart:()=>{this.forward=!0},onComplete:()=>{this.forward=!1},onReverseComplete:()=>{this.forward=!1}}).to(this.highlightedImg,{x:E.mq.md.matches?this.imgLeft:"+=0",y:E.mq.md.matches?this.imgTop:"+=0",ease:E.mq.md.matches?"sine.inOut":"sine.out",force3D:!1},0).to(this.extensionSection.dom.translate,{x:E.mq.md.matches?this.imgLeft:"+=0",y:E.mq.md.matches?this.imgTop:"+=0",ease:E.mq.md.matches?"sine.inOut":"sine.out"},0).to(this.imageTranslate,{scale:E.mq.md.matches?this.scale:1,transformOrigin:"0% 0%",ease:"linear"},0).to(this.dom.grid,{y:0,force3D:!1},0),E.mq.md.matches&&this.scrubbedTL.to([this.extensionSection.dom.cursorOpacity,this.extensionSection.dom.inner],{opacity:0,duration:.2,onComplete:()=>{this.extensionSection.loopedTL.pause().progress(0),this.forward=!1}},.3),this.scrubbedTL.call(()=>{this.forward||this.extensionSection.loopedTL.play()},null,.49).to(this.itemArray,{y:t=>E.mq.md.matches?-this.settings.itemTranslateValues[t]+"vh":"+=0",autoAlpha:0,duration:E.mq.md.matches?.75:1,force3D:!1},0).to([this.dom.itemArray,this.dom.canvasInner],{y:0,force3D:!1,duration:1},0),E.mq.md.matches&&this.scrubbedTL.set(this.highlightedImg,{autoAlpha:0},1).set(this.dom.dummyImage,{autoAlpha:1},1),this.stCollection.push(this.scrubbedTL)}animateGridText(){this.gridTextTL=Y.timeline({scrollTrigger:{trigger:Xe.scrollTriggers.appGrid.gridText.trigger,start:Xe.scrollTriggers.appGrid.gridText.start[gn],endTrigger:Xe.scrollTriggers.appGrid.gridText.endTrigger[gn],end:Xe.scrollTriggers.appGrid.gridText.end[gn],scrub:!0},defaults:{ease:"linear",force3D:!1}}).to([this.extensionSection.dom.title,this.extensionSection.dom.iconArray],{y:E.mq.md.matches?"-200vh":"+=0",duration:1,ease:E.mq.md.matches?"linear":"sine.out"},0).to([this.extensionSection.dom.title,this.extensionSection.dom.iconArray],{opacity:0,duration:E.mq.md.matches?.2:1},0),E.mq.md.matches||this.gridTextTL.to([this.extensionSection.dom.cursorOpacity,this.extensionSection.dom.inner,this.highlightedImg],{opacity:0,duration:.8,onComplete:()=>{this.extensionSection.loopedTL.pause().progress(0),this.forward=!1}},0).to(".main-grid__item--4",{opacity:0,duration:.2,overwrite:"auto"},0),this.stCollection.push(this.gridTextTL)}buildTitleTextST(){this.titleTextST=Y.timeline({scrollTrigger:{trigger:Xe.scrollTriggers.appGrid.sectionText.trigger,start:Xe.scrollTriggers.appGrid.sectionText.start[gn],end:Xe.scrollTriggers.appGrid.sectionText.end[gn],scrub:!0}}).titleIn(this.dom.title,null,0).paragraphIn(this.dom.text,null,.1),this.stCollection.push(this.titleTextST)}destroy(){super.destroy()}}q(_u,"selector",".js-app-grid");/*!
 * paths 3.12.5
 * https://gsap.com
 *
 * Copyright 2008-2024, GreenSock. All rights reserved.
 * Subject to the terms at https://gsap.com/standard-license or for
 * Club GSAP members, the agreement issued with that membership.
 * @author: Jack Doyle, jack@greensock.com
*/var xR=/[achlmqstvz]|(-?\d*\.?\d*(?:e[\-+]?\d+)?)[0-9]/ig,wR=/[\+\-]?\d*\.?\d+e[\+\-]?\d+/ig,yR=Math.PI/180,Ph=Math.sin,Ah=Math.cos,Vc=Math.abs,fc=Math.sqrt,SR=function(e){return typeof e=="number"},z0=1e5,Or=function(e){return Math.round(e*z0)/z0||0};function MR(r,e,t,i,n,s,a){for(var o=r.length,u,h,f,c,d;--o>-1;)for(u=r[o],h=u.length,f=0;f<h;f+=2)c=u[f],d=u[f+1],u[f]=c*e+d*i+s,u[f+1]=c*t+d*n+a;return r._dirty=1,r}function TR(r,e,t,i,n,s,a,o,u){if(!(r===o&&e===u)){t=Vc(t),i=Vc(i);var h=n%360*yR,f=Ah(h),c=Ph(h),d=Math.PI,m=d*2,x=(r-o)/2,_=(e-u)/2,b=f*x+c*_,y=-c*x+f*_,M=b*b,D=y*y,C=M/(t*t)+D/(i*i);C>1&&(t=fc(C)*t,i=fc(C)*i);var P=t*t,I=i*i,F=(P*I-P*D-I*M)/(P*D+I*M);F<0&&(F=0);var A=(s===a?-1:1)*fc(F),k=A*(t*y/i),O=A*-(i*b/t),J=(r+o)/2,Q=(e+u)/2,X=J+(f*k-c*O),j=Q+(c*k+f*O),K=(b-k)/t,ie=(y-O)/i,ee=(-b-k)/t,V=(-y-O)/i,_e=K*K+ie*ie,U=(ie<0?-1:1)*Math.acos(K/fc(_e)),oe=(K*V-ie*ee<0?-1:1)*Math.acos((K*ee+ie*V)/fc(_e*(ee*ee+V*V)));isNaN(oe)&&(oe=d),!a&&oe>0?oe-=m:a&&oe<0&&(oe+=m),U%=m,oe%=m;var ce=Math.ceil(Vc(oe)/(m/4)),me=[],le=oe/ce,be=4/3*Ph(le/2)/(1+Ah(le/2)),ue=f*t,We=c*t,ye=c*-i,Ne=f*i,Ce;for(Ce=0;Ce<ce;Ce++)n=U+Ce*le,b=Ah(n),y=Ph(n),K=Ah(n+=le),ie=Ph(n),me.push(b-be*y,y+be*b,K+be*ie,ie-be*K,K,ie);for(Ce=0;Ce<me.length;Ce+=2)b=me[Ce],y=me[Ce+1],me[Ce]=b*ue+y*ye+X,me[Ce+1]=b*We+y*Ne+j;return me[Ce-2]=o,me[Ce-1]=u,me}}function ER(r){var e=(r+"").replace(wR,function(k){var O=+k;return O<1e-4&&O>-1e-4?0:O}).match(xR)||[],t=[],i=0,n=0,s=2/3,a=e.length,o=0,u="ERROR: malformed path: "+r,h,f,c,d,m,x,_,b,y,M,D,C,P,I,F,A=function(O,J,Q,X){M=(Q-O)/3,D=(X-J)/3,_.push(O+M,J+D,Q-M,X-D,Q,X)};if(!r||!isNaN(e[0])||isNaN(e[1]))return console.log(u),t;for(h=0;h<a;h++)if(P=m,isNaN(e[h])?(m=e[h].toUpperCase(),x=m!==e[h]):h--,c=+e[h+1],d=+e[h+2],x&&(c+=i,d+=n),h||(b=c,y=d),m==="M")_&&(_.length<8?t.length-=1:o+=_.length),i=b=c,n=y=d,_=[c,d],t.push(_),h+=2,m="L";else if(m==="C")_||(_=[0,0]),x||(i=n=0),_.push(c,d,i+e[h+3]*1,n+e[h+4]*1,i+=e[h+5]*1,n+=e[h+6]*1),h+=6;else if(m==="S")M=i,D=n,(P==="C"||P==="S")&&(M+=i-_[_.length-4],D+=n-_[_.length-3]),x||(i=n=0),_.push(M,D,c,d,i+=e[h+3]*1,n+=e[h+4]*1),h+=4;else if(m==="Q")M=i+(c-i)*s,D=n+(d-n)*s,x||(i=n=0),i+=e[h+3]*1,n+=e[h+4]*1,_.push(M,D,i+(c-i)*s,n+(d-n)*s,i,n),h+=4;else if(m==="T")M=i-_[_.length-4],D=n-_[_.length-3],_.push(i+M,n+D,c+(i+M*1.5-c)*s,d+(n+D*1.5-d)*s,i=c,n=d),h+=2;else if(m==="H")A(i,n,i=c,n),h+=1;else if(m==="V")A(i,n,i,n=c+(x?n-i:0)),h+=1;else if(m==="L"||m==="Z")m==="Z"&&(c=b,d=y,_.closed=!0),(m==="L"||Vc(i-c)>.5||Vc(n-d)>.5)&&(A(i,n,c,d),m==="L"&&(h+=2)),i=c,n=d;else if(m==="A"){if(I=e[h+4],F=e[h+5],M=e[h+6],D=e[h+7],f=7,I.length>1&&(I.length<3?(D=M,M=F,f--):(D=F,M=I.substr(2),f-=2),F=I.charAt(1),I=I.charAt(0)),C=TR(i,n,+e[h+1],+e[h+2],+e[h+3],+I,+F,(x?i:0)+M*1,(x?n:0)+D*1),h+=f,C)for(f=0;f<C.length;f++)_.push(C[f]);i=_[_.length-2],n=_[_.length-1]}else console.log(u);return h=_.length,h<6?(t.pop(),h=0):_[0]===_[h-2]&&_[1]===_[h-1]&&(_.closed=!0),t.totalPoints=o+h,t}function CR(r){SR(r[0])&&(r=[r]);var e="",t=r.length,i,n,s,a;for(n=0;n<t;n++){for(a=r[n],e+="M"+Or(a[0])+","+Or(a[1])+" C",i=a.length,s=2;s<i;s++)e+=Or(a[s++])+","+Or(a[s++])+" "+Or(a[s++])+","+Or(a[s++])+" "+Or(a[s++])+","+Or(a[s])+" ";a.closed&&(e+="z")}return e}/*!
 * CustomEase 3.12.5
 * https://gsap.com
 *
 * @license Copyright 2008-2024, GreenSock. All rights reserved.
 * Subject to the terms at https://gsap.com/standard-license or for
 * Club GSAP members, the agreement issued with that membership.
 * @author: Jack Doyle, jack@greensock.com
*/var vn,Sw,Mw=function(){return vn||typeof window<"u"&&(vn=window.gsap)&&vn.registerPlugin&&vn},U0=function(){vn=Mw(),vn?(vn.registerEase("_CE",Ds.create),Sw=1):console.warn("Please gsap.registerPlugin(CustomEase)")},DR=1e20,Lh=function(e){return~~(e*1e3+(e<0?-.5:.5))/1e3},PR=/[-+=.]*\d+[.e\-+]*\d*[e\-+]*\d*/gi,AR=/[cLlsSaAhHvVtTqQ]/g,LR=function(e){var t=e.length,i=DR,n;for(n=1;n<t;n+=6)+e[n]<i&&(i=+e[n]);return i},RR=function(e,t,i){!i&&i!==0&&(i=Math.max(+e[e.length-1],+e[1]));var n=+e[0]*-1,s=-i,a=e.length,o=1/(+e[a-2]+n),u=-t||(Math.abs(+e[a-1]-+e[1])<.01*(+e[a-2]-+e[0])?LR(e)+s:+e[a-1]+s),h;for(u?u=1/u:u=-o,h=0;h<a;h+=2)e[h]=(+e[h]+n)*o,e[h+1]=(+e[h+1]+s)*u},kR=function r(e,t,i,n,s,a,o,u,h,f,c){var d=(e+i)/2,m=(t+n)/2,x=(i+s)/2,_=(n+a)/2,b=(s+o)/2,y=(a+u)/2,M=(d+x)/2,D=(m+_)/2,C=(x+b)/2,P=(_+y)/2,I=(M+C)/2,F=(D+P)/2,A=o-e,k=u-t,O=Math.abs((i-o)*k-(n-u)*A),J=Math.abs((s-o)*k-(a-u)*A),Q;return f||(f=[{x:e,y:t},{x:o,y:u}],c=1),f.splice(c||f.length-1,0,{x:I,y:F}),(O+J)*(O+J)>h*(A*A+k*k)&&(Q=f.length,r(e,t,d,m,M,D,I,F,h,f,c),r(I,F,C,P,b,y,o,u,h,f,c+1+(f.length-Q))),f},Ds=function(){function r(t,i,n){Sw||U0(),this.id=t,this.setData(i,n)}var e=r.prototype;return e.setData=function(i,n){n=n||{},i=i||"0,0,1,1";var s=i.match(PR),a=1,o=[],u=[],h=n.precision||1,f=h<=1,c,d,m,x,_,b,y,M,D;if(this.data=i,(AR.test(i)||~i.indexOf("M")&&i.indexOf("C")<0)&&(s=ER(i)[0]),c=s.length,c===4)s.unshift(0,0),s.push(1,1),c=8;else if((c-2)%6)throw"Invalid CustomEase";for((+s[0]!=0||+s[c-2]!=1)&&RR(s,n.height,n.originY),this.segment=s,x=2;x<c;x+=6)d={x:+s[x-2],y:+s[x-1]},m={x:+s[x+4],y:+s[x+5]},o.push(d,m),kR(d.x,d.y,+s[x],+s[x+1],+s[x+2],+s[x+3],m.x,m.y,1/(h*2e5),o,o.length-1);for(c=o.length,x=0;x<c;x++)y=o[x],M=o[x-1]||y,(y.x>M.x||M.y!==y.y&&M.x===y.x||y===M)&&y.x<=1?(M.cx=y.x-M.x,M.cy=y.y-M.y,M.n=y,M.nx=y.x,f&&x>1&&Math.abs(M.cy/M.cx-o[x-2].cy/o[x-2].cx)>2&&(f=0),M.cx<a&&(M.cx?a=M.cx:(M.cx=.001,x===c-1&&(M.x-=.001,a=Math.min(a,.001),f=0)))):(o.splice(x--,1),c--);if(c=1/a+1|0,_=1/c,b=0,y=o[0],f){for(x=0;x<c;x++)D=x*_,y.nx<D&&(y=o[++b]),d=y.y+(D-y.x)/y.cx*y.cy,u[x]={x:D,cx:_,y:d,cy:0,nx:9},x&&(u[x-1].cy=d-u[x-1].y);u[c-1].cy=o[o.length-1].y-d}else{for(x=0;x<c;x++)y.nx<x*_&&(y=o[++b]),u[x]=y;b<o.length-1&&(u[x-1]=o[o.length-2])}return this.ease=function(C){var P=u[C*c|0]||u[c-1];return P.nx<C&&(P=P.n),P.y+(C-P.x)/P.cx*P.cy},this.ease.custom=this,this.id&&vn&&vn.registerEase(this.id,this.ease),this},e.getSVGData=function(i){return r.getSVGData(this,i)},r.create=function(i,n,s){return new r(i,n,s).ease},r.register=function(i){vn=i,U0()},r.get=function(i){return vn.parseEase(i)},r.getSVGData=function(i,n){n=n||{};var s=n.width||100,a=n.height||100,o=n.x||0,u=(n.y||0)+a,h=vn.utils.toArray(n.path)[0],f,c,d,m,x,_,b,y,M,D;if(n.invert&&(a=-a,u=0),typeof i=="string"&&(i=vn.parseEase(i)),i.custom&&(i=i.custom),i instanceof r)f=CR(MR([i.segment],s,0,0,-a,o,u));else{for(f=[o,u],b=Math.max(5,(n.precision||1)*200),m=1/b,b+=2,y=5/b,M=Lh(o+m*s),D=Lh(u+i(m)*-a),c=(D-u)/(M-o),d=2;d<b;d++)x=Lh(o+d*m*s),_=Lh(u+i(d*m)*-a),(Math.abs((_-D)/(x-M)-c)>y||d===b-1)&&(f.push(M,D),c=(_-D)/(x-M)),M=x,D=_;f="M"+f.join(",")}return h&&h.setAttribute("d",f),f},r}();Mw()&&vn.registerPlugin(Ds);Ds.version="3.12.5";var Br=Xi.registerPlugin(tg)||Xi;Br.core.Tween;let tr="default";class xd extends Wt{constructor(e){super(e),E.mq.sm.matches&&(tr="sm"),E.mq.md.matches&&(tr="md"),E.mq.md.matches&&E.mq.touch.matches&&(tr="tablet"),this.populateDom(),this.settings={appGridItemEnd:[10,-20,10,-10,10,5]},this.appGrid=E.components.get(_u).first(),this.setup(),this.setInitialPositions(),E.mq.md.matches&&this.buildScrubbedTL(),this.buildTextST(),this.dom.video.currentTime=0,this.dom.video.playbackRate=2,this.taggingVideo.currentTime=0,this.taggingVideo.playbackRate=2}setup(){this.placeholderBCR=this.dom.video.getBoundingClientRect(),this.canvasBCR=this.appGrid.dom.canvas.getBoundingClientRect(),this.leftTranslate=this.placeholderBCR.left-this.canvasBCR.left,this.topTranslate=this.appGrid.dom.inner.clientHeight-(this.canvasBCR.top-this.appGrid.gridTranslate-this.dom.placeholder.offsetTop),this.scale=this.placeholderBCR.width/this.canvasBCR.width,this.taggingVideo=st(".js-tagging-video",E.body),this.taggingVideoBCR=this.taggingVideo.getBoundingClientRect(),this.aspect=this.taggingVideoBCR.height/this.taggingVideoBCR.width,!E.mq.md.matches||E.mq.touch.matches?this.dom.video.classList.remove("opacity-0"):this.dom.video.classList.contains("opacity-0")||this.dom.video.classList.add("opacity-0")}setInitialPositions(){const e=Br.timeline().set([this.dom.tagInnerArray,this.appGrid.dom.tagInnerArray],{opacity:0,scale:0});E.mq.md.matches&&!E.mq.touch.matches&&e.set([this.dom.tagContainer],{opacity:0}).set(this.appGrid.dom.canvas,{position:"fixed",x:0,y:0,width:this.canvasBCR.width,height:this.canvasBCR.width*this.aspect}).set(this.appGrid.dom.canvasPlaceholder,{width:this.canvasBCR.width,height:this.canvasBCR.width*this.aspect})}buildScrubbedTL(){this.scrubbedTL=Br.timeline({paused:!0,defaults:{ease:"linear",duration:1,force3D:!1},scrollTrigger:{trigger:Xe.scrollTriggers.taggingSystem.section.trigger,endTrigger:Xe.scrollTriggers.taggingSystem.section.endTrigger,start:Xe.scrollTriggers.taggingSystem.section.start,end:Xe.scrollTriggers.taggingSystem.section.end,scrub:!0}}).to(this.appGrid.dom.inner,{y:-this.appGrid.dom.inner.clientHeight}).to(this.appGrid.dom.tagArray,{scale:this.canvasBCR.width/this.placeholderBCR.width,duration:.2,transformOrigin:"0 0"},0).to(this.appGrid.dom.gridText,{opacity:0,duration:.2},.2).to([this.appGrid.dom.itemArray,this.appGrid.dom.dummyImage],{opacity:0,y:e=>"+="+this.settings.appGridItemEnd[e]+"vh"},0),E.mq.touch.matches||this.scrubbedTL.to(this.appGrid.dom.canvas,{y:this.topTranslate,x:this.leftTranslate,scale:this.scale,transformOrigin:"0 0",duration:.9,ease:"sine.inOut"},.1),this.stCollection.push(this.scrubbedTL)}buildTextST(){this.titleTextST=Br.timeline({scrollTrigger:{trigger:Xe.scrollTriggers.taggingSystem.text.trigger,start:Xe.scrollTriggers.taggingSystem.text.start[tr],end:Xe.scrollTriggers.taggingSystem.text.end,scrub:!0}}).to([this.dom.title,this.dom.text],{opacity:1,duration:.1,overwrite:"auto"}).titleIn(this.dom.title,null,0).paragraphIn(this.dom.text,null,.1),this.videoST=Br.timeline({scrollTrigger:{trigger:Xe.scrollTriggers.taggingSystem.video.trigger,start:Xe.scrollTriggers.taggingSystem.video.start[tr],toggleActions:"restart none none reverse",onEnter:()=>{E.mq.md.matches&&!E.mq.touch.matches?this.taggingVideo.play():this.dom.video.play()}}}),E.mq.md.matches&&!E.mq.touch.matches?this.videoST.to(this.appGrid.dom.tagInnerArray,{stagger:-.1,scale:1,duration:.3,delay:this.taggingVideo.duration*.5*.25},0):this.videoST.to(this.dom.tagInnerArray,{opacity:1,stagger:-.1,scale:1,duration:.3,delay:this.taggingVideo.duration*.5*.25},0),this.hideTagsTL=Br.timeline({scrollTrigger:{trigger:Xe.scrollTriggers.taggingSystem.hideTags.trigger,start:Xe.scrollTriggers.taggingSystem.hideTags.start,end:Xe.scrollTriggers.taggingSystem.hideTags.end,scrub:!0},defaults:{ease:"linear"}}),E.mq.md.matches&&this.hideTagsTL.to(this.appGrid.dom.tagInnerArray,{opacity:1},0),this.outroTL=Br.timeline({scrollTrigger:{trigger:Xe.scrollTriggers.taggingSystem.out.trigger,start:Xe.scrollTriggers.taggingSystem.out.start,end:Xe.scrollTriggers.taggingSystem.out.end,scrub:!0},defaults:{ease:"linear"}}),E.mq.md.matches&&this.outroTL.to(this.appGrid.dom.canvas,{y:"-="+E.window.h,force3D:!1},0),this.stCollection.push(this.titleTextST,this.videoST,this.outroTL,this.hideTagsTL)}onResize(){tr="default",E.mq.sm.matches&&(tr="sm"),E.mq.md.matches&&(tr="md"),E.mq.md.matches&&E.mq.touch.matches&&(tr="tablet"),Br.set([this.taggingVideo,this.dom.video,this.dom.tagContainer,this.appGrid.dom.itemArray,this.appGrid.dom.canvas,this.appGrid.dom.canvasPlaceholder],{clearProps:"all"}),this.setup(),clearTimeout(this.timeout),this.timeout=setTimeout(()=>{this.setInitialPositions(),E.mq.md.matches&&this.buildScrubbedTL(),this.buildTextST()},100)}destroy(){super.destroy()}}q(xd,"selector",".js-tagging-system");let gf="default";class wd extends Wt{constructor(e){super(e),E.mq.sm.matches&&(gf="sm"),E.mq.md.matches&&(gf="md"),this.populateDom(),this.taggingSystem=E.components.get(xd).first(),this.appGrid=E.components.get(_u).first(),this.startPositions={0:["+=0","+=200"],1:["-=200","+=0"],2:["-=120","-=200"],3:["+=0","-=200"],4:["+=120","-=200"],5:["+=120","+=200"]},this.delay=[.2,0,.1,0,.1,0],this.ctx=Y.context(()=>{this.querySplit=new _r(this.dom.query,{type:"chars",charsClass:"split-chars"}),Y.set(this.querySplit.chars,{opacity:0}),Y.set(this.dom.searchBar,{scale:1.5}),this.buildQueryTL(),this.buildTextTL(),this.buildClusterTL()})}buildQueryTL(){this.queryTextTL=Y.timeline({scrollTrigger:{trigger:Xe.scrollTriggers.searchSection.queryText.trigger,start:Xe.scrollTriggers.searchSection.queryText.start,end:Xe.scrollTriggers.searchSection.queryText.end,scrub:!0}}).set(this.querySplit.chars,{opacity:1,stagger:.1,duration:.2},.8),this.stCollection.push(this.queryTextTL)}buildTextTL(){this.textTL=Y.timeline({scrollTrigger:{trigger:Xe.scrollTriggers.searchSection.sectionText.trigger,start:Xe.scrollTriggers.searchSection.sectionText.start,end:Xe.scrollTriggers.searchSection.sectionText.end[gf],scrub:!0}}).titleIn(this.dom.title,null,0).paragraphIn(this.dom.text,null,.2),this.stCollection.push(this.textTL)}buildClusterTL(){this.clusterTL=Y.timeline({scrollTrigger:{trigger:Xe.scrollTriggers.searchSection.cluster.trigger,start:Xe.scrollTriggers.searchSection.cluster.start,end:Xe.scrollTriggers.searchSection.cluster.end,toggleActions:"play none none reverse",scrub:!0},defaults:{duration:1.5,ease:"linear"}}).to(this.dom.searchBar,{scale:1},0).from(this.dom.imageArray,{opacity:0,duration:1.3},.2),this.stCollection.push(this.clusterTL),E.mq.sm.matches&&this.clusterTL.from(this.dom.imageArray,{x:e=>this.startPositions[this.dom.imageArray[e].dataset.index][0],y:e=>this.startPositions[this.dom.imageArray[e].dataset.index][1],force3D:!1},0)}onResize(){setTimeout(()=>{this.ctx.revert(),this.ctx=Y.context(()=>{this.querySplit=new _r(this.dom.query,{type:"chars",charsClass:"split-chars"}),Y.set(this.querySplit.chars,{opacity:0}),Y.set(this.dom.searchBar,{scale:1.5}),this.buildQueryTL(),this.buildTextTL(),this.buildClusterTL()})},1)}}q(wd,"selector",".js-search-section");class Tw extends Wt{constructor(t){super(t);q(this,"onResize",()=>{this.headerHideST(),this.buildTextTL()});this.populateDom(),this.headerHideST(),this.buildTextTL(),this.footerComp=E.components.get(cg).first(),this.footerComp.dummy.style.height="0px",this.dom.inputEl=st(".js-cta-footer\\:inputEl"),this.dom.submitContainer=st(".js-cta-footer\\:submitContainer"),this.dom.submitBorder=st(".js-cta-footer\\:inputBorder"),this.dom.confirmationText=st(".js-cta-footer\\:confirmationText"),Y.set(this.dom.inputEl,{opacity:0}),Y.set(this.dom.submitContainer,{opacity:0}),this.on(Je.RESIZE,this.onResize)}headerHideST(){var t;(t=this.headerSt)==null||t.kill(),this.headerSt=ft.create({trigger:this.el,start:"top 20%",invalidateOnRefresh:!0,onEnter:()=>{this.emit("ShyHeader:hide"),this.emit("FooterForm:ShowText"),Y.to([this.dom.inputEl,this.dom.submitContainer],{opacity:1,duration:.3,overwrite:!1})},onLeaveBack:()=>{this.emit("ShyHeader:show"),this.emit("FooterForm:HideText"),Y.to([this.dom.inputEl,this.dom.submitContainer],{opacity:0,duration:.3,overwrite:!1})}}),this.stCollection.push(this.headerSt)}buildTextTL(){var t;(t=this.textTl)==null||t.kill(),this.textTl=Y.timeline({scrollTrigger:{trigger:this.el,start:"top bottom",end:"top top",scrub:!0}}).paragraphIn(this.dom.text,null,0).titleIn(this.dom.title,null,.1),this.stCollection.push(this.textTl)}}q(Tw,"selector",".js-rocks-section");const Za=class Za extends Wt{constructor(t){super(t);q(this,"VISIBLE_SLIDES",3);q(this,"onPointerDown",()=>{this.preventDrag=!1,this.yDragTotal=0,this.xDragTotal=0});q(this,"onPointerUp",()=>{this.preventDrag=!1,this.yDragTotal=0,this.xDragTotal=0});q(this,"touchDrag",(t,i)=>{this.el.classList.remove("is-clickable"),this.timeout&&window.clearTimeout(this.timeout),E.mq.touch.matches&&(this.yDragTotal+=Math.abs(i.deltaY),this.xDragTotal+=Math.abs(i.deltaX),this.yDragTotal>5&&this.xDragTotal<20&&(this.preventDrag=!0)),this.reversed=i.deltaX<0,E.pointer.isDragging&&this.parentSection.contains(t.target)&&!this.preventDrag&&(Za.hasDragged||(Za.hasDragged=!0,this.emit("ImageSlider:drag")),this.delta.x=i.deltaX,clearTimeout(this.timeout),this.timeout=setTimeout(()=>{this.delta.x=0},400)),this.timeout=setTimeout(()=>{this.el.classList.add("is-clickable")},300)});q(this,"onRaf",()=>{if(this.enabled){this.delta.x=Y.utils.clamp(-30,30,this.delta.x),this.current.lerp(this.delta,.05);for(let t=0;t<this.progress.length;t++)this.progress[t]+=this.current.x*.00165*E.WebGL.normalizeDelta,this.progress[t]=this.progressWrap(this.progress[t]),this.timelines[t].progress(this.progress[t]);this.reversed?E.globeWebGL.scenes.globe.globeGroup.rotation.y-=.001:E.globeWebGL.scenes.globe.globeGroup.rotation.y+=.001,E.globeWebGL.scenes.globe.globeGroup.rotation.y+=No.radToDeg(this.current.x*6e-5*E.WebGL.normalizeDelta)}});q(this,"onResize",()=>{this.ctx.revert(),this.ctx.kill(),this.dom.slideArray.forEach(t=>{t.classList.remove("reveal-text")}),this.initValues()});this.enabled=!1,E.RAFCollection.add(this.onRaf,5),this.populateDom(),this.initValues()}createSlides(){this.dom.slideArray.forEach((t,i)=>{t.style.width=this.maxWidth/this.VISIBLE_SLIDES+"px",this.setInitialPositions(t,i),this.buildSlideTimeline(t,i),this.progress.push(i*this.progressInteger),this.originalProgress.push(i*this.progressInteger)})}addEvents(){this.on(Je.MOUSEDRAG,this.touchDrag),this.on(Je.TOUCHDRAG,this.touchDrag),this.on(Je.POINTERDOWN,this.onPointerDown),this.on(Je.POINTERUP,this.onPointerUp),this.on(Je.RESIZE,this.onResize)}removeEvents(){this.off(Je.MOUSEDRAG,this.touchDrag),this.off(Je.TOUCHDRAG,this.touchDrag),this.off(Je.POINTERDOWN,this.onPointerDown),this.off(Je.POINTERUP,this.onPointerUp),this.off(Je.RESIZE,this.onResize)}resetTimelines(){for(let t=0;t<this.progress.length;t++){const i=this.originalProgress[t]+.12;this.progress[t]=i,this.timelines[t].progress(i)}}setInitialPositions(t,i){const n=Y.utils.wrap([-20,60,0,-50,30]);Y.timeline().set(t,{x:0},0).set(this.el,{xPercent:-20}).set(this.dom.slideInnerArray[i],{y:()=>E.mq.sm.matches?n(i):0,scale:0},0).set(this.dom.slideIntroAnimArray,{xPercent:-120,scale:.4,opacity:0,transformOrigin:"center center"}).set(this.dom.textArray,{opacity:0})}buildSlideTimeline(t,i){const n=this.dom.slideArray.length*.1,s=this.VISIBLE_SLIDES*.1,a=Y.timeline({paused:!0,defaults:{duration:n,ease:"linear"}}).to(t,{x:this.maxWidth,force3D:!1,duration:this.VISIBLE_SLIDES*.1,ease:"linear"},0).call(()=>{t.classList.toggle("reveal-text")},null,s*.1).to(this.dom.slideInnerArray[i],{scale:1,duration:s*.2,ease:"power1.inOut"},0).to(this.dom.slideInnerArray[i],{scale:0,duration:s*.2,ease:"power1.inOut"},s*.8).call(()=>{t.classList.toggle("reveal-text")},null,s*.9).to(t,{x:0,force3D:!1,duration:this.remainder*.1},this.VISIBLE_SLIDES*.1);this.timelines.push(a)}initValues(){E.mq.md.matches?this.VISIBLE_SLIDES=4:this.VISIBLE_SLIDES=3,this.maxWidth=this.el.clientWidth,this.current=new Ue(0,0),this.delta=new Ue(0,0),this.progress=0,this.yDragTotal=0,this.xDragTotal=0,this.preventDrag=!1,this.timelines=[],this.progress=[],this.originalProgress=[],this.parentSection=st(".js-globe-section"),this.progressInteger=1/this.dom.slideArray.length,this.remainder=this.dom.slideArray.length-this.VISIBLE_SLIDES,this.ctx=Y.context(()=>{this.createSlides()});for(let t=0;t<this.progress.length;t++)this.progress[t]+=.06;this.tweenParams={animateInMultiplier:0},this.progressWrap=Y.utils.wrap(0,1),this.reversed=!1}destroy(){super.destroy(),this.preventDrag=!1,E.RAFCollection.remove(this.onRaf,5)}};q(Za,"selector",".js-image-slider"),q(Za,"hasDragged",!1);let bl=Za,_f="default";class ug extends Wt{constructor(t){super(t);q(this,"hideDragPrompt",()=>{Y.to(this.dom.dragPrompt.parentElement,{opacity:0})});q(this,"onGlobeSceneResize",()=>{this.buildScrubbedTL()});this.populateDom(),E.mq.sm.matches&&(_f="sm"),E.mq.md.matches&&(_f="md"),this.searchSection=E.components.get(wd).first(),this.imageSlider=E.components.get(bl).first(),this.ctx=Y.context(()=>{this.buildScrubbedTL(),this.buildST(),this.buildTextTL(),this.buildImageSliderTL()}),Y.set(this.dom.dragPrompt,{opacity:0}),this.on("ImageSlider:drag",this.hideDragPrompt),this.on("GlobeScene:resize",this.onGlobeSceneResize)}buildScrubbedTL(){this.scrubbedParticleTL=Y.timeline({defaults:{ease:"linear"},scrollTrigger:{trigger:Xe.scrollTriggers.particleGlobe.particleScrubbed.trigger,start:Xe.scrollTriggers.particleGlobe.particleScrubbed.start,end:Xe.scrollTriggers.particleGlobe.particleScrubbed.end,scrub:!0}}).to(E.globeWebGL.scenes.globe.material.uniforms.uYPosMultiplier,{value:0}),this.stCollection.push(this.scrubbedParticleTL)}buildST(){this.st=ft.create({trigger:Xe.scrollTriggers.particleGlobe.section.trigger,start:Xe.scrollTriggers.particleGlobe.section.start,onEnter:()=>{this.imageSlider.enabled=!0,E.globeWebGL.scenes.globe.start(),this.imageSlider.addEvents()},onLeaveBack:()=>{E.globeWebGL.scenes.globe.stop(),this.imageSlider.enabled=!1,this.imageSlider.removeEvents(),this.imageSlider.resetTimelines()},onLeave:()=>{this.imageSlider.enabled=!1,E.globeWebGL.scenes.globe.stop(),this.imageSlider.removeEvents()},onEnterBack:()=>{this.imageSlider.enabled=!0,E.globeWebGL.scenes.globe.start(),this.imageSlider.addEvents()}}),this.stCollection.push(this.st)}buildTextTL(){this.textTl=Y.timeline({scrollTrigger:{trigger:Xe.scrollTriggers.particleGlobe.text.trigger,start:Xe.scrollTriggers.particleGlobe.text.start,end:Xe.scrollTriggers.particleGlobe.text.end[_f],scrub:!0}}).titleIn(this.dom.title,null,0).paragraphIn(this.dom.text,null,.1),bl.hasDragged||this.textTl.to(this.dom.dragPrompt,{opacity:1},.8),this.stCollection.push(this.textTl)}buildImageSliderTL(){const t=[...this.imageSlider.dom.slideIntroAnimArray],i=t.slice(0,this.imageSlider.VISIBLE_SLIDES),n=[...this.imageSlider.dom.textArray],s=n.slice(0,this.imageSlider.VISIBLE_SLIDES);this.sliderST=Y.timeline({scrollTrigger:{trigger:Xe.scrollTriggers.particleGlobe.imageSlider.trigger,start:Xe.scrollTriggers.particleGlobe.imageSlider.start,toggleActions:"restart none none none",onLeaveBack:a=>a.disable()}}).to(i,{xPercent:0,scale:1,duration:1,ease:"power2.inOut",stagger:{each:-.1,ease:"power1.out"}},0).to(i,{opacity:1,ease:"power2.inOut",duration:.8,stagger:{each:-.1,ease:"power1.out"}},.2).to(s,{opacity:1,duration:.4,stagger:{each:-.1,ease:"power1.out"}},.2).to(this.imageSlider.el,{xPercent:0,duration:1.8},0).set(t,{xPercent:0,scale:1,opacity:1}).set(n,{opacity:1}),this.stCollection.push(this.sliderST)}onResize(){this.ctx.revert(),this.imageSlider.enabled=!0,this.imageSlider.removeEvents(),this.ctx=Y.context(()=>{this.buildST(),this.buildTextTL(),this.buildImageSliderTL()})}destroy(){super.destroy()}}q(ug,"selector",".js-globe-section");class Ew extends og{constructor(){super();q(this,"enableDarkMode",()=>{this.material.uniforms.uBaseColor.value=new pt(16777215)});q(this,"disableDarkMode",()=>{this.material.uniforms.uBaseColor.value=new pt(0)});q(this,"onRaf",()=>{this.controls.enabled&&this.controls.update(),this.options.controls?E.globeWebGL.renderer.render(this,this.devCamera):E.globeWebGL.renderer.render(this,this.camera)});q(this,"onResize",()=>{this.camera.aspect=E.window.w/E.window.h,this.camera.updateProjectionMatrix()});this.origOptions={...this.options},this.fog=new dd(0,2,11)}build(){const t=new pd(.007);this.instancedGeometry=new CP().copy(t),this.instanceCount=800,this.instancedGeometry.maxInstancedCount=this.instanceCount,this.instancedGeometry.instanceCount=this.instanceCount,this.material=new pR,this.mesh=new Wi(this.instancedGeometry,this.material),this.currentOrientation=this.checkOrientation(),this.newOrientation=this.currentOrientation,this.initialOrientation=this.currentOrientation,this.calculateSceneDimensions(),this.calcParticlePositions(),this.globeGroup=new ts,this.globeGroup.add(this.mesh),this.add(this.globeGroup),this.addEvents(),this.oldRadius=this.radius,this.newRadius=this.radius}checkOrientation(){return E.window.w>E.window.h?"landscape":"portrait"}calcParticlePositions(){this.aPos=[];const t=[],i=[];this.material.uniforms.uRadius.value=this.radius;for(let o=0;o<this.instanceCount;o++){const u=this.getRandomArbitrary(.98,1)*this.radius,h=No.randFloatSpread(360),f=No.randFloatSpread(360),c=u*Math.sin(h)*Math.cos(f),d=u*Math.sin(h)*Math.sin(f),m=u*Math.cos(h),x=this.getRandomArbitrary(.1,3),_=this.getRandomArbitrary(2,6);this.aPos.push(c,d,m),t.push(x),i.push(_)}const n=new Float32Array(this.aPos);this.instancedGeometry.setAttribute("aPos",new Vo(n,3,!1));const s=new Float32Array(t);this.instancedGeometry.setAttribute("yPosMultiplier",new Vo(s,1,!1));const a=new Float32Array(i);this.instancedGeometry.setAttribute("opacityPosMultiplier",new Vo(a,1,!1))}getRandomArbitrary(t,i){return Math.random()*(i-t)+t}calculateSceneDimensions(){const t=No.degToRad(this.camera.fov);this.sceneHeight=2*Math.tan(t/2)*5.5,this.sceneHeight*=.8,this.sceneWidth=this.sceneHeight*this.camera.aspect;const i=E.window.w>E.window.h?this.sceneHeight:this.sceneWidth*1.1;this.radius=i}start(){E.RAFCollection.add(this.onRaf,1)}stop(){E.RAFCollection.remove(this.onRaf)}addEvents(){De.on(Je.RESIZE,this.onResize),De.on("DarkMode:enabled",this.enableDarkMode),De.on("DarkMode:disabled",this.disableDarkMode)}removeEvents(){De.on(Je.RESIZE,this.onResize),De.off("DarkMode:enabled",this.enableDarkMode),De.off("DarkMode:disabled",this.disableDarkMode)}destroy(){this.stop(),this.removeEvents(),this.traverse(t=>{t.isMesh&&this.deleteObject(t)}),this.remove(this.globeGroup)}deleteObject(t){t.geometry.dispose(),t.material instanceof Array?t.material.forEach(i=>i.dispose()):t.material.dispose(),t.removeFromParent(),this.remove(t)}}class Cw extends Wt{constructor(t){super(t);q(this,"onResize",()=>{var i,n,s,a,o,u,h,f;(i=E.SmoothScroll)==null||i.unlock(),ft.killAll(),pl.scrollTo(0,{immediate:!0,force:!0});const t=st(".js-header-wordmark");Y.set(t,{autoAlpha:0}),(n=E.components.get(gu))==null||n.first().onResize(),(s=E.components.get(su))==null||s.first().onResize(),(a=E.components.get(_u))==null||a.first().onResize(),(o=E.components.get(xd))==null||o.first().onResize(),(u=E.components.get(wd))==null||u.first().onResize(),(h=E.components.get(ug))==null||h.first().onResize(),(f=E.components.get(bl))==null||f.first().onResize(),this.footer.style.opacity=0});this.footer=st(".js-footer",E.body),this.on(Je.RESIZE,this.onResize)}destroy(){super.destroy()}}q(Cw,"selector",".home");class Dw{constructor(e,t){this.name=e,this.canvas=t,this.renderer=new Sm({alpha:!0,antialias:!0,canvas:t,powerPreference:"high-performance",stencil:!1}),this.renderer.setPixelRatio(E.window.dpr>=2?2:E.window.dpr),this.renderer.setSize(E.window.w,E.window.h),this.renderer.info.autoReset=!1,this.renderer.setClearColor(0,0),this.clock=E.WebGL.clock,this.clockDelta=E.WebGL.clockDelta,this.normalizeDelta=E.WebGL.normalizeDelta,this.globalUniforms=E.WebGL.globalUniforms}generateTexture(e,t={}){return e instanceof HTMLImageElement&&(e=new vi(e)),e.minFilter=t.minFilter||dr,e.magFilter=t.magFilter||Ui,e.wrapS=e.wrapT=t.wrapping||bn,e.flipY=t.flipY!==void 0?t.flipY:!0,e.encoding=t.encoding||pr,this.renderer.initTexture(e),e}}class IR extends Dw{constructor(t){super("globe",t);q(this,"onResize",()=>{this.renderer.setSize(E.window.w,E.window.h),this.scenes.globe.stop(),this.scenes.globe.destroy(),this.scenes.globe=new Ew,this.scenes.globe.build(),De.emit("GlobeScene:resize")});this.canvas=t,this.renderer.setSize(this.canvas.offsetWidth,this.canvas.offsetHeight,!1),this.scenes={globe:null}}start(){De.on(Je.RESIZE,this.onResize)}stop(){De.off(Je.RESIZE,this.onResize)}destroy(){this.renderer.dispose(),this.scenes.globe.destroy()}}class FR extends Dw{constructor(t){super("rocks",t);q(this,"onResize",()=>{this.renderer.setSize(E.window.w,E.window.h)});this.canvas=t,this.renderer.setSize(this.canvas.offsetWidth,this.canvas.offsetHeight,!1),this.scenes={rocks:null}}start(){De.on(Je.RESIZE,this.onResize)}stop(){De.off(Je.RESIZE,this.onResize)}destroy(){this.renderer.dispose(),this.scenes.rocks.destroy()}}class OR extends ts{constructor(t={}){super();q(this,"updateRocksPos",()=>{for(let t=0;t<this.options.count;t++)this.updateDummyValues(t),this.dummy.updateMatrix(),this.mesh.setMatrixAt(t,this.dummy.matrix),this.mesh.instanceMatrix.needsUpdate=!0});q(this,"onRAF",t=>{this.rotation.y=t*.1*this.options.speed+this.options.scrollY,this.uniforms.uScrollY.value=this.options.scrollY});q(this,"onBeforeCompileRocks",t=>{t.uniforms={...t.uniforms,...E.WebGL.globalUniforms,...this.uniforms},t.vertexShader=t.vertexShader.replace("varying vec3 vViewPosition;",`
				varying vec3 vViewPosition;
				attribute vec3 aAxis;
				attribute float aAngle;
				uniform float uTime;
				uniform float uScrollY;
				uniform float uRotateSpeed;

				mat4 rotationMatrix(vec3 axis, float angle){
					axis = normalize(axis);
					float s = sin(angle);
					float c = cos(angle);
					float oc = 1.0 - c;

					return mat4(oc * axis.x * axis.x + c,           oc * axis.x * axis.y - axis.z * s,  oc * axis.z * axis.x + axis.y * s,  0.0,
						oc * axis.x * axis.y + axis.z * s,  oc * axis.y * axis.y + c,           oc * axis.y * axis.z - axis.x * s,  0.0,
						oc * axis.z * axis.x - axis.y * s,  oc * axis.y * axis.z + axis.x * s,  oc * axis.z * axis.z + c,           0.0,
						0.0,                                0.0,                                0.0,                                1.0);
				}
			`),t.vertexShader=t.vertexShader.replace("#include <beginnormal_vertex>",`
				#include <beginnormal_vertex>

				float angle = (uTime * 0.01 * uRotateSpeed + aAngle) * 20. + uScrollY * 5.;
				mat4 rotateMatrix = rotationMatrix(aAxis, angle);

				objectNormal = (rotateMatrix * vec4(objectNormal, 1.0)).xyz;
			`),t.vertexShader=t.vertexShader.replace("#include <begin_vertex>",`
				#include <begin_vertex>

				transformed = (rotateMatrix * vec4(transformed, 1.0)).xyz;
			`),t.fragmentShader=t.fragmentShader.replace("#include <map_pars_fragment>",`
				#include <map_pars_fragment>
				uniform sampler2D uLightRockDiffuse;
				uniform float uLightModeProgress;
			`),t.fragmentShader=t.fragmentShader.replace("#include <map_fragment>",`
				#ifdef USE_MAP

					vec4 sampledDiffuseColor = texture2D( map, vUv );

					vec4 lightRockDiffuseColor = texture2D( uLightRockDiffuse, vUv );

					sampledDiffuseColor = sampledDiffuseColor * (1. - uLightModeProgress) + lightRockDiffuseColor * uLightModeProgress;

					#ifdef DECODE_VIDEO_TEXTURE

						// inline sRGB decode (TODO: Remove this code when https://crbug.com/1256340 is solved)

						sampledDiffuseColor = vec4( mix( pow( sampledDiffuseColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), sampledDiffuseColor.rgb * 0.0773993808, vec3( lessThanEqual( sampledDiffuseColor.rgb, vec3( 0.04045 ) ) ) ), sampledDiffuseColor.w );

					#endif

					diffuseColor *= sampledDiffuseColor;

				#endif
			`)});this.name="rocks",this.options=t,this.params={base:{radius:1.2,baseScale:.7},sm:{radius:1.25,baseScale:.8},md:{radius:this.options.radius,baseScale:this.options.baseScale}},this.uniforms={uScrollY:{value:0},uRotateSpeed:{value:1},uLightRockDiffuse:{value:null},uLightModeProgress:{value:0}}}build(t){this.buildMaterial();const i=E.rocksWebGL.scenes.rocks.assets.models.rocks.geometry.clone();this.mesh=new Sb(i,this.rocksMaterial,this.options.count),this.dummy=new ei,this.updateRocksPos();const n=new Float32Array(this.options.count*3),s=new Float32Array(this.options.count);for(let a=0;a<this.options.count;a++)n[a*3]=Math.random(),n[a*3+1]=Math.random(),n[a*3+2]=Math.random(),s[a]=Math.random();this.mesh.geometry.setAttribute("aAxis",new Vo(n,3)),this.mesh.geometry.setAttribute("aAngle",new Vo(s,1)),this.add(this.mesh),this.uniforms.uLightRockDiffuse.value=E.rocksWebGL.scenes.rocks.assets.textures.rocksLightModeDiffuse,De.on(Je.RESIZE,this.updateRocksPos)}buildMaterial(){this.rocksMaterial=new fd({map:E.rocksWebGL.scenes.rocks.assets.textures.rocksDiffuse,normalMap:E.rocksWebGL.scenes.rocks.assets.textures.rocksNormal,roughnessMap:E.rocksWebGL.scenes.rocks.assets.textures.rocksRoughness}),this.rocksMaterial.onBeforeCompile=this.onBeforeCompileRocks}updateDummyValues(t){let i=this.params.base;E.mq.md.matches?i=this.params.md:E.mq.sm.matches&&(i=this.params.sm);const n=Math.PI*2/this.options.count;this.dummy.position.x=Math.cos(n*t)*i.radius,this.dummy.position.z=Math.sin(n*t)*i.radius,this.dummy.rotation.x=Math.random()*2*Math.PI,this.dummy.rotation.y=Math.random()*2*Math.PI,this.dummy.rotation.z=Math.random()*2*Math.PI,this.dummy.scale.x=this.dummy.scale.y=this.dummy.scale.z=i.baseScale-this.options.scaleOffset+Math.random()*this.options.scaleOffset*2}start(){this.addEvents()}stop(){this.removeEvents()}addEvents(){E.RAFCollection.add(this.onRAF,3)}removeEvents(){E.RAFCollection.remove(this.onRAF)}destroy(){E.RAFCollection.remove(this.onRAF),De.off(Je.RESIZE,this.updateRocksPos),E.rocksWebGL.scenes.rocks.remove(this),this.mesh.geometry.dispose(),this.rocksMaterial.dispose(),this.mesh=void 0,this.rocksMaterial=void 0}}class NR extends og{constructor(){super();q(this,"switchModeDuration",.2);q(this,"onPointerMove",t=>{this.pointer.x=t.clientX/E.window.w*2-1,this.pointer.y=-((t.clientY-this.canvasTop)/E.window.h)*2+1});q(this,"onDarkModeEnabled",()=>{var t;(t=this.fogTl)==null||t.kill(),Y.to(this.ambient,{intensity:1,duration:this.switchModeDuration}),Y.to(this.fixedLight,{intensity:1,duration:this.switchModeDuration}),Y.to(this.movingLight,{intensity:4.7,duration:this.switchModeDuration}),Y.to(this.ambient.color,{r:this.darkModeAmbientColor.r,g:this.darkModeAmbientColor.g,b:this.darkModeAmbientColor.b,duration:this.switchModeDuration}),Y.to(this.components.rocks.uniforms.uLightModeProgress,{value:0,duration:this.switchModeDuration}),this.fogTl=Y.timeline(),this.fogTl.to(this.fog,{near:this.fogOptions.far,duration:this.switchModeDuration}).set(this.fog,{near:this.fogOptions.far+5,far:this.fogOptions.far+5})});q(this,"onLightModeEnabled",()=>{var t;(t=this.fogTl)==null||t.kill(),Y.to(this.ambient,{intensity:2.17,duration:this.switchModeDuration}),Y.to(this.fixedLight,{intensity:.5,duration:this.switchModeDuration}),Y.to(this.movingLight,{intensity:.6,duration:this.switchModeDuration}),Y.to(this.ambient.color,{r:this.lightModeAmbientColor.r,g:this.lightModeAmbientColor.g,b:this.lightModeAmbientColor.b,duration:this.switchModeDuration}),Y.to(this.components.rocks.uniforms.uLightModeProgress,{value:1,duration:this.switchModeDuration}),this.fogTl=Y.timeline(),this.fogTl.set(this.fog,{near:this.fogOptions.far,far:this.fogOptions.far,duration:this.switchModeDuration}).to(this.fog,{near:this.fogOptions.near})});q(this,"onRAF",()=>{this.controls.enabled&&this.controls.update(),this.options.controls?this.raycaster.setFromCamera(this.pointer,this.devCamera):this.raycaster.setFromCamera(this.pointer,this.camera);const t=this.raycaster.intersectObject(this.planeRaycast);if(t.length>0){const{point:i}=t[0];this.movingLightPos.setX(i.x),this.movingLightPos.setZ(i.z),this.movingLight.position.lerp(this.movingLightPos,this.options.lightLerp),this.lightTarget.position.lerp(i,this.options.lightLerp),this.movingLight.position.clamp(this.lightMinPos,this.lightMaxPos),this.lightTarget.position.clamp(this.lightTargetMinPos,this.lightTargetMaxPos)}this.options.controls?E.rocksWebGL.renderer.render(this,this.devCamera):E.rocksWebGL.renderer.render(this,this.camera)});q(this,"onResize",()=>{this.camera.aspect=E.window.w/E.window.h,this.camera.updateProjectionMatrix(),this.devCamera.aspect=E.window.w/E.window.h,this.devCamera.updateProjectionMatrix(),this.setCameraPos(),this.stop(),this.buildScrollTriggerRender()});this.options=Object.assign(this.options,{rocks:{count:6,scrollY:0,speed:1,radius:1.62,baseScale:.91,scaleOffset:.08},lightLerp:.03}),this.fogOptions={near:4.89,far:7.5},this.cameraOptions={y:1.8,z:5.1},this.camera.fov=40,this.camera.updateProjectionMatrix(),this.setCameraPos(),this.canvasEl=st(".webgl-rocks"),this.origOptions={...this.options},this.components={rocks:new OR(this.options.rocks)},this.load()}setCameraPos(){let t=-.15;E.mq.md.matches?t=0:E.mq.sm.matches&&(t=-.1),this.camera.position.y=this.cameraOptions.y,this.camera.position.z=this.cameraOptions.z,this.camera.lookAt(new Z),this.camera.position.y=this.cameraOptions.y+t}start(){for(const t in this.components)this.components[t].start();this.addDynamicEvents()}stop(){for(const t in this.components)this.components[t].stop();this.removeDynamicEvents()}build(){this.buildScrollTriggerRender(),this.buildFog(),this.buildRocks(),this.buildLights(),this.buildRaycaster(),De.on(Je.RESIZE,this.onResize),De.on("DarkMode:enabled",this.onDarkModeEnabled),De.on("DarkMode:disabled",this.onLightModeEnabled)}buildScrollTriggerRender(){this.st=ft.create({trigger:this.canvasEl,start:"top bottom",end:"bottom top",onEnter:()=>{E.urlParams.has("nowebgl")||this.start()},onEnterBack:()=>{E.urlParams.has("nowebgl")||this.start()},onLeave:()=>{E.urlParams.has("nowebgl")||this.stop()},onLeaveBack:()=>{E.urlParams.has("nowebgl")||this.stop()},onUpdate:t=>{window.clearTimeout(this.timeout),this.options.rocks.scrollY+=Y.utils.clamp(-1500,1500,t.getVelocity())*1e-5,this.timeout=window.setTimeout(()=>{this.canvasTop=this.canvasEl.getBoundingClientRect().top},100)}})}buildFog(){this.fog=new dd("#E9E8E3",this.fogOptions.far+5,this.fogOptions.far+5)}buildRocks(){for(const t in this.components)this.components[t].build(this.objectData),this.add(this.components[t])}buildLights(){this.darkModeAmbientColor=new pt("#080808"),this.lightModeAmbientColor=new pt("#5e5d5d"),this.ambient=new EP(this.darkModeAmbientColor,1),this.add(this.ambient),this.fixedLight=new kb("#FFF",1),this.fixedLight.position.set(0,5,.4),this.add(this.fixedLight),this.movingLight=new Rb("#FFF",4.7,4.1,Math.PI/2),this.movingLight.position.set(0,2,.4),this.lightTarget=new ei,this.movingLight.target=this.lightTarget,this.movingLightPos=new Z(0,this.movingLight.position.y,0),this.add(this.movingLight)}buildRaycaster(){const t=this.options.rocks.radius*2.5+200;this.planeRaycast=new Wi(new uu(t,t,1,1),new ar({color:"blue",visible:!1})),this.planeRaycast.rotateX(-Math.PI/2),this.lightMinPos=new Z(-3,this.movingLight.position.y,-3),this.lightMaxPos=new Z(3,this.movingLight.position.y,3),this.lightTargetMinPos=new Z(-3,this.lightTarget.position.y,-3),this.lightTargetMaxPos=new Z(3,this.lightTarget.position.y,3),this.add(this.planeRaycast),this.raycaster=new VP,this.pointer=new Ue}addDynamicEvents(){De.on(Je.POINTERMOVE,this.onPointerMove),E.RAFCollection.add(this.onRAF,2)}removeDynamicEvents(){De.off(Je.POINTERMOVE,this.onPointerMove),E.RAFCollection.remove(this.onRAF)}load(){this.assets={textures:{},models:{}};const t={rocksDiffuse:"rocks_diffuse.jpg",rocksNormal:"rocks_normal.jpg",rocksRoughness:"rocks_roughness.jpg",rocksLightModeDiffuse:"light_rocks_diffuse.jpg"};E.AssetLoader.loadGltf("/webgl/models/rocks.glb").then(i=>{this.assets.models.rocks=i.scene.children[0].clone(),this.assets.models.rocks.geometry=this.assets.models.rocks.geometry.clone(),this.assets.models.rocks.geometry.scale(.01,.01,.01)});for(const i in t)E.AssetLoader.loadTexture(`/webgl/textures/rocks/${t[i]}`,{wrapping:Kr,flipY:!1}).then(n=>{this.assets.textures[i]=n})}destroy(){this.stop(),this.st.kill(),Object.assign(this.options,this.origOptions),De.off(Je.RESIZE,this.onResize),De.off("DarkMode:enabled",this.onDarkModeEnabled),De.off("DarkMode:disabled",this.onLightModeEnabled),this.traverse(t=>{t.isMesh&&this.deleteObject(t)})}deleteObject(t){t.geometry.dispose(),t.material instanceof Array?t.material.forEach(i=>i.dispose()):t.material.dispose(),t.removeFromParent(),this.remove(t)}}let vf="default";class Pw extends Wt{constructor(t){super(t);q(this,"onResize",()=>{var t;(t=this.ctx)==null||t.revert(),this.createContext()});this.populateDom(),E.mq.sm.matches&&(vf="sm"),E.mq.md.matches&&(vf="md"),this.createContext(),this.on(Je.RESIZE,this.onResize),Y.set(this.dom.btn,{opacity:0})}createContext(){this.ctx=Y.context(()=>{this.buildTextTL(),E.mq.md.matches&&this.buildDevicesParallax()})}buildTextTL(){this.textTl=Y.timeline({scrollTrigger:{trigger:Xe.scrollTriggers.appPreview.text.trigger,start:Xe.scrollTriggers.appPreview.text.start,end:Xe.scrollTriggers.appPreview.text.end[vf],scrub:!0}}).titleIn(this.dom.title,null,0).paragraphIn(this.dom.text,null,.1).to(this.dom.btn,{opacity:1},.8),this.stCollection.push(this.textTl)}buildDevicesParallax(){this.devicesTl=Y.timeline({scrollTrigger:{trigger:this.dom.el,start:"top bottom",end:"bottom top",scrub:!0}}).to(this.dom.tablet,{y:30}).fromTo(this.dom.mobile,{y:15},{y:-20},0),this.stCollection.push(this.devicesTl)}}q(Pw,"selector",".js-app-preview");class BR extends Al{initialLoad(){super.initialLoad()}onEnter(){super.onEnter(),E.components.add(Cw),Y.set(".vortex-vignette",{autoAlpha:1}),this.initializeWebGLScenes(),E.urlParams.has("limitScroll")&&(E.SmoothScroll.Lenis.virtualScroll.wheelMultiplier=E.urlParams.get("limitScroll"))}initializeWebGLScenes(){E.AssetLoader.loaded.isResolved?this.buildWebGLScenes():E.AssetLoader.loaded.then(()=>{this.buildWebGLScenes()})}buildWebGLScenes(){E.urlParams.has("nowebgl")||(E.globeWebGL||this.registerAdditionalWebgl(),E.globeWebGL.scenes.globe.build(),E.globeWebGL.start(),E.rocksWebGL.scenes.rocks.build(),E.rocksWebGL.start(),E.rocksWebGL.scenes.rocks.onRAF())}onEnterCompleted(){super.onEnterCompleted(),this.loadHomeComponents(),E.urlParams.has("nowebgl")||E.WebGL.scenes.vortex.start()}loadHomeComponents(){E.AssetLoader.loaded.isResolved?this.addHomeComponents():E.AssetLoader.loaded.then(()=>{this.addHomeComponents()})}addHomeComponents(){E.components.add(gu,su,_u,xd,wd,bl,ug,Pw,Tw),Y.set(E.mainGridItems,{opacity:0,overwrite:"auto"}),this.dynamicText=E.components.get(na).get(0),E.Taxi.isTransitioning&&this.dynamicText.tl.play()}onLeave(){var e,t,i,n;super.onLeave(),E.urlParams.has("nowebgl")||(E.WebGL.scenes.vortex.stop(),(t=(e=E.globeWebGL)==null?void 0:e.scenes.globe)==null||t.stop(),(n=(i=E.rocksWebGL)==null?void 0:i.scenes.rocks)==null||n.stop())}onLeaveCompleted(){super.onLeaveCompleted();const e=st(".js-header-wordmark");Y.set(e,{autoAlpha:1}),Y.set(".vortex-vignette",{autoAlpha:0}),E.globeWebGL&&E.globeWebGL.destroy(),E.rocksWebGL&&E.rocksWebGL.destroy()}registerAdditionalWebgl(){E.globeWebGL=new IR(st(".webgl-globe")),E.globeWebGL.scenes.globe=new Ew,E.rocksWebGL=new FR(st(".webgl-rocks")),E.rocksWebGL.scenes.rocks=new NR}}var ru={};/*!
 *  howler.js v2.2.4
 *  howlerjs.com
 *
 *  (c) 2013-2020, James Simpson of GoldFire Studios
 *  goldfirestudios.com
 *
 *  MIT License
 */(function(r){(function(){var e=function(){this.init()};e.prototype={init:function(){var c=this||t;return c._counter=1e3,c._html5AudioPool=[],c.html5PoolSize=10,c._codecs={},c._howls=[],c._muted=!1,c._volume=1,c._canPlayEvent="canplaythrough",c._navigator=typeof window<"u"&&window.navigator?window.navigator:null,c.masterGain=null,c.noAudio=!1,c.usingWebAudio=!0,c.autoSuspend=!0,c.ctx=null,c.autoUnlock=!0,c._setup(),c},volume:function(c){var d=this||t;if(c=parseFloat(c),d.ctx||f(),typeof c<"u"&&c>=0&&c<=1){if(d._volume=c,d._muted)return d;d.usingWebAudio&&d.masterGain.gain.setValueAtTime(c,t.ctx.currentTime);for(var m=0;m<d._howls.length;m++)if(!d._howls[m]._webAudio)for(var x=d._howls[m]._getSoundIds(),_=0;_<x.length;_++){var b=d._howls[m]._soundById(x[_]);b&&b._node&&(b._node.volume=b._volume*c)}return d}return d._volume},mute:function(c){var d=this||t;d.ctx||f(),d._muted=c,d.usingWebAudio&&d.masterGain.gain.setValueAtTime(c?0:d._volume,t.ctx.currentTime);for(var m=0;m<d._howls.length;m++)if(!d._howls[m]._webAudio)for(var x=d._howls[m]._getSoundIds(),_=0;_<x.length;_++){var b=d._howls[m]._soundById(x[_]);b&&b._node&&(b._node.muted=c?!0:b._muted)}return d},stop:function(){for(var c=this||t,d=0;d<c._howls.length;d++)c._howls[d].stop();return c},unload:function(){for(var c=this||t,d=c._howls.length-1;d>=0;d--)c._howls[d].unload();return c.usingWebAudio&&c.ctx&&typeof c.ctx.close<"u"&&(c.ctx.close(),c.ctx=null,f()),c},codecs:function(c){return(this||t)._codecs[c.replace(/^x-/,"")]},_setup:function(){var c=this||t;if(c.state=c.ctx&&c.ctx.state||"suspended",c._autoSuspend(),!c.usingWebAudio)if(typeof Audio<"u")try{var d=new Audio;typeof d.oncanplaythrough>"u"&&(c._canPlayEvent="canplay")}catch{c.noAudio=!0}else c.noAudio=!0;try{var d=new Audio;d.muted&&(c.noAudio=!0)}catch{}return c.noAudio||c._setupCodecs(),c},_setupCodecs:function(){var c=this||t,d=null;try{d=typeof Audio<"u"?new Audio:null}catch{return c}if(!d||typeof d.canPlayType!="function")return c;var m=d.canPlayType("audio/mpeg;").replace(/^no$/,""),x=c._navigator?c._navigator.userAgent:"",_=x.match(/OPR\/(\d+)/g),b=_&&parseInt(_[0].split("/")[1],10)<33,y=x.indexOf("Safari")!==-1&&x.indexOf("Chrome")===-1,M=x.match(/Version\/(.*?) /),D=y&&M&&parseInt(M[1],10)<15;return c._codecs={mp3:!!(!b&&(m||d.canPlayType("audio/mp3;").replace(/^no$/,""))),mpeg:!!m,opus:!!d.canPlayType('audio/ogg; codecs="opus"').replace(/^no$/,""),ogg:!!d.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),oga:!!d.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),wav:!!(d.canPlayType('audio/wav; codecs="1"')||d.canPlayType("audio/wav")).replace(/^no$/,""),aac:!!d.canPlayType("audio/aac;").replace(/^no$/,""),caf:!!d.canPlayType("audio/x-caf;").replace(/^no$/,""),m4a:!!(d.canPlayType("audio/x-m4a;")||d.canPlayType("audio/m4a;")||d.canPlayType("audio/aac;")).replace(/^no$/,""),m4b:!!(d.canPlayType("audio/x-m4b;")||d.canPlayType("audio/m4b;")||d.canPlayType("audio/aac;")).replace(/^no$/,""),mp4:!!(d.canPlayType("audio/x-mp4;")||d.canPlayType("audio/mp4;")||d.canPlayType("audio/aac;")).replace(/^no$/,""),weba:!!(!D&&d.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,"")),webm:!!(!D&&d.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,"")),dolby:!!d.canPlayType('audio/mp4; codecs="ec-3"').replace(/^no$/,""),flac:!!(d.canPlayType("audio/x-flac;")||d.canPlayType("audio/flac;")).replace(/^no$/,"")},c},_unlockAudio:function(){var c=this||t;if(!(c._audioUnlocked||!c.ctx)){c._audioUnlocked=!1,c.autoUnlock=!1,!c._mobileUnloaded&&c.ctx.sampleRate!==44100&&(c._mobileUnloaded=!0,c.unload()),c._scratchBuffer=c.ctx.createBuffer(1,1,22050);var d=function(m){for(;c._html5AudioPool.length<c.html5PoolSize;)try{var x=new Audio;x._unlocked=!0,c._releaseHtml5Audio(x)}catch{c.noAudio=!0;break}for(var _=0;_<c._howls.length;_++)if(!c._howls[_]._webAudio)for(var b=c._howls[_]._getSoundIds(),y=0;y<b.length;y++){var M=c._howls[_]._soundById(b[y]);M&&M._node&&!M._node._unlocked&&(M._node._unlocked=!0,M._node.load())}c._autoResume();var D=c.ctx.createBufferSource();D.buffer=c._scratchBuffer,D.connect(c.ctx.destination),typeof D.start>"u"?D.noteOn(0):D.start(0),typeof c.ctx.resume=="function"&&c.ctx.resume(),D.onended=function(){D.disconnect(0),c._audioUnlocked=!0,document.removeEventListener("touchstart",d,!0),document.removeEventListener("touchend",d,!0),document.removeEventListener("click",d,!0),document.removeEventListener("keydown",d,!0);for(var C=0;C<c._howls.length;C++)c._howls[C]._emit("unlock")}};return document.addEventListener("touchstart",d,!0),document.addEventListener("touchend",d,!0),document.addEventListener("click",d,!0),document.addEventListener("keydown",d,!0),c}},_obtainHtml5Audio:function(){var c=this||t;if(c._html5AudioPool.length)return c._html5AudioPool.pop();var d=new Audio().play();return d&&typeof Promise<"u"&&(d instanceof Promise||typeof d.then=="function")&&d.catch(function(){console.warn("HTML5 Audio pool exhausted, returning potentially locked audio object.")}),new Audio},_releaseHtml5Audio:function(c){var d=this||t;return c._unlocked&&d._html5AudioPool.push(c),d},_autoSuspend:function(){var c=this;if(!(!c.autoSuspend||!c.ctx||typeof c.ctx.suspend>"u"||!t.usingWebAudio)){for(var d=0;d<c._howls.length;d++)if(c._howls[d]._webAudio){for(var m=0;m<c._howls[d]._sounds.length;m++)if(!c._howls[d]._sounds[m]._paused)return c}return c._suspendTimer&&clearTimeout(c._suspendTimer),c._suspendTimer=setTimeout(function(){if(c.autoSuspend){c._suspendTimer=null,c.state="suspending";var x=function(){c.state="suspended",c._resumeAfterSuspend&&(delete c._resumeAfterSuspend,c._autoResume())};c.ctx.suspend().then(x,x)}},3e4),c}},_autoResume:function(){var c=this;if(!(!c.ctx||typeof c.ctx.resume>"u"||!t.usingWebAudio))return c.state==="running"&&c.ctx.state!=="interrupted"&&c._suspendTimer?(clearTimeout(c._suspendTimer),c._suspendTimer=null):c.state==="suspended"||c.state==="running"&&c.ctx.state==="interrupted"?(c.ctx.resume().then(function(){c.state="running";for(var d=0;d<c._howls.length;d++)c._howls[d]._emit("resume")}),c._suspendTimer&&(clearTimeout(c._suspendTimer),c._suspendTimer=null)):c.state==="suspending"&&(c._resumeAfterSuspend=!0),c}};var t=new e,i=function(c){var d=this;if(!c.src||c.src.length===0){console.error("An array of source files must be passed with any new Howl.");return}d.init(c)};i.prototype={init:function(c){var d=this;return t.ctx||f(),d._autoplay=c.autoplay||!1,d._format=typeof c.format!="string"?c.format:[c.format],d._html5=c.html5||!1,d._muted=c.mute||!1,d._loop=c.loop||!1,d._pool=c.pool||5,d._preload=typeof c.preload=="boolean"||c.preload==="metadata"?c.preload:!0,d._rate=c.rate||1,d._sprite=c.sprite||{},d._src=typeof c.src!="string"?c.src:[c.src],d._volume=c.volume!==void 0?c.volume:1,d._xhr={method:c.xhr&&c.xhr.method?c.xhr.method:"GET",headers:c.xhr&&c.xhr.headers?c.xhr.headers:null,withCredentials:c.xhr&&c.xhr.withCredentials?c.xhr.withCredentials:!1},d._duration=0,d._state="unloaded",d._sounds=[],d._endTimers={},d._queue=[],d._playLock=!1,d._onend=c.onend?[{fn:c.onend}]:[],d._onfade=c.onfade?[{fn:c.onfade}]:[],d._onload=c.onload?[{fn:c.onload}]:[],d._onloaderror=c.onloaderror?[{fn:c.onloaderror}]:[],d._onplayerror=c.onplayerror?[{fn:c.onplayerror}]:[],d._onpause=c.onpause?[{fn:c.onpause}]:[],d._onplay=c.onplay?[{fn:c.onplay}]:[],d._onstop=c.onstop?[{fn:c.onstop}]:[],d._onmute=c.onmute?[{fn:c.onmute}]:[],d._onvolume=c.onvolume?[{fn:c.onvolume}]:[],d._onrate=c.onrate?[{fn:c.onrate}]:[],d._onseek=c.onseek?[{fn:c.onseek}]:[],d._onunlock=c.onunlock?[{fn:c.onunlock}]:[],d._onresume=[],d._webAudio=t.usingWebAudio&&!d._html5,typeof t.ctx<"u"&&t.ctx&&t.autoUnlock&&t._unlockAudio(),t._howls.push(d),d._autoplay&&d._queue.push({event:"play",action:function(){d.play()}}),d._preload&&d._preload!=="none"&&d.load(),d},load:function(){var c=this,d=null;if(t.noAudio){c._emit("loaderror",null,"No audio support.");return}typeof c._src=="string"&&(c._src=[c._src]);for(var m=0;m<c._src.length;m++){var x,_;if(c._format&&c._format[m])x=c._format[m];else{if(_=c._src[m],typeof _!="string"){c._emit("loaderror",null,"Non-string found in selected audio sources - ignoring.");continue}x=/^data:audio\/([^;,]+);/i.exec(_),x||(x=/\.([^.]+)$/.exec(_.split("?",1)[0])),x&&(x=x[1].toLowerCase())}if(x||console.warn('No file extension was found. Consider using the "format" property or specify an extension.'),x&&t.codecs(x)){d=c._src[m];break}}if(!d){c._emit("loaderror",null,"No codec support for selected audio sources.");return}return c._src=d,c._state="loading",window.location.protocol==="https:"&&d.slice(0,5)==="http:"&&(c._html5=!0,c._webAudio=!1),new n(c),c._webAudio&&a(c),c},play:function(c,d){var m=this,x=null;if(typeof c=="number")x=c,c=null;else{if(typeof c=="string"&&m._state==="loaded"&&!m._sprite[c])return null;if(typeof c>"u"&&(c="__default",!m._playLock)){for(var _=0,b=0;b<m._sounds.length;b++)m._sounds[b]._paused&&!m._sounds[b]._ended&&(_++,x=m._sounds[b]._id);_===1?c=null:x=null}}var y=x?m._soundById(x):m._inactiveSound();if(!y)return null;if(x&&!c&&(c=y._sprite||"__default"),m._state!=="loaded"){y._sprite=c,y._ended=!1;var M=y._id;return m._queue.push({event:"play",action:function(){m.play(M)}}),M}if(x&&!y._paused)return d||m._loadQueue("play"),y._id;m._webAudio&&t._autoResume();var D=Math.max(0,y._seek>0?y._seek:m._sprite[c][0]/1e3),C=Math.max(0,(m._sprite[c][0]+m._sprite[c][1])/1e3-D),P=C*1e3/Math.abs(y._rate),I=m._sprite[c][0]/1e3,F=(m._sprite[c][0]+m._sprite[c][1])/1e3;y._sprite=c,y._ended=!1;var A=function(){y._paused=!1,y._seek=D,y._start=I,y._stop=F,y._loop=!!(y._loop||m._sprite[c][2])};if(D>=F){m._ended(y);return}var k=y._node;if(m._webAudio){var O=function(){m._playLock=!1,A(),m._refreshBuffer(y);var j=y._muted||m._muted?0:y._volume;k.gain.setValueAtTime(j,t.ctx.currentTime),y._playStart=t.ctx.currentTime,typeof k.bufferSource.start>"u"?y._loop?k.bufferSource.noteGrainOn(0,D,86400):k.bufferSource.noteGrainOn(0,D,C):y._loop?k.bufferSource.start(0,D,86400):k.bufferSource.start(0,D,C),P!==1/0&&(m._endTimers[y._id]=setTimeout(m._ended.bind(m,y),P)),d||setTimeout(function(){m._emit("play",y._id),m._loadQueue()},0)};t.state==="running"&&t.ctx.state!=="interrupted"?O():(m._playLock=!0,m.once("resume",O),m._clearTimer(y._id))}else{var J=function(){k.currentTime=D,k.muted=y._muted||m._muted||t._muted||k.muted,k.volume=y._volume*t.volume(),k.playbackRate=y._rate;try{var j=k.play();if(j&&typeof Promise<"u"&&(j instanceof Promise||typeof j.then=="function")?(m._playLock=!0,A(),j.then(function(){m._playLock=!1,k._unlocked=!0,d?m._loadQueue():m._emit("play",y._id)}).catch(function(){m._playLock=!1,m._emit("playerror",y._id,"Playback was unable to start. This is most commonly an issue on mobile devices and Chrome where playback was not within a user interaction."),y._ended=!0,y._paused=!0})):d||(m._playLock=!1,A(),m._emit("play",y._id)),k.playbackRate=y._rate,k.paused){m._emit("playerror",y._id,"Playback was unable to start. This is most commonly an issue on mobile devices and Chrome where playback was not within a user interaction.");return}c!=="__default"||y._loop?m._endTimers[y._id]=setTimeout(m._ended.bind(m,y),P):(m._endTimers[y._id]=function(){m._ended(y),k.removeEventListener("ended",m._endTimers[y._id],!1)},k.addEventListener("ended",m._endTimers[y._id],!1))}catch(K){m._emit("playerror",y._id,K)}};k.src==="data:audio/wav;base64,UklGRigAAABXQVZFZm10IBIAAAABAAEARKwAAIhYAQACABAAAABkYXRhAgAAAAEA"&&(k.src=m._src,k.load());var Q=window&&window.ejecta||!k.readyState&&t._navigator.isCocoonJS;if(k.readyState>=3||Q)J();else{m._playLock=!0,m._state="loading";var X=function(){m._state="loaded",J(),k.removeEventListener(t._canPlayEvent,X,!1)};k.addEventListener(t._canPlayEvent,X,!1),m._clearTimer(y._id)}}return y._id},pause:function(c){var d=this;if(d._state!=="loaded"||d._playLock)return d._queue.push({event:"pause",action:function(){d.pause(c)}}),d;for(var m=d._getSoundIds(c),x=0;x<m.length;x++){d._clearTimer(m[x]);var _=d._soundById(m[x]);if(_&&!_._paused&&(_._seek=d.seek(m[x]),_._rateSeek=0,_._paused=!0,d._stopFade(m[x]),_._node))if(d._webAudio){if(!_._node.bufferSource)continue;typeof _._node.bufferSource.stop>"u"?_._node.bufferSource.noteOff(0):_._node.bufferSource.stop(0),d._cleanBuffer(_._node)}else(!isNaN(_._node.duration)||_._node.duration===1/0)&&_._node.pause();arguments[1]||d._emit("pause",_?_._id:null)}return d},stop:function(c,d){var m=this;if(m._state!=="loaded"||m._playLock)return m._queue.push({event:"stop",action:function(){m.stop(c)}}),m;for(var x=m._getSoundIds(c),_=0;_<x.length;_++){m._clearTimer(x[_]);var b=m._soundById(x[_]);b&&(b._seek=b._start||0,b._rateSeek=0,b._paused=!0,b._ended=!0,m._stopFade(x[_]),b._node&&(m._webAudio?b._node.bufferSource&&(typeof b._node.bufferSource.stop>"u"?b._node.bufferSource.noteOff(0):b._node.bufferSource.stop(0),m._cleanBuffer(b._node)):(!isNaN(b._node.duration)||b._node.duration===1/0)&&(b._node.currentTime=b._start||0,b._node.pause(),b._node.duration===1/0&&m._clearSound(b._node))),d||m._emit("stop",b._id))}return m},mute:function(c,d){var m=this;if(m._state!=="loaded"||m._playLock)return m._queue.push({event:"mute",action:function(){m.mute(c,d)}}),m;if(typeof d>"u")if(typeof c=="boolean")m._muted=c;else return m._muted;for(var x=m._getSoundIds(d),_=0;_<x.length;_++){var b=m._soundById(x[_]);b&&(b._muted=c,b._interval&&m._stopFade(b._id),m._webAudio&&b._node?b._node.gain.setValueAtTime(c?0:b._volume,t.ctx.currentTime):b._node&&(b._node.muted=t._muted?!0:c),m._emit("mute",b._id))}return m},volume:function(){var c=this,d=arguments,m,x;if(d.length===0)return c._volume;if(d.length===1||d.length===2&&typeof d[1]>"u"){var _=c._getSoundIds(),b=_.indexOf(d[0]);b>=0?x=parseInt(d[0],10):m=parseFloat(d[0])}else d.length>=2&&(m=parseFloat(d[0]),x=parseInt(d[1],10));var y;if(typeof m<"u"&&m>=0&&m<=1){if(c._state!=="loaded"||c._playLock)return c._queue.push({event:"volume",action:function(){c.volume.apply(c,d)}}),c;typeof x>"u"&&(c._volume=m),x=c._getSoundIds(x);for(var M=0;M<x.length;M++)y=c._soundById(x[M]),y&&(y._volume=m,d[2]||c._stopFade(x[M]),c._webAudio&&y._node&&!y._muted?y._node.gain.setValueAtTime(m,t.ctx.currentTime):y._node&&!y._muted&&(y._node.volume=m*t.volume()),c._emit("volume",y._id))}else return y=x?c._soundById(x):c._sounds[0],y?y._volume:0;return c},fade:function(c,d,m,x){var _=this;if(_._state!=="loaded"||_._playLock)return _._queue.push({event:"fade",action:function(){_.fade(c,d,m,x)}}),_;c=Math.min(Math.max(0,parseFloat(c)),1),d=Math.min(Math.max(0,parseFloat(d)),1),m=parseFloat(m),_.volume(c,x);for(var b=_._getSoundIds(x),y=0;y<b.length;y++){var M=_._soundById(b[y]);if(M){if(x||_._stopFade(b[y]),_._webAudio&&!M._muted){var D=t.ctx.currentTime,C=D+m/1e3;M._volume=c,M._node.gain.setValueAtTime(c,D),M._node.gain.linearRampToValueAtTime(d,C)}_._startFadeInterval(M,c,d,m,b[y],typeof x>"u")}}return _},_startFadeInterval:function(c,d,m,x,_,b){var y=this,M=d,D=m-d,C=Math.abs(D/.01),P=Math.max(4,C>0?x/C:x),I=Date.now();c._fadeTo=m,c._interval=setInterval(function(){var F=(Date.now()-I)/x;I=Date.now(),M+=D*F,M=Math.round(M*100)/100,D<0?M=Math.max(m,M):M=Math.min(m,M),y._webAudio?c._volume=M:y.volume(M,c._id,!0),b&&(y._volume=M),(m<d&&M<=m||m>d&&M>=m)&&(clearInterval(c._interval),c._interval=null,c._fadeTo=null,y.volume(m,c._id),y._emit("fade",c._id))},P)},_stopFade:function(c){var d=this,m=d._soundById(c);return m&&m._interval&&(d._webAudio&&m._node.gain.cancelScheduledValues(t.ctx.currentTime),clearInterval(m._interval),m._interval=null,d.volume(m._fadeTo,c),m._fadeTo=null,d._emit("fade",c)),d},loop:function(){var c=this,d=arguments,m,x,_;if(d.length===0)return c._loop;if(d.length===1)if(typeof d[0]=="boolean")m=d[0],c._loop=m;else return _=c._soundById(parseInt(d[0],10)),_?_._loop:!1;else d.length===2&&(m=d[0],x=parseInt(d[1],10));for(var b=c._getSoundIds(x),y=0;y<b.length;y++)_=c._soundById(b[y]),_&&(_._loop=m,c._webAudio&&_._node&&_._node.bufferSource&&(_._node.bufferSource.loop=m,m&&(_._node.bufferSource.loopStart=_._start||0,_._node.bufferSource.loopEnd=_._stop,c.playing(b[y])&&(c.pause(b[y],!0),c.play(b[y],!0)))));return c},rate:function(){var c=this,d=arguments,m,x;if(d.length===0)x=c._sounds[0]._id;else if(d.length===1){var _=c._getSoundIds(),b=_.indexOf(d[0]);b>=0?x=parseInt(d[0],10):m=parseFloat(d[0])}else d.length===2&&(m=parseFloat(d[0]),x=parseInt(d[1],10));var y;if(typeof m=="number"){if(c._state!=="loaded"||c._playLock)return c._queue.push({event:"rate",action:function(){c.rate.apply(c,d)}}),c;typeof x>"u"&&(c._rate=m),x=c._getSoundIds(x);for(var M=0;M<x.length;M++)if(y=c._soundById(x[M]),y){c.playing(x[M])&&(y._rateSeek=c.seek(x[M]),y._playStart=c._webAudio?t.ctx.currentTime:y._playStart),y._rate=m,c._webAudio&&y._node&&y._node.bufferSource?y._node.bufferSource.playbackRate.setValueAtTime(m,t.ctx.currentTime):y._node&&(y._node.playbackRate=m);var D=c.seek(x[M]),C=(c._sprite[y._sprite][0]+c._sprite[y._sprite][1])/1e3-D,P=C*1e3/Math.abs(y._rate);(c._endTimers[x[M]]||!y._paused)&&(c._clearTimer(x[M]),c._endTimers[x[M]]=setTimeout(c._ended.bind(c,y),P)),c._emit("rate",y._id)}}else return y=c._soundById(x),y?y._rate:c._rate;return c},seek:function(){var c=this,d=arguments,m,x;if(d.length===0)c._sounds.length&&(x=c._sounds[0]._id);else if(d.length===1){var _=c._getSoundIds(),b=_.indexOf(d[0]);b>=0?x=parseInt(d[0],10):c._sounds.length&&(x=c._sounds[0]._id,m=parseFloat(d[0]))}else d.length===2&&(m=parseFloat(d[0]),x=parseInt(d[1],10));if(typeof x>"u")return 0;if(typeof m=="number"&&(c._state!=="loaded"||c._playLock))return c._queue.push({event:"seek",action:function(){c.seek.apply(c,d)}}),c;var y=c._soundById(x);if(y)if(typeof m=="number"&&m>=0){var M=c.playing(x);M&&c.pause(x,!0),y._seek=m,y._ended=!1,c._clearTimer(x),!c._webAudio&&y._node&&!isNaN(y._node.duration)&&(y._node.currentTime=m);var D=function(){M&&c.play(x,!0),c._emit("seek",x)};if(M&&!c._webAudio){var C=function(){c._playLock?setTimeout(C,0):D()};setTimeout(C,0)}else D()}else if(c._webAudio){var P=c.playing(x)?t.ctx.currentTime-y._playStart:0,I=y._rateSeek?y._rateSeek-y._seek:0;return y._seek+(I+P*Math.abs(y._rate))}else return y._node.currentTime;return c},playing:function(c){var d=this;if(typeof c=="number"){var m=d._soundById(c);return m?!m._paused:!1}for(var x=0;x<d._sounds.length;x++)if(!d._sounds[x]._paused)return!0;return!1},duration:function(c){var d=this,m=d._duration,x=d._soundById(c);return x&&(m=d._sprite[x._sprite][1]/1e3),m},state:function(){return this._state},unload:function(){for(var c=this,d=c._sounds,m=0;m<d.length;m++)d[m]._paused||c.stop(d[m]._id),c._webAudio||(c._clearSound(d[m]._node),d[m]._node.removeEventListener("error",d[m]._errorFn,!1),d[m]._node.removeEventListener(t._canPlayEvent,d[m]._loadFn,!1),d[m]._node.removeEventListener("ended",d[m]._endFn,!1),t._releaseHtml5Audio(d[m]._node)),delete d[m]._node,c._clearTimer(d[m]._id);var x=t._howls.indexOf(c);x>=0&&t._howls.splice(x,1);var _=!0;for(m=0;m<t._howls.length;m++)if(t._howls[m]._src===c._src||c._src.indexOf(t._howls[m]._src)>=0){_=!1;break}return s&&_&&delete s[c._src],t.noAudio=!1,c._state="unloaded",c._sounds=[],c=null,null},on:function(c,d,m,x){var _=this,b=_["_on"+c];return typeof d=="function"&&b.push(x?{id:m,fn:d,once:x}:{id:m,fn:d}),_},off:function(c,d,m){var x=this,_=x["_on"+c],b=0;if(typeof d=="number"&&(m=d,d=null),d||m)for(b=0;b<_.length;b++){var y=m===_[b].id;if(d===_[b].fn&&y||!d&&y){_.splice(b,1);break}}else if(c)x["_on"+c]=[];else{var M=Object.keys(x);for(b=0;b<M.length;b++)M[b].indexOf("_on")===0&&Array.isArray(x[M[b]])&&(x[M[b]]=[])}return x},once:function(c,d,m){var x=this;return x.on(c,d,m,1),x},_emit:function(c,d,m){for(var x=this,_=x["_on"+c],b=_.length-1;b>=0;b--)(!_[b].id||_[b].id===d||c==="load")&&(setTimeout((function(y){y.call(this,d,m)}).bind(x,_[b].fn),0),_[b].once&&x.off(c,_[b].fn,_[b].id));return x._loadQueue(c),x},_loadQueue:function(c){var d=this;if(d._queue.length>0){var m=d._queue[0];m.event===c&&(d._queue.shift(),d._loadQueue()),c||m.action()}return d},_ended:function(c){var d=this,m=c._sprite;if(!d._webAudio&&c._node&&!c._node.paused&&!c._node.ended&&c._node.currentTime<c._stop)return setTimeout(d._ended.bind(d,c),100),d;var x=!!(c._loop||d._sprite[m][2]);if(d._emit("end",c._id),!d._webAudio&&x&&d.stop(c._id,!0).play(c._id),d._webAudio&&x){d._emit("play",c._id),c._seek=c._start||0,c._rateSeek=0,c._playStart=t.ctx.currentTime;var _=(c._stop-c._start)*1e3/Math.abs(c._rate);d._endTimers[c._id]=setTimeout(d._ended.bind(d,c),_)}return d._webAudio&&!x&&(c._paused=!0,c._ended=!0,c._seek=c._start||0,c._rateSeek=0,d._clearTimer(c._id),d._cleanBuffer(c._node),t._autoSuspend()),!d._webAudio&&!x&&d.stop(c._id,!0),d},_clearTimer:function(c){var d=this;if(d._endTimers[c]){if(typeof d._endTimers[c]!="function")clearTimeout(d._endTimers[c]);else{var m=d._soundById(c);m&&m._node&&m._node.removeEventListener("ended",d._endTimers[c],!1)}delete d._endTimers[c]}return d},_soundById:function(c){for(var d=this,m=0;m<d._sounds.length;m++)if(c===d._sounds[m]._id)return d._sounds[m];return null},_inactiveSound:function(){var c=this;c._drain();for(var d=0;d<c._sounds.length;d++)if(c._sounds[d]._ended)return c._sounds[d].reset();return new n(c)},_drain:function(){var c=this,d=c._pool,m=0,x=0;if(!(c._sounds.length<d)){for(x=0;x<c._sounds.length;x++)c._sounds[x]._ended&&m++;for(x=c._sounds.length-1;x>=0;x--){if(m<=d)return;c._sounds[x]._ended&&(c._webAudio&&c._sounds[x]._node&&c._sounds[x]._node.disconnect(0),c._sounds.splice(x,1),m--)}}},_getSoundIds:function(c){var d=this;if(typeof c>"u"){for(var m=[],x=0;x<d._sounds.length;x++)m.push(d._sounds[x]._id);return m}else return[c]},_refreshBuffer:function(c){var d=this;return c._node.bufferSource=t.ctx.createBufferSource(),c._node.bufferSource.buffer=s[d._src],c._panner?c._node.bufferSource.connect(c._panner):c._node.bufferSource.connect(c._node),c._node.bufferSource.loop=c._loop,c._loop&&(c._node.bufferSource.loopStart=c._start||0,c._node.bufferSource.loopEnd=c._stop||0),c._node.bufferSource.playbackRate.setValueAtTime(c._rate,t.ctx.currentTime),d},_cleanBuffer:function(c){var d=this,m=t._navigator&&t._navigator.vendor.indexOf("Apple")>=0;if(!c.bufferSource)return d;if(t._scratchBuffer&&c.bufferSource&&(c.bufferSource.onended=null,c.bufferSource.disconnect(0),m))try{c.bufferSource.buffer=t._scratchBuffer}catch{}return c.bufferSource=null,d},_clearSound:function(c){var d=/MSIE |Trident\//.test(t._navigator&&t._navigator.userAgent);d||(c.src="data:audio/wav;base64,UklGRigAAABXQVZFZm10IBIAAAABAAEARKwAAIhYAQACABAAAABkYXRhAgAAAAEA")}};var n=function(c){this._parent=c,this.init()};n.prototype={init:function(){var c=this,d=c._parent;return c._muted=d._muted,c._loop=d._loop,c._volume=d._volume,c._rate=d._rate,c._seek=0,c._paused=!0,c._ended=!0,c._sprite="__default",c._id=++t._counter,d._sounds.push(c),c.create(),c},create:function(){var c=this,d=c._parent,m=t._muted||c._muted||c._parent._muted?0:c._volume;return d._webAudio?(c._node=typeof t.ctx.createGain>"u"?t.ctx.createGainNode():t.ctx.createGain(),c._node.gain.setValueAtTime(m,t.ctx.currentTime),c._node.paused=!0,c._node.connect(t.masterGain)):t.noAudio||(c._node=t._obtainHtml5Audio(),c._errorFn=c._errorListener.bind(c),c._node.addEventListener("error",c._errorFn,!1),c._loadFn=c._loadListener.bind(c),c._node.addEventListener(t._canPlayEvent,c._loadFn,!1),c._endFn=c._endListener.bind(c),c._node.addEventListener("ended",c._endFn,!1),c._node.src=d._src,c._node.preload=d._preload===!0?"auto":d._preload,c._node.volume=m*t.volume(),c._node.load()),c},reset:function(){var c=this,d=c._parent;return c._muted=d._muted,c._loop=d._loop,c._volume=d._volume,c._rate=d._rate,c._seek=0,c._rateSeek=0,c._paused=!0,c._ended=!0,c._sprite="__default",c._id=++t._counter,c},_errorListener:function(){var c=this;c._parent._emit("loaderror",c._id,c._node.error?c._node.error.code:0),c._node.removeEventListener("error",c._errorFn,!1)},_loadListener:function(){var c=this,d=c._parent;d._duration=Math.ceil(c._node.duration*10)/10,Object.keys(d._sprite).length===0&&(d._sprite={__default:[0,d._duration*1e3]}),d._state!=="loaded"&&(d._state="loaded",d._emit("load"),d._loadQueue()),c._node.removeEventListener(t._canPlayEvent,c._loadFn,!1)},_endListener:function(){var c=this,d=c._parent;d._duration===1/0&&(d._duration=Math.ceil(c._node.duration*10)/10,d._sprite.__default[1]===1/0&&(d._sprite.__default[1]=d._duration*1e3),d._ended(c)),c._node.removeEventListener("ended",c._endFn,!1)}};var s={},a=function(c){var d=c._src;if(s[d]){c._duration=s[d].duration,h(c);return}if(/^data:[^;]+;base64,/.test(d)){for(var m=atob(d.split(",")[1]),x=new Uint8Array(m.length),_=0;_<m.length;++_)x[_]=m.charCodeAt(_);u(x.buffer,c)}else{var b=new XMLHttpRequest;b.open(c._xhr.method,d,!0),b.withCredentials=c._xhr.withCredentials,b.responseType="arraybuffer",c._xhr.headers&&Object.keys(c._xhr.headers).forEach(function(y){b.setRequestHeader(y,c._xhr.headers[y])}),b.onload=function(){var y=(b.status+"")[0];if(y!=="0"&&y!=="2"&&y!=="3"){c._emit("loaderror",null,"Failed loading audio file with status: "+b.status+".");return}u(b.response,c)},b.onerror=function(){c._webAudio&&(c._html5=!0,c._webAudio=!1,c._sounds=[],delete s[d],c.load())},o(b)}},o=function(c){try{c.send()}catch{c.onerror()}},u=function(c,d){var m=function(){d._emit("loaderror",null,"Decoding audio data failed.")},x=function(_){_&&d._sounds.length>0?(s[d._src]=_,h(d,_)):m()};typeof Promise<"u"&&t.ctx.decodeAudioData.length===1?t.ctx.decodeAudioData(c).then(x).catch(m):t.ctx.decodeAudioData(c,x,m)},h=function(c,d){d&&!c._duration&&(c._duration=d.duration),Object.keys(c._sprite).length===0&&(c._sprite={__default:[0,c._duration*1e3]}),c._state!=="loaded"&&(c._state="loaded",c._emit("load"),c._loadQueue())},f=function(){if(t.usingWebAudio){try{typeof AudioContext<"u"?t.ctx=new AudioContext:typeof webkitAudioContext<"u"?t.ctx=new webkitAudioContext:t.usingWebAudio=!1}catch{t.usingWebAudio=!1}t.ctx||(t.usingWebAudio=!1);var c=/iP(hone|od|ad)/.test(t._navigator&&t._navigator.platform),d=t._navigator&&t._navigator.appVersion.match(/OS (\d+)_(\d+)_?(\d+)?/),m=d?parseInt(d[1],10):null;if(c&&m&&m<9){var x=/safari/.test(t._navigator&&t._navigator.userAgent.toLowerCase());t._navigator&&!x&&(t.usingWebAudio=!1)}t.usingWebAudio&&(t.masterGain=typeof t.ctx.createGain>"u"?t.ctx.createGainNode():t.ctx.createGain(),t.masterGain.gain.setValueAtTime(t._muted?0:t._volume,t.ctx.currentTime),t.masterGain.connect(t.ctx.destination)),t._setup()}};r.Howler=t,r.Howl=i,typeof Ao<"u"?(Ao.HowlerGlobal=e,Ao.Howler=t,Ao.Howl=i,Ao.Sound=n):typeof window<"u"&&(window.HowlerGlobal=e,window.Howler=t,window.Howl=i,window.Sound=n)})();/*!
 *  Spatial Plugin - Adds support for stereo and 3D audio where Web Audio is supported.
 *  
 *  howler.js v2.2.4
 *  howlerjs.com
 *
 *  (c) 2013-2020, James Simpson of GoldFire Studios
 *  goldfirestudios.com
 *
 *  MIT License
 */(function(){HowlerGlobal.prototype._pos=[0,0,0],HowlerGlobal.prototype._orientation=[0,0,-1,0,1,0],HowlerGlobal.prototype.stereo=function(t){var i=this;if(!i.ctx||!i.ctx.listener)return i;for(var n=i._howls.length-1;n>=0;n--)i._howls[n].stereo(t);return i},HowlerGlobal.prototype.pos=function(t,i,n){var s=this;if(!s.ctx||!s.ctx.listener)return s;if(i=typeof i!="number"?s._pos[1]:i,n=typeof n!="number"?s._pos[2]:n,typeof t=="number")s._pos=[t,i,n],typeof s.ctx.listener.positionX<"u"?(s.ctx.listener.positionX.setTargetAtTime(s._pos[0],Howler.ctx.currentTime,.1),s.ctx.listener.positionY.setTargetAtTime(s._pos[1],Howler.ctx.currentTime,.1),s.ctx.listener.positionZ.setTargetAtTime(s._pos[2],Howler.ctx.currentTime,.1)):s.ctx.listener.setPosition(s._pos[0],s._pos[1],s._pos[2]);else return s._pos;return s},HowlerGlobal.prototype.orientation=function(t,i,n,s,a,o){var u=this;if(!u.ctx||!u.ctx.listener)return u;var h=u._orientation;if(i=typeof i!="number"?h[1]:i,n=typeof n!="number"?h[2]:n,s=typeof s!="number"?h[3]:s,a=typeof a!="number"?h[4]:a,o=typeof o!="number"?h[5]:o,typeof t=="number")u._orientation=[t,i,n,s,a,o],typeof u.ctx.listener.forwardX<"u"?(u.ctx.listener.forwardX.setTargetAtTime(t,Howler.ctx.currentTime,.1),u.ctx.listener.forwardY.setTargetAtTime(i,Howler.ctx.currentTime,.1),u.ctx.listener.forwardZ.setTargetAtTime(n,Howler.ctx.currentTime,.1),u.ctx.listener.upX.setTargetAtTime(s,Howler.ctx.currentTime,.1),u.ctx.listener.upY.setTargetAtTime(a,Howler.ctx.currentTime,.1),u.ctx.listener.upZ.setTargetAtTime(o,Howler.ctx.currentTime,.1)):u.ctx.listener.setOrientation(t,i,n,s,a,o);else return h;return u},Howl.prototype.init=function(t){return function(i){var n=this;return n._orientation=i.orientation||[1,0,0],n._stereo=i.stereo||null,n._pos=i.pos||null,n._pannerAttr={coneInnerAngle:typeof i.coneInnerAngle<"u"?i.coneInnerAngle:360,coneOuterAngle:typeof i.coneOuterAngle<"u"?i.coneOuterAngle:360,coneOuterGain:typeof i.coneOuterGain<"u"?i.coneOuterGain:0,distanceModel:typeof i.distanceModel<"u"?i.distanceModel:"inverse",maxDistance:typeof i.maxDistance<"u"?i.maxDistance:1e4,panningModel:typeof i.panningModel<"u"?i.panningModel:"HRTF",refDistance:typeof i.refDistance<"u"?i.refDistance:1,rolloffFactor:typeof i.rolloffFactor<"u"?i.rolloffFactor:1},n._onstereo=i.onstereo?[{fn:i.onstereo}]:[],n._onpos=i.onpos?[{fn:i.onpos}]:[],n._onorientation=i.onorientation?[{fn:i.onorientation}]:[],t.call(this,i)}}(Howl.prototype.init),Howl.prototype.stereo=function(t,i){var n=this;if(!n._webAudio)return n;if(n._state!=="loaded")return n._queue.push({event:"stereo",action:function(){n.stereo(t,i)}}),n;var s=typeof Howler.ctx.createStereoPanner>"u"?"spatial":"stereo";if(typeof i>"u")if(typeof t=="number")n._stereo=t,n._pos=[t,0,0];else return n._stereo;for(var a=n._getSoundIds(i),o=0;o<a.length;o++){var u=n._soundById(a[o]);if(u)if(typeof t=="number")u._stereo=t,u._pos=[t,0,0],u._node&&(u._pannerAttr.panningModel="equalpower",(!u._panner||!u._panner.pan)&&e(u,s),s==="spatial"?typeof u._panner.positionX<"u"?(u._panner.positionX.setValueAtTime(t,Howler.ctx.currentTime),u._panner.positionY.setValueAtTime(0,Howler.ctx.currentTime),u._panner.positionZ.setValueAtTime(0,Howler.ctx.currentTime)):u._panner.setPosition(t,0,0):u._panner.pan.setValueAtTime(t,Howler.ctx.currentTime)),n._emit("stereo",u._id);else return u._stereo}return n},Howl.prototype.pos=function(t,i,n,s){var a=this;if(!a._webAudio)return a;if(a._state!=="loaded")return a._queue.push({event:"pos",action:function(){a.pos(t,i,n,s)}}),a;if(i=typeof i!="number"?0:i,n=typeof n!="number"?-.5:n,typeof s>"u")if(typeof t=="number")a._pos=[t,i,n];else return a._pos;for(var o=a._getSoundIds(s),u=0;u<o.length;u++){var h=a._soundById(o[u]);if(h)if(typeof t=="number")h._pos=[t,i,n],h._node&&((!h._panner||h._panner.pan)&&e(h,"spatial"),typeof h._panner.positionX<"u"?(h._panner.positionX.setValueAtTime(t,Howler.ctx.currentTime),h._panner.positionY.setValueAtTime(i,Howler.ctx.currentTime),h._panner.positionZ.setValueAtTime(n,Howler.ctx.currentTime)):h._panner.setPosition(t,i,n)),a._emit("pos",h._id);else return h._pos}return a},Howl.prototype.orientation=function(t,i,n,s){var a=this;if(!a._webAudio)return a;if(a._state!=="loaded")return a._queue.push({event:"orientation",action:function(){a.orientation(t,i,n,s)}}),a;if(i=typeof i!="number"?a._orientation[1]:i,n=typeof n!="number"?a._orientation[2]:n,typeof s>"u")if(typeof t=="number")a._orientation=[t,i,n];else return a._orientation;for(var o=a._getSoundIds(s),u=0;u<o.length;u++){var h=a._soundById(o[u]);if(h)if(typeof t=="number")h._orientation=[t,i,n],h._node&&(h._panner||(h._pos||(h._pos=a._pos||[0,0,-.5]),e(h,"spatial")),typeof h._panner.orientationX<"u"?(h._panner.orientationX.setValueAtTime(t,Howler.ctx.currentTime),h._panner.orientationY.setValueAtTime(i,Howler.ctx.currentTime),h._panner.orientationZ.setValueAtTime(n,Howler.ctx.currentTime)):h._panner.setOrientation(t,i,n)),a._emit("orientation",h._id);else return h._orientation}return a},Howl.prototype.pannerAttr=function(){var t=this,i=arguments,n,s,a;if(!t._webAudio)return t;if(i.length===0)return t._pannerAttr;if(i.length===1)if(typeof i[0]=="object")n=i[0],typeof s>"u"&&(n.pannerAttr||(n.pannerAttr={coneInnerAngle:n.coneInnerAngle,coneOuterAngle:n.coneOuterAngle,coneOuterGain:n.coneOuterGain,distanceModel:n.distanceModel,maxDistance:n.maxDistance,refDistance:n.refDistance,rolloffFactor:n.rolloffFactor,panningModel:n.panningModel}),t._pannerAttr={coneInnerAngle:typeof n.pannerAttr.coneInnerAngle<"u"?n.pannerAttr.coneInnerAngle:t._coneInnerAngle,coneOuterAngle:typeof n.pannerAttr.coneOuterAngle<"u"?n.pannerAttr.coneOuterAngle:t._coneOuterAngle,coneOuterGain:typeof n.pannerAttr.coneOuterGain<"u"?n.pannerAttr.coneOuterGain:t._coneOuterGain,distanceModel:typeof n.pannerAttr.distanceModel<"u"?n.pannerAttr.distanceModel:t._distanceModel,maxDistance:typeof n.pannerAttr.maxDistance<"u"?n.pannerAttr.maxDistance:t._maxDistance,refDistance:typeof n.pannerAttr.refDistance<"u"?n.pannerAttr.refDistance:t._refDistance,rolloffFactor:typeof n.pannerAttr.rolloffFactor<"u"?n.pannerAttr.rolloffFactor:t._rolloffFactor,panningModel:typeof n.pannerAttr.panningModel<"u"?n.pannerAttr.panningModel:t._panningModel});else return a=t._soundById(parseInt(i[0],10)),a?a._pannerAttr:t._pannerAttr;else i.length===2&&(n=i[0],s=parseInt(i[1],10));for(var o=t._getSoundIds(s),u=0;u<o.length;u++)if(a=t._soundById(o[u]),a){var h=a._pannerAttr;h={coneInnerAngle:typeof n.coneInnerAngle<"u"?n.coneInnerAngle:h.coneInnerAngle,coneOuterAngle:typeof n.coneOuterAngle<"u"?n.coneOuterAngle:h.coneOuterAngle,coneOuterGain:typeof n.coneOuterGain<"u"?n.coneOuterGain:h.coneOuterGain,distanceModel:typeof n.distanceModel<"u"?n.distanceModel:h.distanceModel,maxDistance:typeof n.maxDistance<"u"?n.maxDistance:h.maxDistance,refDistance:typeof n.refDistance<"u"?n.refDistance:h.refDistance,rolloffFactor:typeof n.rolloffFactor<"u"?n.rolloffFactor:h.rolloffFactor,panningModel:typeof n.panningModel<"u"?n.panningModel:h.panningModel};var f=a._panner;f||(a._pos||(a._pos=t._pos||[0,0,-.5]),e(a,"spatial"),f=a._panner),f.coneInnerAngle=h.coneInnerAngle,f.coneOuterAngle=h.coneOuterAngle,f.coneOuterGain=h.coneOuterGain,f.distanceModel=h.distanceModel,f.maxDistance=h.maxDistance,f.refDistance=h.refDistance,f.rolloffFactor=h.rolloffFactor,f.panningModel=h.panningModel}return t},Sound.prototype.init=function(t){return function(){var i=this,n=i._parent;i._orientation=n._orientation,i._stereo=n._stereo,i._pos=n._pos,i._pannerAttr=n._pannerAttr,t.call(this),i._stereo?n.stereo(i._stereo):i._pos&&n.pos(i._pos[0],i._pos[1],i._pos[2],i._id)}}(Sound.prototype.init),Sound.prototype.reset=function(t){return function(){var i=this,n=i._parent;return i._orientation=n._orientation,i._stereo=n._stereo,i._pos=n._pos,i._pannerAttr=n._pannerAttr,i._stereo?n.stereo(i._stereo):i._pos?n.pos(i._pos[0],i._pos[1],i._pos[2],i._id):i._panner&&(i._panner.disconnect(0),i._panner=void 0,n._refreshBuffer(i)),t.call(this)}}(Sound.prototype.reset);var e=function(t,i){i=i||"spatial",i==="spatial"?(t._panner=Howler.ctx.createPanner(),t._panner.coneInnerAngle=t._pannerAttr.coneInnerAngle,t._panner.coneOuterAngle=t._pannerAttr.coneOuterAngle,t._panner.coneOuterGain=t._pannerAttr.coneOuterGain,t._panner.distanceModel=t._pannerAttr.distanceModel,t._panner.maxDistance=t._pannerAttr.maxDistance,t._panner.refDistance=t._pannerAttr.refDistance,t._panner.rolloffFactor=t._pannerAttr.rolloffFactor,t._panner.panningModel=t._pannerAttr.panningModel,typeof t._panner.positionX<"u"?(t._panner.positionX.setValueAtTime(t._pos[0],Howler.ctx.currentTime),t._panner.positionY.setValueAtTime(t._pos[1],Howler.ctx.currentTime),t._panner.positionZ.setValueAtTime(t._pos[2],Howler.ctx.currentTime)):t._panner.setPosition(t._pos[0],t._pos[1],t._pos[2]),typeof t._panner.orientationX<"u"?(t._panner.orientationX.setValueAtTime(t._orientation[0],Howler.ctx.currentTime),t._panner.orientationY.setValueAtTime(t._orientation[1],Howler.ctx.currentTime),t._panner.orientationZ.setValueAtTime(t._orientation[2],Howler.ctx.currentTime)):t._panner.setOrientation(t._orientation[0],t._orientation[1],t._orientation[2])):(t._panner=Howler.ctx.createStereoPanner(),t._panner.pan.setValueAtTime(t._stereo,Howler.ctx.currentTime)),t._panner.connect(t._node),t._paused||t._parent.pause(t._id,!0).play(t._id,!0)}})()})(ru);var bf;let Aw=(bf=class extends Wt{constructor(t){super(t);q(this,"getCrunchDuration",()=>{this.crunch.play(),this.crunchDuration=this.crunch.duration(),this.crunch.pause(),this.off("click",document.body,this.getCrunchDuration,!0)});this.buildAudio(),this.on("click",document.body,this.getCrunchDuration,!0),this.on("visibilitychange",document,()=>{document.visibilityState==="visible"?this.playWhenVisibleAgain&&this.sound.play():this.sound.playing()?(this.playWhenVisibleAgain=!0,this.sound.pause()):this.playWhenVisibleAgain=!1})}buildAudio(){this.sound=new ru.Howl({src:"/audio/ambient-audio.mp3",volume:.7}),this.crunch=new ru.Howl({src:"/audio/crunch-full-length.mp3"})}stop(){this.sound.stop(),this.crunch.stop()}},q(bf,"selector",".js-audio"),bf);class dm extends Wt{constructor(t){super(t);q(this,"isAudioContextReady",!1);q(this,"isMusicPlaying",!1);q(this,"previousScroll",0);q(this,"buildIntro",()=>{this.introTl=Y.timeline({paused:!0}),this.introTl.titleIn(this.dom.title,null).fromTo(this.dom.canvas,{opacity:0,scale:.9},{opacity:.15,scale:1,duration:1,ease:"power2.out",onComplete:()=>{this.buildStCanvas()}},.2).from(this.dom.headphone,{opacity:0},.2),ru.Howler.ctx.state!=="running"&&this.introTl.to(this.dom.audioText,{opacity:1},.2)});q(this,"playAudio",t=>{this.isMusicPlaying?(this.audio.sound.pause(),Y.to(this.dom.soundSpeaker,{fill:"#5B5A55"}),Y.to(this.dom.soundWave,{opacity:0}),Y.to(this.dom.soundCross,{opacity:1})):(this.audio.sound.play(),Y.to(this.dom.soundSpeaker,{fill:"#E3E2E0"}),Y.to(this.dom.soundWave,{opacity:1}),Y.to(this.dom.soundCross,{opacity:0})),this.isMusicPlaying=!this.isMusicPlaying});q(this,"onResize",()=>{this.maxScrollSpeed=this.el.offsetHeight/(this.audio.crunchDuration||10)});q(this,"onBodyClick",()=>{this.skipBodyClick||(this.isAudioContextReady=!0,this.maxScrollSpeed=this.el.offsetHeight/this.audio.crunchDuration,Y.to(this.dom.audioText,{opacity:0}),this.playAudio(),this.off("click",document.body,this.onBodyClick))});this.populateDom(),this.header=st(".js-header"),this.footer=st(".js-footer"),this.scrollPrompt=st(".js-scroll-prompt"),Y.set(this.dom.readTimeContainer,{autoAlpha:0}),this.maxScrollSpeed=this.el.offsetHeight/10,this.audio=E.staticComponents.get(Aw).first(),this.addEvents(),ru.Howler.ctx.state==="running"&&this.onBodyClick(),this.dom.blockArray.shift(),this.buildStScrollPrompt(),this.buildParallax(),this.buildReadTime(),this.buildStHero(),this.buildScrollText(),this.buildStScroll(),this.buildIntro(),this.on("Loader:completed",()=>this.introTl.play())}buildStScrollPrompt(){const t=ft.create({trigger:this.dom.container,start:"top bottom",onEnter:()=>{Y.to(this.scrollPrompt,{autoAlpha:0,overwrite:!0}),Y.to(this.dom.readTimeContainer,{autoAlpha:1,delay:.2,overwrite:!0})},onLeaveBack:()=>{Y.to(this.scrollPrompt,{autoAlpha:1,delay:.2,overwrite:!0}),Y.to(this.dom.readTimeContainer,{autoAlpha:0,overwrite:!0})}});this.stCollection.push(t)}buildReadTime(){this.readProgressCircumference=this.dom.readProgress.getTotalLength(),Y.set(this.dom.readProgress,{strokeDasharray:`${this.readProgressCircumference} ${this.readProgressCircumference}`,strokeDashoffset:this.readProgressCircumference});const t=ft.create({trigger:this.dom.container,start:"top top+=25%",end:"bottom bottom-=20%",onUpdate:({progress:i})=>{this.setProgress(i*100)}});this.stCollection.push(t)}buildStHero(){const t=Y.to(this.dom.audioNotice,{scrollTrigger:{trigger:this.dom.hero,start:"top top",end:"top+=20% top",scrub:!0},opacity:0});this.stCollection.push(t)}buildParallax(){E.mq.sm.matches&&this.dom.blockArray.forEach(t=>{const i=st(".js-block-inner",t),n=Y.to(i,{scrollTrigger:{trigger:t,start:"top bottom",end:"bottom top",scrub:!0,invalidateOnRefresh:!0},y:()=>{const s=E.mq.md.matches,a=.1;return(s?(Math.random()-.5)*2:Math.random())*E.window.h*a},ease:"linear"});this.stCollection.push(n)})}buildScrollText(){const t=[];this.dom.textArray.forEach(s=>{const a=new _r(s,{type:"words"});t.push(...a.words);const o=Y.fromTo(a.words,{willChange:"opacity",opacity:.1},{ease:"none",opacity:1,stagger:.05,scrollTrigger:{trigger:s,start:"top 90%",end:"bottom 90%",scrub:!0}});this.stCollection.push(o)});const i=225,n=Math.ceil(t.length/i);this.dom.readTime.innerText=`${n} mins`}buildStCanvas(){const t=Y.fromTo(this.dom.canvas,{opacity:.6},{opacity:.3,scrollTrigger:{trigger:this.dom.ctaSection,start:"top bottom",end:"bottom bottom",scrub:!0}}),i=Y.fromTo(this.dom.canvas,{opacity:.4},{opacity:.6,scrollTrigger:{trigger:this.dom.secondSection,start:"top top",endTrigger:this.dom.blocksContainer,end:"top top",scrub:!0}}),n=Y.fromTo(this.dom.canvas,{opacity:.15},{opacity:.4,scrollTrigger:{trigger:this.dom.hero,start:"top top",endTrigger:this.dom.secondSection,end:"top top",scrub:!0}});this.stCollection.push(t,i,n)}setProgress(t){this.dom.readProgress.style.strokeDashoffset=this.readProgressCircumference-t/100*this.readProgressCircumference}buildStScroll(){this.st=ft.create({trigger:this.el,onUpdate:t=>{const i=Math.abs(t.getVelocity());if(i>this.maxScrollSpeed?(E.SmoothScroll.Lenis.virtualScroll.wheelMultiplier=this.maxScrollSpeed*E.initialWheelMultiplier/i*.6,E.SmoothScroll.Lenis.virtualScroll.touchMultiplier=this.maxScrollSpeed*E.initialTouchMultiplier/i*.6):(E.SmoothScroll.Lenis.virtualScroll.wheelMultiplier=E.initialWheelMultiplier,E.SmoothScroll.Lenis.virtualScroll.touchMultiplier=E.initialTouchMultiplier),!this.isMusicPlaying)return;window.clearTimeout(this.timeout);const n=Math.abs(t.progress-this.previousScroll);this.audio.crunch.playing()||this.audio.crunch.play(),this.audio.crunch.seek(this.audio.crunch.duration()*t.progress),this.audio.crunch.volume(Math.min(.2,n*75)),this.previousScroll=t.progress,this.timeout=window.setTimeout(()=>this.audio.crunch.pause(),200)},start:"top top",end:"bottom bottom",invalidateOnRefresh:!0}),this.stCollection.push(this.st)}addEvents(){this.on("click",this.header,t=>{this.skipBodyClick=!0}),this.on("click",this.footer,t=>{this.skipBodyClick=!0}),this.on("click",document.body,this.onBodyClick),this.on("click",this.dom.audioBtn,()=>{this.isAudioContextReady&&this.playAudio()}),this.on(Je.RESIZE,this.onResize)}destroy(){super.destroy(),this.audio.stop()}}q(dm,"selector",".js-manifesto");class pm extends Wt{constructor(t){super(t);q(this,"onResize",()=>{this.el.width=this.el.offsetWidth,this.el.height=this.el.offsetHeight,this.setCanvasParams(),this.drawImage()});q(this,"onTick",()=>{this.currentId!==this.prevId&&(this.drawImage(),this.prevId=this.currentId)});this.imgSeqImgElement=st(".js-img-seq-img"),this.imagesCount=300,this.frames=[],this.currentId=0,this.prevId=null,this.scrollProgress=0,this.context=this.el.getContext("2d"),this.load()}addEvents(){this.on(Je.RAF,this.onTick),this.on(Je.RESIZE,this.onResize)}load(){for(let t=0;t<this.imagesCount;t++){const i=new Image;this.frames.push(i),i.src=`images/sequence/manifesto${t.toString().padStart(3,"0")}.jpg`,E.AssetLoader.add(E.AssetLoader.retry(()=>new Promise((n,s)=>{i.addEventListener("load",()=>{n(i)}),i.addEventListener("error",a=>{i.src=null,i.src=`images/sequence/manifesto${t.toString().padStart(3,"0")}.jpg`,s(new Error("Image not loaded",{cause:a}))},{once:!0})})))}}build(){this.onResize(),this.st=ft.create({trigger:st(".js-manifesto"),onUpdate:t=>{this.scrollProgress=t.progress,this.updateImage(t.progress)},start:"top top",end:"bottom bottom"}),this.addEvents()}updateImage(t){this.currentId=Math.floor(t*(this.imagesCount-1))}fit(t){return(i,n,s,a,o=1,u=.5,h=.5)=>{const f=s/a,c=i/n;let d=i*o,m=n*o;return(t?f>c:f<c)?m=d/f:d=m*f,{width:d,height:m,offsetX:(i-d)*u,offsetY:(n-m)*h}}}setCanvasParams(){E.mq.md.matches?(this.scale=1,this.offsetX=.5,this.offsetY=.5,this.gradientStartY=.9):E.mq.sm.matches?(this.scale=.6,this.offsetX=.5,this.offsetY=.5,this.gradientStartY=.7):(this.scale=.5,this.offsetX=.5,this.offsetY=.5,this.gradientStartY=.65)}drawImage(){this.context.clearRect(0,0,this.el.width,this.el.height);const t=this.fit(!1),{offsetX:i,offsetY:n,width:s,height:a}=t(E.window.w,E.window.h,this.imgSeqImgElement.width,this.imgSeqImgElement.height,this.scale,this.offsetX,this.offsetY);this.context.drawImage(this.frames[this.currentId],i,n,s,a);const o=this.context.createLinearGradient(0,E.window.h*this.gradientStartY,0,E.window.h*(this.gradientStartY+.1));o.addColorStop(0,"rgba(0,0,0,0)"),o.addColorStop(1,"#000"),this.context.fillStyle=o,this.context.fillRect(i,n,s,a)}destroy(){super.destroy(),this.st.kill()}}q(pm,"selector",".js-img-seq-canvas");var Tn="top",as="bottom",ls="right",En="left",hg="auto",vu=[Tn,as,ls,En],xl="start",ou="end",VR="clippingParents",Lw="viewport",mc="popper",zR="reference",G0=vu.reduce(function(r,e){return r.concat([e+"-"+xl,e+"-"+ou])},[]),Rw=[].concat(vu,[hg]).reduce(function(r,e){return r.concat([e,e+"-"+xl,e+"-"+ou])},[]),UR="beforeRead",GR="read",HR="afterRead",WR="beforeMain",jR="main",qR="afterMain",XR="beforeWrite",$R="write",YR="afterWrite",KR=[UR,GR,HR,WR,jR,qR,XR,$R,YR];function Vs(r){return r?(r.nodeName||"").toLowerCase():null}function Gn(r){if(r==null)return window;if(r.toString()!=="[object Window]"){var e=r.ownerDocument;return e&&e.defaultView||window}return r}function sa(r){var e=Gn(r).Element;return r instanceof e||r instanceof Element}function rs(r){var e=Gn(r).HTMLElement;return r instanceof e||r instanceof HTMLElement}function dg(r){if(typeof ShadowRoot>"u")return!1;var e=Gn(r).ShadowRoot;return r instanceof e||r instanceof ShadowRoot}function ZR(r){var e=r.state;Object.keys(e.elements).forEach(function(t){var i=e.styles[t]||{},n=e.attributes[t]||{},s=e.elements[t];!rs(s)||!Vs(s)||(Object.assign(s.style,i),Object.keys(n).forEach(function(a){var o=n[a];o===!1?s.removeAttribute(a):s.setAttribute(a,o===!0?"":o)}))})}function JR(r){var e=r.state,t={popper:{position:e.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};return Object.assign(e.elements.popper.style,t.popper),e.styles=t,e.elements.arrow&&Object.assign(e.elements.arrow.style,t.arrow),function(){Object.keys(e.elements).forEach(function(i){var n=e.elements[i],s=e.attributes[i]||{},a=Object.keys(e.styles.hasOwnProperty(i)?e.styles[i]:t[i]),o=a.reduce(function(u,h){return u[h]="",u},{});!rs(n)||!Vs(n)||(Object.assign(n.style,o),Object.keys(s).forEach(function(u){n.removeAttribute(u)}))})}}const QR={name:"applyStyles",enabled:!0,phase:"write",fn:ZR,effect:JR,requires:["computeStyles"]};function Os(r){return r.split("-")[0]}var $o=Math.max,ld=Math.min,wl=Math.round;function fm(){var r=navigator.userAgentData;return r!=null&&r.brands&&Array.isArray(r.brands)?r.brands.map(function(e){return e.brand+"/"+e.version}).join(" "):navigator.userAgent}function kw(){return!/^((?!chrome|android).)*safari/i.test(fm())}function yl(r,e,t){e===void 0&&(e=!1),t===void 0&&(t=!1);var i=r.getBoundingClientRect(),n=1,s=1;e&&rs(r)&&(n=r.offsetWidth>0&&wl(i.width)/r.offsetWidth||1,s=r.offsetHeight>0&&wl(i.height)/r.offsetHeight||1);var a=sa(r)?Gn(r):window,o=a.visualViewport,u=!kw()&&t,h=(i.left+(u&&o?o.offsetLeft:0))/n,f=(i.top+(u&&o?o.offsetTop:0))/s,c=i.width/n,d=i.height/s;return{width:c,height:d,top:f,right:h+c,bottom:f+d,left:h,x:h,y:f}}function pg(r){var e=yl(r),t=r.offsetWidth,i=r.offsetHeight;return Math.abs(e.width-t)<=1&&(t=e.width),Math.abs(e.height-i)<=1&&(i=e.height),{x:r.offsetLeft,y:r.offsetTop,width:t,height:i}}function Iw(r,e){var t=e.getRootNode&&e.getRootNode();if(r.contains(e))return!0;if(t&&dg(t)){var i=e;do{if(i&&r.isSameNode(i))return!0;i=i.parentNode||i.host}while(i)}return!1}function vr(r){return Gn(r).getComputedStyle(r)}function e3(r){return["table","td","th"].indexOf(Vs(r))>=0}function to(r){return((sa(r)?r.ownerDocument:r.document)||window.document).documentElement}function yd(r){return Vs(r)==="html"?r:r.assignedSlot||r.parentNode||(dg(r)?r.host:null)||to(r)}function H0(r){return!rs(r)||vr(r).position==="fixed"?null:r.offsetParent}function t3(r){var e=/firefox/i.test(fm()),t=/Trident/i.test(fm());if(t&&rs(r)){var i=vr(r);if(i.position==="fixed")return null}var n=yd(r);for(dg(n)&&(n=n.host);rs(n)&&["html","body"].indexOf(Vs(n))<0;){var s=vr(n);if(s.transform!=="none"||s.perspective!=="none"||s.contain==="paint"||["transform","perspective"].indexOf(s.willChange)!==-1||e&&s.willChange==="filter"||e&&s.filter&&s.filter!=="none")return n;n=n.parentNode}return null}function bu(r){for(var e=Gn(r),t=H0(r);t&&e3(t)&&vr(t).position==="static";)t=H0(t);return t&&(Vs(t)==="html"||Vs(t)==="body"&&vr(t).position==="static")?e:t||t3(r)||e}function fg(r){return["top","bottom"].indexOf(r)>=0?"x":"y"}function zc(r,e,t){return $o(r,ld(e,t))}function i3(r,e,t){var i=zc(r,e,t);return i>t?t:i}function Fw(){return{top:0,right:0,bottom:0,left:0}}function Ow(r){return Object.assign({},Fw(),r)}function Nw(r,e){return e.reduce(function(t,i){return t[i]=r,t},{})}var n3=function(e,t){return e=typeof e=="function"?e(Object.assign({},t.rects,{placement:t.placement})):e,Ow(typeof e!="number"?e:Nw(e,vu))};function s3(r){var e,t=r.state,i=r.name,n=r.options,s=t.elements.arrow,a=t.modifiersData.popperOffsets,o=Os(t.placement),u=fg(o),h=[En,ls].indexOf(o)>=0,f=h?"height":"width";if(!(!s||!a)){var c=n3(n.padding,t),d=pg(s),m=u==="y"?Tn:En,x=u==="y"?as:ls,_=t.rects.reference[f]+t.rects.reference[u]-a[u]-t.rects.popper[f],b=a[u]-t.rects.reference[u],y=bu(s),M=y?u==="y"?y.clientHeight||0:y.clientWidth||0:0,D=_/2-b/2,C=c[m],P=M-d[f]-c[x],I=M/2-d[f]/2+D,F=zc(C,I,P),A=u;t.modifiersData[i]=(e={},e[A]=F,e.centerOffset=F-I,e)}}function r3(r){var e=r.state,t=r.options,i=t.element,n=i===void 0?"[data-popper-arrow]":i;n!=null&&(typeof n=="string"&&(n=e.elements.popper.querySelector(n),!n)||Iw(e.elements.popper,n)&&(e.elements.arrow=n))}const o3={name:"arrow",enabled:!0,phase:"main",fn:s3,effect:r3,requires:["popperOffsets"],requiresIfExists:["preventOverflow"]};function Sl(r){return r.split("-")[1]}var a3={top:"auto",right:"auto",bottom:"auto",left:"auto"};function l3(r,e){var t=r.x,i=r.y,n=e.devicePixelRatio||1;return{x:wl(t*n)/n||0,y:wl(i*n)/n||0}}function W0(r){var e,t=r.popper,i=r.popperRect,n=r.placement,s=r.variation,a=r.offsets,o=r.position,u=r.gpuAcceleration,h=r.adaptive,f=r.roundOffsets,c=r.isFixed,d=a.x,m=d===void 0?0:d,x=a.y,_=x===void 0?0:x,b=typeof f=="function"?f({x:m,y:_}):{x:m,y:_};m=b.x,_=b.y;var y=a.hasOwnProperty("x"),M=a.hasOwnProperty("y"),D=En,C=Tn,P=window;if(h){var I=bu(t),F="clientHeight",A="clientWidth";if(I===Gn(t)&&(I=to(t),vr(I).position!=="static"&&o==="absolute"&&(F="scrollHeight",A="scrollWidth")),I=I,n===Tn||(n===En||n===ls)&&s===ou){C=as;var k=c&&I===P&&P.visualViewport?P.visualViewport.height:I[F];_-=k-i.height,_*=u?1:-1}if(n===En||(n===Tn||n===as)&&s===ou){D=ls;var O=c&&I===P&&P.visualViewport?P.visualViewport.width:I[A];m-=O-i.width,m*=u?1:-1}}var J=Object.assign({position:o},h&&a3),Q=f===!0?l3({x:m,y:_},Gn(t)):{x:m,y:_};if(m=Q.x,_=Q.y,u){var X;return Object.assign({},J,(X={},X[C]=M?"0":"",X[D]=y?"0":"",X.transform=(P.devicePixelRatio||1)<=1?"translate("+m+"px, "+_+"px)":"translate3d("+m+"px, "+_+"px, 0)",X))}return Object.assign({},J,(e={},e[C]=M?_+"px":"",e[D]=y?m+"px":"",e.transform="",e))}function c3(r){var e=r.state,t=r.options,i=t.gpuAcceleration,n=i===void 0?!0:i,s=t.adaptive,a=s===void 0?!0:s,o=t.roundOffsets,u=o===void 0?!0:o,h={placement:Os(e.placement),variation:Sl(e.placement),popper:e.elements.popper,popperRect:e.rects.popper,gpuAcceleration:n,isFixed:e.options.strategy==="fixed"};e.modifiersData.popperOffsets!=null&&(e.styles.popper=Object.assign({},e.styles.popper,W0(Object.assign({},h,{offsets:e.modifiersData.popperOffsets,position:e.options.strategy,adaptive:a,roundOffsets:u})))),e.modifiersData.arrow!=null&&(e.styles.arrow=Object.assign({},e.styles.arrow,W0(Object.assign({},h,{offsets:e.modifiersData.arrow,position:"absolute",adaptive:!1,roundOffsets:u})))),e.attributes.popper=Object.assign({},e.attributes.popper,{"data-popper-placement":e.placement})}const u3={name:"computeStyles",enabled:!0,phase:"beforeWrite",fn:c3,data:{}};var Rh={passive:!0};function h3(r){var e=r.state,t=r.instance,i=r.options,n=i.scroll,s=n===void 0?!0:n,a=i.resize,o=a===void 0?!0:a,u=Gn(e.elements.popper),h=[].concat(e.scrollParents.reference,e.scrollParents.popper);return s&&h.forEach(function(f){f.addEventListener("scroll",t.update,Rh)}),o&&u.addEventListener("resize",t.update,Rh),function(){s&&h.forEach(function(f){f.removeEventListener("scroll",t.update,Rh)}),o&&u.removeEventListener("resize",t.update,Rh)}}const d3={name:"eventListeners",enabled:!0,phase:"write",fn:function(){},effect:h3,data:{}};var p3={left:"right",right:"left",bottom:"top",top:"bottom"};function jh(r){return r.replace(/left|right|bottom|top/g,function(e){return p3[e]})}var f3={start:"end",end:"start"};function j0(r){return r.replace(/start|end/g,function(e){return f3[e]})}function mg(r){var e=Gn(r),t=e.pageXOffset,i=e.pageYOffset;return{scrollLeft:t,scrollTop:i}}function gg(r){return yl(to(r)).left+mg(r).scrollLeft}function m3(r,e){var t=Gn(r),i=to(r),n=t.visualViewport,s=i.clientWidth,a=i.clientHeight,o=0,u=0;if(n){s=n.width,a=n.height;var h=kw();(h||!h&&e==="fixed")&&(o=n.offsetLeft,u=n.offsetTop)}return{width:s,height:a,x:o+gg(r),y:u}}function g3(r){var e,t=to(r),i=mg(r),n=(e=r.ownerDocument)==null?void 0:e.body,s=$o(t.scrollWidth,t.clientWidth,n?n.scrollWidth:0,n?n.clientWidth:0),a=$o(t.scrollHeight,t.clientHeight,n?n.scrollHeight:0,n?n.clientHeight:0),o=-i.scrollLeft+gg(r),u=-i.scrollTop;return vr(n||t).direction==="rtl"&&(o+=$o(t.clientWidth,n?n.clientWidth:0)-s),{width:s,height:a,x:o,y:u}}function _g(r){var e=vr(r),t=e.overflow,i=e.overflowX,n=e.overflowY;return/auto|scroll|overlay|hidden/.test(t+n+i)}function Bw(r){return["html","body","#document"].indexOf(Vs(r))>=0?r.ownerDocument.body:rs(r)&&_g(r)?r:Bw(yd(r))}function Uc(r,e){var t;e===void 0&&(e=[]);var i=Bw(r),n=i===((t=r.ownerDocument)==null?void 0:t.body),s=Gn(i),a=n?[s].concat(s.visualViewport||[],_g(i)?i:[]):i,o=e.concat(a);return n?o:o.concat(Uc(yd(a)))}function mm(r){return Object.assign({},r,{left:r.x,top:r.y,right:r.x+r.width,bottom:r.y+r.height})}function _3(r,e){var t=yl(r,!1,e==="fixed");return t.top=t.top+r.clientTop,t.left=t.left+r.clientLeft,t.bottom=t.top+r.clientHeight,t.right=t.left+r.clientWidth,t.width=r.clientWidth,t.height=r.clientHeight,t.x=t.left,t.y=t.top,t}function q0(r,e,t){return e===Lw?mm(m3(r,t)):sa(e)?_3(e,t):mm(g3(to(r)))}function v3(r){var e=Uc(yd(r)),t=["absolute","fixed"].indexOf(vr(r).position)>=0,i=t&&rs(r)?bu(r):r;return sa(i)?e.filter(function(n){return sa(n)&&Iw(n,i)&&Vs(n)!=="body"}):[]}function b3(r,e,t,i){var n=e==="clippingParents"?v3(r):[].concat(e),s=[].concat(n,[t]),a=s[0],o=s.reduce(function(u,h){var f=q0(r,h,i);return u.top=$o(f.top,u.top),u.right=ld(f.right,u.right),u.bottom=ld(f.bottom,u.bottom),u.left=$o(f.left,u.left),u},q0(r,a,i));return o.width=o.right-o.left,o.height=o.bottom-o.top,o.x=o.left,o.y=o.top,o}function Vw(r){var e=r.reference,t=r.element,i=r.placement,n=i?Os(i):null,s=i?Sl(i):null,a=e.x+e.width/2-t.width/2,o=e.y+e.height/2-t.height/2,u;switch(n){case Tn:u={x:a,y:e.y-t.height};break;case as:u={x:a,y:e.y+e.height};break;case ls:u={x:e.x+e.width,y:o};break;case En:u={x:e.x-t.width,y:o};break;default:u={x:e.x,y:e.y}}var h=n?fg(n):null;if(h!=null){var f=h==="y"?"height":"width";switch(s){case xl:u[h]=u[h]-(e[f]/2-t[f]/2);break;case ou:u[h]=u[h]+(e[f]/2-t[f]/2);break}}return u}function au(r,e){e===void 0&&(e={});var t=e,i=t.placement,n=i===void 0?r.placement:i,s=t.strategy,a=s===void 0?r.strategy:s,o=t.boundary,u=o===void 0?VR:o,h=t.rootBoundary,f=h===void 0?Lw:h,c=t.elementContext,d=c===void 0?mc:c,m=t.altBoundary,x=m===void 0?!1:m,_=t.padding,b=_===void 0?0:_,y=Ow(typeof b!="number"?b:Nw(b,vu)),M=d===mc?zR:mc,D=r.rects.popper,C=r.elements[x?M:d],P=b3(sa(C)?C:C.contextElement||to(r.elements.popper),u,f,a),I=yl(r.elements.reference),F=Vw({reference:I,element:D,strategy:"absolute",placement:n}),A=mm(Object.assign({},D,F)),k=d===mc?A:I,O={top:P.top-k.top+y.top,bottom:k.bottom-P.bottom+y.bottom,left:P.left-k.left+y.left,right:k.right-P.right+y.right},J=r.modifiersData.offset;if(d===mc&&J){var Q=J[n];Object.keys(O).forEach(function(X){var j=[ls,as].indexOf(X)>=0?1:-1,K=[Tn,as].indexOf(X)>=0?"y":"x";O[X]+=Q[K]*j})}return O}function x3(r,e){e===void 0&&(e={});var t=e,i=t.placement,n=t.boundary,s=t.rootBoundary,a=t.padding,o=t.flipVariations,u=t.allowedAutoPlacements,h=u===void 0?Rw:u,f=Sl(i),c=f?o?G0:G0.filter(function(x){return Sl(x)===f}):vu,d=c.filter(function(x){return h.indexOf(x)>=0});d.length===0&&(d=c);var m=d.reduce(function(x,_){return x[_]=au(r,{placement:_,boundary:n,rootBoundary:s,padding:a})[Os(_)],x},{});return Object.keys(m).sort(function(x,_){return m[x]-m[_]})}function w3(r){if(Os(r)===hg)return[];var e=jh(r);return[j0(r),e,j0(e)]}function y3(r){var e=r.state,t=r.options,i=r.name;if(!e.modifiersData[i]._skip){for(var n=t.mainAxis,s=n===void 0?!0:n,a=t.altAxis,o=a===void 0?!0:a,u=t.fallbackPlacements,h=t.padding,f=t.boundary,c=t.rootBoundary,d=t.altBoundary,m=t.flipVariations,x=m===void 0?!0:m,_=t.allowedAutoPlacements,b=e.options.placement,y=Os(b),M=y===b,D=u||(M||!x?[jh(b)]:w3(b)),C=[b].concat(D).reduce(function(le,be){return le.concat(Os(be)===hg?x3(e,{placement:be,boundary:f,rootBoundary:c,padding:h,flipVariations:x,allowedAutoPlacements:_}):be)},[]),P=e.rects.reference,I=e.rects.popper,F=new Map,A=!0,k=C[0],O=0;O<C.length;O++){var J=C[O],Q=Os(J),X=Sl(J)===xl,j=[Tn,as].indexOf(Q)>=0,K=j?"width":"height",ie=au(e,{placement:J,boundary:f,rootBoundary:c,altBoundary:d,padding:h}),ee=j?X?ls:En:X?as:Tn;P[K]>I[K]&&(ee=jh(ee));var V=jh(ee),_e=[];if(s&&_e.push(ie[Q]<=0),o&&_e.push(ie[ee]<=0,ie[V]<=0),_e.every(function(le){return le})){k=J,A=!1;break}F.set(J,_e)}if(A)for(var U=x?3:1,oe=function(be){var ue=C.find(function(We){var ye=F.get(We);if(ye)return ye.slice(0,be).every(function(Ne){return Ne})});if(ue)return k=ue,"break"},ce=U;ce>0;ce--){var me=oe(ce);if(me==="break")break}e.placement!==k&&(e.modifiersData[i]._skip=!0,e.placement=k,e.reset=!0)}}const S3={name:"flip",enabled:!0,phase:"main",fn:y3,requiresIfExists:["offset"],data:{_skip:!1}};function X0(r,e,t){return t===void 0&&(t={x:0,y:0}),{top:r.top-e.height-t.y,right:r.right-e.width+t.x,bottom:r.bottom-e.height+t.y,left:r.left-e.width-t.x}}function $0(r){return[Tn,ls,as,En].some(function(e){return r[e]>=0})}function M3(r){var e=r.state,t=r.name,i=e.rects.reference,n=e.rects.popper,s=e.modifiersData.preventOverflow,a=au(e,{elementContext:"reference"}),o=au(e,{altBoundary:!0}),u=X0(a,i),h=X0(o,n,s),f=$0(u),c=$0(h);e.modifiersData[t]={referenceClippingOffsets:u,popperEscapeOffsets:h,isReferenceHidden:f,hasPopperEscaped:c},e.attributes.popper=Object.assign({},e.attributes.popper,{"data-popper-reference-hidden":f,"data-popper-escaped":c})}const T3={name:"hide",enabled:!0,phase:"main",requiresIfExists:["preventOverflow"],fn:M3};function E3(r,e,t){var i=Os(r),n=[En,Tn].indexOf(i)>=0?-1:1,s=typeof t=="function"?t(Object.assign({},e,{placement:r})):t,a=s[0],o=s[1];return a=a||0,o=(o||0)*n,[En,ls].indexOf(i)>=0?{x:o,y:a}:{x:a,y:o}}function C3(r){var e=r.state,t=r.options,i=r.name,n=t.offset,s=n===void 0?[0,0]:n,a=Rw.reduce(function(f,c){return f[c]=E3(c,e.rects,s),f},{}),o=a[e.placement],u=o.x,h=o.y;e.modifiersData.popperOffsets!=null&&(e.modifiersData.popperOffsets.x+=u,e.modifiersData.popperOffsets.y+=h),e.modifiersData[i]=a}const D3={name:"offset",enabled:!0,phase:"main",requires:["popperOffsets"],fn:C3};function P3(r){var e=r.state,t=r.name;e.modifiersData[t]=Vw({reference:e.rects.reference,element:e.rects.popper,strategy:"absolute",placement:e.placement})}const A3={name:"popperOffsets",enabled:!0,phase:"read",fn:P3,data:{}};function L3(r){return r==="x"?"y":"x"}function R3(r){var e=r.state,t=r.options,i=r.name,n=t.mainAxis,s=n===void 0?!0:n,a=t.altAxis,o=a===void 0?!1:a,u=t.boundary,h=t.rootBoundary,f=t.altBoundary,c=t.padding,d=t.tether,m=d===void 0?!0:d,x=t.tetherOffset,_=x===void 0?0:x,b=au(e,{boundary:u,rootBoundary:h,padding:c,altBoundary:f}),y=Os(e.placement),M=Sl(e.placement),D=!M,C=fg(y),P=L3(C),I=e.modifiersData.popperOffsets,F=e.rects.reference,A=e.rects.popper,k=typeof _=="function"?_(Object.assign({},e.rects,{placement:e.placement})):_,O=typeof k=="number"?{mainAxis:k,altAxis:k}:Object.assign({mainAxis:0,altAxis:0},k),J=e.modifiersData.offset?e.modifiersData.offset[e.placement]:null,Q={x:0,y:0};if(I){if(s){var X,j=C==="y"?Tn:En,K=C==="y"?as:ls,ie=C==="y"?"height":"width",ee=I[C],V=ee+b[j],_e=ee-b[K],U=m?-A[ie]/2:0,oe=M===xl?F[ie]:A[ie],ce=M===xl?-A[ie]:-F[ie],me=e.elements.arrow,le=m&&me?pg(me):{width:0,height:0},be=e.modifiersData["arrow#persistent"]?e.modifiersData["arrow#persistent"].padding:Fw(),ue=be[j],We=be[K],ye=zc(0,F[ie],le[ie]),Ne=D?F[ie]/2-U-ye-ue-O.mainAxis:oe-ye-ue-O.mainAxis,Ce=D?-F[ie]/2+U+ye+We+O.mainAxis:ce+ye+We+O.mainAxis,Ze=e.elements.arrow&&bu(e.elements.arrow),Qe=Ze?C==="y"?Ze.clientTop||0:Ze.clientLeft||0:0,Pe=(X=J==null?void 0:J[C])!=null?X:0,ct=ee+Ne-Pe-Qe,xt=ee+Ce-Pe,mt=zc(m?ld(V,ct):V,ee,m?$o(_e,xt):_e);I[C]=mt,Q[C]=mt-ee}if(o){var he,Tt=C==="x"?Tn:En,_t=C==="x"?as:ls,Ot=I[P],wt=P==="y"?"height":"width",G=Ot+b[Tt],N=Ot-b[_t],fe=[Tn,En].indexOf(y)!==-1,xe=(he=J==null?void 0:J[P])!=null?he:0,Me=fe?G:Ot-F[wt]-A[wt]-xe+O.altAxis,Se=fe?Ot+F[wt]+A[wt]-xe-O.altAxis:N,je=m&&fe?i3(Me,Ot,Se):zc(m?Me:G,Ot,m?Se:N);I[P]=je,Q[P]=je-Ot}e.modifiersData[i]=Q}}const k3={name:"preventOverflow",enabled:!0,phase:"main",fn:R3,requiresIfExists:["offset"]};function I3(r){return{scrollLeft:r.scrollLeft,scrollTop:r.scrollTop}}function F3(r){return r===Gn(r)||!rs(r)?mg(r):I3(r)}function O3(r){var e=r.getBoundingClientRect(),t=wl(e.width)/r.offsetWidth||1,i=wl(e.height)/r.offsetHeight||1;return t!==1||i!==1}function N3(r,e,t){t===void 0&&(t=!1);var i=rs(e),n=rs(e)&&O3(e),s=to(e),a=yl(r,n,t),o={scrollLeft:0,scrollTop:0},u={x:0,y:0};return(i||!i&&!t)&&((Vs(e)!=="body"||_g(s))&&(o=F3(e)),rs(e)?(u=yl(e,!0),u.x+=e.clientLeft,u.y+=e.clientTop):s&&(u.x=gg(s))),{x:a.left+o.scrollLeft-u.x,y:a.top+o.scrollTop-u.y,width:a.width,height:a.height}}function B3(r){var e=new Map,t=new Set,i=[];r.forEach(function(s){e.set(s.name,s)});function n(s){t.add(s.name);var a=[].concat(s.requires||[],s.requiresIfExists||[]);a.forEach(function(o){if(!t.has(o)){var u=e.get(o);u&&n(u)}}),i.push(s)}return r.forEach(function(s){t.has(s.name)||n(s)}),i}function V3(r){var e=B3(r);return KR.reduce(function(t,i){return t.concat(e.filter(function(n){return n.phase===i}))},[])}function z3(r){var e;return function(){return e||(e=new Promise(function(t){Promise.resolve().then(function(){e=void 0,t(r())})})),e}}function U3(r){var e=r.reduce(function(t,i){var n=t[i.name];return t[i.name]=n?Object.assign({},n,i,{options:Object.assign({},n.options,i.options),data:Object.assign({},n.data,i.data)}):i,t},{});return Object.keys(e).map(function(t){return e[t]})}var Y0={placement:"bottom",modifiers:[],strategy:"absolute"};function K0(){for(var r=arguments.length,e=new Array(r),t=0;t<r;t++)e[t]=arguments[t];return!e.some(function(i){return!(i&&typeof i.getBoundingClientRect=="function")})}function G3(r){r===void 0&&(r={});var e=r,t=e.defaultModifiers,i=t===void 0?[]:t,n=e.defaultOptions,s=n===void 0?Y0:n;return function(o,u,h){h===void 0&&(h=s);var f={placement:"bottom",orderedModifiers:[],options:Object.assign({},Y0,s),modifiersData:{},elements:{reference:o,popper:u},attributes:{},styles:{}},c=[],d=!1,m={state:f,setOptions:function(y){var M=typeof y=="function"?y(f.options):y;_(),f.options=Object.assign({},s,f.options,M),f.scrollParents={reference:sa(o)?Uc(o):o.contextElement?Uc(o.contextElement):[],popper:Uc(u)};var D=V3(U3([].concat(i,f.options.modifiers)));return f.orderedModifiers=D.filter(function(C){return C.enabled}),x(),m.update()},forceUpdate:function(){if(!d){var y=f.elements,M=y.reference,D=y.popper;if(K0(M,D)){f.rects={reference:N3(M,bu(D),f.options.strategy==="fixed"),popper:pg(D)},f.reset=!1,f.placement=f.options.placement,f.orderedModifiers.forEach(function(O){return f.modifiersData[O.name]=Object.assign({},O.data)});for(var C=0;C<f.orderedModifiers.length;C++){if(f.reset===!0){f.reset=!1,C=-1;continue}var P=f.orderedModifiers[C],I=P.fn,F=P.options,A=F===void 0?{}:F,k=P.name;typeof I=="function"&&(f=I({state:f,options:A,name:k,instance:m})||f)}}}},update:z3(function(){return new Promise(function(b){m.forceUpdate(),b(f)})}),destroy:function(){_(),d=!0}};if(!K0(o,u))return m;m.setOptions(h).then(function(b){!d&&h.onFirstUpdate&&h.onFirstUpdate(b)});function x(){f.orderedModifiers.forEach(function(b){var y=b.name,M=b.options,D=M===void 0?{}:M,C=b.effect;if(typeof C=="function"){var P=C({state:f,name:y,instance:m,options:D}),I=function(){};c.push(P||I)}})}function _(){c.forEach(function(b){return b()}),c=[]}return m}}var H3=[d3,A3,u3,QR,D3,S3,k3,o3,T3],W3=G3({defaultModifiers:H3});class zw extends Wt{constructor(t){super(t);q(this,"onResize",()=>{var t;(t=this.popper)==null||t.destroy(),this.off("mouseenter focus click",this.el,this.onShow),this.off("mouseout blur",this.el,this.onHide),this.off("click",[this.tooltips],this.onHide),this.overlay.classList.remove("is-active"),this.tooltips.classList.remove("is-active"),this.addEvents(),E.mq.touch.matches||(this.popper=W3(this.el,this.tooltip,{placement:"right-start",modifiers:[{name:"offset",options:{offset:[-this.tooltip.offsetHeight,0]}}]}))});q(this,"onShow",()=>{this.isOpen=!0,this.overlay.classList.add("is-active"),E.mq.touch.matches?(this.tooltips.classList.add("is-active"),Y.set(this.tooltip,{display:"block"}),E.SmoothScroll.lock()):this.popper.update(),Y.to(this.tooltip,{autoAlpha:1,duration:.3})});q(this,"onHide",t=>{this.isOpen&&(this.isOpen=!1,Y.to(this.tooltip,{autoAlpha:0,duration:.3}),this.overlay.classList.remove("is-active"),this.tooltips.classList.remove("is-active"),E.mq.touch.matches&&E.SmoothScroll.unlock())});this.tooltip=st(`#${Po(this.el,"aria-describedby")}`),this.tooltips=st(".js-tooltips"),this.overlay=st(".js-overlay"),this.isOpen=!1,this.on(Je.RESIZE,this.onResize),this.onResize(),this.addEvents()}addEvents(){E.mq.touch.matches?(this.on("focus click",this.el,this.onShow),this.on("click",[this.tooltips],this.onHide)):(this.on("mouseenter focus",this.el,this.onShow),this.on("mouseout blur",this.el,this.onHide))}destroy(){var t;super.destroy(),(t=this.popper)==null||t.destroy()}}q(zw,"selector",".js-superscript");class j3 extends Al{initialLoad(){super.initialLoad(),this.initialLoadManifesto=!0}onEnter(){var e;super.onEnter(),(e=E.SmoothScroll)==null||e.lock(),this.modeToggle=st(".js-mode-toggle"),this.modeToggle.style.display="none",this.wasLightMode=!E.isDarkMode,E.isDarkMode||De.emit("ModeToggle:ToggleState"),E.AssetLoader.loaded.then(()=>{E.components.get(pm).first().build()})}onEnterCompleted(){super.onEnterCompleted(),this.initialLoadManifesto?this.initialLoadManifesto=!1:E.components.get(dm).first().introTl.play(),De.emit("ShyHeader:enable")}onLeave(){super.onLeave(),this.wasLightMode&&De.emit("ModeToggle:ToggleState"),E.SmoothScroll.Lenis.virtualScroll.wheelMultiplier=E.initialWheelMultiplier,E.SmoothScroll.Lenis.virtualScroll.touchMultiplier=E.initialTouchMultiplier}onLeaveCompleted(){super.onLeaveCompleted(),this.modeToggle.style.display="block",De.emit("ShyHeader:disable")}registerAdditionalComponents(){super.registerAdditionalComponents(),E.components.add(dm,pm,zw)}}class Uw extends Wt{constructor(t){super(t);q(this,"SPEED",.05);q(this,"MAX_OFFSET",5);q(this,"SCALE_OFFSET",.5);q(this,"scrollY",0);q(this,"target",0);q(this,"scale",1);q(this,"onResize",()=>{var t,i;(t=this.dragObserver)==null||t.kill(),(i=this.wheelObserver)==null||i.kill(),this.dragObserver=null,this.wheelObserver=null,this.off(Je.RAF,this.onRAF),E.mq.sm.matches&&(Y.set(this.dom.carousel,{clearProps:"all"}),Y.set(this.dom.imageArray,{clearProps:"all"}),window.requestAnimationFrame(()=>{Y.set(this.dom.carousel,{willChange:"transform"}),this.buildQuickSetters(),this.build(),this.on(Je.RAF,this.onRAF)}))});q(this,"onRAF",()=>{this.target+=this.SPEED*Y.ticker.deltaRatio(),this.scrollY=Y.utils.interpolate(this.scrollY,this.target,.05),this.setRotateCarousel(this.scrollY),this.setRotateImages(-this.scrollY),Y.set(this.dom.imageElArray,{scale:t=>{const i=1-Math.abs((Math.abs(this.scrollY)+t*60)%180-90)/90;return Math.max(1,1+i*this.SCALE_OFFSET)}})});this.populateDom(),Y.set(this.dom.carousel,{willChange:"transform"}),this.on(Je.RESIZE,this.onResize),E.mq.sm.matches&&(this.buildQuickSetters(),this.build(),this.on(Je.RAF,this.onRAF))}build(){this.dragObserver=oi.create({target:this.dom.drag,onDrag:({deltaY:t})=>{const i=Y.utils.clamp(-this.MAX_OFFSET,this.MAX_OFFSET,-t);this.target+=i,this.scale=Y.utils.clamp(1,this.MAX_OFFSET,-t)}}),this.wheelObserver=oi.create({target:document.body,type:"wheel,touch,scroll,pointer",onWheel:({deltaY:t})=>{const i=Y.utils.clamp(-this.MAX_OFFSET,this.MAX_OFFSET,t);this.target+=i,this.scale=Y.utils.clamp(1,this.MAX_OFFSET,t)}})}buildQuickSetters(){this.setRotateCarousel=Y.quickSetter(this.dom.carousel,"rotate","deg"),this.setRotateImages=Y.quickSetter(this.dom.imageArray,"rotate","deg")}}q(Uw,"selector",".js-careers");class q3 extends Al{onEnter(){super.onEnter(),this.scrollPrompt=st(".js-scroll-prompt"),this.scrollPrompt.style.display="none"}onEnterCompleted(){super.onEnterCompleted(),De.emit("ShyHeader:enable")}onLeave(){super.onLeave(),this.scrollPrompt.style.display="flex"}onLeaveCompleted(){super.onLeaveCompleted(),De.emit("ShyHeader:disable")}registerAdditionalComponents(){super.registerAdditionalComponents(),E.components.add(Uw)}}class X3 extends Al{onEnterCompleted(){super.onEnterCompleted()}}class $3 extends Al{onEnter(){super.onEnter(),this.scrollPrompt=st(".js-scroll-prompt"),this.scrollPrompt&&this.scrollPrompt.style.setProperty("display","none","important"),this.modeToggle=st(".js-mode-toggle"),this.modeToggle&&(this.modeToggle.style.display="none"),this.initializeVideo()}onEnterCompleted(){super.onEnterCompleted(),De.emit("ShyHeader:enable")}onLeave(){super.onLeave(),this.scrollPrompt&&this.scrollPrompt.style.setProperty("display","none","important"),this.modeToggle&&this.modeToggle.style.setProperty("display","none","important")}onLeaveCompleted(){super.onLeaveCompleted(),setTimeout(()=>{this.scrollPrompt&&this.scrollPrompt.style.setProperty("display","flex","important"),this.modeToggle&&this.modeToggle.style.setProperty("display","block","important")},100),De.emit("ShyHeader:disable")}initializeVideo(){const e=st("#cosmos-video"),t=st("#video-source");if(!e||!t)return;const i="/Auto-Captions-V6.mp4",n="/Auto-Captions-Square-V1.mp4",s=()=>{const o=window.innerWidth<=700?n:i;t.src!==o&&(t.src=o,e.load(),e.play().catch(()=>{}))};s(),window.addEventListener("resize",s),this.resizeHandler=s}onLeave(){super.onLeave(),this.scrollPrompt&&this.scrollPrompt.style.setProperty("display","none","important"),this.modeToggle&&this.modeToggle.style.setProperty("display","none","important"),this.resizeHandler&&window.removeEventListener("resize",this.resizeHandler)}registerAdditionalComponents(){super.registerAdditionalComponents()}}class Y3 extends k2{constructor(){super({links:"a:not([target]):not([href^=\\#]):not([download]):not([data-router-disabled]):not(.sf-dump-toggle):not(.sf-dump-str-toggle):not(#wpadminbar a)",renderers:{default:Al,home:BR,manifesto:j3,careers:q3,notFound:X3,captions:$3},transitions:{default:vR}}),this.setDefaultRenderer("default"),this.setDefaultTransition("default"),this.on("NAVIGATE_IN",this.onNavigateIn),this.on("NAVIGATE_END",this.onNavigateEnd)}onNavigateIn({to:e}){e&&(document.body.className=e.page.body.className)}onNavigateEnd({from:e,to:t}){typeof window.gtag<"u"&&window.gtag("event","page_view",{page_title:t.page.title,page_location:location.pathname,send_to:"G-SVHGSLGW1H"})}}class K3{constructor(){q(this,"beforeRender",e=>{this.clockDelta=this.clock.getDelta(),this.globalUniforms.uDelta.value=this.clockDelta>.016?.016:this.clockDelta,this.globalUniforms.uTime.value=e,this.renderer.info.reset()});q(this,"render",e=>{E.Gui&&E.Gui.refresh(!1),this.clockDelta=Math.round(this.clock.getDelta()*1e3)/1e3,this.clockDelta=No.clamp(this.clockDelta,0,.016),this.normalizeDelta=this.clockDelta/.016,this.globalUniforms.uDelta.value=this.clockDelta,this.globalUniforms.uTime.value=e});q(this,"onResize",()=>{this.renderer.setSize(E.window.w,E.window.h)});this.canvas={vortex:st(".webgl-vortex")},this.renderer=new Sm({alpha:!0,antialias:!0,canvas:this.canvas.vortex,powerPreference:"high-performance",stencil:!1}),this.renderer.setPixelRatio(E.window.dpr>=2?2:E.window.dpr),this.renderer.setSize(E.window.w,E.window.h),this.renderer.info.autoReset=!1,this.renderer.setClearColor(0,0),this.clock=new PP,this.clockDelta=0,this.normalizeDelta=0,this.globalUniforms={uDelta:{value:0},uTime:{value:0},uResolution:{value:new Ue(E.window.w*this.renderer.getPixelRatio(),E.window.h*this.renderer.getPixelRatio())}},this.scenes={vortex:null},fR()}start(){this.addEvents()}stop(){this.removeEvents()}addEvents(){De.on(Je.RESIZE,this.onResize),E.RAFCollection.add(this.render,100)}removeEvents(){De.off(Je.RESIZE,this.onResize),E.RAFCollection.remove(this.render)}generateTexture(e,t={}){return e instanceof HTMLImageElement&&(e=new vi(e)),e.minFilter=t.minFilter||dr,e.magFilter=t.magFilter||Ui,e.wrapS=e.wrapT=t.wrapping||bn,e.flipY=t.flipY!==void 0?t.flipY:!0,e.encoding=t.encoding||pr,this.renderer.initTexture(e),e}}class Gw extends Wt{constructor(t){super(t);q(this,"onAssetsProgress",({percent:t})=>{this.dom.indicator.textContent=t+"%"});this.populateDom(),this.on("AssetsProgress",this.onAssetsProgress),document.body.classList.add("loader-active"),this.onAssetsLoaded()}onAssetsLoaded(){this.isHome=E.body.classList.contains("home"),E.AssetLoader.loaded.then(()=>{this.dom.indicator.textContent="100%",this.dynamicText=E.components.get(na).get(0);const t=Y.timeline().to(this.dom.gradient,{scale:3,ease:"expo.in",duration:.8},.2).to(this.dom.text,{opacity:0,ease:"expo.in",duration:.8},0).to(this.dom.gradient,{opacity:1,ease:"linear",duration:.45},.2);return this.isHome&&t.from(".js-home-landing-byline",{yPercent:100,opacity:0,duration:.6},.8).call(()=>{this.dynamicText.tl.play()},null,1.4),t.to(this.el,{autoAlpha:0},.7),t.call(()=>{this.isHome&&E.WebGL.scenes.vortex.startVortex(),document.body.classList.remove("loader-active"),this.emit("Loader:completed")},null,1),t})}destroy(){super.destroy()}}q(Gw,"selector",".js-site-loader");class Hw extends xw{constructor(t){super(t);q(this,"onResize",()=>{var t;if(E.mq.sm.matches&&this.openProp)this.reset(),this.openProp="false",Po(this.el,"aria-expanded","false");else{const i=((t=this.tl)==null?void 0:t.progress())||0;this.reset(),this.buildTl(),this.tl.progress(i),this.target.style.display=this.openProp?"block":"none"}});this.closeBtn=st(".js-menu-close"),this.dom={menu:st(".js-menu"),menuList:st(".js-menu-list"),externalLinksArray:ad(".js-menu-external-links"),wordmark:st(".js-menu-wordmark")},this.dom.listItem=ad("li",this.dom.menuList),Y.set(this.dom.menu,{height:0}),this.buildTl(),this.addEvents(),E.Taxi.on("NAVIGATE_OUT",()=>{E.mq.sm.matches||this.close()})}buildTl(){this.tl=Y.timeline({paused:!0,defaults:{ease:"power3.out",duration:1}}),this.tl.fromTo(this.dom.menu,{height:0},{height:window.innerHeight}).from(this.dom.menuList,{y:-window.innerHeight/4},0).from(this.dom.listItem,{y:t=>-(50+(this.dom.listItem.length-1-t)*100)},0).from(this.dom.externalLinksArray,{y:-180},0).from(this.dom.wordmark,{y:-120},0).from(this.closeBtn,{y:-100,duration:.5,rotate:-65},.5),this.tl.duration(1.5)}onOpen(t){this.target.style.display="block",E.SmoothScroll.lock(),this.tl.eventCallback("onComplete",()=>t()),this.tl.duration(1.5),this.tl.play()}onClose(t){E.SmoothScroll.unlock(),this.tl.eventCallback("onReverseComplete",()=>{this.target.style.display="none",t()}),this.tl.duration(.3),this.tl.reverse()}reset(){var t;(t=this.tl)==null||t.kill(),this.tl=null,Object.values(this.dom).forEach(i=>{Y.set(i,{clearProps:!0})}),Y.set(this.closeBtn,{clearProps:!0})}addEvents(){this.on("click",this.closeBtn,()=>this.close()),this.on(Je.RESIZE,this.onResize)}}q(Hw,"selector",".js-menu-toggle");class Sd extends Wt{constructor(t){super(t);q(this,"DIRECTION_UP",-1);q(this,"DIRECTION_DOWN",1);q(this,"waitlistLoading",()=>{this.dom.waitlistLoadingContainer.style.opacity="1",Y.to(this.dom.waitlistLoading,{rotate:360,duration:1,repeat:-1,ease:"linear"},0),this.waitlistLoadingTL=Y.timeline({defaults:{duration:.3}}).to(this.dom.submitText,{opacity:0}).to(this.dom.waitlistLoading,{opacity:1},.2).to(this.dom.closeForm,{opacity:E.mq.sm.matches?0:.2,pointerEvents:"none"},0)});q(this,"returnToPreviousStateSecondary",()=>{this.dom.secondaryInputEl.classList.remove("hide-placeholder"),Y.timeline({defaults:{duration:.3}}).to(this.dom.answerSubmitText,{opacity:1},.2).to(this.dom.secondaryLoading,{opacity:0},0).to(this.dom.secondarySubmit,{opacity:1,overwrite:"auto"}).to(this.dom.closeSecondaryForm,{autoAlpha:1},0).set(this.dom.secondaryLoading,{rotate:0,overwrite:"auto"})});q(this,"formSubmissionSuccess",()=>{this.flowStarted=!0,this.dom.inputEl.value="",this.emit("ShyHeader:disable"),Y.timeline({defaults:{ease:"expo.inOut",duration:.6}}).call(()=>{this.dom.inputEl.classList.add("hide-placeholder")},0).set(this.dom.formContainer,{pointerEvents:"none"},0).to(this.dom.confirmationText,{opacity:1},0).to(this.dom.inputContainer,{width:E.mq.sm.matches?this.confirmationWidth:null},0).to(this.dom.submitContainer,{width:E.mq.sm.matches?null:"3.2rem"},0).to(this.dom.inner,{width:E.mq.sm.matches?this.submitStateWidth:null},0).to(this.dom.submit,{opacity:0,pointerEvents:"none",duration:.2},0).to(this.dom.formContainer,{width:E.mq.sm.matches?this.tickWidth:null},0).to([this.dom.tickMask,this.dom.tickSvg],{xPercent:0,duration:1},0).to(this.dom.waitlistLoading,{opacity:0,duration:.2},0).set(this.dom.waitlistLoading,{rotate:0,overwrite:"auto"},.2).set(this.dom.submitText,{opacity:1}).to(this.dom.closeForm,{opacity:0},0).call(()=>{this.showSecondaryForm(),this.dom.secondaryInputEl.focus()},null,2)});q(this,"showSecondaryForm",()=>{Y.timeline({defaults:{ease:"expo.in",duration:.8}}).call(()=>{this.dom.el.classList.add("reduce-padding")},0).to(this.dom.inner,{width:E.mq.sm.matches?this.secondFormWidth:null,ease:"expo.inOut"},0).to(this.dom.el,{width:E.mq.sm.matches?null:"3.55rem",ease:"expo.inOut"},0).to([this.dom.signInBtnContainer,this.dom.logomarkContainer],{width:0,ease:"expo.inOut"},0).to([this.dom.inputContainer,this.dom.logomark],{opacity:0,duration:.1,ease:"linear"},0).to(this.dom.secondaryForm,{opacity:1,yPercent:0,duration:1.2,ease:"customIn",overwrite:"auto"},.1).set(this.dom.secondaryForm,{pointerEvents:"auto"}).set(this.dom.waitlistError,{yPercent:470,xPercent:-50,opacity:0,pointerEvents:"none"})});q(this,"secondaryWaiting",()=>{Y.to(this.dom.secondaryLoading,{rotate:360,duration:1,repeat:-1,ease:"linear"}),this.secondaryWaitingTL=Y.timeline({defaults:{duration:.3},onStart:()=>{this.dom.secondaryInputEl.blur(),this.dom.secondaryInputEl.classList.add("hide-placeholder")}}).to(this.dom.secondarySubmit,{opacity:0}).to(this.dom.closeSecondaryForm,{autoAlpha:0},0).to(this.dom.secondaryLoadingContainer,{opacity:1},.2)});q(this,"secondaryComplete",()=>{Y.timeline({defaults:{ease:"expo.inOut",duration:.6}}).set(this.dom.answerSubmitText,{opacity:0}).to(this.dom.secondaryLoading,{opacity:0,duration:.2},0).set(this.dom.secondaryLoading,{rotate:0,overwrite:"auto"},.2).to([this.dom.secondaryTickMask,this.dom.secondaryTickSvg],{xPercent:0,duration:1},.1).then(()=>{this.resetForm()})});q(this,"resetForm",()=>{this.emit("ShyHeader:enable"),this.flowComplete=!0,this.flowStarted=!1,this.formOpen=!1,this.dom.el.classList.remove("mobile-bg"),this.dom.openFormTrigger.disabled=!0,this.dom.openFormTrigger.setAttribute("aria-label","Joined"),E.mq.sm.matches||Y.to(this.dom.menuIcon,{autoAlpha:1,display:"flex",delay:.5}),Y.timeline({defaults:{duration:.6,ease:"power2.inOut"}}).set(this.dom.navigation,{opacity:0}).set(this.dom.secondaryForm,{pointerEvents:"none"}).set(this.dom.mobBtnText,{width:"auto"}).to(this.dom.inner,{width:E.mq.sm.matches?this.defaultWidth:null},0).to(this.dom.el,{width:E.mq.sm.matches?null:"calc(100% - 2.25rem)"},0).to(this.dom.submitContainer,{width:E.mq.sm.matches?null:this.submitWidth},0).to(this.dom.logomarkContainer,{width:this.logoWidth},0).to(this.dom.signInBtnContainer,{width:this.signInBtnWidth},0).to(this.dom.formContainer,{width:E.mq.md.matches?this.submitWidth:null},0).to([this.dom.logomark,this.dom.navigation,this.dom.signInBtn,this.dom.openFormTrigger],{opacity:1,duration:.6},.3).to(this.dom.secondaryForm,{opacity:0,yPercent:20},0).to(this.dom.tickContainer,{opacity:0,duration:.1},0).set([this.dom.openFormTrigger,this.dom.signInBtnContainer,this.dom.submitContainer,this.dom.formContainer],{pointerEvents:"auto",overwrite:"auto"},0).set([this.dom.inputContainer],{pointerEvents:"none"},0).to(this.dom.navigation,{xPercent:0,overwrite:"true"},0).call(()=>{this.dom.el.classList.remove("reduce-padding")},null,0).set(this.dom.inputContainer,{opacity:1,width:this.inputWidth}).set(this.dom.input,{xPercent:100}).set(this.dom.confirmationText,{opacity:0}).set(this.dom.tickMask,{xPercent:-100}).set(this.dom.tickSvg,{xPercent:100}).to(this.dom.tickContainer,{opacity:1}).then(()=>{this.dom.inputEl.classList.remove("hide-placeholder")})});q(this,"onClickFormToggle",()=>{window.innerWidth>=1024?window.location.href="https://www.cosmos.so/onboarding":window.location.href="https://apps.apple.com/us/app/cosmos-curate-your-universe/id1577975475"});q(this,"closeForm",()=>{this.formOpen&&(this.formOpen=!1,this.formStateTL.reverse(),E.mq.sm.matches||Y.to(this.dom.menuIcon,{autoAlpha:1,display:"flex",delay:.5}),this.dom.el.classList.remove("mobile-bg"))});q(this,"playFormOpenTL",()=>{this.formOpen||this.formStateTL.restart()});q(this,"playFormCloseTL",()=>{this.formOpen&&this.formStateTL.reverse()});q(this,"onResize",()=>{if(this.formStateTL.kill(),Y.set([this.dom.navigation,this.dom.inner,this.dom.signInBtn,this.dom.mobBtnText],{clearProps:"all"}),this.flowComplete){Y.set([this.dom.formContainer,this.dom.signInBtnContainer],{clearProps:"all"});return}Y.set(this.dom.submit,{opacity:0}),this.flowStarted?this.resetForm():(this.formOpen=!1,this.getElemWidths(),this.setInitialPositions(),this.toggleFormState()),E.mq.sm.matches?Y.set(this.dom.menuIcon,{autoAlpha:0,display:"none"}):this.formOpen||Y.set(this.dom.menuIcon,{autoAlpha:1,display:"flex"})});q(this,"onScroll",({direction:t})=>{});q(this,"onInputChange",()=>{this.dom.secondaryInputEl.value.length>16?Y.to(this.dom.answerSubmitText,{opacity:0,duration:.26}):Y.to(this.dom.answerSubmitText,{opacity:1,duration:.26})});q(this,"onHeaderHidden",()=>{this.formOpen&&this.closeForm()});this.populateDom(),this.buttons=new $h(lg).init(t),this.formOpen=!1,this.flowComplete=!1,this.flowStarted=!1,this.toggleClicked=!1,E.AssetLoader.loaded.then(()=>{this.getElemWidths(),this.addEvents(),this.setInitialPositions(),this.toggleFormState()})}getElemWidths(){this.logoWidth=this.dom.logomarkContainer.getBoundingClientRect().width,this.signInBtnWidth=this.dom.signInBtnContainer.getBoundingClientRect().width,this.navWidth=this.dom.navigation.getBoundingClientRect().width,this.inputWidth=this.dom.input.getBoundingClientRect().width,this.submitWidth=this.dom.submitContainer.getBoundingClientRect().width,this.confirmationWidth=this.dom.confirmationText.getBoundingClientRect().width,this.tickWidth=this.dom.tickContainer.getBoundingClientRect().width,this.formWidth=this.dom.formContainer.getBoundingClientRect().width,this.defaultWidth=this.logoWidth+this.signInBtnWidth+this.navWidth+this.submitWidth,this.formWidth=this.logoWidth+this.inputWidth+this.submitWidth,this.submitStateWidth=this.logoWidth+this.confirmationWidth+this.tickWidth,this.secondFormWidth=this.tickWidth}setInitialPositions(){Y.timeline().set([this.dom.tickContainer,this.dom.secondaryTickContainer],{pointerEvents:"none"}).set([this.dom.tickMask,this.dom.secondaryTickMask],{xPercent:-100}).set([this.dom.tickSvg,this.dom.secondaryTickSvg],{xPercent:100}).set(this.dom.secondaryForm,{pointerEvents:"none",opacity:0,yPercent:20}).set([this.dom.waitlistLoading],{opacity:0}).set([this.dom.waitlistLoadingContainer,this.dom.secondaryLoadingContainer,this.dom.inputContainer],{pointerEvents:"none",opacity:0}).set([this.dom.signInBtnContainer,this.dom.openFormContainer],{pointerEvents:"auto"}).set(this.dom.closeForm,{opacity:0,pointerEvents:"none"}).set(this.dom.waitlistError,{yPercent:-20,xPercent:-50,opacity:0,pointerEvents:"none"}).set(this.dom.input,{xPercent:101}).set(this.dom.openFormTrigger,{opacity:1})}showError(){Y.to(this.dom.waitlistError,{yPercent:"+=20",opacity:1,overwrite:"auto",xPercent:-50})}hideError(){Y.to(this.dom.waitlistError,{yPercent:"+=-20",opacity:0,overwrite:"auto",xPercent:-50})}toggleFormState(){this.formStateTL=Y.timeline({paused:!0,defaults:{duration:1,ease:"expo.inOut"}}).to(this.dom.inner,{width:E.mq.sm.matches?this.formWidth:null}).to(this.dom.navigation,{xPercent:100},0).to(this.dom.input,{xPercent:0},0).to(this.dom.signInBtn,{opacity:0,duration:.8,ease:"linear"},0).to(this.dom.closeForm,{opacity:E.mq.sm.matches?0:1,pointerEvents:E.mq.sm.matches?"none":"auto"},0).to(this.dom.mobBtnText,{width:E.mq.sm.matches?null:0},0).set(this.dom.submit,{opacity:1}).set(this.dom.openFormTrigger,{opacity:0}).set([this.dom.openFormContainer,this.dom.signInBtnContainer],{pointerEvents:"none"},0).set([this.dom.formContainer,this.dom.submitContainer,this.dom.inputContainer],{pointerEvents:"auto",opacity:1},0).call(()=>{this.toggleClicked&&this.dom.inputEl.focus()})}returnToPreviousState(){Y.timeline({defaults:{duration:.3}}).to(this.dom.submitText,{opacity:1},.2).to(this.dom.waitlistLoading,{opacity:0},0).to(this.dom.closeForm,{opacity:E.mq.sm.matches?0:1,pointerEvents:"auto"},0).set(this.dom.waitlistLoading,{rotate:0,overwrite:"auto"})}addEvents(){this.on("click",this.dom.openFormTrigger,this.onClickFormToggle),this.on("click",this.dom.closeForm,this.closeForm),this.on("click",this.dom.closeSecondaryForm,this.resetForm),this.on("Header:OpenForm",this.playFormOpenTL),this.on("Header:CloseForm",this.playFormCloseTL),this.on(Je.RESIZE,this.onResize),this.on("input",this.dom.secondaryInputEl,this.onInputChange),this.on("ShyHeader:hidden",this.onHeaderHidden),E.SmoothScroll.Lenis.on("scroll",this.onScroll)}destroy(){super.destroy(),E.SmoothScroll.Lenis.off("scroll",this.onScroll)}}q(Sd,"selector",".js-header");class Ww extends Wt{constructor(t){super(t);q(this,"DIRECTION_UP",-1);q(this,"DIRECTION_DOWN",1);q(this,"TRIGGER_OFFSET",20);q(this,"isShown",!0);q(this,"duration",.4);q(this,"lastDirection",null);q(this,"isManuallyHidden",!1);q(this,"calculateY",()=>{const t=this.header.getBoundingClientRect();this.y=t.height+t.top+5});q(this,"hideHeader",()=>{var t;if(this.isShown=!1,E.isHeaderHidden=!0,!E.mq.touch.matches)for(let i=0;i<this.headerComponent.buttons.components.length;i++)this.headerComponent.buttons.components[i].hideGlowPanels();(t=this.tl)==null||t.kill(),this.tl=Y.timeline().to(this.header,{y:-this.y,ease:"power2.in",duration:this.duration,onComplete:()=>this.emit("ShyHeader:hidden")})});q(this,"showHeader",()=>{var t;if(this.isShown=!0,E.isHeaderHidden=!1,!E.mq.touch.matches)for(let i=0;i<this.headerComponent.buttons.components.length;i++)this.headerComponent.buttons.components[i].showGlowPanels();(t=this.tl)==null||t.kill(),this.tl=Y.timeline().to(this.header,{y:0,ease:"power2.out",duration:this.duration})});q(this,"enableShyHeader",()=>{E.isShyHeaderActive||(E.SmoothScroll.Lenis.on("scroll",this.onScroll),this.on("mouseenter",this.dom.trigger,this.onMouseEnter))});q(this,"disableShyHeader",()=>{E.SmoothScroll.Lenis.off("scroll",this.onScroll),this.off("mouseenter",this.dom.trigger,this.onMouseEnter),E.isHeaderHidden&&this.showHeader()});q(this,"addEvents",()=>{this.on(Je.RESIZE,this.onResize),this.on("ShyHeader:show",()=>{this.isManuallyHidden=!1,this.showHeader()}),this.on("ShyHeader:hide",()=>{this.isManuallyHidden=!0,this.hideHeader()}),this.on("ShyHeader:enable",()=>{this.enableShyHeader(),E.isShyHeaderActive=!0}),this.on("ShyHeader:disable",()=>{this.disableShyHeader(),E.isShyHeaderActive=!1}),E.Taxi.on("NAVIGATE_OUT",()=>{this.isManuallyHidden=!1})});q(this,"onResize",()=>{this.isManuallyHidden=!1,Y.set(this.header,{clearProps:"all"}),window.requestAnimationFrame(this.calculateY),E.isShyHeaderActive||(E.mq.sm.matches?this.disableShyHeader():this.enableShyHeader())});q(this,"onScroll",({direction:t,targetScroll:i})=>{window.clearTimeout(this.timeout),!(i<=0||this.isManuallyHidden)&&(this.timeout=window.setTimeout(()=>{this.lastDirection=null},100),t!==this.lastDirection&&(this.lastDirection=t,t===this.DIRECTION_DOWN&&this.isShown?this.hideHeader():t===this.DIRECTION_UP&&!this.isShown&&this.showHeader()))});q(this,"onMouseEnter",()=>{!this.isShown&&this.showHeader()});this.populateDom(),this.header=this.dom.el,this.headerComponent=E.staticComponents.get(Sd).get(0),Y.set(this.header,{willChange:"y"}),Y.set(this.dom.trigger,{height:this.TRIGGER_OFFSET}),this.calculateY(),this.addEvents()}destroy(){var t;super.destroy(),this.showHeader(),(t=this.tl)==null||t.kill(),E.SmoothScroll.Lenis.off("scroll",this.onScroll)}}q(Ww,"selector",".js-shy-header");class jw extends Wt{constructor(t,i=!1){super(t);q(this,"formIsSubmitting",!1);q(this,"email",null);q(this,"onEmailFormSubmit",t=>{t.preventDefault(),!this.formIsSubmitting&&(this.formIsSubmitting=!0,this.isHeader?(this.header.waitlistLoading(),this.header.waitlistLoadingTL.then(()=>{this.fetchFirstStep()})):(this.footer.waitlistLoading(),this.footer.waitlistLoadingTL.then(()=>{this.fetchFirstStep()})))});q(this,"onAnswerFormSubmit",t=>{t.preventDefault(),!this.formIsSubmitting&&(this.formIsSubmitting=!0,this.isHeader?(this.header.secondaryWaiting(),this.header.secondaryWaitingTL.then(()=>{this.fetchSecondStep()})):(this.footer.secondaryWaiting(),this.footer.secondaryWaitingTL.then(()=>{this.fetchSecondStep()})))});q(this,"fetchFirstStep",()=>{fetch({}.VITE_COSMOS_GRAPHQL_API,{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify({query:`
					mutation ($input: JoinWaitlistInput!) {
						waitlist {
							join(input: $input) {
								success
							}
						}
					}
				`,variables:{input:{email:this.dom.email.value}}})}).then(t=>t.json()).then(t=>{t.errors?this.handleEmailFormError(t.errors):this.handleEmailFormSuccess()}).catch(()=>{this.handleError()})});q(this,"fetchSecondStep",()=>{fetch({}.VITE_COSMOS_GRAPHQL_API,{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify({query:`
					mutation ($input: SubmitJoinFollowUpAnswerInput!) {
    					waitlist {
        					submitJoinFollowUpAnswer(input: $input) {
            					success
        					}
						}
					}
				`,variables:{input:{email:this.email,howHeardAboutUsAnswer:this.dom.answer.value}}})}).then(t=>t.json()).then(t=>{t.errors?this.handleAnswerFormError(t.errors):this.handleAnswerFormSuccess()}).catch(()=>{this.handleError()})});this.isHeader=t.classList.contains("js-header"),this.isAnswerFormEnabled=i,this.emailSubmitSuccess=!1,this.populateDom(),this.on("submit",this.dom.emailForm,this.onEmailFormSubmit),this.on("submit",this.dom.answerForm,this.onAnswerFormSubmit),this.isHeader&&(this.header=E.staticComponents.get(Sd).first()),this.isHeader||(this.footer=E.components.get(ag).first())}handleError(t=void 0){Array.isArray(t)&&t.length>0&&t[0].message?this.dom.waitlistError.innerHTML=t[0].message:this.dom.waitlistError.innerHTML="Sorry, something went wrong.",this.isHeader&&(this.header.showError(),this.emailSubmitSuccess?this.header.returnToPreviousStateSecondary():this.header.returnToPreviousState(),this.dom.emailForm.reset(),setTimeout(()=>{this.header.hideError()},5e3)),this.isHeader||(this.footer.showError(),this.emailSubmitSuccess?this.footer.returnToPreviousStateSecondary():this.footer.returnToPreviousState(),setTimeout(()=>{this.footer.hideError()},5e3))}handleEmailFormSuccess(){this.formIsSubmitting=!1,this.email=this.dom.email.value,this.isAnswerFormEnabled?this.header.formSubmissionSuccess():this.footer.formSubmissionSuccess(),this.emailSubmitSuccess=!0}handleEmailFormError(t){this.handleError(t),this.formIsSubmitting=!1}handleAnswerFormSuccess(){this.formIsSubmitting=!1,this.isHeader?this.header.secondaryComplete():this.footer.secondaryComplete(),this.dom.emailForm.reset(),this.dom.answerForm.reset()}handleAnswerFormError(t){this.handleError(t),this.formIsSubmitting=!1}}q(jw,"selector",".js-forms");class qw extends Wt{constructor(t){super(t);q(this,"onMouseEnterLight",()=>{this.el.classList.add("light-hovered")});q(this,"onMouseLeaveLight",()=>{this.el.classList.remove("light-hovered")});q(this,"onMouseEnterDark",()=>{this.el.classList.add("dark-hovered")});q(this,"onMouseLeaveDark",()=>{this.el.classList.remove("dark-hovered")});q(this,"toggleState",()=>{this.animating||(this.animating=!0,E.isDarkMode?(De.emit("DarkMode:enabled"),De.emit("ModeToggle:toggled"),this.dom.darkText.classList.add("active"),this.dom.lightText.classList.remove("active"),Y.timeline({onComplete:()=>{this.animating=!1}}).to(this.dom.iconArray[0],{opacity:1,duration:.3,ease:"expo.in"},0).to(this.dom.iconArray[1],{opacity:0,duration:.6,ease:"expo.out"},0)):(De.emit("DarkMode:disabled"),this.dom.lightText.classList.add("active"),this.dom.darkText.classList.remove("active"),Y.timeline({onComplete:()=>{this.animating=!1}}).to(this.dom.iconArray[1],{opacity:1,duration:.3,ease:"expo.in"},0).to(this.dom.iconArray[0],{opacity:0,duration:.6,ease:"expo.out"},0)))});q(this,"collapseToggle",()=>{var t;(t=this.tl)==null||t.restart(),this.collapsed=!0});q(this,"expandToggle",()=>{this.tl.reverse(),this.collapsed=!1});q(this,"onClick",()=>{this.animating||(E.isDarkMode=!E.isDarkMode,E.isDarkMode?E.html.classList.add("is-dark-mode"):E.html.classList.remove("is-dark-mode"),this.toggleState())});q(this,"onResize",()=>{var t;(t=this.tl)==null||t.kill(),this.tl=null,Y.set([this.dom.text,this.dom.mask,this.dom.maskInner,this.dom.icons,this.dom.borderArray,this.dom.borderInnerArray],{clearProps:"all"}),this.dom.borderArray[0].removeAttribute("style"),this.dom.borderInnerArray[0].removeAttribute("style"),this.dom.borderArray[1].removeAttribute("style"),this.dom.borderInnerArray[1].removeAttribute("style"),this.setup(),this.buildCollapseTimeline(),this.toggleState(),(!E.mq.sm.matches||this.collapsed)&&this.emit("ModeToggle:CollapseToggle")});this.populateDom(),this.animating=!1,this.setup(),this.buildCollapseTimeline(),this.toggleState(),this.collapsed=!1,this.on("click",this.el,this.onClick),this.on("ModeToggle:CollapseToggle",this.collapseToggle),this.on("ModeToggle:ExpandToggle",this.expandToggle),this.on("ModeToggle:ToggleState",this.onClick),this.on(Je.RESIZE,this.onResize),this.on("mouseenter",this.dom.lightText,this.onMouseEnterLight),this.on("mouseleave",this.dom.lightText,this.onMouseLeaveLight),this.on("mouseenter",this.dom.darkText,this.onMouseEnterDark),this.on("mouseleave",this.dom.darkText,this.onMouseLeaveDark),E.mq.sm.matches||this.emit("ModeToggle:CollapseToggle")}setup(){this.originalWidth=this.el.getBoundingClientRect().width,this.collapseWidth=this.dom.box.getBoundingClientRect().width,this.dom.borderArray[0].style.width=this.collapseWidth*.5+"px",this.dom.borderInnerArray[0].style.width=this.originalWidth+"px",this.dom.borderArray[1].style.width=this.originalWidth-this.collapseWidth*.5+"px",this.dom.borderInnerArray[1].style.width=this.originalWidth+"px",this.dom.borderInnerArray[1].style.left=-(this.collapseWidth*.5)+"px",this.collapseXPos=this.originalWidth-this.collapseWidth}buildCollapseTimeline(){this.tl=Y.timeline({paused:!0,defaults:{ease:"expo.inOut",duration:1}}).to(this.dom.borderInnerArray[1],{x:-this.collapseXPos},0).to(this.dom.mask,{x:-this.collapseXPos},0).to(this.dom.maskInner,{x:this.collapseXPos},0).to(this.dom.icons,{x:-this.originalWidth},0).to(this.dom.text,{x:E.mq.sm.matches?-this.originalWidth:-100},0).to(this.dom.glowInner,{xPercent:-48},0)}destroy(){super.destroy()}}q(qw,"selector",".js-mode-toggle");class Z3 extends yw{drag(){Y.to(this.dom.dot,{opacity:0,scale:0}),Y.to(this.dom.ew,{opacity:1,scale:1})}default(){Y.to(this.dom.dot,{opacity:1,scale:1}),Y.to(this.dom.ew,{opacity:0,scale:0})}}window.store=E;E.isAndroid&&E.html.classList.add("is-android");De.on("DOMContentLoaded",window,function(){var r;Je.enablePointerEvents(),Je.enableRAF(Y),Je.enableResize(100),Je.detectTouchDevice(),Je.enableDrag(),window.history.scrollRestoration&&(window.history.scrollRestoration="manual"),document.documentElement.style.setProperty("--vh",`${window.innerHeight*.01}px`),E.window.fullHeight=(r=document.querySelector(".height-div"))==null?void 0:r.clientHeight,Y.registerPlugin(ft,Ds,_r),P2(),E.AssetLoader=new DA,E.WebGL=new K3,pl.init(),E.initialWheelMultiplier=E.SmoothScroll.Lenis.virtualScroll.wheelMultiplier,E.initialTouchMultiplier=E.SmoothScroll.Lenis.virtualScroll.touchMultiplier,E.ScrollAnimations=new M2,E.FormsManager=new $h(jw),E.staticComponents.add(qw,Aw,new $h(Z3).with({offset:[.5,.5],ease:.09})),E.Taxi=new Y3,T2.init(),E.staticComponents.add(Sd,Ww,Gw,Hw,ww),this.header=st(".js-header"),this.headerForm=E.FormsManager.make(this.header,!0),E.mq.touch.matches&&Ln.init(),Ds.create("customIn","0.45, 0.34, 0.14, 0.99"),Ds.create("vortexIn","0.29, 0.11, 0.14, 99"),Ds.create("returnEase","M0,0 C0.196,0.598 0.298,1 0.5,1 0.696,1 0.794,0.604 1,0"),Ds.create("imageSlider","M0,0,C0.498,0.302,0.744,1,1,1"),Ds.create("searchOut","M0,0 C0.146,0 0.458,0.332 1,1 "),Ds.create("imageOut","M0,0 C0.194,0 0.18,0.042 1,1")});
